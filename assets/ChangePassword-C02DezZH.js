import{s as $}from"./index-B8WGv_8T.js";import{h as C,z as p,s as N}from"./index-BiNA2n31.js";import{d as j,u as A,r as M,o as e,f,w as r,b as o,e as a,t as l,c as i,i as g,F as v,h,j as L,s as q}from"./index-CbeY2LTE.js";import{s as D}from"./index-BE3N1hIV.js";import{s as E}from"./index-UGns2RAB.js";import{s as O}from"./index-7iI5GcAi.js";import{S as T}from"./index-uAFx2u3e.js";import"./index-B0qWFnFe.js";import"./index-d49K2imb.js";import"./index-BZp1jHCN.js";import"./index-C8kuHmDy.js";const Z={class:"flex flex-col gap-1"},G={for:"old_password"},H={class:"my-0 flex flex-col gap-1"},I={class:"flex flex-col gap-1"},J={for:"new_password"},K={class:"my-0 flex flex-col gap-1"},Q={class:"flex flex-col gap-1"},R={for:"confirm_password"},U={class:"my-0 flex flex-col gap-1"},ds=j({__name:"ChangePassword",setup(W){const y=A(),n=M(!1),P=M({old_password:"",new_password:""}),V=C(p.object({old_password:p.string().min(1,{message:"Old password is required."}).max(100,{message:"Maximum 100 characters."}),new_password:p.string().min(8,{message:"Minimum 8 characters."}).max(100,{message:"Maximum 100 characters."}).refine(s=>/[a-z]/.test(s),{message:"Must have a lowercase letter."}).refine(s=>/[A-Z]/.test(s),{message:"Must have an uppercase letter."}).refine(s=>/[0-9]/.test(s),{message:"Must have a number."}),confirm_password:p.string()}).refine(s=>s.new_password===s.confirm_password,{message:"Passwords must match",path:["confirm_password"]})),z=async s=>{if(!n.value&&s.valid){n.value=!0;try{const{data:d}=await T.changePassword(s.states.old_password.value,s.states.new_password.value);y.add({severity:"success",summary:d.message,life:2e3})}catch(d){y.add({severity:"error",summary:d.response.data.error,detail:d,life:2e3})}finally{n.value=!1}}};return(s,d)=>{const u=O,_=E,w=D,B=q,F=N,S=$;return e(),f(S,{class:"flex-grow",header:s.$t("pages.settings.changePassword")},{default:r(()=>[o(F,{initialValues:P.value,resolver:L(V),onSubmit:z,class:"flex flex-col gap-2"},{default:r(t=>{var b,x,k;return[a("div",Z,[o(_,{variant:"on"},{default:r(()=>[o(u,{id:"old_password",name:"old_password",feedback:!1,toggleMask:"",fluid:"",class:"w-full sm:w-96"}),a("label",G,l(s.$t("pages.settings.oldPassword")),1)]),_:1}),(b=t.old_password)!=null&&b.invalid?(e(),f(w,{key:0,severity:"error",size:"small",variant:"simple"},{default:r(()=>[a("ul",H,[(e(!0),i(v,null,g(t.old_password.errors,(c,m)=>(e(),i("li",{key:m},l(c.message),1))),128))])]),_:2},1024)):h("",!0)]),a("div",I,[o(_,{variant:"on"},{default:r(()=>[o(u,{id:"new_password",name:"new_password",feedback:!1,toggleMask:"",fluid:"",class:"w-full sm:w-96"}),a("label",J,l(s.$t("pages.settings.newPassword")),1)]),_:1}),(x=t.new_password)!=null&&x.invalid?(e(),f(w,{key:0,severity:"error",size:"small",variant:"simple"},{default:r(()=>[a("ul",K,[(e(!0),i(v,null,g(t.new_password.errors,(c,m)=>(e(),i("li",{key:m},l(c.message),1))),128))])]),_:2},1024)):h("",!0)]),a("div",Q,[o(_,{variant:"on"},{default:r(()=>[o(u,{id:"confirm_password",name:"confirm_password",feedback:!1,toggleMask:"",fluid:"",class:"w-full sm:w-96"}),a("label",R,l(s.$t("pages.settings.confirmPassword")),1)]),_:1}),(k=t.confirm_password)!=null&&k.invalid?(e(),f(w,{key:0,severity:"error",size:"small",variant:"simple"},{default:r(()=>[a("ul",U,[(e(!0),i(v,null,g(t.confirm_password.errors,(c,m)=>(e(),i("li",{key:m},l(c.message),1))),128))])]),_:2},1024)):h("",!0)]),o(B,{type:"submit",label:s.$t("pages.settings.savePassword"),class:"w-fit",loading:n.value,disabled:n.value},null,8,["label","loading","disabled"])]}),_:1},8,["initialValues","resolver"])]),_:1},8,["header"])}}});export{ds as default};
