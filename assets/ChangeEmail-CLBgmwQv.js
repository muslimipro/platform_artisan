import{s as T}from"./index-bzgAK5Mg.js";import{s as D}from"./index-DEz_X9Yd.js";import{d as S,W as U,S as A,G as F,u as Y,r as f,p as j,o as d,f as v,w as n,e as u,b as t,g as B,t as k,h as N,q,s as h,M as P,a as R,A as x,ay as z,c as G,j as p,F as H}from"./index-CvXDlvni.js";import{s as C}from"./index-CBf9SASP.js";import{a as L,s as O}from"./index-BtOIGHPq.js";import{s as W}from"./index-uzz1oX1u.js";import{_ as J}from"./VerifyEmailDialog.vue_vue_type_script_setup_true_lang-DfudCUj3.js";import{S as K}from"./index-DAPGQkQY.js";import{u as Q}from"./profile-k67oyp2c.js";import"./index-CwAQA0fP.js";import"./index-Cx2Z2ntV.js";const X={class:"text-blue-500"},Z={class:"flex flex-col gap-1"},ee={class:"flex gap-1 justify-end"},ae=S({__name:"VerifyNewEmailDialog",props:U({email:{}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(V){const g=V,c=A(V,"modelValue"),{t:_}=F(),r=Y(),s=f(!1),a=f(0);let m;const l=()=>{a.value=60,m=setInterval(()=>{a.value>0?a.value--:clearInterval(m)},1e3)};async function e(){s.value=!0;try{await K.changeEmail(g.email),r.add({severity:"success",summary:_("pages.settings.verificationEmailSent"),life:2e3}),l()}catch(o){console.log(o),r.add({severity:"error",summary:_("pages.settings.emailInvalid"),detail:o,life:2e3})}finally{s.value=!1}}return j(()=>{clearInterval(m)}),(o,y)=>{const b=q("i18n-t"),E=h,$=C,w=P;return d(),v(w,{visible:c.value,"onUpdate:visible":y[0]||(y[0]=I=>c.value=I),modal:"",draggable:!1,class:"m-4 max-w-md",header:o.$t("dialog.verifyYourEmail")},{footer:n(()=>[u("div",Z,[u("div",ee,[t(E,{label:a.value>0?`${o.$t("pages.login.resendIn")} ${a.value}s`:o.$t("dialog.sendVerificationEmail"),onClick:e,loading:s.value,disabled:s.value||a.value>0},null,8,["label","loading","disabled"])]),a.value>0?(d(),v($,{key:0,severity:"success"},{default:n(()=>[B(k(o.$t("pages.settings.weHaveSentLinkToVerifyEmail")),1)]),_:1})):N("",!0)])]),default:n(()=>[u("div",null,[t(b,{keypath:"dialog.confirmEmailAddress"},{email:n(()=>[u("span",X,k(g.email),1)]),_:1})])]),_:1},8,["visible","header"])}}}),se={class:"flex flex-col gap-2"},le={class:"flex flex-wrap sm:flex-nowrap gap-2"},oe={class:"flex flex-col gap-1"},ge=S({__name:"ChangeEmail",setup(V){const g=R(),{user:c}=x(g),_=Q(),{verified:r}=x(_),s=f(""),a=f(!1),m=f(!1);return z(()=>{var l;s.value=((l=c.value)==null?void 0:l.email)??""}),(l,e)=>{const o=L,y=W,b=O,E=C,$=h,w=D,I=T;return d(),G(H,null,[t(I,{class:"flex-grow",header:l.$t("pages.settings.changeEmail")},{default:n(()=>[u("div",se,[u("div",le,[u("div",oe,[t(b,null,{default:n(()=>[t(o,{class:"pi pi-envelope"}),t(y,{id:"email",autocomplete:"off",variant:"filled",placeholder:"Email",modelValue:s.value,"onUpdate:modelValue":e[0]||(e[0]=i=>s.value=i),disabled:p(r),class:"w-full sm:w-96"},null,8,["modelValue","disabled"])]),_:1}),t(E,{for:"email",severity:p(r)?"success":"error",size:"small",variant:"simple"},{default:n(()=>[B(k(p(r)?l.$t("pages.settings.yourEmailIsVerified"):l.$t("pages.settings.yourEmailIsNotVerified")),1)]),_:1},8,["severity"])]),p(r)?N("",!0):(d(),v(w,{key:0,severity:"danger"},{default:n(()=>{var i;return[((i=p(c))==null?void 0:i.email)==s.value?(d(),v($,{key:0,label:l.$t("pages.settings.verifyYourEmail"),onClick:e[1]||(e[1]=M=>a.value=!0)},null,8,["label"])):(d(),v($,{key:1,label:l.$t("pages.settings.verifyYourNewEmail"),onClick:e[2]||(e[2]=M=>m.value=!0),severity:"info"},null,8,["label"]))]}),_:1}))])])]),_:1},8,["header"]),t(J,{modelValue:a.value,"onUpdate:modelValue":e[3]||(e[3]=i=>a.value=i)},null,8,["modelValue"]),t(ae,{modelValue:m.value,"onUpdate:modelValue":e[4]||(e[4]=i=>m.value=i),email:s.value},null,8,["modelValue","email"])],64)}}});export{ge as default};
