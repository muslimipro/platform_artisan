import{s as ge}from"./index-BUJyY_Tq.js";import{a as F,r as b,a6 as oe,o as le,b as n,k as c,Y as ae,s as D,u as ve,c as E,_ as fe,e as S,g as e,w as x,f as y,U,h as m,t as j,l as g,S as se,n as te,F as ye,p as ne,q as be,bk as he,Q as ke,v as we,ab as Ce}from"./index-DHVnmQPM.js";import{s as Se}from"./index-B7xbQbD6.js";import{s as xe}from"./index-BM6hZtEV.js";import{s as Ve}from"./index-CzTZ9E-d.js";import{i as $e}from"./index-CG6SXWyB.js";import{S as I}from"./index-BlDh53mH.js";import{a as ze}from"./http-Dcz7Gd9U.js";import{u as Le}from"./profile-PDhrVDtH.js";import{T as je}from"./index-D-99ObJy.js";import{s as Ue}from"./index-CBTzXTNN.js";const es=F({__name:"LocaleSwitcher",setup(T){const i=b([{locale:"en",label:"Eng"},{locale:"ru",label:"Рус"},{locale:"kk",label:"Қаз"}]),{locale:o}=oe(),p=b(i.value[0]);le(()=>{const t=localStorage.getItem("selectedLanguage"),l=i.value.find(u=>u.locale===t)||i.value[0];p.value=l,o.value=l.locale});const v=t=>{const l=(t==null?void 0:t.locale)??i.value[0].locale;o.value=l,localStorage.setItem("selectedLanguage",l)};return(t,l)=>{const u=ge;return n(),c(u,{modelValue:p.value,"onUpdate:modelValue":[l[0]||(l[0]=_=>p.value=_),v],"dropdown-icon":"pi pi-globe",options:i.value,optionLabel:"label",checkmark:"",highlightOnSelect:!0,size:"small"},null,8,["modelValue","options"])}}}),Te={class:"relative overflow-hidden w-full border-0 bg-transparent flex items-start p-2 pl-4 rounded-none cursor-pointer transition-colors duration-200"},Be={class:"inline-flex flex-col items-start"},Me={class:"font-bold"},De={class:"text-sm"},Ee={key:0,class:"flex flex-col gap-1 px-2"},Ie=["href","onClick"],Fe={class:"ml-2"},Ne=["href","target"],Oe={class:"ml-2"},Pe={class:"flex justify-between items-center mb-8"},Re={class:"flex justify-end gap-2"},ss=F({__name:"UserMenu",setup(T){const i=ae(),{user:o}=D(i),p=ve(),v=ne(),{t}=oe(),l=b(),{width:u}=$e(),_=E(()=>u.value<640),B=E(()=>{const r=[{label:t("header.menu.settings"),icon:"pi pi-cog",route:"/settings/edit-profile"},{label:t("logOut"),icon:"pi pi-sign-out",command:async()=>{await v.replace({name:"login"}),await ze.logout(),i.logout()}}],s=[{label:t("projects"),icon:"pi pi-stop",route:"/projects"},{label:t("modules"),icon:"pi pi-circle",route:"/modules"}];return _.value?[...s,...r]:r}),h=r=>{l.value.toggle(r)};async function k(r){const{data:s}=await I.changeView(r);i.setToken(s),i.setUser(s),window.location.reload()}const V=b(""),w=b(!1),$=b(!1);async function ie(){if(V.value.length!=0){$.value=!0;try{const{data:r}=await I.joinClass(V.value);w.value=!1,window.location.reload(),p.add({severity:"success",summary:r.message,life:2e3})}catch(r){p.add({severity:"error",summary:r.response.data.error,detail:r,life:2e3})}finally{$.value=!1}}}const N=Le(),{fetchProfile:O}=N,{verified:P,profile:R,loading:re}=D(N),q=()=>{re.value||O()};return le(()=>{O(),window.addEventListener("focus",q)}),fe(()=>{window.removeEventListener("focus",q)}),(r,s)=>{const d=be,ue=Ve,ce=he,pe=ke("router-link"),de=xe,me=Se,_e=we,M=Ce;return n(),S(ye,null,[e(P)?(n(),c(d,{key:1,type:"button",icon:"pi pi-ellipsis-v",onClick:h,"aria-haspopup":"true","aria-controls":"overlay_menu",size:"small",variant:"outlined",severity:"secondary",class:"border border-slate-300 bg-slate-50",style:{width:"34px"}})):(n(),c(ue,{key:0,value:"1",severity:"danger",size:"small"},{default:x(()=>[y(d,{type:"button",icon:"pi pi-ellipsis-v",onClick:h,"aria-haspopup":"true","aria-controls":"overlay_menu",size:"small",variant:"outlined",severity:"secondary",class:"border border-slate-300 bg-slate-50",style:{width:"34px"}})]),_:1})),y(de,{ref_key:"menu",ref:l,id:"overlay_menu",model:B.value,popup:!0},{start:x(()=>{var a,C,z,L,A,Q,W,Y,G,H,J,K,X,Z;return[U((n(),S("button",Te,[m("span",Be,[m("span",Me,j((a=e(o))==null?void 0:a.email),1),m("span",De,j((C=e(o))==null?void 0:C.user_type),1)])])),[[M]]),["school_manager","super_admin"].includes(((z=e(o))==null?void 0:z.origin_user_type)??"student")?g("",!0):(n(),S("div",Ee,[((L=e(o))==null?void 0:L.user_type)!="teacher"&&((A=e(o))==null?void 0:A.origin_user_type)!="student"?(n(),c(d,{key:0,label:"Teacher mode",class:"w-full",size:"small",onClick:s[0]||(s[0]=f=>k("teacher"))})):g("",!0),((Q=e(o))==null?void 0:Q.user_type)!="student"?(n(),c(d,{key:1,label:"Student mode",class:"w-full",size:"small",onClick:s[1]||(s[1]=f=>k("student")),severity:"info"})):g("",!0),!["student","teacher"].includes(((W=e(o))==null?void 0:W.origin_user_type)??"student")&&((Y=e(o))==null?void 0:Y.user_type)!=((G=e(o))==null?void 0:G.origin_user_type)?(n(),c(d,{key:2,label:`${(H=e(o))==null?void 0:H.origin_user_type.replace(/_/g," ").replace(/^./,f=>f.toUpperCase())} mode`,class:"w-full",size:"small",onClick:s[2]||(s[2]=f=>{var ee;return k(((ee=e(o))==null?void 0:ee.origin_user_type)??"student")}),severity:"help"},null,8,["label"])):g("",!0),((J=e(o))==null?void 0:J.origin_user_type)=="student"&&((K=e(R))==null?void 0:K.class_name)==null?(n(),c(d,{key:3,label:e(t)("pages.settings.joinClass"),icon:"pi pi-user-plus",size:"small",variant:"outlined",onClick:s[3]||(s[3]=f=>w.value=!0)},null,8,["label"])):g("",!0),((X=e(o))==null?void 0:X.origin_user_type)=="student"&&((Z=e(R))==null?void 0:Z.class_name)!=null?(n(),c(d,{key:4,label:e(t)("pages.teacher.schedule"),icon:"pi pi-calendar-plus",size:"small",variant:"outlined",onClick:s[4]||(s[4]=f=>r.$router.push("/student/schedule"))},null,8,["label"])):g("",!0)]))]}),item:x(({item:a,props:C})=>[a.route?(n(),c(pe,{key:0,to:a.route},{default:x(({href:z,navigate:L})=>[U((n(),S("a",se({href:z},C.action,{onClick:L}),[m("span",{class:te(a.icon)},null,2),m("span",Fe,j(a.label),1),!e(P)&&a.route.includes("settings")?(n(),c(ce,{key:0,value:"1",severity:"danger",size:"small"})):g("",!0)],16,Ie)),[[M]])]),_:2},1032,["to"])):U((n(),S("a",se({key:1,href:a.url,target:a.target},C.action),[m("span",{class:te(a.icon)},null,2),m("span",Oe,j(a.label),1)],16,Ne)),[[M]])]),_:1},8,["model"]),y(_e,{visible:w.value,"onUpdate:visible":s[7]||(s[7]=a=>w.value=a),modal:"",header:e(t)("pages.settings.joinClassByCode"),closable:!1},{default:x(()=>[m("div",Pe,[y(me,{type:"text",modelValue:V.value,"onUpdate:modelValue":s[5]||(s[5]=a=>V.value=a),placeholder:e(t)("pages.settings.enterCode")},null,8,["modelValue","placeholder"])]),m("div",Re,[y(d,{type:"button",label:e(t)("pages.settings.cancel"),severity:"secondary",onClick:s[6]||(s[6]=a=>w.value=!1)},null,8,["label"]),y(d,{type:"button",label:e(t)("pages.settings.join"),onClick:ie,loading:$.value,disabled:$.value},null,8,["label","loading","disabled"])])]),_:1},8,["visible","header"])],64)}}}),ts=F({__name:"StudentViewToggle",props:{path:{}},setup(T){const i=T,o=ne(),p=ae(),{user:v}=D(p),t=E({get:()=>{var l;return((l=v.value)==null?void 0:l.user_type)==="student"},set:async l=>{var _;const{data:u}=await I.changeView(l?"student":((_=v.value)==null?void 0:_.origin_user_type)??"student");p.setToken(u),p.setUser(u),i.path?o.push({path:i.path}):window.location.reload()}});return(l,u)=>{var h;const _=Ue,B=je;return["editor","contributor"].includes(((h=e(v))==null?void 0:h.origin_user_type)??"")?U((n(),c(_,{key:0,modelValue:t.value,"onUpdate:modelValue":u[0]||(u[0]=k=>t.value=k)},null,8,["modelValue"])),[[B,"Student view"]]):g("",!0)}}});export{ts as _,es as a,ss as b};
