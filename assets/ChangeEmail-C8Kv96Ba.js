import{s as T}from"./index-CyvfL-8M.js";import{s as D}from"./index-B66HduS2.js";import{d as x,W as U,S as A,u as F,r as c,p as Y,o as m,f,w as i,e as r,b as o,g as B,t as k,h as N,q as j,s as S,M as q,a as P,y as I,ay as R,c as z,j as p,F as H}from"./index-BRYS-vcQ.js";import{s as h}from"./index-Bd-ljPhE.js";import{a as L,s as O}from"./index-BI2AGJnZ.js";import{s as W}from"./index-Df5aeo5u.js";import{_ as G}from"./VerifyEmailDialog.vue_vue_type_script_setup_true_lang-CBey6nZL.js";import{S as J}from"./index-CXh-xjcX.js";import{u as K}from"./profile-DexA0tEb.js";import"./index-Bkk6Dlez.js";import"./index-5i-JSLCr.js";import"./index-Cu6Erxkx.js";const Q={class:"text-blue-500"},X={class:"flex flex-col gap-1"},Z={class:"flex gap-1 justify-end"},ee=x({__name:"VerifyNewEmailDialog",props:U({email:{}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup($){const v=$,u=A($,"modelValue"),g=F(),l=c(!1),a=c(0);let n;const d=()=>{a.value=60,n=setInterval(()=>{a.value>0?a.value--:clearInterval(n)},1e3)};async function s(){l.value=!0;try{const{data:e}=await J.changeEmail(v.email);g.add({severity:"success",summary:e.message,life:2e3}),d()}catch(e){g.add({severity:"error",summary:e.response.data.error,detail:e,life:2e3})}finally{l.value=!1}}return Y(()=>{clearInterval(n)}),(e,_)=>{const V=j("i18n-t"),b=S,E=h,y=q;return m(),f(y,{visible:u.value,"onUpdate:visible":_[0]||(_[0]=w=>u.value=w),modal:"",draggable:!1,class:"m-4 max-w-md",header:e.$t("dialog.verifyYourEmail")},{footer:i(()=>[r("div",X,[r("div",Z,[o(b,{label:a.value>0?`${e.$t("pages.login.resendIn")} ${a.value}s`:e.$t("dialog.sendVerificationEmail"),onClick:s,loading:l.value,disabled:l.value||a.value>0},null,8,["label","loading","disabled"])]),a.value>0?(m(),f(E,{key:0,severity:"success"},{default:i(()=>[B(k(e.$t("pages.settings.weHaveSentLinkToVerifyEmail")),1)]),_:1})):N("",!0)])]),default:i(()=>[r("div",null,[o(V,{keypath:"dialog.confirmEmailAddress"},{email:i(()=>[r("span",Q,k(v.email),1)]),_:1})])]),_:1},8,["visible","header"])}}}),ae={class:"flex flex-col gap-2"},se={class:"flex flex-wrap sm:flex-nowrap gap-2"},le={class:"flex flex-col gap-1"},ge=x({__name:"ChangeEmail",setup($){const v=P(),{user:u}=I(v),g=K(),{verified:l}=I(g),a=c(""),n=c(!1),d=c(!1);return R(()=>{var s;a.value=((s=u.value)==null?void 0:s.email)??""}),(s,e)=>{const _=L,V=W,b=O,E=h,y=S,w=D,C=T;return m(),z(H,null,[o(C,{class:"flex-grow",header:s.$t("pages.settings.changeEmail")},{default:i(()=>[r("div",ae,[r("div",se,[r("div",le,[o(b,null,{default:i(()=>[o(_,{class:"pi pi-envelope"}),o(V,{id:"email",autocomplete:"off",variant:"filled",placeholder:"Email",modelValue:a.value,"onUpdate:modelValue":e[0]||(e[0]=t=>a.value=t),disabled:p(l),class:"w-full sm:w-96"},null,8,["modelValue","disabled"])]),_:1}),o(E,{for:"email",severity:p(l)?"success":"error",size:"small",variant:"simple"},{default:i(()=>[B(k(p(l)?s.$t("pages.settings.yourEmailIsVerified"):s.$t("pages.settings.yourEmailIsNotVerified")),1)]),_:1},8,["severity"])]),p(l)?N("",!0):(m(),f(w,{key:0,severity:"danger"},{default:i(()=>{var t;return[((t=p(u))==null?void 0:t.email)==a.value?(m(),f(y,{key:0,label:s.$t("pages.settings.verifyYourEmail"),onClick:e[1]||(e[1]=M=>n.value=!0)},null,8,["label"])):(m(),f(y,{key:1,label:s.$t("pages.settings.verifyYourNewEmail"),onClick:e[2]||(e[2]=M=>d.value=!0),severity:"info"},null,8,["label"]))]}),_:1}))])])]),_:1},8,["header"]),o(G,{modelValue:n.value,"onUpdate:modelValue":e[3]||(e[3]=t=>n.value=t)},null,8,["modelValue"]),o(ee,{modelValue:d.value,"onUpdate:modelValue":e[4]||(e[4]=t=>d.value=t),email:a.value},null,8,["modelValue","email"])],64)}}});export{ge as default};
