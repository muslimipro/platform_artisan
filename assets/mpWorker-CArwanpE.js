var Fe=Object.defineProperty;var Oe=(e,t,r)=>t in e?Fe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var ke=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var b=(e,t,r)=>Oe(e,typeof t!="symbol"?t+"":t,r);var ot=ke((at,G)=>{var P=(e=>(e.PinGetValue="pin get value",e.PinGetMode="pin get mode",e.PinGetPull="pin get pull",e.AdcReadU16="adc read_u16",e.I2CScan="i2c scan",e.I2CReadFromMem="i2c readfrom_mem",e))(P||{});const Q=2;var p=(e=>(e.I2CWriteToMem="i2c writefrom_mem",e.PinSetValue="pin set value",e.PinSetMode="pin set mode",e.PinSetPull="pin set pull",e.PwmFreq="pwm freq",e.PwmDutyU16="pwm duty_u16",e.Output="output",e.Sleep="sleep",e.DisplayText="display text",e.DisplayClear="display clear",e.NeoPixelWrite="neopixel write",e.KeyboardInterrupt="keyboard interrupt",e.Error="error",e))(p||{}),U=(e=>(e.Finished="finished",e.Initialized="initialized",e.Timeout="timeout",e))(U||{});Object.values({...P,...p,...U});new Set(Object.values(P));new Set(Object.values(U));new Set(Object.values(p));var N=(e=>(e[e.NONE=-1]="NONE",e[e.IN=0]="IN",e[e.OUT=1]="OUT",e[e.ANALOG=5]="ANALOG",e[e.PWM=6]="PWM",e))(N||{}),W=(e=>(e[e.NONE=-1]="NONE",e[e.UP=0]="UP",e[e.DOWN=1]="DOWN",e))(W||{}),xe=Object.defineProperty,m=(e,t)=>xe(e,"name",{value:t,configurable:!0}),re=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(t,r)=>(typeof require<"u"?require:t)[r]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw new Error('Dynamic require of "'+e+'" is not supported')});function ie(e){return!isNaN(parseFloat(e))&&isFinite(e)}m(ie,"_isNumber");function _(e){return e.charAt(0).toUpperCase()+e.substring(1)}m(_,"_capitalize");function B(e){return function(){return this[e]}}m(B,"_getter");var k=["isConstructor","isEval","isNative","isToplevel"],x=["columnNumber","lineNumber"],I=["fileName","functionName","source"],Ie=["args"],De=["evalOrigin"],j=k.concat(x,I,Ie,De);function w(e){if(e)for(var t=0;t<j.length;t++)e[j[t]]!==void 0&&this["set"+_(j[t])](e[j[t]])}m(w,"StackFrame");w.prototype={getArgs:function(){return this.args},setArgs:function(e){if(Object.prototype.toString.call(e)!=="[object Array]")throw new TypeError("Args must be an Array");this.args=e},getEvalOrigin:function(){return this.evalOrigin},setEvalOrigin:function(e){if(e instanceof w)this.evalOrigin=e;else if(e instanceof Object)this.evalOrigin=new w(e);else throw new TypeError("Eval Origin must be an Object or StackFrame")},toString:function(){var e=this.getFileName()||"",t=this.getLineNumber()||"",r=this.getColumnNumber()||"",s=this.getFunctionName()||"";return this.getIsEval()?e?"[eval] ("+e+":"+t+":"+r+")":"[eval]:"+t+":"+r:s?s+" ("+e+":"+t+":"+r+")":e+":"+t+":"+r}};w.fromString=m(function(e){var t=e.indexOf("("),r=e.lastIndexOf(")"),s=e.substring(0,t),i=e.substring(t+1,r).split(","),n=e.substring(r+1);if(n.indexOf("@")===0)var o=/@(.+?)(?::(\d+))?(?::(\d+))?$/.exec(n,""),a=o[1],c=o[2],l=o[3];return new w({functionName:s,args:i||void 0,fileName:a,lineNumber:c||void 0,columnNumber:l||void 0})},"StackFrame$$fromString");for(S=0;S<k.length;S++)w.prototype["get"+_(k[S])]=B(k[S]),w.prototype["set"+_(k[S])]=function(e){return function(t){this[e]=!!t}}(k[S]);var S;for(E=0;E<x.length;E++)w.prototype["get"+_(x[E])]=B(x[E]),w.prototype["set"+_(x[E])]=function(e){return function(t){if(!ie(t))throw new TypeError(e+" must be a Number");this[e]=Number(t)}}(x[E]);var E;for(A=0;A<I.length;A++)w.prototype["get"+_(I[A])]=B(I[A]),w.prototype["set"+_(I[A])]=function(e){return function(t){this[e]=String(t)}}(I[A]);var A,z=w;function ne(){var e=/^\s*at .*(\S+:\d+|\(native\))/m,t=/^(eval@)?(\[native code])?$/;return{parse:m(function(r){if(r.stack&&r.stack.match(e))return this.parseV8OrIE(r);if(r.stack)return this.parseFFOrSafari(r);throw new Error("Cannot parse given Error object")},"ErrorStackParser$$parse"),extractLocation:m(function(r){if(r.indexOf(":")===-1)return[r];var s=/(.+?)(?::(\d+))?(?::(\d+))?$/,i=s.exec(r.replace(/[()]/g,""));return[i[1],i[2]||void 0,i[3]||void 0]},"ErrorStackParser$$extractLocation"),parseV8OrIE:m(function(r){var s=r.stack.split(`
`).filter(function(i){return!!i.match(e)},this);return s.map(function(i){i.indexOf("(eval ")>-1&&(i=i.replace(/eval code/g,"eval").replace(/(\(eval at [^()]*)|(,.*$)/g,""));var n=i.replace(/^\s+/,"").replace(/\(eval code/g,"(").replace(/^.*?\s+/,""),o=n.match(/ (\(.+\)$)/);n=o?n.replace(o[0],""):n;var a=this.extractLocation(o?o[1]:n),c=o&&n||void 0,l=["eval","<anonymous>"].indexOf(a[0])>-1?void 0:a[0];return new z({functionName:c,fileName:l,lineNumber:a[1],columnNumber:a[2],source:i})},this)},"ErrorStackParser$$parseV8OrIE"),parseFFOrSafari:m(function(r){var s=r.stack.split(`
`).filter(function(i){return!i.match(t)},this);return s.map(function(i){if(i.indexOf(" > eval")>-1&&(i=i.replace(/ line (\d+)(?: > eval line \d+)* > eval:\d+:\d+/g,":$1")),i.indexOf("@")===-1&&i.indexOf(":")===-1)return new z({functionName:i});var n=/((.*".+"[^@]*)?[^@]*)(?:@)/,o=i.match(n),a=o&&o[1]?o[1]:void 0,c=this.extractLocation(i.replace(n,""));return new z({functionName:a,fileName:c[0],lineNumber:c[1],columnNumber:c[2],source:i})},this)},"ErrorStackParser$$parseFFOrSafari")}}m(ne,"ErrorStackParser");var Le=new ne,qe=Le,v=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string"&&!process.browser,oe=v&&typeof G<"u"&&typeof G.exports<"u"&&typeof re<"u"&&typeof __dirname<"u",Ue=v&&!oe,Te=typeof Deno<"u",se=!v&&!Te,Re=se&&typeof window=="object"&&typeof document=="object"&&typeof document.createElement=="function"&&"sessionStorage"in window&&typeof importScripts!="function",je=se&&typeof importScripts=="function"&&typeof self=="object";typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent.indexOf("Chrome")==-1&&navigator.userAgent.indexOf("Safari")>-1;var ae,V,ce,X,K;async function Y(){if(!v||(ae=(await import("./__vite-browser-external-9wXp6ZBx.js")).default,X=await import("./__vite-browser-external-9wXp6ZBx.js"),K=await import("./__vite-browser-external-9wXp6ZBx.js"),ce=(await import("./__vite-browser-external-9wXp6ZBx.js")).default,V=await import("./__vite-browser-external-9wXp6ZBx.js"),J=V.sep,typeof re<"u"))return;let e=X,t=await import("./__vite-browser-external-9wXp6ZBx.js"),r=await import("./__vite-browser-external-9wXp6ZBx.js"),s=await import("./__vite-browser-external-9wXp6ZBx.js"),i={fs:e,crypto:t,ws:r,child_process:s};globalThis.require=function(n){return i[n]}}m(Y,"initNodeModules");function le(e,t){return V.resolve(t||".",e)}m(le,"node_resolvePath");function ue(e,t){return t===void 0&&(t=location),new URL(e,t).toString()}m(ue,"browser_resolvePath");var C;v?C=le:C=ue;var J;v||(J="/");function me(e,t){return e.startsWith("file://")&&(e=e.slice(7)),e.includes("://")?{response:fetch(e)}:{binary:K.readFile(e).then(r=>new Uint8Array(r.buffer,r.byteOffset,r.byteLength))}}m(me,"node_getBinaryResponse");function fe(e,t){let r=new URL(e,location);return{response:fetch(r,t?{integrity:t}:{})}}m(fe,"browser_getBinaryResponse");var M;v?M=me:M=fe;async function de(e,t){let{response:r,binary:s}=M(e,t);if(s)return s;let i=await r;if(!i.ok)throw new Error(`Failed to load '${e}': request failed.`);return new Uint8Array(await i.arrayBuffer())}m(de,"loadBinaryFile");var $;if(Re)$=m(async e=>await import(e),"loadScript");else if(je)$=m(async e=>{try{globalThis.importScripts(e)}catch(t){if(t instanceof TypeError)await import(e);else throw t}},"loadScript");else if(v)$=pe;else throw new Error("Cannot determine runtime environment");async function pe(e){e.startsWith("file://")&&(e=e.slice(7)),e.includes("://")?ce.runInThisContext(await(await fetch(e)).text()):await import(ae.pathToFileURL(e).href)}m(pe,"nodeLoadScript");async function ye(e){if(v){await Y();let t=await K.readFile(e,{encoding:"utf8"});return JSON.parse(t)}else return await(await fetch(e)).json()}m(ye,"loadLockFile");async function he(){if(oe)return __dirname;let e;try{throw new Error}catch(s){e=s}let t=qe.parse(e)[0].fileName;if(v&&!t.startsWith("file://")&&(t=`file://${t}`),Ue){let s=await import("./__vite-browser-external-9wXp6ZBx.js");return(await import("./__vite-browser-external-9wXp6ZBx.js")).fileURLToPath(s.dirname(t))}let r=t.lastIndexOf(J);if(r===-1)throw new Error("Could not extract indexURL path from pyodide module location");return t.slice(0,r)}m(he,"calculateDirname");function we(e){let t=e.FS,r=e.FS.filesystems.MEMFS,s=e.PATH,i={DIR_MODE:16895,FILE_MODE:33279,mount:function(n){if(!n.opts.fileSystemHandle)throw new Error("opts.fileSystemHandle is required");return r.mount.apply(null,arguments)},syncfs:async(n,o,a)=>{try{let c=i.getLocalSet(n),l=await i.getRemoteSet(n),u=o?l:c,d=o?c:l;await i.reconcile(n,u,d),a(null)}catch(c){a(c)}},getLocalSet:n=>{let o=Object.create(null);function a(u){return u!=="."&&u!==".."}m(a,"isRealDir");function c(u){return d=>s.join2(u,d)}m(c,"toAbsolute");let l=t.readdir(n.mountpoint).filter(a).map(c(n.mountpoint));for(;l.length;){let u=l.pop(),d=t.stat(u);t.isDir(d.mode)&&l.push.apply(l,t.readdir(u).filter(a).map(c(u))),o[u]={timestamp:d.mtime,mode:d.mode}}return{type:"local",entries:o}},getRemoteSet:async n=>{let o=Object.create(null),a=await $e(n.opts.fileSystemHandle);for(let[c,l]of a)c!=="."&&(o[s.join2(n.mountpoint,c)]={timestamp:l.kind==="file"?(await l.getFile()).lastModifiedDate:new Date,mode:l.kind==="file"?i.FILE_MODE:i.DIR_MODE});return{type:"remote",entries:o,handles:a}},loadLocalEntry:n=>{let o=t.lookupPath(n).node,a=t.stat(n);if(t.isDir(a.mode))return{timestamp:a.mtime,mode:a.mode};if(t.isFile(a.mode))return o.contents=r.getFileDataAsTypedArray(o),{timestamp:a.mtime,mode:a.mode,contents:o.contents};throw new Error("node type not supported")},storeLocalEntry:(n,o)=>{if(t.isDir(o.mode))t.mkdirTree(n,o.mode);else if(t.isFile(o.mode))t.writeFile(n,o.contents,{canOwn:!0});else throw new Error("node type not supported");t.chmod(n,o.mode),t.utime(n,o.timestamp,o.timestamp)},removeLocalEntry:n=>{var o=t.stat(n);t.isDir(o.mode)?t.rmdir(n):t.isFile(o.mode)&&t.unlink(n)},loadRemoteEntry:async n=>{if(n.kind==="file"){let o=await n.getFile();return{contents:new Uint8Array(await o.arrayBuffer()),mode:i.FILE_MODE,timestamp:o.lastModifiedDate}}else{if(n.kind==="directory")return{mode:i.DIR_MODE,timestamp:new Date};throw new Error("unknown kind: "+n.kind)}},storeRemoteEntry:async(n,o,a)=>{let c=n.get(s.dirname(o)),l=t.isFile(a.mode)?await c.getFileHandle(s.basename(o),{create:!0}):await c.getDirectoryHandle(s.basename(o),{create:!0});if(l.kind==="file"){let u=await l.createWritable();await u.write(a.contents),await u.close()}n.set(o,l)},removeRemoteEntry:async(n,o)=>{await n.get(s.dirname(o)).removeEntry(s.basename(o)),n.delete(o)},reconcile:async(n,o,a)=>{let c=0,l=[];Object.keys(o.entries).forEach(function(f){let h=o.entries[f],g=a.entries[f];(!g||t.isFile(h.mode)&&h.timestamp.getTime()>g.timestamp.getTime())&&(l.push(f),c++)}),l.sort();let u=[];if(Object.keys(a.entries).forEach(function(f){o.entries[f]||(u.push(f),c++)}),u.sort().reverse(),!c)return;let d=o.type==="remote"?o.handles:a.handles;for(let f of l){let h=s.normalize(f.replace(n.mountpoint,"/")).substring(1);if(a.type==="local"){let g=d.get(h),R=await i.loadRemoteEntry(g);i.storeLocalEntry(f,R)}else{let g=i.loadLocalEntry(f);await i.storeRemoteEntry(d,h,g)}}for(let f of u)if(a.type==="local")i.removeLocalEntry(f);else{let h=s.normalize(f.replace(n.mountpoint,"/")).substring(1);await i.removeRemoteEntry(d,h)}}};e.FS.filesystems.NATIVEFS_ASYNC=i}m(we,"initializeNativeFS");var $e=m(async e=>{let t=[];async function r(i){for await(let n of i.values())t.push(n),n.kind==="directory"&&await r(n)}m(r,"collect"),await r(e);let s=new Map;s.set(".",e);for(let i of t){let n=(await e.resolve(i)).join("/");s.set(n,i)}return s},"getFsHandles");function ge(e){let t={noImageDecoding:!0,noAudioDecoding:!0,noWasmDecoding:!1,preRun:Ee(e),quit(r,s){throw t.exited={status:r,toThrow:s},s},print:e.stdout,printErr:e.stderr,arguments:e.args,API:{config:e},locateFile:r=>e.indexURL+r,instantiateWasm:Ae(e.indexURL)};return t}m(ge,"createSettings");function ve(e){return function(t){let r="/";try{t.FS.mkdirTree(e)}catch(s){console.error(`Error occurred while making a home directory '${e}':`),console.error(s),console.error(`Using '${r}' for a home directory instead`),e=r}t.FS.chdir(e)}}m(ve,"createHomeDirectory");function be(e){return function(t){Object.assign(t.ENV,e)}}m(be,"setEnvironment");function _e(e){return t=>{for(let r of e)t.FS.mkdirTree(r),t.FS.mount(t.FS.filesystems.NODEFS,{root:r},r)}}m(_e,"mountLocalDirectories");function Se(e){let t=de(e);return r=>{let s=r._py_version_major(),i=r._py_version_minor();r.FS.mkdirTree("/lib"),r.FS.mkdirTree(`/lib/python${s}.${i}/site-packages`),r.addRunDependency("install-stdlib"),t.then(n=>{r.FS.writeFile(`/lib/python${s}${i}.zip`,n)}).catch(n=>{console.error("Error occurred while installing the standard library:"),console.error(n)}).finally(()=>{r.removeRunDependency("install-stdlib")})}}m(Se,"installStdlib");function Ee(e){let t;return e.stdLibURL!=null?t=e.stdLibURL:t=e.indexURL+"python_stdlib.zip",[Se(t),ve(e.env.HOME),be(e.env),_e(e._node_mounts),we]}m(Ee,"getFileSystemInitializationFuncs");function Ae(e){if(typeof WasmOffsetConverter<"u")return;let{binary:t,response:r}=M(e+"pyodide.asm.wasm");return function(s,i){return async function(){try{let n;r?n=await WebAssembly.instantiateStreaming(r,s):n=await WebAssembly.instantiate(await t,s);let{instance:o,module:a}=n;i(o,a)}catch(n){console.warn("wasm instantiation failed!"),console.warn(n)}}(),{}}}m(Ae,"getInstantiateWasmFunc");var ee="0.27.2";async function Pe(e={}){var t,r;await Y();let s=e.indexURL||await he();s=C(s),s.endsWith("/")||(s+="/"),e.indexURL=s;let i={fullStdLib:!1,jsglobals:globalThis,stdin:globalThis.prompt?globalThis.prompt:void 0,lockFileURL:s+"pyodide-lock.json",args:[],_node_mounts:[],env:{},packageCacheDir:s,packages:[],enableRunUntilComplete:!1,checkAPIVersion:!0,BUILD_ID:"f88dc4abb40ec8e780c94a5f70bcef45ec9eb3c1aee1c99da527febfef1c6f3f"},n=Object.assign(i,e);(t=n.env).HOME??(t.HOME="/home/pyodide"),(r=n.env).PYTHONINSPECT??(r.PYTHONINSPECT="1");let o=ge(n),a=o.API;if(a.lockFilePromise=ye(n.lockFileURL),typeof _createPyodideModule!="function"){let f=`${n.indexURL}pyodide.asm.js`;await $(f)}let c;if(e._loadSnapshot){let f=await e._loadSnapshot;ArrayBuffer.isView(f)?c=f:c=new Uint8Array(f),o.noInitialRun=!0,o.INITIAL_MEMORY=c.length}let l=await _createPyodideModule(o);if(o.exited)throw o.exited.toThrow;if(e.pyproxyToStringRepr&&a.setPyProxyToStringMethod(!0),a.version!==ee&&n.checkAPIVersion)throw new Error(`Pyodide version does not match: '${ee}' <==> '${a.version}'. If you updated the Pyodide version, make sure you also updated the 'indexURL' parameter passed to loadPyodide.`);l.locateFile=f=>{throw new Error("Didn't expect to load any more file_packager files!")};let u;c&&(u=a.restoreSnapshot(c));let d=a.finalizeBootstrap(u,e._snapshotDeserializer);return a.sys.path.insert(0,a.config.env.HOME),d.version.includes("dev")||a.setCdnUrl(`https://cdn.jsdelivr.net/pyodide/v${d.version}/full/`),a._pyodide.set_excepthook(),await a.packageIndexReady,a.initializeStreams(n.stdin,n.stdout,n.stderr),d}m(Pe,"loadPyodide");const Me=new SharedArrayBuffer(16),H=new Int32Array(Me),We=new SharedArrayBuffer(2),L=new Uint8Array(We);function y(e){Atomics.store(H,0,0);const t=Ne.currentframe().f_lineno;postMessage({content:e,line:t}),Atomics.wait(H,0,0)}function O(e){postMessage({content:e,line:-1})}function Be(e,t){return e+t}function ze(e,t){return e-t}class Z{constructor(t,r,s){b(this,"pin");this.pin=t,y({command:p.PinSetMode,request:{pin:this.pin,mode:r}}),y({command:p.PinSetPull,request:{pin:this.pin,pull:s}})}on(){y({command:p.PinSetValue,request:{pin:this.pin,value:1}})}off(){y({command:p.PinSetValue,request:{pin:this.pin,value:0}})}toggle(){const t=this.value();y({command:p.PinSetValue,request:{pin:this.pin,value:1-t}})}value(t=null){if(t===1)this.on();else if(t===0)this.off();else{const r=new Int8Array(new SharedArrayBuffer(4));return y({command:P.PinGetValue,request:{pin:this.pin},result:r}),Atomics.load(r,0)}}}function T(e){return e instanceof Z?e.pin:e}class Ve{constructor(t,r,s){b(this,"pin");this.pin=T(t),t instanceof Z?y({command:p.PinSetMode,request:{pin:this.pin,mode:N.OUT}}):y({command:p.PinSetMode,request:{pin:this.pin,mode:N.OUT}})}freq(t){y({command:p.PwmFreq,request:{freq:t,pin:this.pin}})}duty_u16(t){y({command:p.PwmDutyU16,request:{duty_u16:t,pin:this.pin}})}}const Ce={0:[0,4,8,12,16,20],1:[2,6,10,14,18,26]},He={0:[1,5,9,13,17,21],1:[3,7,11,15,19,27]};class Ge{constructor(t,r,s,i=4e5,n=5e4){b(this,"id");b(this,"sda");b(this,"scl");b(this,"freq");b(this,"timeout");if(t!==0&&t!==1)throw`I2C(${t}) doesn't exist: only 0 and 1 can be used`;const o=T(r),a=T(s);if(!He[t].includes(a))throw"Bad SCL pin: "+a;if(!Ce[t].includes(o))throw"Bad SDA pin: "+o;this.sda=o,this.scl=a,this.id=t,this.freq=i,this.timeout=n}readfrom(t,r){return this.readfrom_mem(t,0,r)}readfrom_into(t,r,s){throw"Not implemented"}readfrom_mem(t,r,s){const i=new SharedArrayBuffer(1+s),n=new Uint8Array(i);return y({command:P.I2CReadFromMem,request:{sda:this.sda,scl:this.scl,addr:t,memaddr:r,nbytes:s},result:n}),n}writeto_mem(t,r,s){const i=new Uint8Array(s);y({command:p.I2CWriteToMem,request:{sda:this.sda,scl:this.scl,addr:t,memaddr:r,buf:i}})}writeto(t,r){}scan(){const t=new SharedArrayBuffer(1020),r=new Int32Array(t);y({command:P.I2CScan,request:{sda:this.sda,scl:this.scl},result:r});const s=Atomics.load(r,0),i=[];return i.toString=function(){return`[${this.join(", ")}]`},s<0||i.push(s),i}toString(){return`I2C(${this.id}, freq=${this.freq}, scl=${this.scl}, sda=${this.sda}, timeout=${this.timeout})`}}class Ke{constructor(t){b(this,"pin");if(this.pin=T(t),this.pin===0||this.pin===1||this.pin===2)this.pin+=26;else if(this.pin!==26&&this.pin!==27&&this.pin!==28)throw`Pin(${this.pin}) doesn't have ADC capabilities`;y({command:p.PinSetMode,request:{pin:this.pin,mode:N.ANALOG}})}read_u16(){const t=new Uint16Array(new SharedArrayBuffer(2));return y({command:P.AdcReadU16,request:{pin:this.pin},result:t}),Atomics.load(t,0)}}const Ye=e=>new Ke(e),Je={0:5,1:3},Ze={0:0,1:2},Qe=(e,{sda:t=Ze[e],scl:r=Je[e],freq:s=4e5,timeout:i=5e4}={})=>new Ge(e,t,r,s,i),F=(e,t=N.IN,r=W.NONE)=>new Z(e,t,r),Xe=(e,t,r)=>new Ve(e,t,r);F.IN=N.IN;F.OUT=N.OUT;F.PULL_UP=W.UP;F.PULL_DOWN=W.DOWN;const et={Pin:F,PWM:Xe,ADC:Ye,I2C:Qe},tt={const:e=>e},rt={display:e=>{y({command:p.DisplayText,request:{text:e,x:0,y:16}})},clear:()=>{y({command:p.DisplayClear,request:{}})},LED:e=>F(e,F.OUT)},it={NeoPixel:function(e,t,r=3,s=1){const i={};i.pin=T(e),i.n=t,i.bpp=r,i.timing=s,i.pixels=Array(t).fill(null).map(()=>Array(r).fill(0)),i.fill=function(n){let o;Array.isArray(n)?o=n.slice(0,3).map(Number):n&&typeof n=="object"&&"length"in n?o=[Number(n[0]||0),Number(n[1]||0),Number(n[2]||0)]:o=[0,0,0];for(let a=0;a<i.n;a++)i.pixels[a]=[...o]},i.write=function(){const n=i.pixels.map((o,a)=>Array.isArray(o)?o.slice(0,i.bpp).map(Number):Array(i.bpp).fill(0));y({command:p.NeoPixelWrite,request:{pin:i.pin,pixels:n}})},i.show=i.write,i.__len__=function(){return i.n},i.set_pixel=function(n,o){if(n>=0&&n<i.n){let a;Array.isArray(o)?a=o:o&&typeof o=="object"&&"length"in o&&typeof o.length=="number"?a=Array.from(o):a=[0,0,0];const c=a.slice(0,i.bpp).map(Number);i.pixels[n]=c}},i.get_pixel=function(n){return n>=0&&n<i.n?i.pixels[n].slice():Array(i.bpp).fill(0)},i.set=i.set_pixel,i.get=i.get_pixel;try{i.__setitem__=i.set_pixel,i.__getitem__=i.get_pixel}catch{}return i}};async function nt(){return await fetch("https://raw.githubusercontent.com/Artisan-education/artisan-libs/main/manifest.json").then(t=>t.json()).catch(()=>{})}function q(e,t,r){const s=`
import sys
import os

file_path = "/home/pyodide/${t}.py"
if os.path.exists(file_path):
    os.remove(file_path)

sys.modules.pop("${t}", None)
`;e.runPython(s),e.registerJsModule(t,r)}let Ne,te=!1;(async()=>{const e=Pe({stdout:c=>postMessage({message:{command:p.Output,request:{output:c+`
\r`}},line:-1})}),t=(async()=>{const c=await nt(),l=Object.entries(c).map(async([d,f])=>{if(f)try{const g=await(await fetch("https://raw.githubusercontent.com/Artisan-education/artisan-libs/main/"+d)).text();return[d,g]}catch{return null}}),u=await Promise.all(l);return new Map(u.filter(d=>!!d))})(),[r,s]=await Promise.all([e,t]);Ne=r.pyimport("inspect");for(const[c,l]of s){const u=`/home/pyodide/${c}`;try{r.FS.mkdirTree(u.replace(/\/[^/]+$/,"")),r.FS.writeFile(u,l)}catch(d){console.error("Error writing file to Pyodide FS:",c,d)}}const i=new Int32Array(new SharedArrayBuffer(4)),n={sleep:c=>{const l=c*1e3;n.sleep_ms(l)},sleep_ms:c=>{if(y({command:p.Sleep,request:{time_ms:c}}),te)return;const u=performance.now()+c,d=Math.min(c/20,50);for(;performance.now()<u;){const f=u-performance.now();Atomics.wait(i,0,0,Math.min(d,f)),r.checkInterrupt()}},sleep_us:c=>{n.sleep_ms(c/1e3)},ticks_ms:()=>performance.now(),ticks_us:()=>performance.now()*1e3,ticks_add:Be,ticks_diff:ze,time:()=>Date.now(),time_ns:()=>performance.now()*1e3*1e3},o={print(...c){let l=" ",u=`
\r`;c.length>0&&c[c.length-1]!==null&&typeof c[c.length-1]=="object"&&("sep"in c[c.length-1]||"end"in c[c.length-1])&&({sep:l=l,end:u=u}=c.pop());const d=c.map(String).join(l)+u;y({command:p.Output,request:{output:d}})}};q(r,"utime",n),q(r,"machine",et),q(r,"micropython",tt),q(r,"rtzero",rt),q(r,"neopixel",it),r.setInterruptBuffer(L);const a=`
import time
import utime
time.time = utime.time
time.time_ns = utime.time_ns
time.sleep = utime.sleep
time.sleep_ms = utime.sleep_ms
time.sleep_us = utime.sleep_us
time.ticks_ms = utime.ticks_ms
time.ticks_us = utime.ticks_us
time.ticks_add = utime.ticks_add
time.ticks_diff = utime.ticks_diff
`;r.globals.set("print",o.print),r.runPython(a),self.onmessage=c=>{const{command:l,code:u,isReplay:d}=c.data;if(l==="runPython"){if(!r){O({command:p.Error,request:{message:"Interpreter not initialized"}});return}try{te=d,r.runPython(u),O({command:U.Finished,request:{}})}catch(f){let h="";if(L[0]!==Q&&L[1]===Q)L[1]=0,O({command:p.KeyboardInterrupt,request:{message:`KeyboardInterrupt
\r`}});else if(f instanceof Error){const g=f.message.split(`
`),R=g.findIndex(D=>D.includes("<exec>"));R!==-1?h=g.slice(R).filter(D=>!D.includes("mpWorker.ts")&&!/mpWorker-[A-Za-z0-9]+\.js/.test(D)&&!D.includes("pyodide.asm.js")).join(`
`):h=f.message,O({command:p.Error,request:{message:h}})}else h=String(f),O({command:p.Error,request:{message:h}})}}},O({command:U.Initialized,request:{sharedArrayInterrupt:L,sharedWakeupArray:H}})})()});export default ot();
