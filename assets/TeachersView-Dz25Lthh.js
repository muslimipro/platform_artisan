import{s as R,a as E}from"./index-CgZdH5o-.js";import{s as H}from"./index-CilaYyg5.js";import{a as K,s as L}from"./index-DD6M-OEO.js";import{s as S}from"./index-Btm1kpXS.js";import{a as F,u as N,a3 as z,r as h,b as v,k as $,w as l,h as r,t as i,f as a,q as M,v as G,D as J,a6 as Q,s as W,e as x,g as _,l as B,i as f,aP as X}from"./index-CpNfsgee.js";import{u as P,S as U}from"./useSchoolStore-BlLnYvqL.js";import{s as Y}from"./index-CS_MPzE8.js";import"./index-r12sdB34.js";import"./index-CtINQhxX.js";import"./index-CzVNyT2P.js";import"./index-9p8eLLNz.js";import"./index-Cirr2mSc.js";import"./index-CMFiuxN3.js";import"./index-CHRQnRVv.js";import"./index-CfyDH4d5.js";import"./index-Ds6Y6T-h.js";import"./http-uAg3sWem.js";const Z={class:"flex flex-col gap-1"},ee={class:"flex flex-col"},oe={class:"font-bold text-sm mb-1"},se={class:"flex gap-2 justify-end"},ae=F({__name:"InviteTeacherDialog",props:{modelValue:{type:Boolean,required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(C){const g=N(),T=P(),{loadTeachers:m}=T,d=z(C,"modelValue"),c=h(""),p=h(!1);async function V(){p.value=!0;try{const{data:t}=await U.inviteTeacher(c.value);await m(),g.add({severity:"success",summary:t.message,life:2e3}),d.value=!1}catch(t){g.add({severity:"error",summary:t.response.data.error,detail:t,life:2e3})}finally{p.value=!1}}return(t,n)=>{const u=S,D=Y,y=M,w=G;return v(),$(w,{visible:d.value,"onUpdate:visible":n[2]||(n[2]=e=>d.value=e),modal:"",draggable:!1,class:"m-4 max-w-md",header:t.$t("pages.school.inviteTeacher")},{default:l(()=>[r("div",Z,[r("div",ee,[r("div",oe,i(t.$t("pages.school.email")),1),a(u,{type:"text",modelValue:c.value,"onUpdate:modelValue":n[0]||(n[0]=e=>c.value=e)},null,8,["modelValue"])]),a(D),r("div",se,[a(y,{label:t.$t("pages.school.cancel"),severity:"secondary",onClick:n[1]||(n[1]=e=>d.value=!1)},null,8,["label"]),a(y,{label:t.$t("pages.school.invite"),onClick:V,loading:p.value,disabled:p.value},null,8,["label","loading","disabled"])])])]),_:1},8,["visible","header"])}}}),le={class:"flex-grow min-w-0 pb-4 mb-4 bg-white rounded-md border"},te={class:"flex items-center"},ie={class:"flex-grow flex gap-2 items-center"},ne={key:0,class:"text-2xl"},Ce=F({__name:"TeachersView",setup(C){const g=N(),T=J(),{t:m}=Q(),d=P(),{teachers:c,isLoading:p}=W(d),{loadTeachers:V}=d,t=h(!1),n=h(),u=h();(()=>{u.value={global:{value:null,matchMode:X.CONTAINS}}})();function y(e){T.require({message:m("pages.school.confirmDelete"),header:m("pages.school.confirmHeader"),icon:"pi pi-exclamation-triangle",rejectProps:{label:m("pages.school.confirmCancel"),severity:"secondary",outlined:!0},acceptProps:{label:m("pages.school.confirmDeleteBtn"),severity:"danger"},accept:async()=>{w(e)}})}async function w(e){try{const{data:s}=await U.deleteTeacher(e);V(),g.add({severity:"success",summary:s.message,life:2e3})}catch(s){g.add({severity:"error",summary:s.response.data.error,detail:s,life:2e3})}}return(e,s)=>{const I=M,j=K,q=S,A=L,b=R,k=H,O=E;return v(),x("div",le,[a(O,{ref_key:"dt",ref:n,filters:u.value,"onUpdate:filters":s[2]||(s[2]=o=>u.value=o),value:_(c),dataKey:"id",loading:_(p),scrollable:"",globalFilterFields:["name","email"],class:"rounded-md overflow-hidden w-full",paginator:"",rows:10,rowsPerPageOptions:[5,10,25]},{header:l(()=>[r("div",te,[r("div",ie,[_(c)?(v(),x("div",ne,i(e.$t("pages.school.teachers"))+" - "+i(_(c).length),1)):B("",!0)]),a(I,{label:e.$t("pages.school.inviteTeacher"),icon:"pi pi-plus",variant:"outlined",class:"mr-2",onClick:s[0]||(s[0]=o=>t.value=!0)},null,8,["label"]),a(A,null,{default:l(()=>[a(j,null,{default:l(()=>s[4]||(s[4]=[r("i",{class:"pi pi-search"},null,-1)])),_:1}),a(q,{modelValue:u.value.global.value,"onUpdate:modelValue":s[1]||(s[1]=o=>u.value.global.value=o),placeholder:e.$t("pages.school.search")},null,8,["modelValue","placeholder"])]),_:1})])]),empty:l(()=>[f(i(e.$t("pages.school.noTeachersFound")),1)]),loading:l(()=>[f(i(e.$t("pages.school.loadingTeachers")),1)]),default:l(()=>[a(b,{field:"email",header:e.$t("pages.school.email"),sortable:""},{body:l(({data:o})=>[f(i(o.email),1)]),_:1},8,["header"]),a(b,{field:"name",header:e.$t("pages.school.name"),sortable:""},{body:l(({data:o})=>[r("div",null,i(`${o.name}`),1)]),_:1},8,["header"]),a(b,{header:e.$t("pages.school.status"),sortable:""},{body:l(({data:o})=>[o.registered?o.registered&&!o.invited?(v(),$(k,{key:1,severity:"info"},{default:l(()=>[f(i(e.$t("pages.school.invited")),1)]),_:1})):o.registered&&o.invited?(v(),$(k,{key:2,severity:"success"},{default:l(()=>[f(i(e.$t("pages.school.joined")),1)]),_:1})):B("",!0):(v(),$(k,{key:0,severity:"danger"},{default:l(()=>[f(i(e.$t("pages.school.notRegistered")),1)]),_:1}))]),_:1},8,["header"]),a(b,{exportable:!1},{body:l(({data:o})=>[a(I,{icon:"pi pi-trash",outlined:"",rounded:"",severity:"danger",onClick:re=>y(o.email)},null,8,["onClick"])]),_:1})]),_:1},8,["filters","value","loading"]),a(ae,{modelValue:t.value,"onUpdate:modelValue":s[3]||(s[3]=o=>t.value=o)},null,8,["modelValue"])])}}});export{Ce as default};
