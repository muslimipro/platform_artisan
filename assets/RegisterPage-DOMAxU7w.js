import{z as q,a as l,_ as E,s as L,b as D}from"./AuthHeader.vue_vue_type_script_setup_true_lang-B9YplsNF.js";import{d as H,h as x,f as I,i as Z,j as G,o as i,c as d,b as a,a as s,w as r,t as o,k as p,l as B,m as f,F as w,n as F,u as N,e as J,s as K}from"./index-CwzbvGLS.js";import{s as O}from"./index-4c7-Qulg.js";import{s as Q}from"./index-CoTkcHHE.js";import{s as W}from"./index-CvKssE0J.js";import{a as C}from"./index-v0XTaiQL.js";import"./logo-BsqmYzAp.js";import"./LocaleSwitcher.vue_vue_type_script_setup_true_lang-Bol7sjQ4.js";const X={class:"card flex flex-col items-center pt-4"},Y={class:"flex flex-1 items-center justify-center my-4"},ee={class:"text-4xl font-semibold px-2 mr-4"},se={class:"flex flex-col gap-1"},ae={class:"flex gap-2"},te={for:"name"},re={for:"surname"},oe={class:"flex flex-col gap-1"},ie={for:"email"},ne={class:"flex flex-col gap-1"},le={for:"password"},me={class:"my-0 flex flex-col gap-1"},ce={class:"flex flex-col gap-1"},de={for:"confirm_password"},ue={class:"my-0 flex flex-col gap-1"},be=H({__name:"RegisterPage",setup(pe){const P=x([]),m=x(!1);I(async()=>{const e=await fetch("src/assets/countries.json");P.value=await e.json()});const y=Z(),h=J(),b=G(),T=x({name:"",surname:"",email:"",password:"",city:""}),A=q(l.object({name:l.string().min(1,{message:"Name "}).max(100,{message:"Maximum 100 characters."}),surname:l.string().min(1,{message:"Surname "}).max(100,{message:"Maximum 100 characters."}),email:l.string().min(1,{message:"Email is required."}).max(100,{message:"Maximum 100 characters."}),password:l.string().min(8,{message:"Minimum 8 characters."}).max(100,{message:"Maximum 100 characters."}).refine(e=>/[a-z]/.test(e),{message:"Must have a lowercase letter."}).refine(e=>/[A-Z]/.test(e),{message:"Must have an uppercase letter."}).refine(e=>/[0-9]/.test(e),{message:"Must have a number."}),confirm_password:l.string()}).refine(e=>e.password===e.confirm_password,{message:"Passwords must match",path:["confirm_password"]})),R=async e=>{if(!m.value&&e.valid){m.value=!0;try{await C.signUp(e.states.name.value,e.states.surname.value,e.states.email.value,e.states.password.value);const{data:n}=await C.login(e.states.email.value,e.states.password.value);b.setToken(n),b.setUser(n),h.replace({name:"projects"}),y.add({severity:"success",summary:"Success",life:3e3})}catch(n){y.add({severity:"error",summary:n.toString(),life:3e3})}finally{m.value=!1}}};return(e,n)=>{const _=W,c=Q,u=O,k=L,M=K,U=D;return i(),d(w,null,[a(E),s("div",X,[a(U,{initialValues:T.value,resolver:N(A),onSubmit:R,class:"flex flex-col gap-4 w-full sm:w-80 sm:px-0 px-8"},{default:r(t=>{var z,S,V,j,$;return[s("div",Y,[s("p",ee,o(e.$t("registration")),1)]),s("div",se,[s("div",ae,[a(c,{variant:"on"},{default:r(()=>[a(_,{id:"name",name:"name",type:"text",fluid:""}),s("label",te,o(e.$t("name")),1)]),_:1}),a(c,{variant:"on"},{default:r(()=>[a(_,{id:"surname",name:"surname",type:"text",fluid:""}),s("label",re,o(e.$t("surname")),1)]),_:1})]),(z=t.name)!=null&&z.invalid||(S=t.surname)!=null&&S.invalid?(i(),p(u,{key:0,severity:"error",size:"small",variant:"simple"},{default:r(()=>[B(o(t.name.error.message+t.surname.error.message+"is required."),1)]),_:2},1024)):f("",!0)]),s("div",oe,[a(c,{variant:"on"},{default:r(()=>[a(_,{id:"email",name:"email",type:"text",fluid:""}),s("label",ie,o(e.$t("email")),1)]),_:1}),(V=t.email)!=null&&V.invalid?(i(),p(u,{key:0,severity:"error",size:"small",variant:"simple"},{default:r(()=>[B(o(t.email.error.message),1)]),_:2},1024)):f("",!0)]),s("div",ne,[a(c,{variant:"on"},{default:r(()=>[a(k,{id:"password",name:"password",feedback:!1,toggleMask:"",fluid:""}),s("label",le,o(e.$t("password")),1)]),_:1}),(j=t.password)!=null&&j.invalid?(i(),p(u,{key:0,severity:"error",size:"small",variant:"simple"},{default:r(()=>[s("ul",me,[(i(!0),d(w,null,F(t.password.errors,(v,g)=>(i(),d("li",{key:g},o(v.message),1))),128))])]),_:2},1024)):f("",!0)]),s("div",ce,[a(c,{variant:"on"},{default:r(()=>[a(k,{id:"confirm_password",name:"confirm_password",feedback:!1,toggleMask:"",fluid:""}),s("label",de,o(e.$t("confirmPassword")),1)]),_:1}),($=t.confirm_password)!=null&&$.invalid?(i(),p(u,{key:0,severity:"error",size:"small",variant:"simple"},{default:r(()=>[s("ul",ue,[(i(!0),d(w,null,F(t.confirm_password.errors,(v,g)=>(i(),d("li",{key:g},o(v.message),1))),128))])]),_:2},1024)):f("",!0)]),a(M,{type:"submit",label:e.$t("signUp"),loading:m.value,disabled:m.value},null,8,["label","loading","disabled"])]}),_:1},8,["initialValues","resolver"]),a(M,{severity:"secondary",variant:"link",label:e.$t("alreadyHaveAnAccount"),onClick:n[0]||(n[0]=t=>N(h).push({name:"login"}))},null,8,["label"])])],64)}}});export{be as default};
