import{s as S,a as E}from"./index-BFcyraEE.js";import{a as j,s as O}from"./index-DmQEPo33.js";import{s as I}from"./index-dDCPORGv.js";import{d as U,a5 as P,a3 as R,u as q,G,r as v,H,o as _,f as T,w as o,e as n,t as c,b as l,s as D,_ as K,A as L,c as F,j as b,h as z,g as x,k as J,aF as Q}from"./index-DcyBeJgC.js";import{u as M}from"./useTeacherStore-B_tGywlq.js";import{s as W}from"./index-d4SORqJN.js";import{T as B}from"./teacherApi-fBa8RL9v.js";import"./index-Dm115m7X.js";import"./index-BauW75GO.js";import"./index-Dzo9KCOb.js";import"./index-CcCvklg2.js";import"./index-N8YLxu86.js";import"./index-C5SrmfWd.js";import"./index-CCrQOVR9.js";import"./index-BHfeFhRm.js";import"./index-seXcSKnd.js";const X={class:"flex flex-col gap-1"},Y={class:"flex flex-col"},Z={class:"font-bold text-sm mb-1"},ee={class:"flex gap-2 justify-end"},ae=U({__name:"EditClassDialog",props:P({selectedClass:{}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(C){const u=R(C,"modelValue"),p=C,r=q(),{t:f}=G(),w=M(),{loadClasses:m}=w,d=v(""),t=v(!1);H(()=>p.selectedClass,e=>{d.value="",e&&(d.value=e.name)},{immediate:!0});async function y(){t.value=!0;try{await B.createClass(d.value),await m(),r.add({severity:"success",summary:f("pages.teacher.classAdded"),life:2e3}),u.value=!1}catch(e){r.add({severity:"error",summary:f("pages.teacher.classAddingFailed"),detail:e,life:2e3})}finally{t.value=!1}}async function $(){if(p.selectedClass){t.value=!0;try{await B.updateClassById(p.selectedClass.id,d.value),await m(),r.add({severity:"success",summary:f("pages.teacher.classUpdated"),life:2e3}),u.value=!1}catch(e){r.add({severity:"error",summary:f("pages.teacher.classUpdateFailed"),detail:e,life:2e3})}finally{t.value=!1}}}return(e,a)=>{const g=I,k=W,h=D,V=K;return _(),T(V,{visible:u.value,"onUpdate:visible":a[2]||(a[2]=i=>u.value=i),modal:"",draggable:!1,class:"m-4 max-w-md",header:p.selectedClass?e.$t("pages.teacher.editClass"):e.$t("pages.teacher.addClass")},{default:o(()=>[n("div",X,[n("div",Y,[n("div",Z,c(e.$t("pages.teacher.name")),1),l(g,{type:"text",modelValue:d.value,"onUpdate:modelValue":a[0]||(a[0]=i=>d.value=i)},null,8,["modelValue"])]),l(k),n("div",ee,[l(h,{label:e.$t("pages.teacher.cancel"),severity:"secondary",onClick:a[1]||(a[1]=i=>u.value=!1)},null,8,["label"]),p.selectedClass==null?(_(),T(h,{key:0,label:e.$t("pages.teacher.create"),onClick:y,loading:t.value,disabled:t.value},null,8,["label","loading","disabled"])):(_(),T(h,{key:1,label:e.$t("pages.teacher.save"),onClick:$,loading:t.value,disabled:t.value},null,8,["label","loading","disabled"]))])])]),_:1},8,["visible","header"])}}}),se={class:"flex-grow min-w-0 pb-4 mb-4 bg-white rounded-md border"},le={class:"flex items-center"},te={class:"flex-grow flex gap-2 items-center"},oe={key:0,class:"text-2xl"},ne={class:"flex gap-2"},we=U({__name:"ClassesView",setup(C){const u=J(),p=v(),r=v();(()=>{r.value={global:{value:null,matchMode:Q.CONTAINS}}})();const w=M(),{classes:m,isLoading:d}=L(w),t=v(!1),y=v(null);function $(e){t.value=!0,y.value=e}return(e,a)=>{const g=D,k=j,h=I,V=O,i=S,N=E;return _(),F("div",se,[l(N,{ref_key:"dt",ref:p,filters:r.value,"onUpdate:filters":a[2]||(a[2]=s=>r.value=s),value:b(m),dataKey:"id",loading:b(d),scrollable:"",globalFilterFields:["name","email"],class:"rounded-md overflow-hidden w-full",paginator:"",rows:10,rowsPerPageOptions:[5,10,25]},{header:o(()=>[n("div",le,[n("div",te,[b(m)?(_(),F("div",oe,c(e.$t("pages.teacher.classes"))+" - "+c(b(m).length),1)):z("",!0)]),l(g,{label:e.$t("pages.teacher.addClass"),icon:"pi pi-plus",variant:"outlined",class:"mr-2",onClick:a[0]||(a[0]=s=>$(null))},null,8,["label"]),l(V,null,{default:o(()=>[l(k,null,{default:o(()=>a[4]||(a[4]=[n("i",{class:"pi pi-search"},null,-1)])),_:1}),l(h,{modelValue:r.value.global.value,"onUpdate:modelValue":a[1]||(a[1]=s=>r.value.global.value=s),placeholder:e.$t("pages.teacher.search")},null,8,["modelValue","placeholder"])]),_:1})])]),empty:o(()=>[x(c(e.$t("pages.teacher.noClassesFound")),1)]),loading:o(()=>[x(c(e.$t("pages.teacher.loadingClasses")),1)]),default:o(()=>[l(i,{field:"name",header:e.$t("pages.teacher.name"),sortable:""},{body:o(({data:s})=>[n("div",null,c(`${s.name}`),1)]),_:1},8,["header"]),l(i,{field:"creator_name",header:e.$t("pages.teacher.classTeacher"),sortable:""},{body:o(({data:s})=>[n("div",null,c(`${s.creator_name??s.creator_email}`),1)]),_:1},8,["header"]),l(i,{field:"student_count",header:e.$t("pages.teacher.students"),sortable:""},{body:o(({data:s})=>[n("div",null,c(`${s.student_count}`),1)]),_:1},8,["header"]),l(i,{exportable:!1},{body:o(({data:s})=>[n("div",ne,[l(g,{icon:"pi pi-pencil",outlined:"",rounded:"",severity:"warn",onClick:A=>$(s)},null,8,["onClick"]),l(g,{icon:"pi pi-angle-right",outlined:"",rounded:"",severity:"info",onClick:A=>b(u).push({name:"teacher-class",params:{id:s.id}})},null,8,["onClick"])])]),_:1})]),_:1},8,["filters","value","loading"]),l(ae,{"model-value":t.value,"onUpdate:modelValue":a[3]||(a[3]=s=>t.value=s),"selected-class":y.value},null,8,["model-value","selected-class"])])}}});export{we as default};
