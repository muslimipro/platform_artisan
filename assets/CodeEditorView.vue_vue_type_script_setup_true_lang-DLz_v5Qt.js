var Kn=Object.defineProperty;var Jn=(n,e,t)=>e in n?Kn(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var Y=(n,e,t)=>Jn(n,typeof e!="symbol"?e+"":e,t);import{r as b,a as W,o as Te,b as O,e as N,t as ae,J as z,S as Se,E as Q,Y as vt,c as J,h as y,g,i as Ie,F as Gt,k as Vt,U as $n,K as ie,P as re,V as ye,A as ke,Z as Ht,I as Wt,O as V,n as ve,C as ot,M as pt,f as pe,w as _e,m as ht,_ as Qn,$ as Zn,p as es,L as Yt,N as ts,W as ns}from"./index-CTzBRDkF.js";import{_ as Be}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{g as at,M as ss,t as os,h as rs,w as is,p as as,a as ls,b as cs,c as us,d as ds,e as ps,f as je,i as fs,j as ms,m as Kt,k as Xe,s as Ge,l as Ve,n as Rn,o as vs,q as hs,r as Mn,u as gs,v as ys,x as ws,y as Jt,z as xs,A as bs,S as _s,B as Ss,D as lt,E as ks,C as Es,F as Ts,G as Ps,H as Is,T as qs}from"./index-C-VH0vPw.js";import{b as ft,a as Le}from"./index-CWSLGCMt.js";import{s as Cs}from"./index-DpB8_Bbd.js";import{s as $s}from"./index-DHNHenM9.js";var F=(n=>(n.PinGetValue="pin get value",n.PinGetMode="pin get mode",n.PinGetPull="pin get pull",n.AdcReadU16="adc read_u16",n.I2CScan="i2c scan",n.I2CReadFromMem="i2c readfrom_mem",n.Input="input",n))(F||{});const Qt=2;var U=(n=>(n.I2CWriteToMem="i2c writefrom_mem",n.PinSetValue="pin set value",n.PinSetMode="pin set mode",n.PinSetPull="pin set pull",n.PwmFreq="pwm freq",n.PwmDutyU16="pwm duty_u16",n.Output="output",n.Sleep="sleep",n.DisplayText="display text",n.DisplayClear="display clear",n.NeoPixelWrite="neopixel write",n.RawOutput="raw output",n.KeyboardInterrupt="keyboard interrupt",n.Error="error",n))(U||{}),$e=(n=>(n.Finished="finished",n.Initialized="initialized",n.Timeout="timeout",n))($e||{});const ll=Object.values({...F,...U,...$e}),Rs=new Set(Object.values(F)),Ms=new Set(Object.values($e));new Set(Object.values(U));function An(n){return Rs.has(n)}function As(n){return Ms.has(n)}function Ds(n){return An(n.command)}function Os(n){return As(n.command)}function Bs(n){return An(n.command)}const cl=[];function _t(n,e){return n.length!==e.length?!1:n.every((t,s)=>t===e[s])}const Ls={error:()=>!0,"keyboard interrupt":()=>!0,finished:()=>!0,initialized:()=>!0,timeout:()=>!0,sleep:(n,e)=>n.request.time_ms===e.request.time_ms,output:(n,e)=>n.request.output===e.request.output,"pin set value":(n,e)=>n.request.pin===e.request.pin&&n.request.value===e.request.value,"pin set mode":(n,e)=>n.request.pin===e.request.pin&&n.request.mode===e.request.mode,"pin set pull":(n,e)=>n.request.pin===e.request.pin&&n.request.pull===e.request.pull,"pwm freq":(n,e)=>n.request.pin===e.request.pin&&n.request.freq===e.request.freq,"pwm duty_u16":(n,e)=>n.request.pin===e.request.pin&&n.request.duty_u16===e.request.duty_u16,"display text":(n,e)=>n.request.x===e.request.x&&n.request.y===e.request.y&&n.request.text===e.request.text,"display clear":()=>!0,"i2c writefrom_mem":(n,e)=>n.request.addr===e.request.addr&&n.request.buf===e.request.buf&&n.request.memaddr===e.request.memaddr&&n.request.scl===e.request.scl&&n.request.sda===e.request.sda,"neopixel write":(n,e)=>n.request.pin===e.request.pin&&n.request.pixels.every((t,s)=>_t(t,e.request.pixels[s])==!0),"raw output":(n,e)=>n.request.output===e.request.output,"pin get value":(n,e)=>n.request.pin===e.request.pin&&n.result===e.result,"pin get mode":(n,e)=>n.request.pin===e.request.pin&&n.result===e.result,"pin get pull":(n,e)=>n.request.pin===e.request.pin&&n.result===e.result,"adc read_u16":(n,e)=>n.request.pin===e.request.pin&&n.result===e.result,"i2c readfrom_mem":(n,e)=>n.request.addr===e.request.addr&&n.request.memaddr===e.request.memaddr&&n.request.nbytes===e.request.nbytes&&n.request.scl===e.request.scl&&n.request.sda===e.request.sda&&_t(n.result,e.result),"i2c scan":(n,e)=>n.request.scl===e.request.scl&&n.request.sda===e.request.sda&&_t(n.result,e.result),input:(n,e)=>n.result===e.result};function Fs(n){return n.command==="pin set value"||n.command==="pin set pull"||n.command==="pin set mode"||n.command==="pwm duty_u16"||n.command==="pwm freq"||n.command==="neopixel write"||n.command==="pin get mode"||n.command==="pin get value"||n.command==="pin get pull"||n.command==="adc read_u16"}globalThis.__codeEditorInstances||(globalThis.__codeEditorInstances=new Map);globalThis.__codeEditorRefs||(globalThis.__codeEditorRefs=new Map);const St=globalThis.__codeEditorInstances,kt=globalThis.__codeEditorRefs;function gt(n){St.has(n)||St.set(n,{highlights:[],disabled:!1,code:""});const e=St.get(n);kt.has(n)||kt.set(n,{highlights:b(e.highlights),disabled:b(e.disabled),code:b(e.code)});const t=kt.get(n);function s(){t.highlights.value=[]}function o(l){l!==t.code.value&&(t.code.value=l,e.code=l)}return{highlights:t.highlights,reset:s,disabled:t.disabled,code:t.code,setCode:o}}const Ns="/assets/buzzer-Dl6pLH91.jpg";var B=(n=>(n[n.NONE=-1]="NONE",n[n.IN=0]="IN",n[n.OUT=1]="OUT",n[n.ANALOG=5]="ANALOG",n[n.PWM=6]="PWM",n))(B||{}),be=(n=>(n[n.NONE=-1]="NONE",n[n.UP=0]="UP",n[n.DOWN=1]="DOWN",n))(be||{});function Ye(n){return n===0||n===5}function Us(n){return n!==0&&n!==5}function Bt(n){return n===1||n===6}function ct(n,e,t=-1){return{value:0,freq:0,mode:e,id:n,pull:t,arr:[]}}function Zt(n){return n===0?1:n===1?0:Math.random()}const en={id:-1,value:0,freq:0,mode:0,pull:-1,arr:[]},ul="rgb(87,176,54)",dl="rgb(254, 116, 25)",xe="rgb(0,159,217)",Et="rgb(0,129,55)",Dn=65535,pl={0:{name:"GP0",able:[{color:xe,name:"I2C0 SDA"}]},1:{name:"GP1",able:[{color:xe,name:"I2C0 SCL"}]},2:{name:"GP2",able:[{color:xe,name:"I2C1 SDA"}]},3:{name:"GP3",able:[{color:xe,name:"I2C1 SCL"}]},28:{name:"GP28",able:[{color:Et,name:"ADC2"}]},22:{name:"GP22",able:[]},4:{name:"GP4",able:[{color:xe,name:"I2C0 SDA"}]},5:{name:"GP5",able:[{color:xe,name:"I2C0 SCL"}]},6:{name:"GP6",able:[{color:xe,name:"I2C1 SDA"}]},7:{name:"GP7",able:[{color:xe,name:"I2C1 SCL"}]},26:{name:"GP26",able:[{color:Et,name:"ADC1"},{color:xe,name:"I2C1 SDA"}]},27:{name:"GP27",able:[{color:Et,name:"ADC0"},{color:xe,name:"I2C1 SCL"}]}},fl={[-1]:"rgb(0,2,253)",0:"rgb(254,101,0)",1:"rgb(1,169,0)",5:"rgb(254,101,0)",6:"rgb(1,169,0)"},ml={[-1]:"rgb(0,2,253)",0:"rgb(0,2,253)",1:"rgb(0,2,253)"};function vl(n,e){let t=n.value.toFixed(2);return Ye(n.mode)&&Us(e.mode)?t="~":Ye(n.mode)&&Ye(e.mode)&&(t=e.value.toFixed(2)),t}function hl(n){return n.toFixed(2)}function gl(n,e){let t=n.value;return Ye(n.mode)&&Bt(e.mode)?t=0:Ye(n.mode)&&Ye(e.mode)&&(t=e.value),zs(t)}function zs(n){return{background:`rgb(${255*n}, 0, 0)`}}function Re(n,e,t){let s=Math.round(t);s>32767&&(s=32767),s<-32768&&(s=-32768),n[e+0]=s>>8&255,n[e+1]=s&255}function He(n,e,t){let s=Math.round(t);s>65535&&(s=65535),s<0&&(s=0),n[e+0]=s&255,n[e+1]=s>>8&255}function he(n,e,t){let s=Math.round(t);s>32767&&(s=32767),s<-32768&&(s=-32768),n[e+0]=s&255,n[e+1]=s>>8&255}function Ee(n,e,t){let s=Math.round(t);s>255&&(s=255),s<0&&(s=0),n[e]=s&255}function Tt(n,e,t){let s=Math.round(t);s>127&&(s=127),s<-128&&(s=-128),n[e]=s&255}function On(n,e,t){let s=Math.round(t);s>65535&&(s=65535),s<0&&(s=0),n[e+0]=s>>>8&255,n[e+1]=s&255}function tn(n,e,t){let s=Math.round(t);s>16777215&&(s=16777215),s<0&&(s=0),n[e+0]=s>>>16&255,n[e+1]=s>>>8&255,n[e+2]=s&255}function js(n){return{address:n,read:()=>{},write:()=>{}}}const nn={address:0,read:()=>{},write:()=>{}},Gs=W({__name:"FloatingNote",props:{note:{},loudness:{},x:{},y:{},color:{},fontSize:{}},emits:["remove"],setup(n,{emit:e}){at.registerPlugin(ss);const t=n,s=e,o=b(null);return Te(()=>{var c;if(!o.value)return;const l=at.utils.random(-50,50),p=(c=o.value)==null?void 0:c.parentElement,{x:u,y:d}=ft(p),r=t.x-u.value-t.fontSize/2,i=t.y-d.value-t.fontSize/2;at.set(o.value,{x:r,y:i}),at.to(o.value,{motionPath:{path:[{x:r,y:i},{x:r+l,y:i-40},{x:r-l,y:i-70}],curviness:1.25},scale:2*t.loudness,opacity:0,duration:2,ease:"power2.out",onComplete:()=>s("remove")})}),(l,p)=>(O(),N("div",{ref_key:"noteRef",ref:o,class:"absolute font-bold",style:z({zIndex:"2",color:`rgb(${t.color.r}, ${t.color.g}, ${t.color.b})`,fontSize:t.fontSize+"px"})},ae(l.note),5))}}),Vs={ref:"theref"},Hs={class:"rounded-lg overflow-hidden relative"},Ws=["src"],Xs=W({type:"buzzer",params:{mode2:B.OUT},__name:"Buzzer",props:{x:{},y:{},w:{},h:{},m_id:{},on:{},type:{},putOn8or9:{type:Boolean},dragging:{type:Boolean},connector:{},params:{},id:{},pin0:{},pin1:{},pin2:{},pin3:{},reset:{type:Function},i2c:{}},setup(n){const e=n,t=b([]);let s=0;function o(I,P){const k=Math.ceil(I),M=Math.floor(P);return Math.floor(Math.random()*(M-k)+k)}const l=(I,P,k,M)=>{t.value.push({id:s++,note:I,loudness:P,color:k,fontSize:M})},p=b(""),u=I=>{t.value=t.value.filter(P=>P.id!==I)};function d(I){if(I<=0)return"";const P=440,k=["C","C♯","D","D♯","E","F","F♯","G","G♯","A","A♯","B"],M=Math.round(12*Math.log2(I/P)),$=(M+9)%12,w=Math.floor((M+9)/12)+4;return`${k[$]}${w}`}const r=new AudioContext,i=r.createOscillator(),c=r.createGain();i.type="triangle",i.frequency.value=0,c.gain.value=0,i.connect(c).connect(r.destination),i.start();const v=Se("theref"),{x,y:T,width:S,height:f}=ft(v),E=b({r:0,g:0,b:0}),C=b(0),R=b(0);Q(()=>e.pin2.freq,()=>{l(p.value,R.value,E.value,C.value);const I=o(0,256),P=o(0,256),k=255-I;E.value={r:I,g:P,b:k},p.value=d(e.pin2.freq),i.frequency.value=e.pin2.freq},{immediate:!0}),Q(()=>e.pin2.value,()=>{R.value=1-4*(e.pin2.value-.5)**2,c.gain.value=R.value,C.value=Math.sqrt(R.value)*30},{immediate:!0});const _=b(!1);Te(()=>{_.value=!!document.querySelector(`#pibody-${e.m_id}`)}),vt(()=>{i.stop(),i.disconnect()});const q=J(()=>{var P;const{x:I}=ft((P=v.value)==null?void 0:P.parentElement);return x.value-I.value}),D=J(()=>{var P;const{y:I}=ft((P=v.value)==null?void 0:P.parentElement);return T.value-I.value});return(I,P)=>(O(),N("div",Vs,[y("div",Hs,[y("img",{src:g(Ns),alt:"Buzzer"},null,8,Ws),y("div",{class:"absolute text-blue-500 -translate-x-1/2 -translate-y-1/2",style:z({left:g(S)/2+"px",top:g(f)/2+"px",fontSize:C.value+"px",color:`rgb(${E.value.r}, ${E.value.g}, ${E.value.b})`})},ae(p.value),5)]),_.value?(O(),Ie($n,{key:0,to:`#pibody-${e.m_id}`},[(O(!0),N(Gt,null,Vt(t.value,k=>(O(),Ie(Gs,{key:k.id,note:k.note,loudness:k.loudness,color:k.color,fontSize:k.fontSize,x:q.value+g(S)/2,y:D.value+g(f)/2,onRemove:M=>u(k.id)},null,8,["note","loudness","color","fontSize","x","y","onRemove"]))),128))],8,["to"])):ie("",!0)],512))}}),Ys=Object.freeze(Object.defineProperty({__proto__:null,default:Xs},Symbol.toStringTag,{value:"Module"})),Ks="/assets/climate_sensor-werWdoYS.jpg";function Pt(n,e){n.x+=e.x,n.y+=e.y}function st(n,e){n.x-=e.x,n.y-=e.y}function Ke(n,e,t){n.x=Math.min(Math.max(n.x,e.x),t.x),n.y=Math.min(Math.max(n.y,e.y),t.y)}function Js(n,e){const t=Math.max(0,Math.min(n.x+n.w,e.x+e.w)-Math.max(n.x,e.x)),s=Math.max(0,Math.min(n.y+n.h,e.y+e.h)-Math.max(n.y,e.y));return t*s}function Lt(n){const{left:e,top:t,width:s,height:o}=n.getBoundingClientRect();return{x:e,y:t,w:s,h:o}}function mt(n){return{x:n.x+n.w/2,y:n.y+n.h/2}}function Oe(n){return{left:n.x+"px",top:n.y+"px",width:n.w+"px",height:n.h+"px"}}function Qs(n){return{width:n.w+"px",height:n.h+"px"}}function Zs(n){return{left:n.x+"px",top:n.y+"px"}}function sn(n,e){const t=n.x-e.x,s=n.y-e.y;return t*t+s*s}function Je(n){const e=document.getElementById(n),t={x:0,y:0,w:0,h:0};if(e){const{top:s,left:o,width:l,height:p}=e.getBoundingClientRect(),u=e.clientTop,d=e.clientLeft;t.x=o+d-e.scrollLeft,t.y=s+u-e.scrollTop,t.w=l+e.scrollLeft,t.h=p+e.scrollTop}return t}function et(n,e){const t=document.getElementById(`emulator-${e}`);if(t){const{top:s,left:o}=t.getBoundingClientRect(),l=t.clientTop,p=t.clientLeft;n.x-=o+p-t.scrollLeft,n.y-=s+l-t.scrollTop}}function on(n,e,t=200){const s={...n},o=performance.now();function l(p){const u=Math.min((p-o)/t,1),d=u<.5?2*u*u:-1+(4-2*u)*u;n.x=s.x+(e.x-s.x)*d,n.y=s.y+(e.y-s.y)*d,n.w=s.w+(e.w-s.w)*d,n.h=s.h+(e.h-s.h)*d,u<1&&requestAnimationFrame(l)}requestAnimationFrame(l)}const eo={ref:"theref"},to={class:"rounded-lg overflow-hidden relative"},no=["src"],so=["src"],oo=["src"],ro=["src"],io=["src"],ao=["src"],lo={class:"absolute bottom-0 left-0 flex items-center cursor-ew-resize"},co=136,uo=138,po=140,fo=142,mo=144,vo=146,ho=148,go=150,yo=152,wo=154,xo=156,bo=158,_o=161,So=225,ko=227,Eo=228,To=229,Po=230,Io=231,qo=247,Co=250,$o=253,tt=28236,It=26415,ut=50,rn=36692,an=10648,ln=3024,cn=7839,un=105,dn=7,pn=11700,fn=11800,mn=5e3,vn=75,hn=368,gn=0,qt=304,Ct=50,yn=30,wn=22,Ro=4,Mo=W({type:"climate-sensor",params:{mode2:B.IN,mode3:B.IN,address:118},__name:"ClimateSensor",props:{x:{},y:{},w:{},h:{},m_id:{},on:{},type:{},putOn8or9:{type:Boolean},dragging:{type:Boolean},connector:{},params:{},id:{},pin0:{},pin1:{},pin2:{},pin3:{},reset:{type:Function},i2c:{}},setup(n){const{isOutside:e}=Le(Se("theref")),t=n,s=new Uint8Array(255);He(s,co,tt),he(s,uo,It),he(s,po,ut),He(s,fo,rn),he(s,mo,an),he(s,vo,ln),he(s,ho,cn),he(s,go,un),he(s,yo,dn),he(s,wo,pn),he(s,xo,fn),he(s,bo,mn),Ee(s,_o,vn),he(s,So,hn),Ee(s,ko,gn),Tt(s,Eo,qt>>>4&255),Ee(s,To,qt&15|(Ct&15)<<4),Tt(s,Po,Ct>>>4&255),Tt(s,Io,yn);const o={x:50,y:26,w:30,h:30},l=b(0),p=b(0),u=b(0);let d=0;function r(P){d=(P*100*256-128)/5;const k=ut/4096/16384/256,M=It/8/2048-ut*tt/8/4096/16384,$=ut*tt*tt/4096/16384-It*tt/1024-d,w=M*M-4*k*$,j=(-M+Math.sqrt(w))/(2*k);return Math.round(j)}function i(P){P=P*256;const k=BigInt(Math.round(d))-128000n,$=k*k*BigInt(dn)+k*BigInt(un)*131071n,w=Number(BigInt($)+(BigInt(cn)<<35n)),j=k*k*BigInt(ln)/256n+k*BigInt(an)*4096n,L=Number(((1n<<47n)+j)*BigInt(rn)>>33n),le=mn/0x8000000000000,Z=fn/524288+1,ce=(P-16*pn)*256,Pe=Z*Z-4*le*ce;return(1048576-((-Z+Math.sqrt(Pe))/(2*le)*L/3125+w))/2147483648}function c(P){const k=d-76800,M=(P<<14)-(qt<<20)-Ct*k+16384>>15;let $=(k*yn>>10)*((k*gn>>11)+32768)>>10;$=($+2097152)*hn+8192>>14;let w=M*$;const j=((w>>15)*(w>>15)>>7)*vn>>4;return w=w-j,w<0&&(w=0),w>419430400&&(w=419430400),w>>12}function v(P){const k=Math.round(P*1024);let M=0,$=65535;for(;M<$;){const w=M+$>>>1;c(w)<k?M=w+1:$=w}return M}t.i2c.read=(P,k,M)=>{const $=r(l.value*12+21);tn(s,Co,$*16);const w=i((1-u.value)*2e4+79e3);tn(s,qo,w*16);const j=v(p.value*100);On(s,$o,j);for(let L=0;L<M;L++)P[L]=s[k+L]};const x=b(0),T=J({get(){return x.value===0?l.value:x.value===1?p.value:u.value},set(P){x.value===0?l.value=P:x.value===1?p.value=P:u.value=P}}),S=()=>{x.value++,x.value>2&&(x.value=0)},f=J(()=>l.value*wn),E=J(()=>({height:`${f.value}px`,bottom:`${Ro}px`})),C=J(()=>p.value*wn),R=J(()=>({height:`${C.value}px`,bottom:"2px"})),_=J(()=>({transform:`rotate(${u.value*.75+.5}turn)`,transformOrigin:"4px 9.5px"})),q=b(!1),D=()=>{q.value=!1},I=()=>{q.value=!0};return(P,k)=>(O(),N("div",eo,[y("div",to,[y("img",{src:g(Ks),alt:"climate sensor"},null,8,no),re(y("div",{class:"absolute cursor-pointer",style:z(g(Oe)(o)),onPointerdown:S},[y("img",{src:g(os),alt:"shows temperature",class:"w-[15px]"},null,8,so),k[1]||(k[1]=y("div",{class:"absolute top-[21px] left-[3px] w-[8px] h-[8px] bg-red-500 rounded-full"},null,-1)),y("div",{class:"absolute left-[5px] w-[4px] bg-red-500",style:z(E.value)},null,4)],36),[[ye,x.value==0]]),re(y("div",{class:"absolute cursor-pointer",style:z(g(Oe)(o)),onPointerdown:S},[y("img",{src:g(rs),alt:"shows humidity",class:"absolute w-[20px] top-1 -left-[2px]"},null,8,oo),y("div",{class:"absolute w-20 overflow-hidden left-[1.3px]",style:z(R.value)},[y("img",{class:"absolute bottom-0 w-[13px]",src:g(is),alt:"shows humidity level"},null,8,ro)],4)],36),[[ye,x.value==1]]),re(y("div",{class:"absolute cursor-pointer",style:z(g(Oe)(o)),onPointerdown:S},[y("img",{src:g(as),alt:"pressure base",class:"absolute top-1 -left-1 w-[25px]"},null,8,io),y("img",{src:g(ls),alt:"pressure arrow",class:"absolute top-[7px] left-[4px] w-[13px]",style:z(_.value)},null,12,ao)],36),[[ye,x.value==2]]),re(y("div",lo,[re(y("input",{type:"range",min:"0",max:"1",step:"0.01","onUpdate:modelValue":k[0]||(k[0]=M=>T.value=M),class:"w-full cursor-ew-resize",onPointerdown:ke(I,["stop"]),onPointerup:D,onPointercancel:D},null,544),[[Ht,T.value,void 0,{number:!0}]])],512),[[ye,!g(e)||q.value]])])],512))}}),Ao=Object.freeze(Object.defineProperty({__proto__:null,default:Mo},Symbol.toStringTag,{value:"Module"})),Do="/assets/color_sensor-DwtQkxue.jpg";function xn(n){return{background:`rgba(${n.r}, ${n.g}, ${n.b}, ${n.a})`}}function Bn(n=5e3){const e=b(!1);let t=null;const s=()=>{t=setTimeout(()=>{e.value=!0},n)},o=()=>{t&&clearTimeout(t),e.value=!1};return Te(()=>{s()}),Wt(()=>{t&&clearTimeout(t)}),{isHint:e,stopHint:o}}const Oo={ref:"theref"},Bo={class:"relative"},Lo={class:"overflow-hidden w-20 h-20 rounded-xl"},Fo=["src"],No=["src"],Uo={class:"absolute left-[1px] -top-[9px]"},zo=["src"],jo=8,Go=9,Vo=10,Ho=11,Me=3,$t=10,bn=14,Wo=W({type:"color-sensor",params:{mode2:B.IN,mode3:B.IN,address:16},__name:"ColorSensor",props:{x:{},y:{},w:{},h:{},m_id:{},on:{},type:{},putOn8or9:{type:Boolean},dragging:{type:Boolean},connector:{},params:{},id:{},pin0:{},pin1:{},pin2:{},pin3:{},reset:{type:Function},i2c:{}},setup(n){const e=n;e.i2c.read=(f,E,C)=>{const R=d.value.r,_=d.value.g,q=d.value.b,D=(R+_+q)/3;switch(E){case jo:C==1&&Ee(f,0,R*256),He(f,0,R*256);break;case Go:C==1&&Ee(f,0,R*256),He(f,0,_*256);break;case Vo:C==1&&Ee(f,0,R*256),He(f,0,q*256);break;case Ho:C==1&&Ee(f,0,R*256),He(f,0,D*256);break}};const t={x:44,y:35},s=V({x:44,y:35,w:25,h:25}),o=Se(`pickerRef-${e.m_id}`),l=b(!1);Q(l,()=>{const f=document.getElementById(`pibody-${e.m_id}`);f&&(l.value?f.style.cursor="none":f.style.cursor="auto")});const{isHint:p,stopHint:u}=Bn(),d=b({r:0,g:0,b:0,a:255}),r=b(null);function i(f,E,C,R){const _=4*(C+R*E),q=f[_],D=f[_+1],I=f[_+2],P=f[_+3];return{r:q,g:D,b:I,a:P}}const c=2*Me+1,v=c*($t+1)+2,x=b(Array(c*c)),T=V({x:10,y:10});function S(f){if(e.on===-1)return;f.stopPropagation(),l.value=!0;const E=Je(`pibody-${e.m_id}`);u();const C=f.clientX-s.x,R=f.clientY-s.y,_={x:s.x,y:s.y},q=b();let D=1,I=E.w;if(r.value){const M=Lt(r.value),$=w=>w===o.value;cs(r.value,{logging:!1,ignoreElements:$}).then(w=>{D=w.width/M.w,I=w.width;const j=w.getContext("2d",{willReadFrequently:!0});j&&(q.value=j.getImageData(0,0,w.width,w.height).data)}).catch(w=>{console.error("Error capturing page:",w)})}const P=M=>{const $={x:0,y:0};r.value&&($.x=r.value.scrollLeft,$.y=r.value.scrollTop);const w={x:$.x,y:$.y},j={x:E.w-s.w,y:E.h-s.h};s.x=M.clientX-C,s.y=M.clientY-R,Ke(s,w,j);let L=7/8*2*Math.PI,le=Math.cos(L),Z=Math.sin(L);if(T.x=bn*le,T.y=bn*Z,q.value){const ce=Math.round((s.x-1-$.x)*D),Pe=Math.round((s.y+s.h-$.y)*D);for(let Ne=-Me;Ne<=Me;Ne++)for(let Ue=-Me;Ue<=Me;Ue++){const xt=i(q.value,Math.round(I),ce+Ue,Pe+Ne),bt=Ue+Me+(Ne+Me)*c;x.value[bt]=xt}const{r:Qe,g:Ze,b:it}=x.value[(x.value.length-1)/2];d.value={r:Qe,g:Ze,b:it,a:255}}},k=()=>{l.value=!1,s.x=_.x,s.y=_.y,document.removeEventListener("pointermove",P),document.removeEventListener("pointerup",k)};document.addEventListener("pointermove",P),document.addEventListener("pointerup",k)}return Q([()=>e.x,()=>e.y],()=>{e.on!==-1&&(s.x=e.x+t.x,s.y=e.y+t.y)}),Te(()=>{r.value=document.getElementById(`pibody-${e.m_id}`)}),(f,E)=>(O(),N("div",Oo,[y("div",Bo,[y("div",Lo,[y("img",{src:g(Do),alt:"color sensor"},null,8,Fo)]),(O(),Ie($n,{to:r.value?e.dragging?`#emulator-${e.m_id}`:`#pibody-${e.m_id}`:"body"},[re(y("div",{ref_key:"pickerRef",ref:o,class:ve(["absolute z-20 cursor-move",{wiggle:g(p)&&e.on!==-1,"cursor-none":l.value}]),style:z([g(Oe)(s)]),onPointerdown:[S,E[0]||(E[0]=ke(C=>C.preventDefault(),["prevent"]))]},[re(y("img",{src:g(us),class:"absolute -left-[11px] top-[15px]"},null,8,No),[[ye,l.value]]),y("div",Uo,[y("img",{src:g(ds),alt:"Color picker for color sensor",class:ve({wiggle:g(p)&&e.on!==-1})},null,10,zo),y("div",{class:"polygon absolute left-0 bottom-0 w-[11px] h-[9px]",style:z([g(xn)(d.value)])},null,4)]),re(y("div",{class:"grid gap-px rounded-full overflow-hidden border-2 border-black bg-gray-500 absolute",style:z([{gridTemplateRows:`repeat(${c}, 1fr)`,gridTemplateColumns:`repeat(${c}, 1fr)`,width:v+"px"},g(Zs)(T)])},[(O(!0),N(Gt,null,Vt(x.value,(C,R)=>(O(),N("div",{style:z([g(xn)(C??{r:0,g:0,b:0}),g(Qs)({w:$t,h:$t})]),class:ve({"outline outline-1 outline-red-500":x.value.length-1===2*R})},null,6))),256))],4),[[ye,l.value]])],38),[[ye,e.on!==-1]])],8,["to"]))])],512))}}),Xo=Be(Wo,[["__scopeId","data-v-ef01bc5e"]]),Yo=Object.freeze(Object.defineProperty({__proto__:null,default:Xo},Symbol.toStringTag,{value:"Module"})),Ko="/assets/distance_sensor-D0uHoJZH.jpg",Jo="/assets/distance_sensor_ruler-u7x_6a7O.png",Qo={ref:"theref"},Zo={class:"rounded-lg relative"},er={class:"overflow-hidden w-20 h-20 rounded-xl"},tr=["src"],nr=["src"],sr=19,or=20,rr=W({type:"distance-sensor",params:{mode2:B.IN,mode3:B.IN,address:41},__name:"DistanceSensor",props:{x:{},y:{},w:{},h:{},m_id:{},on:{},type:{},putOn8or9:{type:Boolean},dragging:{type:Boolean},connector:{},params:{},id:{},pin0:{},pin1:{},pin2:{},pin3:{},reset:{type:Function},i2c:{}},setup(n){const e=n;e.i2c.read=(r,i,c)=>{switch(i){case sr:Ee(r,0,7);break;case or+10:c==1&&Ee(r,0,s&255),On(r,0,s);break}};const t=V({x:45,y:28,w:25,h:25});let s=0;const o=J(()=>{const r=mt(t),i={x:0,y:0,w:0,h:0,angle:0};i.x=e.w/2,i.y=e.h/2;const c=r.x-i.x,v=r.y-i.y;return i.w=Math.sqrt(c*c+v*v),s=i.w/290*95,i.angle=Math.atan2(v,c)/Math.PI/2,i}),l=Je(`pibody-${e.m_id}`),{isHint:p,stopHint:u}=Bn();function d(r){if(e.on===-1)return;r.stopPropagation(),u();const i=r.clientX-t.x,c=r.clientY-t.y,v=T=>{const S={x:-e.x,y:-e.y},f={x:l.w-e.x-t.w,y:l.h-e.y-t.h};t.x=T.clientX-i,t.y=T.clientY-c,Ke(t,S,f)},x=()=>{document.removeEventListener("pointermove",v),document.removeEventListener("pointerup",x)};document.addEventListener("pointermove",v),document.addEventListener("pointerup",x)}return Q([()=>e.x,()=>e.y],()=>{if(e.on!==-1){const r=Je(`pibody-${e.m_id}`),i={x:-e.x,y:-e.y},c={x:r.w-e.x-t.w,y:1/0};Ke(t,i,c)}}),Q(()=>e.on,()=>{const r={x:-e.x,y:-e.y},i={x:l.w-e.x-t.w,y:l.h-e.y-t.h};Ke(t,r,i)}),(r,i)=>(O(),N("div",Qo,[y("div",Zo,[y("div",er,[y("img",{src:g(Ko),alt:"distance sensor"},null,8,tr)]),y("div",{style:z([g(Oe)(o.value),{transform:`rotate(${o.value.angle}turn)`,pointerEvents:"none","--line-length":o.value.w+"px"}]),class:"absolute border-t-2 border-dashed border-blue-500 origin-top-left cursor-default pulsing-line"},i[1]||(i[1]=[y("div",{class:"pulse"},null,-1)]),4),y("img",{src:g(Jo),alt:"ruler of a distance sensor that sets distance",class:ve(["absolute",{wiggle:g(p)&&e.on!==-1}]),style:z(g(Oe)(t)),onPointerdown:[d,i[0]||(i[0]=ke(c=>c.preventDefault(),["prevent"]))]},null,46,nr)])],512))}}),ir=Be(rr,[["__scopeId","data-v-e6f90b4a"]]),ar=Object.freeze(Object.defineProperty({__proto__:null,default:ir},Symbol.toStringTag,{value:"Module"})),lr="/assets/encoder-BbdKADqm.jpg",cr="/assets/encoder_knob-Du3tJHEr.png",ur={class:"rounded-lg overflow-hidden relative"},dr=["src"],pr=["src"],fr={key:0,class:"absolute bg-blue-500 top-3 left-6 w-1 h-1"},mr={class:"absolute bottom-1 left-[25px] flex items-center"},_n=1/24,vr=W({type:"encoder",params:{mode2:B.IN,mode3:B.IN},__name:"Encoder",props:{x:{},y:{},w:{},h:{},m_id:{},on:{},type:{},putOn8or9:{type:Boolean},dragging:{type:Boolean},connector:{},params:{},id:{},pin0:{},pin1:{},pin2:{},pin3:{},reset:{type:Function},i2c:{}},setup(n){const e=n,t=J(()=>e.pin0.value===0&&e.pin1.value>0),s=b(0);Q(s,()=>{e.pin2.value=Math.abs(s.value*96%4)<2?1:0,e.pin3.value=Math.abs((s.value*96+95)%4)<2?1:0},{immediate:!0});let o=!1,l=0,p=0,u=0,d=0,r=0,i=null;const c=S=>{if(S.stopPropagation(),S.preventDefault(),d=Math.atan2(S.clientY-p,S.clientX-l)/(2*Math.PI)+1/4,r=s.value,o=!o,S.currentTarget instanceof HTMLElement){const E=S.currentTarget.getBoundingClientRect();l=E.left+E.width/2,p=E.top+E.height/2}window.addEventListener("pointermove",T),window.addEventListener("pointerup",x)},v=()=>{if(!i)return;let S=u-s.value;S>.5&&(S-=1),S<-.5&&(S+=1);const f=.1;Math.abs(S)>.001?(s.value+=S*f,s.value>1&&(s.value-=1),s.value<0&&(s.value+=1),i=requestAnimationFrame(v)):(s.value=u,cancelAnimationFrame(i),i=null)},x=()=>{u=Math.round(s.value/_n)*_n,i||(i=requestAnimationFrame(v)),o=!1,window.removeEventListener("pointermove",T),window.removeEventListener("pointerup",x)},T=S=>{if(o){const E=Math.atan2(S.clientY-p,S.clientX-l)/(2*Math.PI)+1/4-d;u=r+E,i||(i=requestAnimationFrame(v))}};return(S,f)=>(O(),N("div",null,[y("div",ur,[y("img",{src:g(lr),alt:"Potentiometer"},null,8,dr),y("button",{class:"absolute rounded-full top-3 left-[22px] w-14 h-14",onPointerdown:c},[y("img",{class:"top-0 left-0 w-14 h-14",src:g(cr),style:z(`transform: rotate(${s.value}turn)`)},null,12,pr),t.value?(O(),N("div",fr)):ie("",!0)],32),y("div",mr,[y("div",{class:ve(["w-1 h-1 rounded-full",e.pin2.value?"bg-green-500":"bg-transparent"])},null,2),f[0]||(f[0]=y("div",{class:"w-1 h-1 bg-transparent"},null,-1)),y("div",{class:ve(["w-1 h-1 rounded-full",e.pin3.value?"bg-green-500":"bg-transparent"])},null,2)])])]))}}),hr=Object.freeze(Object.defineProperty({__proto__:null,default:vr},Symbol.toStringTag,{value:"Module"})),gr="/assets/gyro-B0eg3n6B.jpg";let yr=5;const wr=`
attribute vec3 aPosition;
attribute vec2 aTexCoord;
uniform mat4 uMVP;
varying vec2 vTexCoord;
void main() {
  gl_Position = uMVP * vec4(aPosition,1.0);
  vTexCoord = aTexCoord;
}`,xr=`
precision mediump float;
uniform sampler2D uSampler;
varying vec2 vTexCoord;
void main() {
  gl_FragColor = texture2D(uSampler, vTexCoord);
}`,we=new Map,br=new Float32Array([0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1]),_r=new Uint16Array(Array.from({length:6},(n,e)=>[4*e+0,4*e+1,4*e+2,4*e+0,4*e+2,4*e+3]).flat()),Sr=[{label:"+X",background:"#ff0000"},{label:"-X",background:"#cc0000"},{label:"+Y",background:"#00ff00"},{label:"-Y",background:"#00cc00"},{label:"+Z",background:"#0000ff"},{label:"-Z",background:"#0000cc"}];function Sn(n,e,t){if(!n)return null;const s=n.createShader(t);return s?(n.shaderSource(s,e),n.compileShader(s),n.getShaderParameter(s,n.COMPILE_STATUS)?s:(console.error(n.getShaderInfoLog(s)),n.deleteShader(s),null)):null}async function yl(n){if(we.has(n))return we.get(n).gl;for(await ot();n.clientWidth===0||n.clientHeight===0;)await new Promise(x=>setTimeout(x,10));const e=window.devicePixelRatio||1;n.width=n.clientWidth*e,n.height=n.clientHeight*e;const t=n.getContext("webgl",{antialias:!0,preserveDrawingBuffer:!0});if(!t)return null;t.viewport(0,0,n.width,n.height);const s=Sn(t,wr,t.VERTEX_SHADER),o=Sn(t,xr,t.FRAGMENT_SHADER),l=t.createProgram();if(!l||!s||!o)return null;t.attachShader(l,s),t.attachShader(l,o),t.linkProgram(l),t.getProgramParameter(l,t.LINK_STATUS)||console.error(t.getProgramInfoLog(l)),t.useProgram(l);const p=t.getAttribLocation(l,"aPosition"),u=t.getAttribLocation(l,"aTexCoord"),d=t.getUniformLocation(l,"uMVP"),r=t.getUniformLocation(l,"uSampler"),i=ps(je(),Math.PI/4,n.width/n.height,.1,80200),c=performance.now(),v={gl:t,canvasEl:n,aPos:p,aUV:u,uMVP:d,uSampler:r,proj:i,lastTime:c,instances:new Map,idCounter:0};return we.set(n,v),t}function kr(n){let e=null;if(n.m_id){const r=document.getElementById(`pibody-${n.m_id}`);if(r){const i=r.querySelector("canvas:not(.display-container canvas)");i&&i instanceof HTMLCanvasElement&&we.has(i)&&(e=i)}}if(!e){let r=n.el.parentElement;for(;r&&!(r instanceof HTMLCanvasElement);)r=r.parentElement;if(r instanceof HTMLCanvasElement)e=r;else{const i=document.querySelectorAll("canvas");for(const c of i)if(we.has(c)){e=c;break}}}if(!e||!we.has(e))return null;const t=we.get(e);t.idCounter++;const s=t.idCounter;if(!t.gl)return null;const o=t.gl.createBuffer();t.gl.bindBuffer(t.gl.ARRAY_BUFFER,o),t.gl.bufferData(t.gl.ARRAY_BUFFER,n.facePositions,t.gl.STATIC_DRAW);const l=t.gl.createBuffer();t.gl.bindBuffer(t.gl.ARRAY_BUFFER,l),t.gl.bufferData(t.gl.ARRAY_BUFFER,br,t.gl.STATIC_DRAW);const p=t.gl.createBuffer();t.gl.bindBuffer(t.gl.ELEMENT_ARRAY_BUFFER,p),t.gl.bufferData(t.gl.ELEMENT_ARRAY_BUFFER,_r,t.gl.STATIC_DRAW);const u=Sr.map(r=>{if(!t.gl)return null;const i=256,c=document.createElement("canvas");c.width=c.height=i;const v=c.getContext("2d");v.fillStyle=r.background,v.fillRect(0,0,i,i),v.fillStyle="#000",v.font="bold 128px sans-serif",v.textAlign="center",v.textBaseline="middle",v.fillText(r.label,i/2,i/2);const x=t.gl.createTexture();return t.gl.bindTexture(t.gl.TEXTURE_2D,x),t.gl.pixelStorei(t.gl.UNPACK_FLIP_Y_WEBGL,!0),t.gl.texImage2D(t.gl.TEXTURE_2D,0,t.gl.RGBA,t.gl.RGBA,t.gl.UNSIGNED_BYTE,c),t.gl.texParameteri(t.gl.TEXTURE_2D,t.gl.TEXTURE_MIN_FILTER,t.gl.LINEAR),t.gl.texParameteri(t.gl.TEXTURE_2D,t.gl.TEXTURE_WRAP_S,t.gl.CLAMP_TO_EDGE),t.gl.texParameteri(t.gl.TEXTURE_2D,t.gl.TEXTURE_WRAP_T,t.gl.CLAMP_TO_EDGE),x}),d={id:s,cube:n,buffers:{pos:o,uv:l,idx:p},textures:u};return t.instances.set(s,d),d}function Er(n){for(const e of we.values())if(e.instances.has(n)){e.instances.delete(n);break}}function Tr(n){for(const e of we.values()){if(!e.gl||!e.canvasEl)continue;const t=(n-e.lastTime)/1e3;e.lastTime=n,e.gl.clearColor(0,0,0,1),e.gl.clear(e.gl.COLOR_BUFFER_BIT|e.gl.DEPTH_BUFFER_BIT),e.gl.clearColor(0,0,0,0),e.gl.clear(e.gl.COLOR_BUFFER_BIT|e.gl.DEPTH_BUFFER_BIT),e.gl.enable(e.gl.DEPTH_TEST);for(const{cube:s,buffers:o,textures:l}of e.instances.values()){s.update(t);const p=Lt(s.el),u=Lt(e.canvasEl);st(p,u);const d=e.gl.drawingBufferWidth/u.w,r=e.gl.drawingBufferHeight/u.h,i=p.x*d,c=p.y*r,v=p.w*d,x=p.h*r,T=e.gl.drawingBufferHeight-c-x;e.gl.enable(e.gl.SCISSOR_TEST),e.gl.scissor(i,T,v,x),e.gl.viewport(i,T,v,x),e.gl.bindBuffer(e.gl.ARRAY_BUFFER,o.pos),e.gl.enableVertexAttribArray(e.aPos),e.gl.vertexAttribPointer(e.aPos,3,e.gl.FLOAT,!1,0,0),e.gl.bindBuffer(e.gl.ARRAY_BUFFER,o.uv),e.gl.enableVertexAttribArray(e.aUV),e.gl.vertexAttribPointer(e.aUV,2,e.gl.FLOAT,!1,0,0),e.gl.bindBuffer(e.gl.ELEMENT_ARRAY_BUFFER,o.idx);const S=fs(je(),je(),[0,0,-yr]),f=ms(je(),s.orientationQuat),E=Kt(je(),S,f),C=Kt(je(),e.proj,E);e.gl.uniformMatrix4fv(e.uMVP,!1,C);for(let R=0;R<6;R++)l[R]?(e.gl.activeTexture(e.gl.TEXTURE0),e.gl.bindTexture(e.gl.TEXTURE_2D,l[R]),e.gl.uniform1i(e.uSampler,0),e.gl.drawElements(e.gl.TRIANGLES,6,e.gl.UNSIGNED_SHORT,R*6*2)):console.warn(`Texture ${R} is null for cube ${s.id}`);e.gl.disable(e.gl.SCISSOR_TEST),e.gl.viewport(0,0,e.gl.drawingBufferWidth,e.gl.drawingBufferHeight)}}requestAnimationFrame(Tr)}function wl(n){const e=we.get(n);if(e){for(const t of e.instances.values()){e.gl.deleteBuffer(t.buffers.pos),e.gl.deleteBuffer(t.buffers.uv),e.gl.deleteBuffer(t.buffers.idx);for(const s of t.textures)s&&e.gl.deleteTexture(s)}we.delete(n)}}function Pr(n,e){const t=new Float32Array([1,-1,-1,1,1,-1,1,1,1,1,-1,1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,-1,-1,1,1,1,1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,-1,-1,1,1,-1,1,1,1,1,-1,1,1,1,-1,-1,-1,-1,-1,-1,1,-1,1,1,-1]);let s=Xe(),o=Xe();Ge(o,[1,0,0],.5),Ve(s,o,s),Ge(o,[0,1,0],-.5),Ve(s,o,s),Ge(o,[0,0,1],.5),Ve(s,o,s);let l=Rn();function p(i){const c=vs(l);if(c>0){const v=hs(l);Mn(v,v,1/c);const x=c*i,T=Ge(Xe(),v,x);Ve(s,T,s)}}function u(){Er(d.id)}const d={id:0,el:n,m_id:e,facePositions:t,orientationQuat:s,angularVelocity:l,update:p,delete:u,dragging:!1},r=kr(d);return r&&(d.id=r.id),d.id==1&&u(),d}const Ir={ref:"theref"},qr={class:"rounded-lg overflow-hidden relative"},Cr=["src"],kn=.01,$r=W({type:"gyro-accel",params:{mode2:B.OUT,address:104},__name:"Gyro",props:{x:{},y:{},w:{},h:{},m_id:{},on:{},type:{},putOn8or9:{type:Boolean},dragging:{type:Boolean},connector:{},params:{},id:{},pin0:{},pin1:{},pin2:{},pin3:{},reset:{type:Function},i2c:{}},setup(n){const e=n,t=Se("cubeRef");let s;Te(()=>{t.value&&(s=Pr(t.value,e.m_id),e.i2c.read=(T,S,f)=>{switch(S){case 65:Re(T,0,-5e3);break;case 59:{const[E,C,R,_]=s.orientationQuat,q=E*E,D=C*C,I=E*R,P=C*R,k=_*E,M=_*C,$=-(2*(I+M))*16384,w=-(2*(P-k))*16384,j=-(1-2*(q+D))*16384;Re(T,0,$),Re(T,2,w),Re(T,4,j)}break;case 67:{const E=s.angularVelocity[0]*131,C=s.angularVelocity[1]*131,R=s.angularVelocity[2]*131;Re(T,0,E),Re(T,2,C),Re(T,4,R)}break}})}),Wt(()=>{s&&s.delete()});let o={x:0,y:0},l=0,p={x:0,y:0,w:25,h:25},u={x:0,y:0,w:50,h:50},d=V({...p});function r(T){c&&(clearTimeout(c),c=null),s.dragging=!0,o.x=T.clientX,o.y=T.clientY,gs(s.angularVelocity,0,0,0),on(d,u),l=performance.now(),window.addEventListener("pointermove",i),window.addEventListener("pointerup",x)}function i(T){if(!s.dragging)return;const S=performance.now(),f=(S-l)/1e3;l=S;const E=T.clientX-o.x,C=T.clientY-o.y;o.x=T.clientX,o.y=T.clientY;const R=Ge(Xe(),[0,1,0],E*kn),_=Ge(Xe(),[1,0,0],C*kn),q=Ve(Xe(),_,R);Ve(s.orientationQuat,q,s.orientationQuat);const D=Rn(),I=ys(D,q);ws(D,D),Mn(s.angularVelocity,D,I/f);const P=Jt(10,10,10),k=Jt(-10,-10,-10);xs(s.angularVelocity,P,s.angularVelocity),bs(s.angularVelocity,k,s.angularVelocity)}let c=null,v=2e3;function x(){s.dragging=!1,c||(c=setTimeout(()=>{on(d,p),c=null},v)),window.removeEventListener("pointermove",i),window.removeEventListener("pointerup",x)}return(T,S)=>(O(),N("div",Ir,[y("div",qr,[y("img",{src:g(gr),alt:"climate sensor"},null,8,Cr)]),y("div",{ref:"cubeRef",class:"absolute",style:z(g(Oe)(g(d))),onPointerdown:ke(r,["stop"]),onPointerup:x,onPointercancel:x},null,36)],512))}}),Rr=Object.freeze(Object.defineProperty({__proto__:null,default:$r},Symbol.toStringTag,{value:"Module"})),Mr={class:"color-picker select-none w-32"},Ar={class:"slider-container"},Dr={class:"slider-container"},Or=W({__name:"ColorPicker",props:{modelValue:{required:!0,default:{r:0,g:0,b:0}},modelModifiers:{}},emits:["update:modelValue"],setup(n){const e=pt(n,"modelValue"),{h:t,s}=i(e.value.r,e.value.g,e.value.b),o=b(t/360),l=b(),p=b(s/100),u=b();let d=!1,r=!1;function i(_,q,D){_/=255,q/=255,D/=255;const I=Math.max(_,q,D),P=Math.min(_,q,D),k=I-P;let M=0;k!==0&&(I===_?M=(q-D)/k%6:I===q?M=(D-_)/k+2:M=(_-q)/k+4,M=Math.round(M*60),M<0&&(M+=360));const $=(I+P)/2,w=k===0?0:k/(1-Math.abs(2*$-1));return{h:M,s:w*100,l:$*100}}function c(_,q,D){_=_*360%360,q/=100,D/=100;const I=(1-Math.abs(2*D-1))*q,P=I*(1-Math.abs(_/60%2-1)),k=D-I/2;let M=0,$=0,w=0;return 0<=_&&_<60?(M=I,$=P,w=0):60<=_&&_<120?(M=P,$=I,w=0):120<=_&&_<180?(M=0,$=I,w=P):180<=_&&_<240?(M=0,$=P,w=I):240<=_&&_<300?(M=P,$=0,w=I):300<=_&&_<=360&&(M=I,$=0,w=P),{r:Math.round((M+k)*255),g:Math.round(($+k)*255),b:Math.round((w+k)*255)}}function v(_,q,D){const I=(1-D+q)/2;let P;return I===0||I===1?P=0:P=(1-D-q)/(1-Math.abs(2*I-1)),{h:_,s:P*100,l:I*100}}const x=J(()=>{const{h:_,s:q,l:D}=v(o.value,1-p.value,0),{r:I,g:P,b:k}=c(_,q,D);return e.value={r:I,g:P,b:k},`hsl(${_}turn, ${q}%, ${D}%)`}),T=_=>{r=!r,f(_),window.addEventListener("pointermove",f),window.addEventListener("pointerup",S)},S=()=>{r=!1,window.removeEventListener("pointermove",f),window.removeEventListener("pointerup",S)},f=_=>{if(r){const q=u.value.getBoundingClientRect(),D=Math.min(q.width,Math.max(0,_.clientX-q.left));p.value=D/q.width}},E=_=>{d=!d,R(_),window.addEventListener("pointermove",R),window.addEventListener("pointerup",C)},C=()=>{d=!1,window.removeEventListener("pointermove",R),window.removeEventListener("pointerup",C)},R=_=>{if(d){const q=l.value.getBoundingClientRect(),D=Math.min(q.width,Math.max(0,_.clientX-q.left));o.value=D/q.width}};return(_,q)=>(O(),N("div",Mr,[y("div",Ar,[y("div",{class:"hue-slider",style:{background:"linear-gradient(to right, red, yellow, lime, cyan, blue, magenta, red)"},onPointerdown:E,onPointerup:C,onPointermove:R,ref_key:"hueRef",ref:l},[y("div",{class:"slider-handle",style:z({left:`${o.value*100}%`})},null,4)],544)]),y("div",Dr,[y("div",{class:"saturation-slider",style:z({background:`linear-gradient(to right, white, hsl(${o.value}turn, 100%, 50%))`}),onPointerdown:T,onPointerup:S,onPointermove:f,ref_key:"saturationRef",ref:u},[y("div",{class:"slider-handle",style:z({left:`${p.value*100}%`})},null,4)],36)]),re(y("div",{class:"color-preview",style:z({backgroundColor:`${x.value}`})},null,4),[[ye,!1]])]))}}),Br=Be(Or,[["__scopeId","data-v-cf523b39"]]),Lr="/assets/yellow_led-TydLrbQ8.jpg",Fr={ref:"theref"},Nr={class:"rounded-lg overflow-hidden relative"},Ur=["src"],zr={key:1,class:"absolute top-0 left-0"},jr=W({type:"LED",params:{mode2:B.OUT},__name:"LED",props:{x:{},y:{},w:{},h:{},m_id:{},on:{},type:{},putOn8or9:{type:Boolean},dragging:{type:Boolean},connector:{},params:{},id:{},pin0:{},pin1:{},pin2:{},pin3:{},reset:{type:Function},i2c:{}},setup(n){const{isOutside:e}=Le(Se("theref")),t=b({r:0,g:255,b:0}),s=n,o=b({visible:!1,toggle:i=>{}});function l(i){o.value.toggle(i)}const p=J(()=>`
0 0 3px 3px rgba(${t.value.r}, ${t.value.g}, ${t.value.b}, ${s.pin2.value*.7}),
0 0 5px 5px rgba(${t.value.r}, ${t.value.g}, ${t.value.b}, ${s.pin2.value*.5}),
0 0 7px 7px rgba(${t.value.r}, ${t.value.g}, ${t.value.b}, ${s.pin2.value*.3})
`),u=J(()=>`radial-gradient(circle, rgb(${t.value.r}, ${t.value.g}, ${t.value.b}) 40%, #000 90%)`),d=J(()=>`rgb(${t.value.r}, ${t.value.g}, ${t.value.b})`),r=J(()=>`rgba(${t.value.r}, ${t.value.g}, ${t.value.b}, 0.7)`);return(i,c)=>{const v=ht,x=Qn;return O(),N("div",Fr,[y("div",Nr,[y("img",{src:g(Lr),alt:"LED"},null,8,Ur),y("div",{class:"absolute top-[10px] left-[30px] rounded-full h-[19px] w-[19px]",style:z({background:d.value})},null,4),y("div",{class:"absolute top-[12px] left-[32px] rounded-full h-[15px] w-[15px]",style:z({background:u.value})},null,4),s.pin2.value?(O(),N("div",{key:0,class:"absolute top-2 left-7 rounded-full h-6 w-6 p-0 border-none absolute top-0 left-0 overflow-hidden",style:z({boxShadow:p.value,background:r.value})},null,4)):ie("",!0),!g(e)||o.value.visible?(O(),N("div",zr,[pe(v,{type:"button",class:"w-6 h-6 bg-black",rounded:"",onClick:l,onPointerdown:c[0]||(c[0]=ke(()=>{},["stop"]))},{default:_e(()=>c[2]||(c[2]=[y("span",{class:"material-icons"},"palette",-1)])),_:1})])):ie("",!0),pe(x,{ref_key:"colorPicker",ref:o},{default:_e(()=>[pe(Br,{modelValue:t.value,"onUpdate:modelValue":c[1]||(c[1]=T=>t.value=T)},null,8,["modelValue"])]),_:1},512)])],512)}}}),Gr=Be(jr,[["__scopeId","data-v-315f9436"]]),Vr=Object.freeze(Object.defineProperty({__proto__:null,default:Gr},Symbol.toStringTag,{value:"Module"})),Hr="/assets/led_tower-BgHpljFW.png",Wr={ref:"theref"},Xr={class:"led-tower"},Yr=["src"],Kr=n=>(n.w=30,n),Jr={type:"led-tower",params:{mode2:1},w:30,extend:Kr},Qr=W({...Jr,__name:"LedTower",props:{x:{},y:{},w:{},h:{},m_id:{},on:{},type:{},putOn8or9:{type:Boolean},dragging:{type:Boolean},connector:{},params:{},id:{},pin0:{},pin1:{},pin2:{},pin3:{},reset:{type:Function},i2c:{}},setup(n){const e=n,t=b(!1),s=8;Q(()=>e.dragging,l=>{l||(t.value=!0)});const o=(l,p)=>{try{const u=l||[0,0,0];let[d=0,r=0,i=0]=u;const c=Math.max(d,r,i);if(!c)d=0,r=0,i=0;else{const T=255/c;d=T*d,r=T*r,i=T*i}const v=c/255,x=60.5+p*15.2;return{backgroundColor:d===0&&r===0&&i===0?"transparent":`rgb(${d}, ${r}, ${i})`,boxShadow:v>.1?`
        0 0 2px 2px rgba(${d}, ${r}, ${i}, ${v*.6}),
        0 0 4px 4px rgba(${d}, ${r}, ${i}, ${v*.4}),
        0 0 6px 6px rgba(${d}, ${r}, ${i}, ${v*.2}),
        0 0 6px 6px rgba(0, 0, 0, ${v*.07})
      `:"none",transition:"all 0.1s ease",position:"absolute",left:"14%",top:`${x}px`,width:"7px",height:"7px",borderRadius:"50%",zIndex:2,pointerEvents:"none"}}catch(u){return console.warn("LedTower getPixelStyle error:",u),{position:"absolute",left:"14%",top:"18px",width:"7px",height:"7px",pointerEvents:"none"}}};return(l,p)=>(O(),N("div",Wr,[y("div",Xr,[y("img",{src:g(Hr),alt:"LED Tower",class:ve(t.value?"rotate-90":"base-view")},null,10,Yr),(O(!0),N(Gt,null,Vt(e.pin2.arr.slice(0,s).map(u=>[...u]),(u,d)=>(O(),N("div",{key:d,class:"led-pixel",style:z(o(u,d))},null,4))),128))])],512))}}),Zr=Be(Qr,[["__scopeId","data-v-725a03d8"]]),ei=Object.freeze(Object.defineProperty({__proto__:null,default:Zr},Symbol.toStringTag,{value:"Module"})),ti="/assets/light_sensor-eM0m1ojf.jpg",ni={ref:"theref"},si={class:"rounded-lg overflow-hidden relative"},oi=["src"],ri={class:"absolute bottom-0 left-0 flex items-center cursor-ew-resize"},ii=W({type:"light-sensor",params:{mode2:B.IN},__name:"LightSensor",props:{x:{},y:{},w:{},h:{},m_id:{},on:{},type:{},putOn8or9:{type:Boolean},dragging:{type:Boolean},connector:{},params:{},id:{},pin0:{},pin1:{},pin2:{},pin3:{},reset:{type:Function},i2c:{}},setup(n){const e=n;e.pin2.value=1;const{isOutside:t}=Le(Se("theref")),s=J(()=>({background:`rgba(0, 0, 0, ${(1-e.pin2.value)*.5})`})),o=b(!1),l=()=>{o.value=!0},p=()=>{o.value=!1};return(u,d)=>(O(),N("div",ni,[y("div",si,[y("img",{src:g(ti),alt:"Light Sensor"},null,8,oi),y("div",{class:"absolute w-full h-full top-0 left-0",style:z(s.value)},null,4),re(y("div",ri,[re(y("input",{type:"range",min:"0",max:"1",step:"0.01","onUpdate:modelValue":d[0]||(d[0]=r=>e.pin2.value=r),class:"w-full cursor-ew-resize",onPointerdown:ke(l,["stop"]),onPointerup:p,onPointercancel:p},null,544),[[Ht,e.pin2.value]])],512),[[ye,!g(t)||o.value]])])],512))}}),ai=Object.freeze(Object.defineProperty({__proto__:null,default:ii},Symbol.toStringTag,{value:"Module"})),li="/assets/microphone-BjeZeCno.jpg",ci={ref:"theref"},ui={class:"rounded-lg overflow-hidden relative"},di=["src"],pi=W({type:"microphone",params:{mode2:B.OUT},__name:"Microphone",props:{x:{},y:{},w:{},h:{},m_id:{},on:{},type:{},putOn8or9:{type:Boolean},dragging:{type:Boolean},connector:{},params:{},id:{},pin0:{},pin1:{},pin2:{},pin3:{},reset:{type:Function},i2c:{}},setup(n){return(e,t)=>(O(),N("div",ci,[y("div",ui,[y("img",{src:g(li),alt:"microphone"},null,8,di)])],512))}}),fi=Object.freeze(Object.defineProperty({__proto__:null,default:pi},Symbol.toStringTag,{value:"Module"})),Ln=W({type:"",params:{},__name:"Module",props:{x:{},y:{},w:{},h:{},m_id:{},on:{},type:{},putOn8or9:{type:Boolean},dragging:{type:Boolean},connector:{},params:{},id:{},pin0:{},pin1:{},pin2:{},pin3:{},reset:{type:Function},i2c:{}},setup(n){return(e,t)=>(O(),N("div"))}}),mi=Object.freeze(Object.defineProperty({__proto__:null,default:Ln},Symbol.toStringTag,{value:"Module"})),vi="/assets/motion_detector-5Zx7-09a.jpg";function yt(n,e,t=null){const s=b(""),o=b(!1),l=r=>{o.value&&r.key==="Escape"&&(s.value="",o.value=!1,window.removeEventListener("keydown",l)),o.value&&/^[A-Za-z0-9]$/.test(r.key)&&(s.value=r.key.toUpperCase(),o.value=!1,window.removeEventListener("keydown",l))},p=r=>{!o.value&&r.key.toUpperCase()===s.value&&n()},u=r=>{!o.value&&r.key.toUpperCase()===s.value&&e()},d=r=>{r.stopPropagation(),o.value=!0,window.addEventListener("keydown",l)};return Te(()=>{window.addEventListener("keydown",p),window.addEventListener("keyup",u)}),vt(()=>{window.removeEventListener("keydown",p),window.removeEventListener("keyup",u)}),t&&Q(()=>t.shortcut,()=>{s.value||(s.value=t.shortcut)},{immediate:!0}),{shortcut:s,isSettingShortcut:o,startSettingShortcut:d}}const hi={class:"rounded-lg overflow-hidden relative"},gi=["src"],yi={class:"absolute top-11 left-[18px]"},wi={class:"w-[12px] h-[9px] bg-green-500 absolute top-[36px] left-[34px]"},xi=W({type:"motion-detector",params:{mode2:B.OUT},__name:"MotionDetector",props:{x:{},y:{},w:{},h:{},m_id:{},on:{},type:{},putOn8or9:{type:Boolean},dragging:{type:Boolean},connector:{},params:{},id:{},pin0:{},pin1:{},pin2:{},pin3:{},reset:{type:Function},i2c:{}},setup(n){const e=Se("theref"),{isOutside:t}=Le(e),s=n;let o=null;const l=()=>{s.pin2.value=1,o!==null&&clearTimeout(o),o=setTimeout(()=>{p(),o=null},4e3)},p=()=>{s.pin2.value=0},{shortcut:u,isSettingShortcut:d,startSettingShortcut:r}=yt(l,()=>{},s.params);return Te(()=>{e.value&&(e.value.addEventListener("click",l),e.value.addEventListener("mousemove",l))}),(i,c)=>(O(),N("div",{ref_key:"theref",ref:e},[y("div",hi,[y("img",{src:g(vi),alt:"Toggle Switch"},null,8,gi),y("div",yi,ae(g(u)),1),re(y("div",wi,null,512),[[ye,s.pin2.value]]),!g(t)||g(d)?(O(),N("button",{key:0,onClick:c[0]||(c[0]=(...v)=>g(r)&&g(r)(...v)),onPointerdown:c[1]||(c[1]=ke(()=>{},["stop"])),class:"absolute w-full h-4 text-xs top-0 left-0 bg-black/[0.8] text-white rounded-lg"},ae(g(d)?"Press a key...":g(u)?"Set shortcut":"Add shortcut"),33)):ie("",!0)])],512))}}),bi=Object.freeze(Object.defineProperty({__proto__:null,default:xi},Symbol.toStringTag,{value:"Module"})),_i="/assets/potentiometer-CklP_JJ1.jpg",Si={class:"rounded-lg overflow-hidden relative"},ki=["src"],Ei={class:"absolute rounded-full top-5 left-8 w-10 h-10 cursor-ew-resize"},Ti={key:0,class:"absolute bottom-0 left-0 flex items-center"},Pi=W({type:"potentiometer",params:{mode2:B.IN},__name:"Potentiometer",props:{x:{},y:{},w:{},h:{},m_id:{},on:{},type:{},putOn8or9:{type:Boolean},dragging:{type:Boolean},connector:{},params:{},id:{},pin0:{},pin1:{},pin2:{},pin3:{},reset:{type:Function},i2c:{}},setup(n){const e=n,t=J(()=>e.pin2.value*6/8-3/8),s=b(!1);let o=!1,l=0;const p=r=>{r.stopPropagation(),r.preventDefault(),o=!o,l=r.clientX,s.value=o,window.addEventListener("pointermove",d),window.addEventListener("pointerup",u)},u=()=>{o=!1,s.value=o,window.removeEventListener("pointermove",d),window.removeEventListener("pointerup",u)},d=r=>{if(o){const i=(r.clientX-l)/20;l=r.clientX,e.pin2.value=Math.min(1,Math.max(0,e.pin2.value+i/2))}};return(r,i)=>(O(),N("div",null,[y("div",Si,[y("img",{src:g(_i),alt:"Potentiometer"},null,8,ki),y("button",Ei,[y("div",null,[y("div",{class:"top-0 left-0 relative w-10 h-10 rounded-full bg-rose-600 flex items-center justify-center",onPointerdown:p,style:z(`transform: rotate(${t.value}turn)`)},i[1]||(i[1]=[y("div",{class:"absolute top-0 left-4.5 w-1 h-5 bg-white"},null,-1),y("div",{class:"absolute inset-0 flex items-center justify-center pointer-events-none"},null,-1)]),36)])]),s.value?(O(),N("div",Ti,[re(y("input",{type:"range",min:"0",max:"1",step:"0.01","onUpdate:modelValue":i[0]||(i[0]=c=>e.pin2.value=c),class:"w-full cursor-pointer"},null,512),[[Ht,e.pin2.value]])])):ie("",!0)])]))}}),Ii=Object.freeze(Object.defineProperty({__proto__:null,default:Pi},Symbol.toStringTag,{value:"Module"})),qi="/assets/push_button-DvCvYEel.jpg",Ci={ref:"theref"},$i={class:"rounded-lg overflow-hidden relative"},Ri=["src"],Mi=W({type:"push-button",params:{mode2:B.IN},__name:"PushButton",props:{x:{},y:{},w:{},h:{},m_id:{},on:{},type:{},putOn8or9:{type:Boolean},dragging:{type:Boolean},connector:{},params:{},id:{},pin0:{},pin1:{},pin2:{},pin3:{},reset:{type:Function},i2c:{}},setup(n){const{isOutside:e}=Le(Se("theref")),t=n,s=()=>{t.pin2.value=1},o=()=>{t.pin2.value=0},{shortcut:l,isSettingShortcut:p,startSettingShortcut:u}=yt(s,o,t.params);return(d,r)=>(O(),N("div",Ci,[y("div",$i,[y("img",{src:g(qi),alt:"Push Button"},null,8,Ri),y("button",{class:ve(["absolute top-[27px] left-[27px] rounded-full w-[25px] h-[25px]",t.pin2.value?"bg-green-500":"bg-blue-500"]),onPointerdown:s,onPointerup:o,onPointerleave:o},ae(g(l)),35),!g(e)||g(p)?(O(),N("button",{key:0,onClick:r[0]||(r[0]=(...i)=>g(u)&&g(u)(...i)),onPointerdown:r[1]||(r[1]=ke(()=>{},["stop"])),class:"absolute w-full h-4 text-xs top-0 left-0 bg-black/[0.8] text-white rounded-lg"},ae(g(p)?"Press a key...":g(l)?"Set shortcut":"Add shortcut"),33)):ie("",!0)])],512))}}),Ai=Object.freeze(Object.defineProperty({__proto__:null,default:Mi},Symbol.toStringTag,{value:"Module"})),Di="data:image/svg+xml,%3csvg%20width='200'%20height='100'%20viewBox='0%200%20200%20100'%20xmlns='http://www.w3.org/2000/svg'%3e%3c!--%20Servo%20(circle)%20--%3e%3ccircle%20cx='20'%20cy='20'%20r='20'%20stroke='black'%20fill='white'%20/%3e%3c!--%20Smooth%20transition%20path%20with%20a%20semi-circle%20at%20the%20end%20--%3e%3cpath%20d='M%2020%200%20L%20110%2010%20A%2010%2010%200%200%201%20110%2030%20L%2020%2040%20'%20stroke='black'%20fill='white'%20/%3e%3ccircle%20cx='20'%20cy='20'%20r='10'%20stroke='black'%20fill='white'%20/%3e%3c!--%20Holes%20in%20the%20header%20(5%20small%20circles)%20--%3e%3ccircle%20cx='48'%20cy='20'%20r='3'%20stroke='black'%20fill='none'%20/%3e%3ccircle%20cx='63'%20cy='20'%20r='3'%20stroke='black'%20fill='none'%20/%3e%3ccircle%20cx='77'%20cy='20'%20r='3'%20stroke='black'%20fill='none'%20/%3e%3ccircle%20cx='93'%20cy='20'%20r='3'%20stroke='black'%20fill='none'%20/%3e%3ccircle%20cx='108'%20cy='20'%20r='3'%20stroke='black'%20fill='none'%20/%3e%3c/svg%3e",Oi={class:"rounded-lg relative w-full h-full"},Bi=["src"],Li=W({type:"servo",params:{mode2:B.OUT},__name:"Servo",props:{x:{},y:{},w:{},h:{},m_id:{},on:{},type:{},putOn8or9:{type:Boolean},dragging:{type:Boolean},connector:{},params:{},id:{},pin0:{},pin1:{},pin2:{},pin3:{},reset:{type:Function},i2c:{}},setup(n){const e=n,t=b(0),s=b(!1);let o=!1,l=0;const p=v=>{v.stopPropagation(),v.preventDefault(),o=!0,l=v.clientX,s.value=o,window.addEventListener("pointermove",i),window.addEventListener("pointerup",u)},u=()=>{o=!1,s.value=o,window.removeEventListener("pointermove",i),window.removeEventListener("pointerup",u)};let d=null,r=0;const i=v=>{if(o){const x=(v.clientX-l)/60;l=v.clientX,r=Math.min(0,Math.max(-.5,r+x/2)),d||(d=requestAnimationFrame(c))}},c=()=>{if(!d)return;let v=r-t.value;v>.5&&(v-=1),v<-.5&&(v+=1);const x=.1;Math.abs(v)>.001?(t.value+=v*x,t.value>1&&(t.value-=1),t.value<0&&(t.value+=1),d=requestAnimationFrame(c)):(t.value=r,cancelAnimationFrame(d),d=null)};return Q([()=>e.pin2.freq,()=>e.pin2.value],()=>{if(e.pin2.value>0){const v=1e3/e.pin2.freq;r=-(e.pin2.value*v-.5)/4,r=Math.min(0,Math.max(-.5,r)),d||(d=requestAnimationFrame(c))}}),(v,x)=>(O(),N("div",null,[y("div",Oi,[x[0]||(x[0]=y("div",{class:"absolute top-[20px] left-[26px] w-[28px] h-[60px] rounded bg-zinc-800"},null,-1)),x[1]||(x[1]=y("div",{class:"absolute top-[20px] left-[26px] w-[28px] h-[28px] rounded-full bg-zinc-700"},null,-1)),x[2]||(x[2]=y("div",{class:"absolute top-[41px] left-[34px] w-3 h-3 rounded-full bg-zinc-700"},null,-1)),x[3]||(x[3]=y("div",{class:"absolute top-[55px] left-[26px] w-[28px] h-[28px] text-white text-xs text-center"}," 180° ",-1)),y("button",{class:"absolute top-7 left-[34px] w-[60px]",onPointerdown:p},[y("img",{src:g(Di),style:z(`transform: rotate(${t.value}turn); transform-origin: 6px 6px`)},null,12,Bi)],32)])]))}}),Fi=Object.freeze(Object.defineProperty({__proto__:null,default:Li},Symbol.toStringTag,{value:"Module"})),Ni="/assets/switch-ChSLRb35.jpg",Ui={ref:"theref"},zi={class:"rounded-lg overflow-hidden relative"},ji=["src"],Gi={class:"absolute top-7 left-[55px]"},Vi=W({type:"switch",params:{mode2:B.IN},__name:"Switch",props:{x:{},y:{},w:{},h:{},m_id:{},on:{},type:{},putOn8or9:{type:Boolean},dragging:{type:Boolean},connector:{},params:{},id:{},pin0:{},pin1:{},pin2:{},pin3:{},reset:{type:Function},i2c:{}},setup(n){const{isOutside:e}=Le(Se("theref")),t=n,s=()=>{t.pin2.value=1-t.pin2.value},{shortcut:o,isSettingShortcut:l,startSettingShortcut:p}=yt(s,()=>{},t.params);return(u,d)=>(O(),N("div",Ui,[y("div",zi,[y("img",{src:g(Ni),alt:"Toggle Switch"},null,8,ji),y("button",{class:"absolute top-[20px] left-[32px] w-[16px] h-[40px]",onPointerdown:s},[y("div",{class:ve(["absolute w-[5px] h-[5px] bg-black cursor-pointer border-none",t.pin2.value?"bg-green-500":"bg-rose-500"]),style:z({top:(t.pin2.value?"14":"21")+"px",left:"5px"})},null,6)],32),y("div",Gi,ae(g(o)),1),!g(e)||g(l)?(O(),N("button",{key:0,onClick:d[0]||(d[0]=(...r)=>g(p)&&g(p)(...r)),onPointerdown:d[1]||(d[1]=ke(()=>{},["stop"])),class:"absolute w-full h-4 text-xs top-0 left-0 bg-black/[0.8] text-white rounded-lg"},ae(g(l)?"Press a key...":g(o)?"Set shortcut":"Add shortcut"),33)):ie("",!0)])],512))}}),Hi=Be(Vi,[["__scopeId","data-v-609316c8"]]),Wi=Object.freeze(Object.defineProperty({__proto__:null,default:Hi},Symbol.toStringTag,{value:"Module"})),Xi="/assets/touch_sensor-CfCsQfvI.jpg",Yi={ref:"theref"},Ki={class:"rounded-lg overflow-hidden relative"},Ji=["src"],Qi=W({type:"touch-sensor",params:{mode2:B.OUT},__name:"TouchSensor",props:{x:{},y:{},w:{},h:{},m_id:{},on:{},type:{},putOn8or9:{type:Boolean},dragging:{type:Boolean},connector:{},params:{},id:{},pin0:{},pin1:{},pin2:{},pin3:{},reset:{type:Function},i2c:{}},setup(n){const e=n,{isOutside:t}=Le(Se("theref")),s=()=>{e.pin2.value=1},o=()=>{e.pin2.value=0},{shortcut:l,isSettingShortcut:p,startSettingShortcut:u}=yt(s,o,e.params);return(d,r)=>(O(),N("div",Yi,[y("div",Ki,[y("img",{src:g(Xi),alt:"touch sensor"},null,8,Ji),y("button",{class:ve(["absolute top-[30px] left-[2px] w-[67px] h-[47px] rounded font-extrabold text-black",{"border-4 border-green-500":e.pin2.value,"bg-white":g(l)}]),onPointerdown:s,onPointerup:o,onPointerleave:o},ae(g(l)),35),!g(t)||g(p)?(O(),N("button",{key:0,onClick:r[0]||(r[0]=(...i)=>g(u)&&g(u)(...i)),onPointerdown:r[1]||(r[1]=ke(()=>{},["stop"])),class:"absolute w-full h-4 text-xs top-0 left-0 bg-black/[0.8] text-white rounded-lg"},ae(g(p)?"Press a key...":g(l)?"Set shortcut":"Add shortcut"),33)):ie("",!0)])],512))}}),Zi=Object.freeze(Object.defineProperty({__proto__:null,default:Qi},Symbol.toStringTag,{value:"Module"})),ea=Object.assign({"./modules/Buzzer.vue":Ys,"./modules/ClimateSensor.vue":Ao,"./modules/ColorSensor.vue":Yo,"./modules/DistanceSensor.vue":ar,"./modules/Encoder.vue":hr,"./modules/Gyro.vue":Rr,"./modules/LED.vue":Vr,"./modules/LedTower.vue":ei,"./modules/LightSensor.vue":ai,"./modules/Microphone.vue":fi,"./modules/Module.vue":mi,"./modules/MotionDetector.vue":bi,"./modules/Potentiometer.vue":Ii,"./modules/PushButton.vue":Ai,"./modules/Servo.vue":Fi,"./modules/Switch.vue":Wi,"./modules/TouchSensor.vue":Zi}),ta=Object.fromEntries(Object.values(ea).map(n=>[n.default.type,n.default])),na=["climate-sensor","gyro-accel","color-sensor","distance-sensor"];function Fn(n){return na.includes(n.type)}const Ft=()=>({shortcut:""});let sa=0;const oa=new Map,Nt=(n={})=>{const{mode0:e=B.OUT,mode1:t=B.OUT,mode2:s=B.NONE,mode3:o=B.NONE,address:l=0}=n,p=V(ct(0,e)),u=V(ct(1,t)),d=V(ct(2,s)),r=V(ct(3,o)),i=()=>{p.freq=0,p.value=0,u.freq=0,u.value=0,d.freq=0,d.value=0,r.freq=0,r.value=0},c=sa++,v={id:c,pin0:p,pin1:u,pin2:d,pin3:r,reset:i,i2c:js(l)};return oa.set(c,v),v},ne={x:0,y:0,w:0,h:0,is:Ln,on:-1,style:{},class:"",type:"",dragging:!1,putOn8or9:!1,connector:{},params:Ft(),...Nt()},Rt=new Map,nt={A:0,B:1,C:2,D:3,E:4,F:5,OUTER1:6};function Ae(n,e,t,s,o){const l={id:n,pin2:{id:e,value:0,freq:0,mode:B.IN,pull:be.NONE,arr:[]},pin3:{id:t,value:0,freq:0,mode:B.IN,pull:be.NONE,arr:[]},with:ne,x:s,y:o,w:80,h:80,style:{},class:""};return n=="OUTER1"&&(l.style={width:"30px",height:"215px"}),l}function Nn(n,e=!1){if(!Rt.has(n)){const a=b({showPinInfo:!1}),h={id:8,value:0,freq:0,mode:B.IN,pull:be.NONE,arr:[],x:320,y:368,w:25,h:8},m={id:9,value:0,freq:0,mode:B.IN,pull:be.NONE,arr:[],x:320,y:375,w:25,h:8},A=V({8:{x:h.x-10,y:h.y-48,class:"",style:{},visible:!1},9:{x:m.x-10,y:m.y+8,class:"",style:{},visible:!1}}),G=V([Ae("A",0,1,69,52),Ae("B",2,3,69,157),Ae("C",28,22,69,262),Ae("D",4,5,299,52),Ae("E",6,7,299,157),Ae("F",26,27,299,262),Ae("OUTER1",8,9,415,222)]),K=V({x:0,y:0,w:0,h:0,id:-1,value:0,freq:0,mode:B.NONE,pull:be.NONE,arr:[],with:ne}),fe=V({start:{x:0,y:0,connected:K,at:ne,yOffset:0},end:{x:0,y:0,w:0,h:0,connected:K,at:K,yOffset:0},style:{}});Rt.set(n,{settings:a,slots:G,usb:{x:206,y:48,w:40,h:20},onLED:{x:242,y:40,w:8,h:8},pin8:V({x:320,y:368,w:25,h:8,id:8,value:0,freq:0,mode:B.IN,pull:be.NONE,arr:[],with:ne}),pin9:V({x:320,y:375,w:25,h:8,id:9,value:0,freq:0,mode:B.IN,pull:be.NONE,arr:[],with:ne}),helpArrows:A,modules:V([]),toDelete:b(!1),fromSlotIndex:b(null),maxAreaIndex:b(null),dragged:V({}),pinNone:K,NoneConnector:fe,neededModules:V([]),modulesWerePut:b(!0)})}const t=Rt.get(n),s=a=>{t.settings.value={...t.settings.value,...a}};ne.connector=t.NoneConnector;const o=V([f("LED"),f("push-button"),f("potentiometer"),f("encoder"),f("buzzer"),f("switch"),f("light-sensor"),f("motion-detector"),f("touch-sensor"),f("climate-sensor"),f("color-sensor"),f("distance-sensor"),f("servo"),f("gyro-accel"),f("microphone"),f("led-tower")]),l={8:t.pin8,9:t.pin9,"":t.pinNone},p={8:t.pin8,9:t.pin9},u={0:0,1:0,2:1,3:1,28:2,22:2,4:3,5:3,6:4,7:4,26:5,27:5},d=()=>{const a=t.slots.map(h=>h.with.type);return a.pop(),t.pin8&&a.push(t.pin8.with.type),t.pin9&&a.push(t.pin9.with.type),a.every(h=>h==="")?[]:a};function r(a,h){const m=V(f(a));a!=""&&t.modules.push(m),R(h),ot(()=>{C(h,m)})}function i(a){const h=t.modules.indexOf(a);h>-1&&t.modules.splice(h,1)}function c(a){i(a.with),a.with=ne}function v(a,h){if(a!=="")if(h==="8"||h==="9"){const m=V(f(a));t.modules.push(m),a==="led-tower"?(R(6),C(6,m)):(m.style.zIndex="10",m.x=240,m.y=355),m.dragging=!0,ot(()=>{m.dragging=!1,m.style.zIndex="10",h==="8"?it(m,t.pin8):it(m,t.pin9),m.connector.style.zIndex="10"})}else{const m=nt[h];r(a,m)}}function x(a){const h=Math.min(a.length,6);for(let m=0;m<h;m++)r(a[m],m);for(let m=h;m<a.length;m++)v(a[m],String(m+2))}function T(){for(let a=0;a<t.slots.length;a++)R(a);t.modules.length=0}function S(a){const h=nt[a];R(h)}function f(a){const h=ta[a];let m=Nt(h.params);return typeof h.extend=="function"&&(m=h.extend(m)),{m_id:n,x:0,y:0,w:80,h:80,is:h,on:-1,class:"",style:{},type:a,dragging:!1,connector:t.NoneConnector,putOn8or9:a=="servo"||a==="led-tower",params:Ft(),...m}}function E(a){const h=a.is;let m=Nt(h.params);return typeof h.extend=="function"&&(m=h.extend(m)),{m_id:n,x:0,y:0,w:80,h:80,is:a.is,on:-1,class:"",style:{},type:a.type,dragging:!1,connector:t.NoneConnector,putOn8or9:a.type=="servo"||a.type=="led-tower",params:Ft(),...m}}function C(a,h){const m=t.slots[a];h.x=m.x,h.y=m.y,h.params.shortcut=m.id,m.with=h,h.on=a,h.pin2.mode===B.OUT&&(m.pin2.mode===B.OUT&&(h.pin2.value=m.pin2.value,h.pin2.freq=m.pin2.freq),m.pin2.mode===B.IN&&(h.pin2.freq=0,h.pin2.value=0)),h.pin3.mode===B.OUT&&(m.pin3.mode===B.OUT&&(h.pin3.value=m.pin3.value,h.pin3.freq=m.pin3.freq),m.pin3.mode===B.IN&&(h.pin3.freq=0,h.pin3.value=0))}function R(a){a==6&&(t.pin8.with.type==="led-tower"?t.pin8.with=ne:t.pin9.with.type==="led-tower"&&(t.pin9.with=ne));const h=t.slots[a];i(h.with),h.with=ne}function _(){return t.slots}function q(a){const h=nt[a];return t.slots[h]}function D(a){if(a=="8")return l[a].with;if(a=="9")return l[a].with;const h=nt[a];return t.slots[h].with}function I(a){return t.slots[u[a]]}function P(a){return l[a]}function k(a,h){const m=t.slots[u[a]];return m!==t.slots[u[h]]?nn:Fn(m.with)?m.with.i2c:nn}function M(a){const h=t.slots[u[a]];if(h){let m={id:0,value:0,freq:0,mode:B.NONE,pull:be.NONE,arr:[]};return a===h.pin2.id&&(m=h.pin2,m.value=Bt(h.pin2.mode)?h.pin2.value:h.with.pin2.value,h.with.type===""&&(m.value=Zt(h.pin2.pull))),a===h.pin3.id&&(m=h.pin3,m.value=Bt(h.pin3.mode)?h.pin3.value:h.with.pin3.value,h.with.type===""&&(m.value=Zt(h.pin3.pull))),m.mode===B.NONE,m}return{id:0,value:0,freq:0,mode:B.NONE,pull:be.NONE,arr:[]}}function $(a,h){const m=t.slots[u[a]];if(m){const A=a===m.pin2.id?m.with.pin2:m.with.pin3,{value:G=A.value,freq:K=A.freq}=h;A.value=G,A.freq=K}}function w(a,h){const m=t.slots[u[a]];let A=en,G=en;if(m)[A,G]=a===m.pin2.id?[m.pin2,m.with.pin2]:[m.pin3,m.with.pin3];else if(a===8||a===9){const ue=p[a];A=ue,G=ue.with.pin2}const{value:K=A.value,freq:fe=A.freq,mode:X=A.mode,pull:me=A.pull,arr:se=A.arr}=h,te=A.mode===B.OUT?K:A.value;A.value=te,A.freq=fe,A.mode=X,A.pull=me,A.arr=se,G.mode===B.OUT&&(G.value=A.value,G.freq=A.freq,G.arr=se)}function j(a,h){const m=t.slots[a].with,A=t.slots[h].with;C(h,m),C(a,A)}function L(a,h,m,A){const G={x:A.x,y:A.y};let K={x:A.x+A.w-a.w,y:1/0};return e&&(K={x:1/0,y:A.y+A.h-a.h}),X=>{if(!a)return;a.x=X.clientX-h,a.y=X.clientY-m,Ke(a,G,K);const me=document.getElementById(`module-list-${n}`),se={x:0,y:0,w:0,h:0};if(me){const{top:de,left:ze}=me.getBoundingClientRect();se.x=ze,se.y=de}if(et(se,n),e?t.toDelete.value=a.x+a.w*(3/4)>se.x:t.toDelete.value=a.y+a.h*(3/4)>se.y,Zn(a.connector)!==t.NoneConnector&&(a.connector.start.x=a.x+a.w/2,a.connector.start.y=a.y+a.h/2),a.putOn8or9&&a.type!="led-tower")return;const te=[0,0,0,0,0,0];for(const[de,ze]of t.slots.entries())te[de]=Js(a,{x:ze.x+A.x,y:ze.y+A.y,w:ze.w,h:ze.h});let ue=0;for(let de=1;de<te.length;de++)te[de]>te[ue]&&(ue=de);te[ue]==0?t.maxAreaIndex.value=null:t.maxAreaIndex.value=ue,a.type=="led-tower"&&t.maxAreaIndex.value!=6&&(t.maxAreaIndex.value=null),a.type!="led-tower"&&t.maxAreaIndex.value==6&&(t.maxAreaIndex.value=null)}}function le(a,h,m,A){a.dragging=!0,a.style.zIndex="10";const G=t.slots[m];t.fromSlotIndex.value=m;const K=a.x,fe=a.y,X=Je(`pibody-${n}`);et(X,n),Pt(a,X),a.putOn8or9&&(Pt(a.connector.start,X),Pt(a.connector.end,X));const me=A.clientX-a.x,se=A.clientY-a.y,te=L(a,me,se,X),ue=()=>{t.toDelete.value?(G&&(G.with=ne),t.pin8.with===a&&(t.pin8.with=ne),t.pin9.with===a&&(t.pin9.with=ne),t.modules.splice(h,1)):a.putOn8or9&&m==-1?st(a,X):t.maxAreaIndex.value===null?(a.x=K,a.y=fe,a.style.zIndex="1"):(j(m,t.maxAreaIndex.value),a.style.zIndex="1"),a.putOn8or9&&(st(a.connector.start,X),st(a.connector.end,X),a.connector.start.x=a.x+a.w/2,a.connector.start.y=a.y+a.h/2,a.style.zIndex="10",a.connector.style.zIndex="10"),document.removeEventListener("pointermove",te),document.removeEventListener("pointerup",ue),t.toDelete.value=!1,t.fromSlotIndex.value=null,t.maxAreaIndex.value=null,a.dragging=!1};document.addEventListener("pointermove",te),document.addEventListener("pointerup",ue)}const Z=b(!1),ce=b(t.pin8),Pe=V({8:{x:t.pin8.x-10,y:t.pin8.y-48,class:"",style:{},visible:!1},9:{x:t.pin9.x-10,y:t.pin9.y+8,class:"",style:{},visible:!1}});function Qe(a,h){const m=mt(h);h===t.pin8?a.end.yOffset=30:h===t.pin9&&(a.end.yOffset=-30),h.with=a.start.at,a.end.x=m.x,a.end.y=m.y,a.end.at=h}function Ze(a,h){h.stopPropagation(),a.end.at.with=ne,Z.value=!0;const m=h.clientX-a.end.x,A=h.clientY-a.end.y,G=Je(`pibody-${n}`),K=X=>{a.end.x=X.clientX-m,a.end.y=X.clientY-A;const me={x:a.end.w/2,y:a.end.yOffset},se={x:G.w-a.end.w/2,y:G.h+a.end.yOffset-a.end.h};Ke(a.end,me,se);const te=sn(a.end,mt(t.pin8)),ue=sn(a.end,mt(t.pin9)),de=80;te<ue?(a.end.yOffset=30,te<de*de?ce.value=t.pin8:ce.value=t.pinNone):(a.end.yOffset=-30,ue<de*de?ce.value=t.pin9:ce.value=t.pinNone)},fe=()=>{Z.value=!1,ce.value===t.pinNone?i(a.start.at):ce.value.with&&c(ce.value),Qe(a,ce.value),document.removeEventListener("pointermove",K),document.removeEventListener("pointerup",fe)};document.addEventListener("pointermove",K),document.addEventListener("pointerup",fe)}function it(a,h){c(h);const G={start:{connected:a.pin2,at:a,x:a.x+a.w/2,y:a.y+a.h/2,yOffset:0},end:{connected:h,at:h,x:0,y:0,w:25,h:7,yOffset:0},style:{}};h.with=a,Qe(G,h),a.connector=G}function Ne(a,h){const m={connected:a.pin2,at:a,x:a.x+a.w/2,y:a.y+a.h/2,yOffset:0},A={connected:t.pinNone,at:t.pinNone,x:h.clientX,y:h.clientY,w:25,h:8,yOffset:0};et(A,n);const G={start:m,end:A,style:{}};a.connector=G,Ze(a.connector,h)}function Ue(a,h){const m=V(E(a));m.dragging=!0,t.toDelete.value=!0,m.style.zIndex="10",m.style["touch-action"]="none";const A=Je(`pibody-${n}`);if(h.currentTarget instanceof HTMLElement){const me=h.currentTarget,{top:se,left:te}=me.getBoundingClientRect();m.x=te,m.y=se}et(m,n),et(A,n),m.is=a.is,m.type=a.type,t.modules.push(m);const G=h.clientX-m.x,K=h.clientY-m.y,fe=L(m,G,K,A),X=me=>{m&&(t.toDelete.value||m.type!="servo"&&t.maxAreaIndex.value===null?i(m):(t.maxAreaIndex.value!==null&&(R(t.maxAreaIndex.value),C(t.maxAreaIndex.value,m),m.style.zIndex="1"),m.putOn8or9&&ot(()=>{st(m,A),Ne(m,me),m.style.zIndex="10",m.connector.style.zIndex="10"})),t.maxAreaIndex.value=null,t.toDelete.value=!1,m.dragging=!1,document.removeEventListener("pointermove",fe),document.removeEventListener("pointerup",X))};document.addEventListener("pointermove",fe),document.addEventListener("pointerup",X)}function xt(){for(const a of t.slots)a.with.reset()}const bt=b(["LED","push-button","potentiometer","encoder","buzzer","switch","light-sensor","motion-detector","touch-sensor","climate-sensor","color-sensor","distance-sensor","servo","gyro-accel","microphone","led-tower"]);function Wn(a){let h=[];if(a.length==0)h=bt.value;else for(const m of a)m.module&&(h.includes(m.module)||h.push(m.module),m.autoPut&&m.slot&&v(m.module,m.slot));for(const m of h){const A=V(f(m));t.neededModules.push(A)}}function Xn(){for(let a=0;a<=5;a++)t.slots[a].class="",t.slots[a].style={};for(const a of t.neededModules)a.class="",a.style={};for(const a in Pe){const h=Pe[a];h.visible=!1,h.style={},h.class=""}}function Yn(a,h){if(a==="8"||a==="9")Pe[a].style={color:"rgba(0, 157, 255)"},Pe[a].visible=!0;else{const m=(a??"A").charCodeAt(0)-65;t.slots[m].style={backgroundColor:"rgba(0, 157, 255, 0.26)",boxShadow:"0 0 15px rgb(0, 157, 255)"}}t.neededModules.forEach(m=>{if(m.type==h){m.style={animation:"breathing 1s ease-out infinite normal",boxShadow:"0 0 15px rgb(0, 157, 255)",borderRadius:"10px"};return}})}return{settings:t.settings,setSettings:s,usb:t.usb,onLED:t.onLED,pin8:t.pin8,pin9:t.pin9,NoneModule:ne,maxAreaIndex:t.maxAreaIndex,fromSlotIndex:t.fromSlotIndex,toDelete:t.toDelete,pinToIndex:u,slotTypeToSlotIndex:nt,getSlot:q,getSlotPinWith:D,getSlotByPinId:I,getSlots:_,getPin:M,setPin:w,setPinWith:$,getI2C:k,slots:t.slots,slotHasList:d,moduleComponents:o,modules:t.modules,addModuleToSlot:C,newModuleToSlot:v,newModuleToSlotIndex:r,clearSlot:S,clearSlots:T,putModuleList:x,removeModuleFromSlot:R,dragged:t.dragged,startDragFromSlot:le,startDragFromModuleList:Ue,isConnect8or9:Z,chosenPin8or9:ce,moveConnectorEnd:Ze,getServoPin:P,pinNone:t.pinNone,helpArrows:t.helpArrows,addNeededModules:Wn,neededModules:t.neededModules,modulesWerePut:t.modulesWerePut,clearSlotsModulesClasses:Xn,lightUp:Yn,reset:xt}}const Mt=new Map;function Un(n){if(!Mt.has(n)){const o=b(""),l=b(0),p=b(0),u=b("#000000");Mt.set(n,{text:o,x:l,y:p,textColor:u})}const e=Mt.get(n);function t(o,l,p,u){e.text.value+=o+`\r
`,e.x.value=l,e.y.value=p,u&&(e.textColor.value=u)}function s(){e.text.value="",e.x.value=0,e.y.value=0,e.textColor.value="#000000"}return{text:e.text,x:e.x,y:e.y,textColor:e.textColor,writeText:t,clearDisplay:s}}const At=new Map;function ra(n){const e=b(0);let t=null;const s=b(""),o=65e3,l=new Uint8Array(o);let p=0,u=null;const d=new TextEncoder;let r=[],i="";const c=[],v=[],x=q=>{q=i+q,i="";const D=Array.from(q);let I=0;for(;I<D.length;){const P=D[I];if(P==="\b"){if(r.length>0){const k=r.pop();p=Math.max(0,p-k)}I++}else if(P==="\x1B")if(I+2<D.length)if(D[I+1]==="["&&D[I+2]==="K"){const k=r.slice(0,e.value).reduce((M,$)=>M+$,0);l.fill(0,k,p),p=k,r.splice(e.value),T(),I+=3}else I++;else{i=D.slice(I).join("");break}else{const k=d.encode(P);for(const M of k)p<o?l[p++]=M:(l.copyWithin(0,1),l[p-1]=M);r.push(k.length),e.value=r.length,I++}}T()},T=()=>{u||(u=setTimeout(()=>{S(),u=null},16))},S=()=>{const q=new TextDecoder().decode(l.subarray(0,p));s.value=q,e.value=r.length,E()},f=()=>{s.value="",p=0,e.value=0,r=[],u&&(clearTimeout(u),u=null)},E=()=>{t&&(t.scrollTop=t.scrollHeight)},C=q=>{t=q},R=q=>{s.value=q};function _(){return c.length>0?Promise.resolve(c.shift()):new Promise(q=>{v.push(q)})}return{id:n,output:s,setStdout:R,caret:e,write:x,clear:f,openTerminal:C,readChar:_,inputQueue:c,resolvers:v}}function wt(n){return At.has(n)||At.set(n,ra(n)),At.get(n)}function ia(n,e,t,s,o,l,p){const u=b(!1),d=b(!1),r=b(!1),i=b(!1),c=b(""),v=b(!1),x=ga(),T=va();let S,f,E;_();function C(){return new Promise($=>{d.value&&$(),_();const w=Q(u,j=>{j||(w.stop(),$())})})}function R(){return new Promise($=>{if(!u.value){$();return}const w=Q(u,j=>{j||(w(),$())})})}async function _(){d.value||(u.value=!0,s(),S=new Worker(new URL("/assets/worker-CGF4IHq1.js",import.meta.url),{type:"module"}),S.onmessage=async $=>{const{content:w,line:j}=$.data;switch(w.command){case U.Error:e(w.request.message),i.value=!0,c.value=w.request.message,r.value=!1,v.value=!1;break;case U.KeyboardInterrupt:e(w.request.message),r.value=!1,v.value=!1;break;case $e.Initialized:f=w.request.sharedArrayInterrupt,E=w.request.sharedWakeupArray,u.value=!1;break;case $e.Finished:r.value=!1,T.stop(),x.stop();break;case U.Output:e(w.request.output);break;case U.PinSetValue:o(w.request.pin,w.request);break;case U.PinSetMode:o(w.request.pin,w.request);break;case U.PinSetPull:o(w.request.pin,w.request);break;case U.PwmFreq:o(w.request.pin,{freq:w.request.freq});break;case U.PwmDutyU16:o(w.request.pin,{value:w.request.duty_u16/Dn});break;case U.DisplayText:{const{text:L,x:le,y:Z}=w.request;t(L,le,Z)}break;case U.DisplayClear:s();break;case U.I2CWriteToMem:{const L=p(w.request.sda,w.request.scl);L.address===w.request.addr&&L.write(w.request.memaddr,w.request.buf)}break;case U.NeoPixelWrite:o(w.request.pin,{arr:w.request.pixels});break;case U.RawOutput:e(w.request.output);break}if(T.state.value==ge.Continue)Ds(w)&&T.storeInputToResult(w)!=ge.Continue&&(T.state.value=ge.Finish,x.state.value=ge.Finish);else switch(w.command){case F.Input:{const L=await n.readChar();Atomics.store(w.result,0,L)}break;case F.PinGetValue:l(w.request.pin).value>.4?Atomics.store(w.result,0,1):Atomics.store(w.result,0,0);break;case F.PinGetMode:{const L=l(w.request.pin);Atomics.store(w.result,0,L.mode)}break;case F.PinGetPull:{const L=l(w.request.pin);Atomics.store(w.result,0,L.pull)}break;case F.AdcReadU16:{const L=l(w.request.pin);Atomics.store(w.result,0,L.value*65535)}break;case F.I2CReadFromMem:{const{request:L,result:le}=w,Z=p(L.sda,L.scl);Z.address===L.addr?Z.read(le,L.memaddr,L.nbytes):Atomics.store(le,L.nbytes,1)}break;case F.I2CScan:{const{request:L,result:le}=w,Z=p(L.sda,L.scl);Atomics.store(le,0,Z.address)}break}Os(w)||x.pushResult(w,j)===ge.Finish&&(T.state.value=ge.Finish,x.state.value=ge.Finish),E&&(Atomics.store(E,0,1),Atomics.notify(E,0,1))},d.value=!0)}function q(){for(let $=0;$<29;$++)o($,{value:0,freq:0,mode:B.IN});s()}async function D($){await R(),d.value||await C(),r.value=!0,i.value=!1,c.value="",f&&(f[0]=0,f[1]=0),S.postMessage({command:"runPython",code:$,isReplay:T.state.value==ge.Continue})}function I(){r.value&&(v.value=!0,f[0]=Qt,f[1]=Qt,n.resolvers.length&&n.resolvers.shift()(0))}function P(){return new Promise($=>{if(r.value){I();const w=Q(r,j=>{j||(w.stop(),$())})}else $()})}function k(){S.terminate(),r.value=!1,u.value=!1,d.value=!1,i.value=!1,c.value="",S.onmessage=null}function M(){d.value&&k(),_()}return{connect:_,loadingPromise:R,connectPromise:C,reconnect:M,disconnect:k,stop:I,stopPromise:P,run:D,reset:q,isLoading:u,isConnected:d,isRunning:r,isRunError:i,isStopping:v,recorder:x,replayer:T,runError:c}}class aa{constructor(){Y(this,"activeEmulators",new Map)}register(e,t){this.activeEmulators.set(e,t)}unregister(e){this.activeEmulators.delete(e)}async stopOthers(e){for(const[t,s]of this.activeEmulators)t!==e&&s.instance.isRunning.value&&await s.instance.stopPromise()}async stopAll(){for(const e of this.activeEmulators.values())e.instance.isRunning.value&&await e.instance.stopPromise()}getActiveCount(){return Array.from(this.activeEmulators.values()).filter(e=>e.instance.isRunning.value).length}getInstance(e){var t;return(t=this.activeEmulators.get(e))==null?void 0:t.instance}}const rt=new aa;function zn(n){return JSON.stringify({command:n.command,request:n.request})}function xl(n){return JSON.parse(n)}function la(n){const e=[];for(const{content:t}of n)Bs(t)&&e.push(t);return e}const En=b(!1);function ca(n){const e=la(n),t=new Map;for(const s of e){const o=zn(s),l=t.get(o);l===void 0?t.set(o,[s.result]):l.push(s.result)}return t}function ua(n,e){const t=[];let s=!0;for(let o=0;o<n.length&&o<e.length;o++){const l=da(n[o].content,e[o].content);t.push({correct:l,expected:n[o],replayed:e[o]}),s&&(s=l)}for(let o=e.length;o<n.length;o++)s=!1,t.push({correct:!1,expected:n[o],replayed:null});for(let o=n.length;o<e.length;o++)s=!1,t.push({correct:!1,expected:null,replayed:e[o]});return{feedback:t,success:s}}function da(n,e){if(n.command!==e.command)return!1;const t=Ls[n.command];return t(n,e)}const Ut=[F.PinGetValue,F.PinGetPull,F.PinGetMode,F.AdcReadU16,F.I2CScan,F.I2CReadFromMem,F.Input,U.I2CWriteToMem,U.PinSetValue,U.PwmDutyU16,U.PwmFreq,U.Output,U.Sleep,U.DisplayText,U.DisplayClear],pa=n=>n.map((e,t)=>({...e,index:t}));async function jn(n,e,t,s){En.value=!0;const o=await ma(n,e,t.data,s),l=t.data,p=r=>pa(r).filter(i=>s?s.includes(i.content.command):!0),{feedback:u,success:d}=ua(p(l),p(o));return t.result={code:e,success:d,expected:l,replayed:o,feedback:u,message:""},await n.stopPromise(),En.value=!1,t.result}function bl(n){return n!==void 0?n?"border-green-500":"border-red-500":"border-blue-500"}async function _l(n,e,t,s=Ut){for(const o of t)await jn(n,e,o,s)}async function fa(n){const e=[];for(const t of n){const s=await fetch(t.url).then(o=>o.json());e.push({data:s,test:t})}return e}async function Sl(n,e,t,s=Ut){const o=[];let l=!0;const p=await fa(t);if(!p.length)return{correct:!0,results:[]};s.length==0&&(s=Ut);const u=rt.getInstance(n);if(!u)return{correct:!1,results:[]};await rt.stopAll();for(const d of p){const r=await jn(u,e,d,s);if(o.push(r),l=r.success,!l)break}return{correct:l,results:o}}function ma(n,e,t,s){return new Promise(o=>{n.reset(),n.recorder.start(s,t.length);const l=ca(t);n.replayer.start(l);const p=Q(n.replayer.state,()=>{if(n.replayer.state.value==ge.Finish){n.recorder.stop();const u=n.recorder.getRecords();n.stopPromise(),o(u)}else if(n.replayer.state.value==ge.Timeout){n.recorder.stop();const u=n.recorder.getRecords();u.push({content:{command:$e.Timeout,request:{}},line:-1}),o(u)}p.stop()});n.run(e).then(()=>{n.replayer.restartTimeout()})})}const Tn=n=>n?"oklch(0.723 0.219 149.579)":"oklch(0.637 0.237 25.331)";function kl(n,e){const t=wt(n),s=Un(n),o=Nn(n),l=gt(n),p=b();function u(){for(let i=0;i<6;i++)o.slots[i].class="",o.slots[i].style={};for(const i of o.moduleComponents)i.class="",i.style={}}async function d(i){for(const[c,v]of e.feedback.entries())if(!v.correct){r(c),i[c].scrollIntoView({behavior:"smooth",block:"nearest",inline:"center"});break}}async function r(i){o.reset(),l.code.value=e.code,t.clear(),u(),l.highlights.value=[],p.value=i,await ot();let c=i;const v=e.feedback[c].replayed;if(v===null?c=e.replayed.length-1:c=v.index,v===null||e.replayed[c].line<0)return;for(let S=0;S<=c;S++)if(v!==null){const f=e.replayed[S].content;switch(f.command){case U.Error:t.write(f.request.message);break;case $e.Initialized:break;case $e.Finished:break;case U.Output:t.write(f.request.output);break;case U.PinSetValue:o.setPin(f.request.pin,f.request);break;case U.PinSetMode:o.setPin(f.request.pin,f.request);break;case U.PinSetPull:o.setPin(f.request.pin,f.request);break;case U.PwmFreq:o.setPin(f.request.pin,{freq:f.request.freq});break;case U.PwmDutyU16:o.setPin(f.request.pin,{value:f.request.duty_u16/65535});break;case U.DisplayText:{const{text:E,x:C,y:R}=f.request;s.writeText(E,C,R)}break;case U.DisplayClear:s.clearDisplay();break;case U.I2CWriteToMem:{const E=o.slots[o.pinToIndex[f.request.sda]];if(Fn(E.with)){const C=E.with.i2c;C.address===f.request.addr&&C.write(f.request.memaddr,f.request.buf)}}break;case U.NeoPixelWrite:o.setPin(f.request.pin,{arr:f.request.pixels});break;case F.PinGetValue:o.setPinWith(f.request.pin,{value:f.result});break;case F.PinGetMode:o.setPinWith(f.request.pin,{mode:f.result});break;case F.PinGetPull:o.setPinWith(f.request.pin,{pull:f.result});break;case F.AdcReadU16:o.setPinWith(f.request.pin,{value:f.result/Dn});break}}const x=e.replayed[c].content,T=e.replayed[c].line;if(l.highlights.value=[{line:T,color:Tn(e.feedback[i].correct)}],x!=null&&Fs(x)){const S=o.getSlotByPinId(x.request.pin);S.style={outlineStyle:"solid",outlineColor:Tn(e.feedback[i].correct),outlineWidth:"4px"}}}return{selectNode:r,selectedIndex:p,firstError:d}}var ge=(n=>(n[n.None=0]="None",n[n.Continue=1]="Continue",n[n.Finish=2]="Finish",n[n.Timeout=3]="Timeout",n[n.Error=4]="Error",n))(ge||{});function va(){let n=new Map,e=new Map;const t=b(0);let s=0,o=null;function l(){o&&clearTimeout(o),o=setTimeout(()=>{t.value=3},s)}return{storeInputToResult:r=>{l();const i=zn(r);let c=e.get(i);c||(c=0);const v=n.get(i);if(!v||v.length===0||c>=v.length)return 2;const x=v[c];switch(r.command){case F.AdcReadU16:Atomics.store(r.result,0,x);break;case F.PinGetMode:Atomics.store(r.result,0,x);break;case F.PinGetPull:Atomics.store(r.result,0,x);break;case F.PinGetValue:Atomics.store(r.result,0,x);break;case F.I2CScan:for(let f=0;f<v.length;f++)Atomics.store(r.result,f,x);break;case F.I2CReadFromMem:for(let f=0;f<v.length;f++)Atomics.store(r.result,f,x);break;case F.Input:new TextEncoder().encode(x).forEach((f,E)=>Atomics.store(r.result,E,f));break}return e.set(i,c+1),1},restartTimeout:l,start:(r,i=200)=>{n=r,e=new Map,t.value=1,s=i},stop:()=>{t.value=2},state:t}}let dt=!1,Dt=!1,De="";function Pn(n,e){const t=n.command===e.command,s=JSON.stringify(n.request)===JSON.stringify(e.request),o="result"in n,l="result"in e,p=o&&l?JSON.stringify(n.result)===JSON.stringify(e.result):!o&&!l;return t&&s&&p}function ha(n){var t;if(n.length<2)return n;const e=n.length;for(let s=e-2;s>=0;s--)if(Pn(n[s].content,n[e-1].content)){const o=e-1-s;let l=!0;for(let p=0;p<o;p++)if(!Pn((t=n[s-p])==null?void 0:t.content,n[e-1-p].content)){l=!1;break}if(l)return n.slice(0,s+1)}return n}function ga(){let n=[];const e=b(0);let t,s,o=0;return{pushResult:(r,i)=>{if(e.value==1){let c=0,v;switch(r.command){case F.AdcReadU16:c=r.result[0],v={command:r.command,request:r.request,result:c};break;case F.I2CReadFromMem:c=Array.from(r.result),v={command:r.command,request:r.request,result:c};break;case F.PinGetMode:c=r.result[0],v={command:r.command,request:r.request,result:c};break;case F.PinGetPull:c=r.result[0],v={command:r.command,request:r.request,result:c};break;case F.PinGetValue:c=r.result[0],v={command:r.command,request:r.request,result:c};break;case F.I2CScan:c=Array.from(r.result),v={command:r.command,request:r.request,result:c};break;case F.Input:if(r.result.length>4){const x=new Uint8Array(r.result.length);let T=0;for(let E=0;E<r.result.length;E++){const C=Atomics.load(r.result,E);if(C==0)break;x[E]=C,T++}const f=new TextDecoder().decode(x.subarray(0,T));v={command:F.Input,request:r.request,result:f};break}if(dt=!0,c=r.result[0],dt){if(c===8){De.length>0&&(De=De.substring(0,De.length-1));break}De+=String.fromCharCode(c),c===10&&(v={command:F.Input,request:r.request,result:De},De="",dt=!1,Dt=!0)}break;default:v=r;break}return dt?1:Dt&&r.command!=F.Input?(Dt=!1,1):(n.push({content:v,line:i}),n.length>3&&(n=ha(n)),(!s||s.includes(r.command))&&o++,t&&o>=t?2:1)}return 2},getRecords:()=>n,start:(r,i)=>{t=i,s=r,o=0,n=[],e.value=1},stop:()=>{e.value=2},state:e}}function Ot(n){return new Promise(e=>setTimeout(e,n))}class ya{constructor(){Y(this,"_lock",Promise.resolve());this._lock=Promise.resolve()}acquire(){let e;const t=new Promise(o=>e=o),s=this._lock.then(()=>e);return this._lock=this._lock.then(()=>t),s}}class Xt{constructor(){Y(this,"mutex");Y(this,"inTransaction");Y(this,"receivedData");Y(this,"activityCallback");Y(this,"receiveCallback");Y(this,"disconnectCallback");Y(this,"writeChunk");Y(this,"emit");Y(this,"info");Y(this,"prevRecvCbk");if(new.target===Xt)throw new Error("Cannot instantiate abstract class Transport");this.mutex=new ya,this.inTransaction=!1,this.receivedData="",this.activityCallback=()=>{},this.receiveCallback=()=>{},this.disconnectCallback=()=>{},this.prevRecvCbk=e=>{},this.writeChunk=128,this.emit=!1,this.info={}}async getInfo(){return this.info}async write(e){const s=new TextEncoder().encode(e);try{if(s.byteLength==0)await this.writeBytes(s),this.activityCallback();else{let o=0;for(;o<s.byteLength;){const l=s.slice(o,o+this.writeChunk);await this.writeBytes(l),this.activityCallback(),o+=this.writeChunk}}}catch(o){throw o}}onActivity(e){this.activityCallback=e}onReceive(e){this.receiveCallback=e}onDisconnect(e){this.disconnectCallback=e}async startTransaction(){await Ot(10);const e=await this.mutex.acquire();return this.prevRecvCbk=this.receiveCallback,this.inTransaction=!0,this.receivedData="",this.receiveCallback=t=>{this.receivedData+=t,this.emit&&this.prevRecvCbk&&this.prevRecvCbk(t)},()=>{this.prevRecvCbk&&(this.receiveCallback=this.prevRecvCbk,this.receiveCallback(this.receivedData)),this.receivedData="",this.inTransaction=!1,e()}}async readExactly(e,t=5e3){if(!this.inTransaction)throw new Error("Not in transaction");let s=Date.now()+t;for(;t<=0||Date.now()<s;){if(this.receivedData.length>=e){const l=this.receivedData.substring(0,e);return this.receivedData=this.receivedData.substring(e),l}const o=this.receivedData.length;await Ot(10),this.receivedData.length>o&&(s=Date.now()+t)}throw new Error("Timeout")}async readUntil(e,t=5e3){if(!this.inTransaction)throw new Error("Not in transaction");const s=Date.now();let o=0;for(;t<=0||o<t;){const l=this.receivedData.indexOf(e)+e.length;if(l>=e.length){const p=this.receivedData.substring(0,l);return this.receivedData=this.receivedData.substring(l),p}await Ot(10),o=Date.now()-s}throw new Error("Timeout reached before finding the ending sequence")}}class wa extends Xt{constructor(){super();Y(this,"port");Y(this,"reader");Y(this,"writer");Y(this,"serial");if(this.port=void 0,this.reader=null,this.writer=null,"serial"in navigator)this.serial=navigator.serial;else throw new Error("WebSerial not available")}async requestAccess(){var l,p,u,d;const o={filters:[{usbVendorId:11914,usbProductId:5}]};this.port=await((l=this.serial)==null?void 0:l.requestPort(o));try{const r=(p=this.port)==null?void 0:p.getInfo();this.info={vid:(u=r==null?void 0:r.usbVendorId)==null?void 0:u.toString(16).padStart(4,"0"),pid:(d=r==null?void 0:r.usbProductId)==null?void 0:d.toString(16).padStart(4,"0")}}catch(r){throw r}}async connect(){var t,s;if(!this.port)throw new Error("Port is not available");await this.port.open({baudRate:115200}),this.reader=((t=this.port.readable)==null?void 0:t.getReader())||null,this.writer=((s=this.port.writable)==null?void 0:s.getWriter())||null,this.reader&&this.listen()}async disconnect(){if(!this.reader||!this.port)throw new Error("No active connection to disconnect from");try{await this.reader.cancel()}catch{}await this.port.forget()}async writeBytes(t){if(!this.writer)throw new Error("Writer is not initialized");await this.writer.write(t)}async listen(){if(!this.reader)throw new Error("Reader is not initialized");const t=new TextDecoder;await this.write(""),await this.write("");try{for(;;){const{value:s,done:o}=await this.reader.read();if(o||!s)break;this.receiveCallback(t.decode(s))}}catch(s){throw console.log("disconnect callback"),this.disconnectCallback(),s}}async flushInput(){if(!this.reader)throw new Error("Reader is not initialized");this.receivedData=""}}class Fe{constructor(e){Y(this,"port");Y(this,"end");this.port=e,this.end=async()=>{}}static async begin(e,t=!1){var o;const s=new Fe(e);await s.enterRawRepl(t);try{await s.exec("import sys,os")}catch(l){throw await((o=s.end)==null?void 0:o.call(s)),l}return s}async interruptProgram(){await this.port.write("")}async enterRawRepl(e=!1){const t=await this.port.startTransaction();try{await this.interruptProgram(),await this.port.flushInput(),await this.port.write("\r"),await this.port.readUntil(`raw REPL; CTRL-B to exit\r
`),e&&(await this.port.write(""),await this.port.readUntil("OK")),this.end=async()=>{try{await this.port.write(""),await this.port.readUntil(`>\r
`),await this.port.readUntil(">>> ")}finally{t()}}}catch(s){throw t(),s}}async exec(e,t=5e3,s=!1){if(e.length===0)return"";await this.port.write(e),await this.port.write(""),await this.port.readUntil("OK"),this.port.emit=s,s&&this.port.prevRecvCbk(this.port.receivedData);const o=(await this.port.readUntil("",t)).slice(0,-1),l=(await this.port.readUntil("",t)).slice(0,-1);if(l.length)throw new Error(l);return o}async readFile(e){const t=await this.exec(`
try:
 import binascii
 h=lambda x: binascii.hexlify(x).decode()
 h(b'')
except:
 h=lambda b: ''.join('{:02x}'.format(byte) for byte in b)
with open('${e}','rb') as f:
 while 1:
  b=f.read(64)
  if not b:break
  print(h(b),end='')
`);return t.length?new Uint8Array(t.match(/../g).map(s=>parseInt(s,16))):new Uint8Array}async readFileLines(e,t){const s=await this.exec(`
with open('${e}', 'rb') as f:
 lines = []
 for _ in range(${t}):
  line = f.readline()
  if not line:
   break
  lines.append(line)
 data = b''.join(lines)
try:
 import binascii
 h = lambda x: binascii.hexlify(x).decode()
except:
 h = lambda b: ''.join('{:02x}'.format(byte) for byte in b)
print(h(data), end='')
`);return s.length?new Uint8Array(s.match(/../g).map(o=>parseInt(o,16))):new Uint8Array}async writeFile(e,t,s=128,o=!1){if(typeof t=="string"){const d=new TextEncoder;t=new Uint8Array(d.encode(t))}const l=d=>Array.from(d).map(r=>r.toString(16).padStart(2,"0")).join(""),p=d=>{d=new Uint8Array(d);let r="b'";for(const i of d)i>=32&&i<=126?i===92||i===39?r+="\\"+String.fromCharCode(i):r+=String.fromCharCode(i):r+="\\x"+i.toString(16).padStart(2,"0");return r+="'",r},u=o?e:e+".tmp";await this.exec(`
try:
 import binascii
 h=binascii.unhexlify
 h('')
except:
 h=lambda s: bytes(int(s[i:i+2], 16) for i in range(0, len(s), 2))
f=open('${u}','wb')
w=lambda d: f.write(h(d))
o=f.write
`);for(let d=0;d<t.byteLength;d+=s){const r=t.slice(d,d+s),i="w('"+l(r)+"')",c="o("+p(r)+")";i.length<c.length?await this.exec(i):await this.exec(c)}o?await this.exec("f.close()"):await this.exec(`f.close()
try: os.remove('${e}')
except: pass
os.rename('${u}','${e}')
`)}async getDeviceInfo(){const e=await this.exec(`
try: u=os.uname()
except: u=('','','','',sys.platform)
try: v=sys.version.split(';')[1].strip()
except: v='MicroPython '+u[2]
mpy=getattr(sys.implementation, '_mpy', 0)
sp=':'.join(sys.path)
d=[u[4],u[2],u[0],v,mpy>>10,mpy&0xFF,(mpy>>8)&3,sp]
print('|'.join(str(x) for x in d))
`);let[t,s,o,l,p,u,d,r]=e.trim().split("|");const i=r.split(":");try{p=["","x86","x64","armv6","armv6m","armv7m","armv7em","armv7emsp","armv7emdp","xtensa","xtensawin","rv32imc"][parseInt(p)]}catch{p=""}let c=parseInt(u,10);const v=parseInt(d,10);return c||(c="py"),{machine:t,release:s,sysname:o,version:l,mpy_arch:p,mpy_ver:c,mpy_sub:v,sys_path:i}}async touchFile(e){await this.exec(`
f=open('${e}','wb')
f.close()
`)}async moveFile(e,t){await this.exec(`os.rename('${e}', '${t}')`)}async makeDir(e){await this.exec(`os.mkdir('${e}')`)}async makePath(e){await this.exec(`
p=''
for d in '${e}'.split('/'):
 if not d: continue
 p += '/'+d
 try: os.mkdir(p)
 except OSError as e:
  if e.args[0] not in (17, 20): raise
`)}async removeFile(e){await this.exec(`
try:
 os.remove('${e}')
except OSError as e:
 if e.args[0] == 39:
  throw new Error('Directory not empty')
 else:
  throw e
`)}async removeDir(e){await this.exec(`
try:
 os.rmdir('${e}')
except OSError as e:
 if e.args[0] == 39:
  throw new Error('Directory not empty')
 else:
  throw e
`)}async getFsStats(e="/"){return(await this.exec(`
s = os.statvfs('${e}')
fs = s[1] * s[2]
ff = s[3] * s[0]
fu = fs - ff
print('%s|%s|%s'%(fu,ff,fs))
`)).trim().split("|")}async getFiles(){return await this.exec(`
def walk(p):
 for n in os.listdir(p if p else '/'):
  fn=p+'/'+n
  try: s=os.stat(fn)
  except: s=(0,)*7
  try:
   if s[0] & 0x4000 == 0:
    print('f|'+fn+'|'+str(s[6]))
   elif n not in ('.','..'):
    print('d|'+fn+'|'+str(s[6]))
    walk(fn)
  except:
   print('f|'+p+'/???|'+str(s[6]))
walk('')
`)}async readSysInfoMD(){return await this.exec(`
import gc
gc.collect()
mu = gc.mem_alloc()
mf = gc.mem_free()
ms = mu + mf
uname=os.uname()
p=print
def size_fmt(size):
 suffixes = ['B','KiB','MiB','GiB','TiB']
 i = 0
 while size > 1024 and i < len(suffixes)-1:
  i += 1
  size //= 1024
 return "%d%s" % (size, suffixes[i])
p('## Machine')
p('- Name: \`'+uname.machine+'\`')
try:
 gc.collect()
 import microcontroller as uc
 p('- CPU: \`%s @ %s MHz\`' % (sys.platform, uc.cpu.frequency // 1_000_000))
 p('- UID: \`%s\`' % (uc.cpu.uid.hex(),))
 p('- Temp.: \`%s °C\`' % (uc.cpu.temperature,))
 p('- Voltage: \`%s V\`' % (uc.cpu.voltage,))
except:
 try:
  gc.collect()
  import machine
  p('- CPU: \`%s @ %s MHz\`' % (sys.platform, machine.freq() // 1_000_000))
 except:
  p('- CPU: \`'+sys.platform+'\`')
p()
p('## System')
p('- Version: \`'+sys.version.split(";")[1].strip()+'\`')
if ms:
 p('- Memory use:  \`%s / %s, free: %d%%\`' % (size_fmt(mu), size_fmt(ms), (mf * 100) // ms))
`)}}const zt=b(!1),xa=b(Hn()),ee=b(!1),ba=b(!1),_a=b(),oe=b(!1),In=b(!1),Gn=b(!1),Vn=b(),qe=b(!1),qn=b(!1),Sa=b(!1),ka=b(),We=b(!1);b(!1);b(!1);b();const Ce=b(!1),Cn=b(!1),Ea=b(!1),Ta=b();let H=null;function Pa(n){return new Promise(e=>setTimeout(e,n))}async function Ia(n){try{qe.value=!0,qn.value=!1,await n(),qn.value=!0}catch(e){Sa.value=!0,ka.value=e}finally{qe.value=!1}}async function jt(n){try{Ce.value=!0,Cn.value=!1,await n(),Cn.value=!0}catch(e){Ea.value=!0,Ta.value=e}finally{Ce.value=!1}}async function qa(){return await fetch("https://raw.githubusercontent.com/Artisan-education/artisan-libs/main/manifest.json").then(e=>e.json()).catch(()=>{})}async function Ca(){if(!H)return;We.value=!0;const n=await Ra(),e=await qa(),t=await Fe.begin(H,!0);for(const s of Object.keys(e)){const o=n[s],l=e[s];if(!o||o!==l){const p=await fetch("https://raw.githubusercontent.com/Artisan-education/artisan-libs/main/"+s).then(u=>u.text()).catch(()=>"");await jt(async()=>{await t.makePath(s),await t.writeFile("/"+s,p)})}}await jt(async()=>{await t.writeFile("/manifest.json",JSON.stringify(e,null,2))}),await t.end(),We.value=!1}function $a(n,e){let t=!1;const s=n.trim().split(`
`),o=l=>{const[p,u,d]=l.split("|");return u===e};return s.find(o)&&(t=!0),t}async function Ra(){if(!H)return{};const n=await Fe.begin(H),e=await n.getFiles();let t="{}";return $a(e,"/manifest.json")&&(t=await La("manifest.json",n)),await n.end(),JSON.parse(t)}function Hn(){return/(iPad|iPhone|iPod)/g.test(navigator.userAgent)?(console.error("WebSerial is not available on iOS"),!1):window.isSecureContext?"serial"in navigator||"usb"in navigator?!0:(console.error("Try Chrome, Edge, Opera, Brave","WebSerial and WebUSB are not supported"),!1):(console.error("WebSerial cannot be accessed with unsecure connection"),!1)}async function Ma(){let n;if(n=new wa,!Hn())return null;try{await n.requestAccess()}catch(e){return _a.value=e,null}return n}async function Aa(n,e,t){try{await n.connect(),ee.value=!0}catch{zt.value=!1,ee.value=!1,oe.value=!1,Ce.value=!1,qe.value=!1,ba.value=!0;return}n.onReceive(e),n.onDisconnect(()=>{H==null||H.disconnect(),H=null,ee.value=!1,oe.value=!1,Ce.value=!1,qe.value=!1,zt.value=!1}),H=n}async function Da(){H==null||H.disconnect(),H=null,zt.value=!1,ee.value=!1,oe.value=!1,qe.value=!1,Ce.value=!1}async function Oa(){if(!H)return"";try{await H.write("\r"),oe.value=!1}catch(n){Gn.value=!0,oe.value=!1,Vn.value=n}}async function Ba(n){if(!H||(oe.value&&await H.write("\r"),n.length===0))return;const e=!0,t=-1,s=await Fe.begin(H,e);try{In.value=!1,oe.value=!0;const o=!0;await Pa(10),await s.exec(n,t,o),In.value=!0}catch(o){let l;o instanceof Error?l=o.message:l=String(o),l.includes("KeyboardInterrupt")||(Gn.value=!0,Vn.value=o)}finally{H.emit=!1,oe.value=!1}await s.end()}async function La(n,e){if(!H)return"";let t="";const s=e??await Fe.begin(H);return await Ia(async()=>{const o=await s.readFile(n);t=new TextDecoder("utf-8",{fatal:!0}).decode(o)}),e||s.end(),t}async function Fa(n,e){if(!H)return;const t=await Fe.begin(H);await jt(async()=>await t.writeFile(n,e)),t.end()}const Na={class:"flex flex-col h-full"},Ua={class:"flex px-2 w-full bg-zinc-900 text-white h-6 justify-between items-center"},za={class:"text-xs"},ja=W({__name:"Terminal",props:{id:{}},setup(n){const e=n,t=b(!1),s=wt(e.id),o=b("");let l=null;const p=()=>{var r,i;((r=s==null?void 0:s.output)==null?void 0:r.value)!==o.value&&(o.value=((i=s==null?void 0:s.output)==null?void 0:i.value)||"")};Q(()=>{var r;return(r=s==null?void 0:s.output)==null?void 0:r.value},r=>{o.value=r||""},{immediate:!0});function u(r){let i=r.key;if(i==="Enter")i=`
\r`;else if(i==="Backspace")i="\b";else if(i.length>1)return;if(ee.value)s.write(i);else{const c=i.charCodeAt(0);s.resolvers.length?s.resolvers.shift()(c):s.inputQueue.push(c)}}const d=b(null);return Te(()=>{var r;s&&(s.openTerminal(d.value),o.value=((r=s.output)==null?void 0:r.value)||"",l=setInterval(p,100))}),vt(()=>{l&&clearInterval(l)}),(r,i)=>{const c=ht;return O(),N("div",Na,[y("div",Ua,[i[4]||(i[4]=y("span",{class:"material-icons"},"terminal",-1)),y("span",za,ae(e.id),1),pe(c,{onClick:i[0]||(i[0]=v=>{var x;return(x=g(s))==null?void 0:x.clear()}),class:"w-4 h-4 text-white",link:""},{default:_e(()=>i[3]||(i[3]=[y("span",{class:"material-icons",style:{"font-size":"16px"}},"cleaning_services",-1)])),_:1})]),y("pre",{class:"h-full font-mono overflow-auto p-2 text-white bg-black rounded-b-xl",ref_key:"el",ref:d,tabindex:"0",onKeydown:u,onFocus:i[1]||(i[1]=v=>t.value=!0),onBlur:i[2]||(i[2]=v=>t.value=!1)},[y("span",null,ae(o.value),1),y("span",{class:ve([{caret:t.value},"bg-white"])}," ",2)],544)])}}}),El=Be(ja,[["__scopeId","data-v-a6055507"]]),Ga=W({__name:"CodeEditor",props:{id:{},disabled:{type:Boolean,default:!1}},setup(n){const e=n,t=gt(e.id),s=J({get:()=>t.code.value,set:i=>{i!=null&&i!=null&&i!==t.code.value&&t.setCode(i)}}),o=_s.define(),p=[Ss.define({create(){return lt.none},update(i,c){i=i.map(c.changes);for(const v of c.effects)if(v.is(o))if(v.value==null)i=lt.none;else{const x=c.state.doc.line(v.value.line);i=lt.set([lt.line({attributes:{class:"cm-highlight-line",style:`border-width: 2px; border-color: ${v.value.color};`}}).range(x.from)])}return i},provide:i=>ks.decorations.from(i)})],u=[Es(),Ts(),p,Ps.of(Is)],d=b(null);function r(i){d.value=i.view,Q(()=>t.highlights.value,c=>{if(i.view.dispatch({effects:o.of(null)}),Array.isArray(c))for(const v of c)i.view.dispatch({effects:o.of(v)})}),Q(s,()=>{t.highlights.value=[]})}return(i,c)=>(O(),Ie(g(qs),{modelValue:s.value,"onUpdate:modelValue":c[0]||(c[0]=v=>s.value=v),placeholder:"Code goes here..",autofocus:!0,"indent-with-tab":!0,"tab-size":4,extensions:u,onReady:r,style:{width:"100%"},disabled:e.disabled},null,8,["modelValue","disabled"]))}}),Va={class:"border flex justify-center items-center rounded mb-2 space-x-2"},Ha={key:0,class:"material-icons"},Wa={key:1,class:"material-icons"},Xa={class:"flex items-center gap-4 mb-8"},Ya={class:"flex justify-end gap-2"},Ka=W({__name:"IdeButtons",props:{id:{}},setup(n){const e=n,t=wt(e.id),s=gt(e.id);let o=null;Te(()=>{o=setInterval(()=>{localStorage.setItem("code",s.code.value)},1e3)}),Wt(()=>{o&&clearInterval(o)});async function l(){const S=await Ma();S&&(await Aa(S,t.write),Ca(),t.clear())}function p(){ee.value?Da():l()}const u=b(!1);function d(){Ba(s.code.value)}function r(S){return/\.[^\/\\]+$/.test(S)?S:`${S}.py`}const i=b(!1);function c(S,f){S?Fa(S,f):i.value=!0}const v=b("");function x(){i.value=!1}function T(){const S=r(v.value);c(S,s.code.value),i.value=!1}return(S,f)=>{const E=ht,C=Cs,R=es;return O(),N("div",null,[re(y("div",Va,[f[7]||(f[7]=y("p",null,"Updating",-1)),y("div",null,[pe(g($s),{class:"w-7 h-7"})])],512),[[ye,g(We)]]),y("div",null,[g(ee)?(O(),Ie(E,{key:0,id:"#run",type:"button",class:"w-9 h-9 mr-1",variant:g(oe)||!g(ee)?"outlined":void 0,severity:"info",rounded:"",onClick:d,disabled:g(oe)||!g(ee),loading:g(oe)},{default:_e(()=>f[8]||(f[8]=[y("span",{class:"material-icons"},"play_arrow",-1)])),_:1},8,["variant","disabled","loading"])):ie("",!0),g(ee)?(O(),Ie(E,{key:1,type:"button",class:"w-9 h-9 mr-1",variant:!g(oe)||!g(ee)?"outlined":void 0,severity:"danger",rounded:"",onClick:f[0]||(f[0]=_=>g(Oa)()),disabled:!g(oe)||!g(ee)},{default:_e(()=>f[9]||(f[9]=[y("span",{class:"material-icons"},"stop",-1)])),_:1},8,["variant","disabled"])):ie("",!0),g(ee)?(O(),Ie(E,{key:2,type:"button",class:"w-9 h-9",variant:"outlined",severity:"secondary",rounded:"",onClick:f[1]||(f[1]=_=>c(v.value,g(s).code.value)),disabled:g(Ce)||g(qe)||g(We)||g(oe)||!g(ee),loading:g(Ce)||g(qe)||g(We)},{default:_e(()=>f[10]||(f[10]=[y("span",{class:"material-icons"},"save",-1)])),_:1},8,["disabled","loading"])):ie("",!0),pe(E,{type:"button",class:ve(["w-9 h-9 mr-1 text-white",g(ee)?u.value?"bg-red-500":"bg-green-500":"bg-gray-600"]),rounded:"",text:"",onClick:f[2]||(f[2]=_=>p()),onMouseover:f[3]||(f[3]=_=>u.value=!0),onMouseleave:f[4]||(f[4]=_=>u.value=!1),loading:g(Ce)||g(qe)||g(We)},{default:_e(()=>[u.value&&g(ee)?(O(),N("span",Ha,"close")):(O(),N("span",Wa,"cable"))]),_:1},8,["class","loading"])]),pe(R,{visible:i.value,"onUpdate:visible":f[6]||(f[6]=_=>i.value=_),modal:"",header:"File Name",style:{width:"25rem"}},{default:_e(()=>[y("div",Xa,[pe(C,{id:"filename",modelValue:v.value,"onUpdate:modelValue":f[5]||(f[5]=_=>v.value=_),class:"flex-auto",autocomplete:"off"},null,8,["modelValue"])]),y("div",Ya,[pe(E,{type:"button",label:"Cancel",severity:"secondary",onClick:x}),pe(E,{disabled:!v.value,type:"button",label:"Save",onClick:T},null,8,["disabled"])])]),_:1},8,["visible"])])}}}),Ja={class:"relative flex h-full"},Qa={key:0,class:"absolute bottom-2 left-2"},Za={class:"material-icons"},el={class:"material-icons"},Tl=W({__name:"CodeEditorView",props:Yt({id:{},disabled:{type:Boolean}},{code:{default:""},codeModifiers:{},connectbuttons:{type:Boolean,default:!1},connectbuttonsModifiers:{},runbuttons:{type:Boolean,default:!0},runbuttonsModifiers:{}}),emits:Yt(["run","stop"],["update:code","update:connectbuttons","update:runbuttons"]),setup(n,{emit:e}){const t=n,s=wt(t.id),o=Nn(t.id),l=Un(t.id),p=ia(s,s.write,l.writeText,l.clearDisplay,o.setPin,o.getPin,o.getI2C),u=gt(t.id),{isLoading:d,isStopping:r,isRunning:i,isConnected:c}=p,v=pt(n,"code"),x=pt(n,"connectbuttons"),T=pt(n,"runbuttons");rt.register(t.id,{instance:p}),p.connect();const S=e;function f(){c.value?(rt.stopOthers(t.id),p.run(String(u.code.value))):p.connect(),S("run")}function E(){p.stop(),S("stop")}return ts(()=>{u.code.value=v.value}),Q(u.code,C=>{C!==v.value&&(v.value=C)}),vt(()=>{rt.unregister(t.id)}),(C,R)=>{const _=ht;return O(),N("div",Ja,[pe(Ga,ns(g(u),{disabled:t.disabled,id:t.id}),null,16,["disabled","id"]),R[0]||(R[0]=y("div",{id:"#editor",class:"absolute top-10 left-10"},null,-1)),T.value?(O(),N("div",Qa,[pe(_,{id:"#run",type:"button",class:"w-9 h-9 mr-1",severity:"info",rounded:"",onClick:f,disabled:g(d)||g(i)},{default:_e(()=>[y("span",Za,ae(g(d)?"hourglass_top":"play_arrow"),1)]),_:1},8,["disabled"]),pe(_,{type:"button",class:"w-9 h-9 mr-1",variant:g(i)?void 0:"outlined",severity:"danger",rounded:"",onClick:E,disabled:!g(i)||!g(c)},{default:_e(()=>[y("span",el,ae(g(r)?"hourglass_top":"stop"),1)]),_:1},8,["variant","disabled"])])):ie("",!0),x.value&&g(xa)?(O(),Ie(Ka,{key:1,class:"absolute bottom-2 right-2",id:t.id},null,8,["id"])):ie("",!0)])}}});export{pl as A,gl as B,vl as C,Zs as D,Oe as E,yl as F,Tr as G,wl as H,F as I,B as M,U as O,be as P,ge as R,El as T,Tl as _,zs as a,Dn as b,Sl as c,$e as d,kl as e,xl as f,ca as g,fa as h,dl as i,Ut as j,wt as k,gt as l,fl as m,Un as n,ul as o,ml as p,ia as q,ll as r,_l as s,En as t,Nn as u,hl as v,jn as w,bl as x,cl as y,ma as z};
