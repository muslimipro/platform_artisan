import{s as $}from"./index-CJ6nYy3M.js";import{h as C,z as p,s as N}from"./index-DQKBVlMT.js";import{a as A,u as L,r as M,b as e,i as f,w as r,f as t,h as a,t as l,e as i,k as g,F as v,K as h,g as j,m as q}from"./index-C5BusG5M.js";import{s as D}from"./index-Bj7sNZBv.js";import{s as E}from"./index-dcL3f34T.js";import{s as K}from"./index-CTIjgyK3.js";import{S as O}from"./index-DFGvECIt.js";import"./index-cOWlq3Hq.js";import"./index-Cl4zzoYA.js";import"./index-CckRWD9q.js";import"./index-xNy4xIqP.js";import"./http-TNhZgV1b.js";const T={class:"flex flex-col gap-1"},Z={for:"old_password"},G={class:"my-0 flex flex-col gap-1"},H={class:"flex flex-col gap-1"},I={for:"new_password"},J={class:"my-0 flex flex-col gap-1"},Q={class:"flex flex-col gap-1"},R={for:"confirm_password"},U={class:"my-0 flex flex-col gap-1"},cs=A({__name:"ChangePassword",setup(W){const y=L(),n=M(!1),P=M({old_password:"",new_password:""}),V=C(p.object({old_password:p.string().min(1,{message:"Old password is required."}).max(100,{message:"Maximum 100 characters."}),new_password:p.string().min(8,{message:"Minimum 8 characters."}).max(100,{message:"Maximum 100 characters."}).refine(s=>/[a-z]/.test(s),{message:"Must have a lowercase letter."}).refine(s=>/[A-Z]/.test(s),{message:"Must have an uppercase letter."}).refine(s=>/[0-9]/.test(s),{message:"Must have a number."}),confirm_password:p.string()}).refine(s=>s.new_password===s.confirm_password,{message:"Passwords must match",path:["confirm_password"]})),z=async s=>{if(!n.value&&s.valid){n.value=!0;try{const{data:d}=await O.changePassword(s.states.old_password.value,s.states.new_password.value);y.add({severity:"success",summary:d.message,life:2e3})}catch(d){y.add({severity:"error",summary:d.response.data.error,detail:d,life:2e3})}finally{n.value=!1}}};return(s,d)=>{const u=K,_=E,w=D,B=q,F=N,S=$;return e(),f(S,{class:"flex-grow",header:s.$t("pages.settings.changePassword")},{default:r(()=>[t(F,{initialValues:P.value,resolver:j(V),onSubmit:z,class:"flex flex-col gap-2"},{default:r(o=>{var b,x,k;return[a("div",T,[t(_,{variant:"on"},{default:r(()=>[t(u,{id:"old_password",name:"old_password",feedback:!1,toggleMask:"",fluid:"",class:"w-full sm:w-96"}),a("label",Z,l(s.$t("pages.settings.oldPassword")),1)]),_:1}),(b=o.old_password)!=null&&b.invalid?(e(),f(w,{key:0,severity:"error",size:"small",variant:"simple"},{default:r(()=>[a("ul",G,[(e(!0),i(v,null,g(o.old_password.errors,(c,m)=>(e(),i("li",{key:m},l(c.message),1))),128))])]),_:2},1024)):h("",!0)]),a("div",H,[t(_,{variant:"on"},{default:r(()=>[t(u,{id:"new_password",name:"new_password",feedback:!1,toggleMask:"",fluid:"",class:"w-full sm:w-96"}),a("label",I,l(s.$t("pages.settings.newPassword")),1)]),_:1}),(x=o.new_password)!=null&&x.invalid?(e(),f(w,{key:0,severity:"error",size:"small",variant:"simple"},{default:r(()=>[a("ul",J,[(e(!0),i(v,null,g(o.new_password.errors,(c,m)=>(e(),i("li",{key:m},l(c.message),1))),128))])]),_:2},1024)):h("",!0)]),a("div",Q,[t(_,{variant:"on"},{default:r(()=>[t(u,{id:"confirm_password",name:"confirm_password",feedback:!1,toggleMask:"",fluid:"",class:"w-full sm:w-96"}),a("label",R,l(s.$t("pages.settings.confirmPassword")),1)]),_:1}),(k=o.confirm_password)!=null&&k.invalid?(e(),f(w,{key:0,severity:"error",size:"small",variant:"simple"},{default:r(()=>[a("ul",U,[(e(!0),i(v,null,g(o.confirm_password.errors,(c,m)=>(e(),i("li",{key:m},l(c.message),1))),128))])]),_:2},1024)):h("",!0)]),t(B,{type:"submit",label:s.$t("pages.settings.savePassword"),class:"w-fit",loading:n.value,disabled:n.value},null,8,["label","loading","disabled"])]}),_:1},8,["initialValues","resolver"])]),_:1},8,["header"])}}});export{cs as default};
