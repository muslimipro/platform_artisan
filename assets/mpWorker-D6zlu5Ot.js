var Oe=Object.defineProperty;var Ae=(e,t,r)=>t in e?Oe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var Ne=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var m=(e,t,r)=>Ae(e,typeof t!="symbol"?t+"":t,r);var at=Ne((lt,B)=>{var F=(e=>(e[e.NONE=-1]="NONE",e[e.IN=0]="IN",e[e.OUT=1]="OUT",e))(F||{}),T=(e=>(e[e.NONE=-1]="NONE",e[e.UP=0]="UP",e[e.DOWN=1]="DOWN",e))(T||{}),xe=Object.defineProperty,d=(e,t)=>xe(e,"name",{value:t,configurable:!0}),Z=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(t,r)=>(typeof require<"u"?require:t)[r]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw new Error('Dynamic require of "'+e+'" is not supported')});function K(e){return!isNaN(parseFloat(e))&&isFinite(e)}d(K,"_isNumber");function v(e){return e.charAt(0).toUpperCase()+e.substring(1)}d(v,"_capitalize");function U(e){return function(){return this[e]}}d(U,"_getter");var N=["isConstructor","isEval","isNative","isToplevel"],x=["columnNumber","lineNumber"],k=["fileName","functionName","source"],ke=["args"],Fe=["evalOrigin"],D=N.concat(x,k,ke,Fe);function y(e){if(e)for(var t=0;t<D.length;t++)e[D[t]]!==void 0&&this["set"+v(D[t])](e[D[t]])}d(y,"StackFrame");y.prototype={getArgs:function(){return this.args},setArgs:function(e){if(Object.prototype.toString.call(e)!=="[object Array]")throw new TypeError("Args must be an Array");this.args=e},getEvalOrigin:function(){return this.evalOrigin},setEvalOrigin:function(e){if(e instanceof y)this.evalOrigin=e;else if(e instanceof Object)this.evalOrigin=new y(e);else throw new TypeError("Eval Origin must be an Object or StackFrame")},toString:function(){var e=this.getFileName()||"",t=this.getLineNumber()||"",r=this.getColumnNumber()||"",i=this.getFunctionName()||"";return this.getIsEval()?e?"[eval] ("+e+":"+t+":"+r+")":"[eval]:"+t+":"+r:i?i+" ("+e+":"+t+":"+r+")":e+":"+t+":"+r}};y.fromString=d(function(e){var t=e.indexOf("("),r=e.lastIndexOf(")"),i=e.substring(0,t),o=e.substring(t+1,r).split(","),n=e.substring(r+1);if(n.indexOf("@")===0)var s=/@(.+?)(?::(\d+))?(?::(\d+))?$/.exec(n,""),a=s[1],c=s[2],u=s[3];return new y({functionName:i,args:o||void 0,fileName:a,lineNumber:c||void 0,columnNumber:u||void 0})},"StackFrame$$fromString");for(S=0;S<N.length;S++)y.prototype["get"+v(N[S])]=U(N[S]),y.prototype["set"+v(N[S])]=function(e){return function(t){this[e]=!!t}}(N[S]);var S;for(E=0;E<x.length;E++)y.prototype["get"+v(x[E])]=U(x[E]),y.prototype["set"+v(x[E])]=function(e){return function(t){if(!K(t))throw new TypeError(e+" must be a Number");this[e]=Number(t)}}(x[E]);var E;for(O=0;O<k.length;O++)y.prototype["get"+v(k[O])]=U(k[O]),y.prototype["set"+v(k[O])]=function(e){return function(t){this[e]=String(t)}}(k[O]);var O,R=y;function Q(){var e=/^\s*at .*(\S+:\d+|\(native\))/m,t=/^(eval@)?(\[native code])?$/;return{parse:d(function(r){if(r.stack&&r.stack.match(e))return this.parseV8OrIE(r);if(r.stack)return this.parseFFOrSafari(r);throw new Error("Cannot parse given Error object")},"ErrorStackParser$$parse"),extractLocation:d(function(r){if(r.indexOf(":")===-1)return[r];var i=/(.+?)(?::(\d+))?(?::(\d+))?$/,o=i.exec(r.replace(/[()]/g,""));return[o[1],o[2]||void 0,o[3]||void 0]},"ErrorStackParser$$extractLocation"),parseV8OrIE:d(function(r){var i=r.stack.split(`
`).filter(function(o){return!!o.match(e)},this);return i.map(function(o){o.indexOf("(eval ")>-1&&(o=o.replace(/eval code/g,"eval").replace(/(\(eval at [^()]*)|(,.*$)/g,""));var n=o.replace(/^\s+/,"").replace(/\(eval code/g,"(").replace(/^.*?\s+/,""),s=n.match(/ (\(.+\)$)/);n=s?n.replace(s[0],""):n;var a=this.extractLocation(s?s[1]:n),c=s&&n||void 0,u=["eval","<anonymous>"].indexOf(a[0])>-1?void 0:a[0];return new R({functionName:c,fileName:u,lineNumber:a[1],columnNumber:a[2],source:o})},this)},"ErrorStackParser$$parseV8OrIE"),parseFFOrSafari:d(function(r){var i=r.stack.split(`
`).filter(function(o){return!o.match(t)},this);return i.map(function(o){if(o.indexOf(" > eval")>-1&&(o=o.replace(/ line (\d+)(?: > eval line \d+)* > eval:\d+:\d+/g,":$1")),o.indexOf("@")===-1&&o.indexOf(":")===-1)return new R({functionName:o});var n=/((.*".+"[^@]*)?[^@]*)(?:@)/,s=o.match(n),a=s&&s[1]?s[1]:void 0,c=this.extractLocation(o.replace(n,""));return new R({functionName:a,fileName:c[0],lineNumber:c[1],columnNumber:c[2],source:o})},this)},"ErrorStackParser$$parseFFOrSafari")}}d(Q,"ErrorStackParser");var De=new Q,Le=De,g=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string"&&!process.browser,ee=g&&typeof B<"u"&&typeof B.exports<"u"&&typeof Z<"u"&&typeof __dirname<"u",Ie=g&&!ee,$e=typeof Deno<"u",te=!g&&!$e,Me=te&&typeof window=="object"&&typeof document=="object"&&typeof document.createElement=="function"&&"sessionStorage"in window&&typeof importScripts!="function",Te=te&&typeof importScripts=="function"&&typeof self=="object";typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent.indexOf("Chrome")==-1&&navigator.userAgent.indexOf("Safari")>-1;var re,C,ne,J,W;async function q(){if(!g||(re=(await import("./__vite-browser-external-9wXp6ZBx.js")).default,J=await import("./__vite-browser-external-9wXp6ZBx.js"),W=await import("./__vite-browser-external-9wXp6ZBx.js"),ne=(await import("./__vite-browser-external-9wXp6ZBx.js")).default,C=await import("./__vite-browser-external-9wXp6ZBx.js"),H=C.sep,typeof Z<"u"))return;let e=J,t=await import("./__vite-browser-external-9wXp6ZBx.js"),r=await import("./__vite-browser-external-9wXp6ZBx.js"),i=await import("./__vite-browser-external-9wXp6ZBx.js"),o={fs:e,crypto:t,ws:r,child_process:i};globalThis.require=function(n){return o[n]}}d(q,"initNodeModules");function ie(e,t){return C.resolve(t||".",e)}d(ie,"node_resolvePath");function oe(e,t){return t===void 0&&(t=location),new URL(e,t).toString()}d(oe,"browser_resolvePath");var j;g?j=ie:j=oe;var H;g||(H="/");function se(e,t){return e.startsWith("file://")&&(e=e.slice(7)),e.includes("://")?{response:fetch(e)}:{binary:W.readFile(e).then(r=>new Uint8Array(r.buffer,r.byteOffset,r.byteLength))}}d(se,"node_getBinaryResponse");function ae(e,t){let r=new URL(e,location);return{response:fetch(r,t?{integrity:t}:{})}}d(ae,"browser_getBinaryResponse");var I;g?I=se:I=ae;async function ce(e,t){let{response:r,binary:i}=I(e,t);if(i)return i;let o=await r;if(!o.ok)throw new Error(`Failed to load '${e}': request failed.`);return new Uint8Array(await o.arrayBuffer())}d(ce,"loadBinaryFile");var L;if(Me)L=d(async e=>await import(e),"loadScript");else if(Te)L=d(async e=>{try{globalThis.importScripts(e)}catch(t){if(t instanceof TypeError)await import(e);else throw t}},"loadScript");else if(g)L=le;else throw new Error("Cannot determine runtime environment");async function le(e){e.startsWith("file://")&&(e=e.slice(7)),e.includes("://")?ne.runInThisContext(await(await fetch(e)).text()):await import(re.pathToFileURL(e).href)}d(le,"nodeLoadScript");async function de(e){if(g){await q();let t=await W.readFile(e,{encoding:"utf8"});return JSON.parse(t)}else return await(await fetch(e)).json()}d(de,"loadLockFile");async function ue(){if(ee)return __dirname;let e;try{throw new Error}catch(i){e=i}let t=Le.parse(e)[0].fileName;if(g&&!t.startsWith("file://")&&(t=`file://${t}`),Ie){let i=await import("./__vite-browser-external-9wXp6ZBx.js");return(await import("./__vite-browser-external-9wXp6ZBx.js")).fileURLToPath(i.dirname(t))}let r=t.lastIndexOf(H);if(r===-1)throw new Error("Could not extract indexURL path from pyodide module location");return t.slice(0,r)}d(ue,"calculateDirname");function me(e){let t=e.FS,r=e.FS.filesystems.MEMFS,i=e.PATH,o={DIR_MODE:16895,FILE_MODE:33279,mount:function(n){if(!n.opts.fileSystemHandle)throw new Error("opts.fileSystemHandle is required");return r.mount.apply(null,arguments)},syncfs:async(n,s,a)=>{try{let c=o.getLocalSet(n),u=await o.getRemoteSet(n),l=s?u:c,f=s?c:u;await o.reconcile(n,l,f),a(null)}catch(c){a(c)}},getLocalSet:n=>{let s=Object.create(null);function a(l){return l!=="."&&l!==".."}d(a,"isRealDir");function c(l){return f=>i.join2(l,f)}d(c,"toAbsolute");let u=t.readdir(n.mountpoint).filter(a).map(c(n.mountpoint));for(;u.length;){let l=u.pop(),f=t.stat(l);t.isDir(f.mode)&&u.push.apply(u,t.readdir(l).filter(a).map(c(l))),s[l]={timestamp:f.mtime,mode:f.mode}}return{type:"local",entries:s}},getRemoteSet:async n=>{let s=Object.create(null),a=await Ue(n.opts.fileSystemHandle);for(let[c,u]of a)c!=="."&&(s[i.join2(n.mountpoint,c)]={timestamp:u.kind==="file"?(await u.getFile()).lastModifiedDate:new Date,mode:u.kind==="file"?o.FILE_MODE:o.DIR_MODE});return{type:"remote",entries:s,handles:a}},loadLocalEntry:n=>{let s=t.lookupPath(n).node,a=t.stat(n);if(t.isDir(a.mode))return{timestamp:a.mtime,mode:a.mode};if(t.isFile(a.mode))return s.contents=r.getFileDataAsTypedArray(s),{timestamp:a.mtime,mode:a.mode,contents:s.contents};throw new Error("node type not supported")},storeLocalEntry:(n,s)=>{if(t.isDir(s.mode))t.mkdirTree(n,s.mode);else if(t.isFile(s.mode))t.writeFile(n,s.contents,{canOwn:!0});else throw new Error("node type not supported");t.chmod(n,s.mode),t.utime(n,s.timestamp,s.timestamp)},removeLocalEntry:n=>{var s=t.stat(n);t.isDir(s.mode)?t.rmdir(n):t.isFile(s.mode)&&t.unlink(n)},loadRemoteEntry:async n=>{if(n.kind==="file"){let s=await n.getFile();return{contents:new Uint8Array(await s.arrayBuffer()),mode:o.FILE_MODE,timestamp:s.lastModifiedDate}}else{if(n.kind==="directory")return{mode:o.DIR_MODE,timestamp:new Date};throw new Error("unknown kind: "+n.kind)}},storeRemoteEntry:async(n,s,a)=>{let c=n.get(i.dirname(s)),u=t.isFile(a.mode)?await c.getFileHandle(i.basename(s),{create:!0}):await c.getDirectoryHandle(i.basename(s),{create:!0});if(u.kind==="file"){let l=await u.createWritable();await l.write(a.contents),await l.close()}n.set(s,u)},removeRemoteEntry:async(n,s)=>{await n.get(i.dirname(s)).removeEntry(i.basename(s)),n.delete(s)},reconcile:async(n,s,a)=>{let c=0,u=[];Object.keys(s.entries).forEach(function(h){let w=s.entries[h],b=a.entries[h];(!b||t.isFile(w.mode)&&w.timestamp.getTime()>b.timestamp.getTime())&&(u.push(h),c++)}),u.sort();let l=[];if(Object.keys(a.entries).forEach(function(h){s.entries[h]||(l.push(h),c++)}),l.sort().reverse(),!c)return;let f=s.type==="remote"?s.handles:a.handles;for(let h of u){let w=i.normalize(h.replace(n.mountpoint,"/")).substring(1);if(a.type==="local"){let b=f.get(w),P=await o.loadRemoteEntry(b);o.storeLocalEntry(h,P)}else{let b=o.loadLocalEntry(h);await o.storeRemoteEntry(f,w,b)}}for(let h of l)if(a.type==="local")o.removeLocalEntry(h);else{let w=i.normalize(h.replace(n.mountpoint,"/")).substring(1);await o.removeRemoteEntry(f,w)}}};e.FS.filesystems.NATIVEFS_ASYNC=o}d(me,"initializeNativeFS");var Ue=d(async e=>{let t=[];async function r(o){for await(let n of o.values())t.push(n),n.kind==="directory"&&await r(n)}d(r,"collect"),await r(e);let i=new Map;i.set(".",e);for(let o of t){let n=(await e.resolve(o)).join("/");i.set(n,o)}return i},"getFsHandles");function fe(e){let t={noImageDecoding:!0,noAudioDecoding:!0,noWasmDecoding:!1,preRun:ge(e),quit(r,i){throw t.exited={status:r,toThrow:i},i},print:e.stdout,printErr:e.stderr,arguments:e.args,API:{config:e},locateFile:r=>e.indexURL+r,instantiateWasm:we(e.indexURL)};return t}d(fe,"createSettings");function pe(e){return function(t){let r="/";try{t.FS.mkdirTree(e)}catch(i){console.error(`Error occurred while making a home directory '${e}':`),console.error(i),console.error(`Using '${r}' for a home directory instead`),e=r}t.FS.chdir(e)}}d(pe,"createHomeDirectory");function he(e){return function(t){Object.assign(t.ENV,e)}}d(he,"setEnvironment");function ye(e){return t=>{for(let r of e)t.FS.mkdirTree(r),t.FS.mount(t.FS.filesystems.NODEFS,{root:r},r)}}d(ye,"mountLocalDirectories");function _e(e){let t=ce(e);return r=>{let i=r._py_version_major(),o=r._py_version_minor();r.FS.mkdirTree("/lib"),r.FS.mkdirTree(`/lib/python${i}.${o}/site-packages`),r.addRunDependency("install-stdlib"),t.then(n=>{r.FS.writeFile(`/lib/python${i}${o}.zip`,n)}).catch(n=>{console.error("Error occurred while installing the standard library:"),console.error(n)}).finally(()=>{r.removeRunDependency("install-stdlib")})}}d(_e,"installStdlib");function ge(e){let t;return e.stdLibURL!=null?t=e.stdLibURL:t=e.indexURL+"python_stdlib.zip",[_e(t),pe(e.env.HOME),he(e.env),ye(e._node_mounts),me]}d(ge,"getFileSystemInitializationFuncs");function we(e){if(typeof WasmOffsetConverter<"u")return;let{binary:t,response:r}=I(e+"pyodide.asm.wasm");return function(i,o){return async function(){try{let n;r?n=await WebAssembly.instantiateStreaming(r,i):n=await WebAssembly.instantiate(await t,i);let{instance:s,module:a}=n;o(s,a)}catch(n){console.warn("wasm instantiation failed!"),console.warn(n)}}(),{}}}d(we,"getInstantiateWasmFunc");var Y="0.27.2";async function ve(e={}){var t,r;await q();let i=e.indexURL||await ue();i=j(i),i.endsWith("/")||(i+="/"),e.indexURL=i;let o={fullStdLib:!1,jsglobals:globalThis,stdin:globalThis.prompt?globalThis.prompt:void 0,lockFileURL:i+"pyodide-lock.json",args:[],_node_mounts:[],env:{},packageCacheDir:i,packages:[],enableRunUntilComplete:!1,checkAPIVersion:!0,BUILD_ID:"f88dc4abb40ec8e780c94a5f70bcef45ec9eb3c1aee1c99da527febfef1c6f3f"},n=Object.assign(o,e);(t=n.env).HOME??(t.HOME="/home/pyodide"),(r=n.env).PYTHONINSPECT??(r.PYTHONINSPECT="1");let s=fe(n),a=s.API;if(a.lockFilePromise=de(n.lockFileURL),typeof _createPyodideModule!="function"){let h=`${n.indexURL}pyodide.asm.js`;await L(h)}let c;if(e._loadSnapshot){let h=await e._loadSnapshot;ArrayBuffer.isView(h)?c=h:c=new Uint8Array(h),s.noInitialRun=!0,s.INITIAL_MEMORY=c.length}let u=await _createPyodideModule(s);if(s.exited)throw s.exited.toThrow;if(e.pyproxyToStringRepr&&a.setPyProxyToStringMethod(!0),a.version!==Y&&n.checkAPIVersion)throw new Error(`Pyodide version does not match: '${Y}' <==> '${a.version}'. If you updated the Pyodide version, make sure you also updated the 'indexURL' parameter passed to loadPyodide.`);u.locateFile=h=>{throw new Error("Didn't expect to load any more file_packager files!")};let l;c&&(l=a.restoreSnapshot(c));let f=a.finalizeBootstrap(l,e._snapshotDeserializer);return a.sys.path.insert(0,a.config.env.HOME),f.version.includes("dev")||a.setCdnUrl(`https://cdn.jsdelivr.net/pyodide/v${f.version}/full/`),a._pyodide.set_excepthook(),await a.packageIndexReady,a.initializeStreams(n.stdin,n.stdout,n.stderr),f}d(ve,"loadPyodide");const be=new SharedArrayBuffer(16),_=new Int32Array(be),Pe=new SharedArrayBuffer(1),X=new Uint8Array(Pe);let G=0;function p(e){Atomics.store(_,0,0),e.id=G,postMessage(e),Atomics.wait(_,0,0),G++}function Re(e,t){return e+t}function Se(e,t){return e-t}class V{constructor(t,r,i){m(this,"pin");this.pin=t,p({command:"pin mode",data:{pin:this.pin,mode:r}}),p({command:"pin pull",data:{pin:this.pin,pull:i}})}on(){p({command:"on",data:{pin:this.pin}})}off(){p({command:"off",data:{pin:this.pin}})}toggle(){p({command:"toggle",data:{pin:this.pin}})}value(t=null){if(t===1)p({command:"on",data:{pin:this.pin}});else if(t===0)p({command:"off",data:{pin:this.pin}});else return p({command:"value",data:{pin:this.pin}}),Atomics.load(_,1)}}function $(e){return e instanceof V?e.pin:e}class Ce{constructor(t,r,i){m(this,"pin");this.pin=$(t),t instanceof V?p({command:"pin mode",data:{pin:this.pin,mode:F.OUT}}):p({command:"pin mode",data:{pin:this.pin,mode:F.OUT}})}freq(t){p({command:"pwm freq",data:{freq:t,pin:this.pin}})}duty_u16(t){p({command:"pwm duty_u16",data:{duty_u16:t,pin:this.pin}})}}const je={0:[0,4,8,12,16,20],1:[2,6,10,14,18,26]},Be={0:[1,5,9,13,17,21],1:[3,7,11,15,19,27]};class z{constructor(t,r,i,o=4e5,n=5e4){m(this,"id");m(this,"sda");m(this,"scl");m(this,"freq");m(this,"timeout");if(t!==0&&t!==1)throw`I2C(${t}) doesn't exist`;const s=$(r),a=$(i);if(!Be[t].includes(a))throw"Bad SCL pin: "+a;if(!je[t].includes(s))throw"Bad SDA pin: "+s;this.sda=s,this.scl=a,this.id=t,this.freq=o,this.timeout=n}readfrom(t,r){throw"Not implemented"}writeto(t,r){throw"Not implemented"}scan(){p({command:"i2c scan",data:{sda:this.sda,scl:this.scl}});const t=Atomics.load(_,1),r=[];return r.toString=function(){return`[${this.join(", ")}]`},t<0||r.push(t),r}toString(){return`I2C(${this.id}, freq=${this.freq}, scl=${this.scl}, sda=${this.sda}, timeout=${this.timeout})`}}class We{constructor(t){m(this,"i2c");m(this,"_temperature");m(this,"_pressure");m(this,"_humidity");this.i2c=t,this._temperature=0,this._pressure=0,this._humidity=0}get temperature(){return p({command:"bme280 temperature",data:{pin:this.i2c.sda}}),Atomics.load(_,1)}get pressure(){return p({command:"bme280 pressure",data:{pin:this.i2c.sda}}),Atomics.load(_,1)}get humidity(){return p({command:"bme280 humidity",data:{pin:this.i2c.sda}}),Atomics.load(_,1)}}class qe{constructor(t,r){m(this,"i2c");m(this,"address");m(this,"_started");m(this,"min_valid_mm");m(this,"max_valid_mm");m(this,"_on_close");m(this,"_on_motion");m(this,"_close_threshold");m(this,"_motion_threshold");m(this,"_last_distance");m(this,"_motion_last_trigger");m(this,"_motion_cooldown_ms");if(this.i2c=t,this.address=r,this._started=!1,this._on_close=null,this._on_motion=null,this._close_threshold=null,this._motion_threshold=null,this._last_distance=null,this._motion_last_trigger=0,this._motion_cooldown_ms=500,this.min_valid_mm=20,this.max_valid_mm=2e3,!this.i2c.scan().includes(this.address))throw`VL53L0X not found at address ${this.address.toString(16)}`}read(){p({command:"VL53LOX read",data:{sda:this.i2c.sda,scl:this.i2c.scl}});const t=Atomics.load(_,1);if(t<0)throw`VL53L0X error: sda=${this.i2c.sda}, scl=${this.i2c.scl} are not connected to a Distance Sensor`;return t}is_valid(t){return this.min_valid_mm<t&&t<this.max_valid_mm}add_cloase_trigger(t,r){this._close_threshold=t,this._on_close=r}add_motion_trigger(t,r,i=500){this._motion_threshold=t,this._on_motion=r,this._last_distance=null,this._motion_cooldown_ms=i}check(){const t=this.read();if(this.is_valid(t)&&(this._on_close&&this._close_threshold&&t<this._close_threshold&&this._on_close(t),this._on_motion&&this._last_distance&&this._motion_threshold)){const r=Math.abs(t-this._last_distance),i=performance.now();r>this._motion_threshold&&Se(i,this._motion_last_trigger)>this._motion_cooldown_ms&&(this._motion_last_trigger=i,this._on_motion(t,r)),this._last_distance=t}}bar(t=200,r=20,i="#",o=" "){const n=this.read();if(!this.is_valid(n))return`[${"?".repeat(r)}] invalid (${n} mm)`;const s=Math.min(r,Math.floor(n/t*r)),a=i.repeat(s),c=o.repeat(r-s);return`[${a}${c}] ${n} mm`}}class He{constructor(t,r,i,o){m(this,"i2c");m(this,"addr");this.i2c=new z(t,i,o,r),this.addr=16}readRGB(){p({command:"VEML6040 readRGB",data:{sda:this.i2c.sda,scl:this.i2c.scl}});const t=new Uint8Array(be),r=Atomics.load(t,4),i=Atomics.load(t,5),o=Atomics.load(t,6),n=r+i+o;if(r<0)throw`VEML6040 error: sda=${this.i2c.sda}, scl=${this.i2c.scl} are not connected to a Color Sensor`;let s=.048403*r+.183633*i+-.253589*o,a=.022916*r+.176388*i+-.183205*o,c=-.077436*r+.124541*i+.032081*o;const u=s+a+c+1,l=new Map;s=s/u,a=a/u;const f=(s-.332)/(.1858-a),h=449*f**3+3525*f**2+6823.3*f+5520.33,w=.25168;return l.set("red",r),l.set("green",i),l.set("blue",o),l.set("white",n),l.set("als",i*w),l.set("cct",h),l.toString=function(){return`{${Array.from(this.entries()).map(([P,Ee])=>`'${P}': ${Ee}`).join(", ")}}`},l}classifyHue(t={red:0,yellow:60,green:120,cyan:180,blue:240,magenta:300},r=0){const i=this.readHSV();if(i.val>r){let o="None",n=1/0;for(const[s,a]of Object.entries(t)){const c=Math.min(360-Math.abs(i.hue-a),Math.abs(i.hue-a));c<n&&(n=c,o=s)}return o}else return"None"}readHSV(){const t=this.readRGB();let r=t.get("red"),i=t.get("green"),o=t.get("blue");r=r/256,i=i/256,o=o/256;const n=Math.max(r,i,o),s=Math.min(r,i,o);let[a,c,u]=[n,n,n];const l=n-s;return c=n==0?0:l/n,n==s?a=0:(n==r?a=(i-o)/l+(i<o?6:0):n==i?a=(o-r)/l+2:n==o&&(a=(r-i)/l+4),a/=6),{hue:a*360,sat:c,val:u}}detectColor(){const t=this.readHSV(),{hue:r,sat:i,val:o}=t;return console.log(r),o<.015?"black":i<.15&&o>.75?"white":i<.15&&o<=.75?"gray":r<15||r>=345?"red":r<35?"orange":r<65?"yellow":r<170?"green":r<200?"cyan":r<250?"blue":r<295?"magenta":r<345?"pink":"unknown"}lux(){throw"Not implemented"}}class Ve{constructor(t){m(this,"pin");if(this.pin=$(t),this.pin!==26&&this.pin!==27&&this.pin!==28)throw`Pin(${this.pin}) doesn't have ADC capabilities`}read_u16(){return p({command:"adc read_u16",data:{pin:this.pin}}),Atomics.load(_,1)}}class ze{constructor(t,r,i){m(this,"cs");m(this,"dc");m(this,"rst");m(this,"_text");m(this,"_x");m(this,"_y");this.cs=t,this.dc=r,this.rst=i,this._text="",this._x=0,this._y=0}display_text(t,r,i){this._text=t,this._x=r,this._y=i,p({command:"display_text",data:{text:t,x:r,y:i}})}get text(){return this._text}get x(){return this._x}get y(){return this._y}}const Je=e=>new Ve(e),Ye=e=>new We(e),M={A:[0,1],B:[2,3],D:[4,5],E:[6,7],F:[26,27]},Xe=(e,t=4e5)=>{if(e=e.toUpperCase(),!M[e])throw"Invalid slot. Use A, B, D, E, or F (C is not I2C-compatible)";const[i,o]=M[e],n=["A","D"].includes(e)?0:1;return new He(n,t,i,o)},Ge={0:5,1:3},Ze={0:0,1:2},Ke=(e,{sda:t=Ze[e],scl:r=Ge[e],freq:i=4e5,timeout:o=5e4}={})=>new z(e,t,r,i,o),A=(e,t=F.IN,r=T.NONE)=>new V(e,t,r),Qe=(e,t,r)=>new Ce(e,t,r),et=(e,t,r)=>new ze(e,t,r);A.IN=F.IN;A.OUT=F.OUT;A.PULL_UP=T.UP;A.PULL_DOWN=T.DOWN;const tt=(e="A",t=41)=>{if(e=e.toUpperCase(),!M[e])throw"Invalid slot. Use A, B, D, E, or F (C is not I2C-compatible)";const[i,o]=M[e],n=["A","D"].includes(e)?0:1,s=new z(n,i,o);return new qe(s,t)},rt={Distance:tt},nt={ColorSensor:Xe},it={BME280:Ye,ST7789:et},ot={Pin:A,PWM:Qe,ADC:Je,I2C:Ke},st={display:e=>{p({command:"display_text",data:{text:e,x:0,y:16}})},clear:()=>{p({command:"clear_display"})},LED:e=>A(e,A.OUT)};(async()=>{const e=await ve({stdout:o=>{p({command:"output",data:o+`
\r`})}}),t=new Int32Array(new SharedArrayBuffer(4)),r={sleep:o=>{const n=o*1e3;r.sleep_ms(n)},sleep_ms:o=>{const s=performance.now()+o,a=Math.min(o/20,50);for(;performance.now()<s;){const c=s-performance.now();Atomics.wait(t,0,0,Math.min(a,c)),e.checkInterrupt()}},sleep_us:o=>{r.sleep_ms(o/1e3)},ticks_ms:()=>performance.now(),ticks_us:()=>performance.now()*1e3,ticks_add:Re,ticks_diff:Se,time:()=>Date.now(),time_ns:()=>performance.now()*1e3*1e3};e.registerJsModule("utime",r),e.registerJsModule("machine",ot),e.registerJsModule("artisan",it),e.registerJsModule("distance",rt),e.registerJsModule("colorsensor",nt),e.registerJsModule("rtzero",st),e.setInterruptBuffer(X);const i=`
import time
import utime
time.sleep = utime.sleep
`;self.onmessage=o=>{const{command:n,code:s}=o.data;if(n==="runPython"){if(!e){postMessage({command:"error",error:"Interpreter not initialized"});return}try{e.runPython(i),e.runPython(s),postMessage({command:"finished"})}catch(a){let c="";if(a instanceof Error){const u=a.message.split(`
`),l=u.findIndex(f=>f.includes("<exec>"));l!==-1?c=u.slice(l).filter(f=>!f.includes("mpWorker.ts")&&!/mpWorker-[A-Za-z0-9]+\.js/.test(f)&&!f.includes("pyodide.asm.js")).join(`
`):c=a.message}else c=String(a);postMessage({command:"error",data:c})}}},postMessage({command:"initialized",data:{sharedArrayInterrupt:X,sharedArray:_}})})()});export default at();
