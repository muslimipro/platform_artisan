var dt=Object.defineProperty;var ht=(n,e,t)=>e in n?dt(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var O=(n,e,t)=>ht(n,typeof e!="symbol"?e+"":e,t);import{B as Xe,C as vt,D as mt,E as xe,G as be,H as Re,I as gt,o as b,c as P,F as se,e as fe,h as N,i as Se,m as _e,b as x,a as J,s as He,r as wt,k as h,J as me,j as H,K as re,y as oe,L as yt,p as C,w as U,M as d,n as Z,v as le,N as xt,O as Ae,t as he,P as bt,Q as ne,R as Y,S as We,T as St,V as _t,W as zt,z as ge,X as Ge,Y as Ye,q as de,Z as Et,_ as kt,$ as $t,a0 as ce,a1 as ze,x as Ke,a2 as qe,u as Pt}from"./index-tu3qNG6j.js";import{_ as Lt,a as we,b as Tt,t as Ct,c as Mt,d as Dt,M as It,e as Rt,f as At}from"./QuestionStep.vue_vue_type_script_setup_true_lang-D8JyCPhL.js";import{a as Je,L as Ft,_ as Bt,b as Ot}from"./LocaleSwitcher.vue_vue_type_script_setup_true_lang-DUNicSy-.js";import{s as Ut,a as jt,t as Vt}from"./types-C39Ma9Tn.js";var Nt=function(e){var t=e.dt;return`
.p-splitter {
    display: flex;
    flex-wrap: nowrap;
    border: 1px solid `.concat(t("splitter.border.color"),`;
    background: `).concat(t("splitter.background"),`;
    border-radius: `).concat(t("border.radius.md"),`;
    color: `).concat(t("splitter.color"),`;
}

.p-splitter-vertical {
    flex-direction: column;
}

.p-splitter-gutter {
    flex-grow: 0;
    flex-shrink: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 1;
    background: `).concat(t("splitter.gutter.background"),`;
}

.p-splitter-gutter-handle {
    border-radius: `).concat(t("splitter.handle.border.radius"),`;
    background: `).concat(t("splitter.handle.background"),`;
    transition: outline-color `).concat(t("splitter.transition.duration"),", box-shadow ").concat(t("splitter.transition.duration"),`;
    outline-color: transparent;
}

.p-splitter-gutter-handle:focus-visible {
    box-shadow: `).concat(t("splitter.handle.focus.ring.shadow"),`;
    outline: `).concat(t("splitter.handle.focus.ring.width")," ").concat(t("splitter.handle.focus.ring.style")," ").concat(t("splitter.handle.focus.ring.color"),`;
    outline-offset: `).concat(t("splitter.handle.focus.ring.offset"),`;
}

.p-splitter-horizontal.p-splitter-resizing {
    cursor: col-resize;
    user-select: none;
}

.p-splitter-vertical.p-splitter-resizing {
    cursor: row-resize;
    user-select: none;
}

.p-splitter-horizontal > .p-splitter-gutter > .p-splitter-gutter-handle {
    height: `).concat(t("splitter.handle.size"),`;
    width: 100%;
}

.p-splitter-vertical > .p-splitter-gutter > .p-splitter-gutter-handle {
    width: `).concat(t("splitter.handle.size"),`;
    height: 100%;
}

.p-splitter-horizontal > .p-splitter-gutter {
    cursor: col-resize;
}

.p-splitter-vertical > .p-splitter-gutter {
    cursor: row-resize;
}

.p-splitterpanel {
    flex-grow: 1;
    overflow: hidden;
}

.p-splitterpanel-nested {
    display: flex;
}

.p-splitterpanel .p-splitter {
    flex-grow: 1;
    border: 0 none;
}
`)},Xt={root:function(e){var t=e.props;return["p-splitter p-component","p-splitter-"+t.layout]},gutter:"p-splitter-gutter",gutterHandle:"p-splitter-gutter-handle"},Ht={root:function(e){var t=e.props;return[{display:"flex","flex-wrap":"nowrap"},t.layout==="vertical"?{"flex-direction":"column"}:""]}},Wt=Xe.extend({name:"splitter",theme:Nt,classes:Xt,inlineStyles:Ht}),Gt={name:"BaseSplitter",extends:He,props:{layout:{type:String,default:"horizontal"},gutterSize:{type:Number,default:4},stateKey:{type:String,default:null},stateStorage:{type:String,default:"session"},step:{type:Number,default:5}},style:Wt,provide:function(){return{$pcSplitter:this,$parentInstance:this}}};function Fe(n){return Jt(n)||qt(n)||Kt(n)||Yt()}function Yt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Kt(n,e){if(n){if(typeof n=="string")return $e(n,e);var t={}.toString.call(n).slice(8,-1);return t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set"?Array.from(n):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?$e(n,e):void 0}}function qt(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function Jt(n){if(Array.isArray(n))return $e(n)}function $e(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,s=Array(e);t<e;t++)s[t]=n[t];return s}var Qe={name:"Splitter",extends:Gt,inheritAttrs:!1,emits:["resizestart","resizeend","resize"],dragging:!1,mouseMoveListener:null,mouseUpListener:null,touchMoveListener:null,touchEndListener:null,size:null,gutterElement:null,startPos:null,prevPanelElement:null,nextPanelElement:null,nextPanelSize:null,prevPanelSize:null,panelSizes:null,prevPanelIndex:null,timer:null,mutationObserver:null,data:function(){return{prevSize:null,isRTL:!1}},mounted:function(){this.initializePanels(),this.updateDirection(),this.observeDirectionChanges()},beforeUnmount:function(){this.clear(),this.unbindMouseListeners(),this.mutationObserver&&this.mutationObserver.disconnect()},methods:{updateDirection:function(){this.isRTL=!!this.$el.closest('[dir="rtl"]')},observeDirectionChanges:function(){var e=this,t=document.documentElement,s={attributes:!0,attributeFilter:["dir"]};this.mutationObserver=new MutationObserver(function(){e.updateDirection()}),this.mutationObserver.observe(t,s)},isSplitterPanel:function(e){return e.type.name==="SplitterPanel"},initializePanels:function(){var e=this;if(this.panels&&this.panels.length){var t=!1;if(this.isStateful()&&(t=this.restoreState()),!t){var s=Fe(this.$el.children).filter(function(i){return i.getAttribute("data-pc-name")==="splitterpanel"}),r=[];this.panels.map(function(i,o){var l=i.props&&i.props.size?i.props.size:null,u=l||100/e.panels.length;r[o]=u,s[o].style.flexBasis="calc("+u+"% - "+(e.panels.length-1)*e.gutterSize+"px)"}),this.panelSizes=r,this.prevSize=parseFloat(r[0]).toFixed(4)}}},onResizeStart:function(e,t,s){this.gutterElement=e.currentTarget||e.target.parentElement,this.size=this.horizontal?vt(this.$el):mt(this.$el),s||(this.dragging=!0,this.startPos=this.layout==="horizontal"?e.pageX||e.changedTouches[0].pageX:e.pageY||e.changedTouches[0].pageY),this.prevPanelElement=this.gutterElement.previousElementSibling,this.nextPanelElement=this.gutterElement.nextElementSibling,s?(this.prevPanelSize=this.horizontal?xe(this.prevPanelElement,!0):be(this.prevPanelElement,!0),this.nextPanelSize=this.horizontal?xe(this.nextPanelElement,!0):be(this.nextPanelElement,!0)):(this.prevPanelSize=100*(this.horizontal?xe(this.prevPanelElement,!0):be(this.prevPanelElement,!0))/this.size,this.nextPanelSize=100*(this.horizontal?xe(this.nextPanelElement,!0):be(this.nextPanelElement,!0))/this.size),this.prevPanelIndex=t,this.$emit("resizestart",{originalEvent:e,sizes:this.panelSizes}),this.$refs.gutter[t].setAttribute("data-p-gutter-resizing",!0),this.$el.setAttribute("data-p-resizing",!0)},onResize:function(e,t,s){var r,i,o;s?this.horizontal?(i=100*(this.prevPanelSize+t)/this.size,o=100*(this.nextPanelSize-t)/this.size):(i=100*(this.prevPanelSize-t)/this.size,o=100*(this.nextPanelSize+t)/this.size):(this.horizontal?this.isRTL?r=(this.startPos-e.pageX)*100/this.size:r=(e.pageX-this.startPos)*100/this.size:r=(e.pageY-this.startPos)*100/this.size,i=this.prevPanelSize+r,o=this.nextPanelSize-r),this.validateResize(i,o)&&(this.prevPanelElement.style.flexBasis="calc("+i+"% - "+(this.panels.length-1)*this.gutterSize+"px)",this.nextPanelElement.style.flexBasis="calc("+o+"% - "+(this.panels.length-1)*this.gutterSize+"px)",this.panelSizes[this.prevPanelIndex]=i,this.panelSizes[this.prevPanelIndex+1]=o,this.prevSize=parseFloat(i).toFixed(4)),this.$emit("resize",{originalEvent:e,sizes:this.panelSizes})},onResizeEnd:function(e){this.isStateful()&&this.saveState(),this.$emit("resizeend",{originalEvent:e,sizes:this.panelSizes}),this.$refs.gutter.forEach(function(t){return t.setAttribute("data-p-gutter-resizing",!1)}),this.$el.setAttribute("data-p-resizing",!1),this.clear()},repeat:function(e,t,s){this.onResizeStart(e,t,!0),this.onResize(e,s,!0)},setTimer:function(e,t,s){var r=this;this.timer||(this.timer=setInterval(function(){r.repeat(e,t,s)},40))},clearTimer:function(){this.timer&&(clearInterval(this.timer),this.timer=null)},onGutterKeyUp:function(){this.clearTimer(),this.onResizeEnd()},onGutterKeyDown:function(e,t){switch(e.code){case"ArrowLeft":{this.layout==="horizontal"&&this.setTimer(e,t,this.step*-1),e.preventDefault();break}case"ArrowRight":{this.layout==="horizontal"&&this.setTimer(e,t,this.step),e.preventDefault();break}case"ArrowDown":{this.layout==="vertical"&&this.setTimer(e,t,this.step*-1),e.preventDefault();break}case"ArrowUp":{this.layout==="vertical"&&this.setTimer(e,t,this.step),e.preventDefault();break}}},onGutterMouseDown:function(e,t){this.onResizeStart(e,t),this.bindMouseListeners()},onGutterTouchStart:function(e,t){this.onResizeStart(e,t),this.bindTouchListeners(),e.preventDefault()},onGutterTouchMove:function(e){this.onResize(e),e.preventDefault()},onGutterTouchEnd:function(e){this.onResizeEnd(e),this.unbindTouchListeners(),e.preventDefault()},bindMouseListeners:function(){var e=this;this.mouseMoveListener||(this.mouseMoveListener=function(t){return e.onResize(t)},document.addEventListener("mousemove",this.mouseMoveListener)),this.mouseUpListener||(this.mouseUpListener=function(t){e.onResizeEnd(t),e.unbindMouseListeners()},document.addEventListener("mouseup",this.mouseUpListener))},bindTouchListeners:function(){var e=this;this.touchMoveListener||(this.touchMoveListener=function(t){return e.onResize(t.changedTouches[0])},document.addEventListener("touchmove",this.touchMoveListener)),this.touchEndListener||(this.touchEndListener=function(t){e.resizeEnd(t),e.unbindTouchListeners()},document.addEventListener("touchend",this.touchEndListener))},validateResize:function(e,t){if(e>100||e<0||t>100||t<0)return!1;var s=Re(this.panels[this.prevPanelIndex],"minSize");if(this.panels[this.prevPanelIndex].props&&s&&s>e)return!1;var r=Re(this.panels[this.prevPanelIndex+1],"minSize");return!(this.panels[this.prevPanelIndex+1].props&&r&&r>t)},unbindMouseListeners:function(){this.mouseMoveListener&&(document.removeEventListener("mousemove",this.mouseMoveListener),this.mouseMoveListener=null),this.mouseUpListener&&(document.removeEventListener("mouseup",this.mouseUpListener),this.mouseUpListener=null)},unbindTouchListeners:function(){this.touchMoveListener&&(document.removeEventListener("touchmove",this.touchMoveListener),this.touchMoveListener=null),this.touchEndListener&&(document.removeEventListener("touchend",this.touchEndListener),this.touchEndListener=null)},clear:function(){this.dragging=!1,this.size=null,this.startPos=null,this.prevPanelElement=null,this.nextPanelElement=null,this.prevPanelSize=null,this.nextPanelSize=null,this.gutterElement=null,this.prevPanelIndex=null},isStateful:function(){return this.stateKey!=null},getStorage:function(){switch(this.stateStorage){case"local":return window.localStorage;case"session":return window.sessionStorage;default:throw new Error(this.stateStorage+' is not a valid value for the state storage, supported values are "local" and "session".')}},saveState:function(){gt(this.panelSizes)&&this.getStorage().setItem(this.stateKey,JSON.stringify(this.panelSizes))},restoreState:function(){var e=this,t=this.getStorage(),s=t.getItem(this.stateKey);if(s){this.panelSizes=JSON.parse(s);var r=Fe(this.$el.children).filter(function(i){return i.getAttribute("data-pc-name")==="splitterpanel"});return r.forEach(function(i,o){i.style.flexBasis="calc("+e.panelSizes[o]+"% - "+(e.panels.length-1)*e.gutterSize+"px)"}),!0}return!1},resetState:function(){this.initializePanels()}},computed:{panels:function(){var e=this,t=[];return this.$slots.default().forEach(function(s){e.isSplitterPanel(s)?t.push(s):s.children instanceof Array&&s.children.forEach(function(r){e.isSplitterPanel(r)&&t.push(r)})}),t},gutterStyle:function(){return this.horizontal?{width:this.gutterSize+"px"}:{height:this.gutterSize+"px"}},horizontal:function(){return this.layout==="horizontal"},getPTOptions:function(){var e;return{context:{nested:(e=this.$parentInstance)===null||e===void 0?void 0:e.nestedState}}}}},Qt=["onMousedown","onTouchstart","onTouchmove","onTouchend"],Zt=["aria-orientation","aria-valuenow","onKeydown"];function en(n,e,t,s,r,i){return b(),P("div",_e({class:n.cx("root"),style:n.sx("root"),"data-p-resizing":!1},n.ptmi("root",i.getPTOptions)),[(b(!0),P(se,null,fe(i.panels,function(o,l){return b(),P(se,{key:l},[(b(),N(Se(o),{tabindex:"-1"})),l!==i.panels.length-1?(b(),P("div",_e({key:0,ref_for:!0,ref:"gutter",class:n.cx("gutter"),role:"separator",tabindex:"-1",onMousedown:function(a){return i.onGutterMouseDown(a,l)},onTouchstart:function(a){return i.onGutterTouchStart(a,l)},onTouchmove:function(a){return i.onGutterTouchMove(a,l)},onTouchend:function(a){return i.onGutterTouchEnd(a,l)},"data-p-gutter-resizing":!1},n.ptm("gutter")),[x("div",_e({class:n.cx("gutterHandle"),tabindex:"0",style:[i.gutterStyle],"aria-orientation":n.layout,"aria-valuenow":r.prevSize,onKeyup:e[0]||(e[0]=function(){return i.onGutterKeyUp&&i.onGutterKeyUp.apply(i,arguments)}),onKeydown:function(a){return i.onGutterKeyDown(a,l)},ref_for:!0},n.ptm("gutterHandle")),null,16,Zt)],16,Qt)):J("",!0)],64)}),128))],16)}Qe.render=en;var tn={root:function(e){var t=e.instance;return["p-splitterpanel",{"p-splitterpanel-nested":t.isNested}]}},nn=Xe.extend({name:"splitterpanel",classes:tn}),sn={name:"BaseSplitterPanel",extends:He,props:{size:{type:Number,default:null},minSize:{type:Number,default:null}},style:nn,provide:function(){return{$pcSplitterPanel:this,$parentInstance:this}}},Ze={name:"SplitterPanel",extends:sn,inheritAttrs:!1,data:function(){return{nestedState:null}},computed:{isNested:function(){var e=this;return this.$slots.default().some(function(t){return e.nestedState=t.type.name==="Splitter"?!0:null,e.nestedState})},getPTOptions:function(){return{context:{nested:this.isNested}}}}};function rn(n,e,t,s,r,i){return b(),P("div",_e({ref:"container",class:n.cx("root")},n.ptmi("root",i.getPTOptions)),[wt(n.$slots,"default")],16)}Ze.render=rn;function ke(n){return new Promise(e=>setTimeout(e,n))}class an{constructor(){O(this,"_lock",Promise.resolve());this._lock=Promise.resolve()}acquire(){let e;const t=new Promise(r=>e=r),s=this._lock.then(()=>e);return this._lock=this._lock.then(()=>t),s}}class Te{constructor(){O(this,"mutex");O(this,"inTransaction");O(this,"receivedData");O(this,"activityCallback");O(this,"receiveCallback");O(this,"disconnectCallback");O(this,"writeChunk");O(this,"emit");O(this,"info");O(this,"prevRecvCbk");if(new.target===Te)throw new Error("Cannot instantiate abstract class Transport");this.mutex=new an,this.inTransaction=!1,this.receivedData="",this.activityCallback=()=>{},this.receiveCallback=()=>{},this.disconnectCallback=()=>{},this.prevRecvCbk=e=>{},this.writeChunk=128,this.emit=!1,this.info={}}async getInfo(){return this.info}async write(e){const s=new TextEncoder().encode(e);try{if(s.byteLength==0)await this.writeBytes(s),this.activityCallback();else{let r=0;for(;r<s.byteLength;){const i=s.slice(r,r+this.writeChunk);await this.writeBytes(i),this.activityCallback(),r+=this.writeChunk}}}catch(r){throw r}}onActivity(e){this.activityCallback=e}onReceive(e){this.receiveCallback=e}onDisconnect(e){this.disconnectCallback=e}async startTransaction(){await ke(10);const e=await this.mutex.acquire();return this.prevRecvCbk=this.receiveCallback,this.inTransaction=!0,this.receivedData="",this.receiveCallback=t=>{this.receivedData+=t,this.emit&&this.prevRecvCbk&&this.prevRecvCbk(t)},()=>{this.prevRecvCbk&&(this.receiveCallback=this.prevRecvCbk,this.receiveCallback(this.receivedData)),this.receivedData="",this.inTransaction=!1,e()}}async readExactly(e,t=5e3){if(!this.inTransaction)throw new Error("Not in transaction");let s=Date.now()+t;for(;t<=0||Date.now()<s;){if(this.receivedData.length>=e){const i=this.receivedData.substring(0,e);return this.receivedData=this.receivedData.substring(e),i}const r=this.receivedData.length;await ke(10),this.receivedData.length>r&&(s=Date.now()+t)}throw new Error("Timeout")}async readUntil(e,t=5e3){if(!this.inTransaction)throw new Error("Not in transaction");const s=Date.now();let r=0;for(;t<=0||r<t;){const i=this.receivedData.indexOf(e)+e.length;if(i>=e.length){const o=this.receivedData.substring(0,i);return this.receivedData=this.receivedData.substring(i),o}await ke(10),r=Date.now()-s}throw new Error("Timeout reached before finding the ending sequence")}}class on extends Te{constructor(){super();O(this,"port");O(this,"reader");O(this,"writer");O(this,"serial");if(this.port=void 0,this.reader=null,this.writer=null,"serial"in navigator)this.serial=navigator.serial;else throw new Error("WebSerial not available")}async requestAccess(){var i,o,l,u;const r={filters:[{usbVendorId:11914,usbProductId:5}]};this.port=await((i=this.serial)==null?void 0:i.requestPort(r));try{const a=(o=this.port)==null?void 0:o.getInfo();this.info={vid:(l=a==null?void 0:a.usbVendorId)==null?void 0:l.toString(16).padStart(4,"0"),pid:(u=a==null?void 0:a.usbProductId)==null?void 0:u.toString(16).padStart(4,"0")}}catch(a){throw a}}async connect(){var t,s;if(!this.port)throw new Error("Port is not available");await this.port.open({baudRate:115200}),this.reader=((t=this.port.readable)==null?void 0:t.getReader())||null,this.writer=((s=this.port.writable)==null?void 0:s.getWriter())||null,this.reader&&this.listen()}async disconnect(){if(!this.reader||!this.port)throw new Error("No active connection to disconnect from");try{await this.reader.cancel()}catch{}await this.port.forget()}async writeBytes(t){if(!this.writer)throw new Error("Writer is not initialized");await this.writer.write(t)}async listen(){if(!this.reader)throw new Error("Reader is not initialized");const t=new TextDecoder;await this.write(""),await this.write("");try{for(;;){const{value:s,done:r}=await this.reader.read();if(r||!s)break;this.receiveCallback(t.decode(s))}}catch(s){throw console.log("disconnect callback"),this.disconnectCallback(),s}}async flushInput(){if(!this.reader)throw new Error("Reader is not initialized");this.receivedData=""}}class ae{constructor(e){O(this,"port");O(this,"end");this.port=e,this.end=async()=>{}}static async begin(e,t=!1){var r;const s=new ae(e);await s.enterRawRepl(t);try{await s.exec("import sys,os")}catch(i){throw await((r=s.end)==null?void 0:r.call(s)),i}return s}async interruptProgram(){await this.port.write("")}async enterRawRepl(e=!1){const t=await this.port.startTransaction();try{await this.interruptProgram(),await this.port.flushInput(),await this.port.write("\r"),await this.port.readUntil(`raw REPL; CTRL-B to exit\r
`),e&&(await this.port.write(""),await this.port.readUntil("OK")),this.end=async()=>{try{await this.port.write(""),await this.port.readUntil(`>\r
`),await this.port.readUntil(">>> ")}finally{t()}}}catch(s){throw t(),s}}async exec(e,t=5e3,s=!1){if(e.length===0)return"";await this.port.write(e),await this.port.write(""),await this.port.readUntil("OK"),this.port.emit=s,s&&this.port.prevRecvCbk(this.port.receivedData);const r=(await this.port.readUntil("",t)).slice(0,-1),i=(await this.port.readUntil("",t)).slice(0,-1);if(i.length)throw new Error(i);return r}async readFile(e){const t=await this.exec(`
try:
 import binascii
 h=lambda x: binascii.hexlify(x).decode()
 h(b'')
except:
 h=lambda b: ''.join('{:02x}'.format(byte) for byte in b)
with open('${e}','rb') as f:
 while 1:
  b=f.read(64)
  if not b:break
  print(h(b),end='')
`);return t.length?new Uint8Array(t.match(/../g).map(s=>parseInt(s,16))):new Uint8Array}async writeFile(e,t,s=128,r=!1){if(typeof t=="string"){const u=new TextEncoder;t=new Uint8Array(u.encode(t))}const i=u=>Array.from(u).map(a=>a.toString(16).padStart(2,"0")).join(""),o=u=>{u=new Uint8Array(u);let a="b'";for(const p of u)p>=32&&p<=126?p===92||p===39?a+="\\"+String.fromCharCode(p):a+=String.fromCharCode(p):a+="\\x"+p.toString(16).padStart(2,"0");return a+="'",a},l=r?e:".viper.tmp";await this.exec(`
try:
 import binascii
 h=binascii.unhexlify
 h('')
except:
 h=lambda s: bytes(int(s[i:i+2], 16) for i in range(0, len(s), 2))
f=open('${l}','wb')
w=lambda d: f.write(h(d))
o=f.write
`);for(let u=0;u<t.byteLength;u+=s){const a=t.slice(u,u+s),p="w('"+i(a)+"')",v="o("+o(a)+")";p.length<v.length?await this.exec(p):await this.exec(v)}r?await this.exec("f.close()"):await this.exec(`f.close()
try: os.remove('${e}')
except: pass
os.rename('${l}','${e}')
`)}async getDeviceInfo(){const e=await this.exec(`
try: u=os.uname()
except: u=('','','','',sys.platform)
try: v=sys.version.split(';')[1].strip()
except: v='MicroPython '+u[2]
mpy=getattr(sys.implementation, '_mpy', 0)
sp=':'.join(sys.path)
d=[u[4],u[2],u[0],v,mpy>>10,mpy&0xFF,(mpy>>8)&3,sp]
print('|'.join(str(x) for x in d))
`);let[t,s,r,i,o,l,u,a]=e.trim().split("|");const p=a.split(":");try{o=["","x86","x64","armv6","armv6m","armv7m","armv7em","armv7emsp","armv7emdp","xtensa","xtensawin","rv32imc"][parseInt(o)]}catch{o=""}let v=parseInt(l,10);const m=parseInt(u,10);return v||(v="py"),{machine:t,release:s,sysname:r,version:i,mpy_arch:o,mpy_ver:v,mpy_sub:m,sys_path:p}}async touchFile(e){await this.exec(`
f=open('${e}','wb')
f.close()
`)}async moveFile(e,t){await this.exec(`os.rename('${e}', '${t}')`)}async makeDir(e){await this.exec(`os.mkdir('${e}')`)}async makePath(e){await this.exec(`
p=''
for d in '${e}'.split('/'):
 if not d: continue
 p += '/'+d
 try: os.mkdir(p)
 except OSError as e:
  if e.args[0] not in (17, 20): raise
`)}async removeFile(e){await this.exec(`
try:
 os.remove('${e}')
except OSError as e:
 if e.args[0] == 39:
  throw new Error('Directory not empty')
 else:
  throw e
`)}async removeDir(e){await this.exec(`
try:
 os.rmdir('${e}')
except OSError as e:
 if e.args[0] == 39:
  throw new Error('Directory not empty')
 else:
  throw e
`)}async getFsStats(e="/"){return(await this.exec(`
s = os.statvfs('${e}')
fs = s[1] * s[2]
ff = s[3] * s[0]
fu = fs - ff
print('%s|%s|%s'%(fu,ff,fs))
`)).trim().split("|")}async getFiles(){return await this.exec(`
def walk(p):
 for n in os.listdir(p if p else '/'):
  fn=p+'/'+n
  try: s=os.stat(fn)
  except: s=(0,)*7
  try:
   if s[0] & 0x4000 == 0:
    print('f|'+fn+'|'+str(s[6]))
   elif n not in ('.','..'):
    print('d|'+fn+'|'+str(s[6]))
    walk(fn)
  except:
   print('f|'+p+'/???|'+str(s[6]))
walk('')
`)}async readSysInfoMD(){return await this.exec(`
import gc
gc.collect()
mu = gc.mem_alloc()
mf = gc.mem_free()
ms = mu + mf
uname=os.uname()
p=print
def size_fmt(size):
 suffixes = ['B','KiB','MiB','GiB','TiB']
 i = 0
 while size > 1024 and i < len(suffixes)-1:
  i += 1
  size //= 1024
 return "%d%s" % (size, suffixes[i])
p('## Machine')
p('- Name: \`'+uname.machine+'\`')
try:
 gc.collect()
 import microcontroller as uc
 p('- CPU: \`%s @ %s MHz\`' % (sys.platform, uc.cpu.frequency // 1_000_000))
 p('- UID: \`%s\`' % (uc.cpu.uid.hex(),))
 p('- Temp.: \`%s °C\`' % (uc.cpu.temperature,))
 p('- Voltage: \`%s V\`' % (uc.cpu.voltage,))
except:
 try:
  gc.collect()
  import machine
  p('- CPU: \`%s @ %s MHz\`' % (sys.platform, machine.freq() // 1_000_000))
 except:
  p('- CPU: \`'+sys.platform+'\`')
p()
p('## System')
p('- Version: \`'+sys.version.split(";")[1].strip()+'\`')
if ms:
 p('- Memory use:  \`%s / %s, free: %d%%\`' % (size_fmt(mu), size_fmt(ms), (mf * 100) // ms))
`)}}const Pe=h(!1);h(st());const G=h(!1),ln=h(!1),un=h(),j=h(!1),Be=h(!1),et=h(!1),tt=h(),ve=h(!1),Oe=h(!1),cn=h(!1),pn=h(),ie=h(!1),Ue=h(!1),fn=h(!1),dn=h();let A=null;function hn(n){return new Promise(e=>setTimeout(e,n))}async function vn(n){try{ve.value=!0,Oe.value=!1,await n(),Oe.value=!0}catch(e){cn.value=!0,pn.value=e}finally{ve.value=!1}}async function mn(n){try{ie.value=!0,Ue.value=!1,await n(),Ue.value=!0}catch(e){fn.value=!0,dn.value=e}finally{ie.value=!1}}function ue(n){return"children"in n}function nt(n){if(n){n.children.sort((e,t)=>ue(e)&&!ue(t)?-1:!ue(e)&&ue(t)?1:e.name.localeCompare(t.name));for(const e of n.children)ue(e)&&nt(e)}}async function gn(){if(!A)return{name:"",path:"",children:[]};const n=await ae.begin(A,!0),e=await n.getFiles();await n.end();const t=wn(e);return nt(t),t}function wn(n){const e={name:"",path:"",children:[]},t=n.trim().split(`
`),s={"":e};for(const r of t){const[i,o,l]=r.split("|"),u=o.split("/"),a=u[u.length-1],p=u.slice(0,-1).join("/")||"";if(i==="f"){const v={name:a,path:o,size:parseInt(l)};s[p]&&s[p].children.push(v)}else if(i==="d"){const v={name:a,path:o,children:[]};s[o]=v,s[p]&&s[p].children.push(v)}}return e}function je(n,e){let t=!1;const s=n.trim().split(`
`),r=i=>{const[o,l,u]=i.split("|");return l===e};return s.find(r)&&(t=!0),t}function st(){return/(iPad|iPhone|iPod)/g.test(navigator.userAgent)?(console.error("WebSerial is not available on iOS"),!1):window.isSecureContext?"serial"in navigator||"usb"in navigator?!0:(console.error("Try Chrome, Edge, Opera, Brave","WebSerial and WebUSB are not supported"),!1):(console.error("WebSerial cannot be accessed with unsecure connection"),!1)}async function yn(){let n;if(n=new on,!st())return null;try{await n.requestAccess()}catch(e){return un.value=e,null}return n}async function xn(n,e,t){try{await n.connect(),G.value=!0}catch{Pe.value=!1,G.value=!1,j.value=!1,ie.value=!1,ve.value=!1,ln.value=!0;return}n.onReceive(e),n.onDisconnect(()=>{t(),G.value=!1,j.value=!1,ie.value=!1,ve.value=!1,Pe.value=!1}),A=n}async function bn(){A==null||A.disconnect(),A=null,Pe.value=!1,G.value=!1,j.value=!1,ve.value=!1,ie.value=!1}async function Sn(n){if(A)if(j.value)await A.write(n);else{const e=await A.mutex.acquire();try{await A.write(n)}finally{e()}}}async function _n(){if(!A)return"";try{await A.write("\r"),j.value=!1}catch(n){et.value=!0,j.value=!1,tt.value=n}}async function zn(n){if(!A||(j.value&&await A.write("\r"),n.length===0))return;const e=!0,t=-1,s=await ae.begin(A,e);try{Be.value=!1,j.value=!0;const r=!0;await hn(10),await s.exec(n,t,r),Be.value=!0}catch(r){let i;r instanceof Error?i=r.message:i=String(r),i.includes("KeyboardInterrupt")||(et.value=!0,tt.value=r)}finally{A.emit=!1,j.value=!1}await s.end()}async function Le(n){if(!A)return"";let e="";const t=await ae.begin(A);return await vn(async()=>{const s=await t.readFile(n);e=new TextDecoder("utf-8",{fatal:!0}).decode(s)}),t.end(),e}async function En(){if(!A)return"";const n=await ae.begin(A),e=await n.getFiles();await n.end();let t="";return je(e,"/main.py")?t=await Le("/main.py"):je(e,"/code.py")?t=await Le("/code.py"):(t="",await it("/main.py",t)),t}async function it(n,e){if(!A)return;const t=await ae.begin(A);await mn(async()=>await t.writeFile(n,e)),t.end()}const Ce=me("useTerminalStore",()=>{const n=h("");let e="",t=65536,s=null;const r=h(0);let i=null;const o=m=>{for(let f=0;f<m.length;f++){let c=m[f];c==="\b"?r.value=Math.max(0,r.value-1):c==="\x1B"?(c=m[++f],c==="["&&(c=m[++f],c==="K"&&(e=e.slice(0,r.value)+n.value.slice(r.value+1),l()))):(e+=c,e.length>t&&(e=e.slice(e.length-t,e.length)),l())}},l=()=>{s||(s=setTimeout(()=>{u(),s=null},1))},u=()=>{n.value=e,r.value=n.value.length,p()},a=()=>{n.value="",e="",r.value=0,s&&(clearTimeout(s),s=null)},p=()=>{i&&(i.scrollTop=i.scrollHeight)};return{output:n,caret:r,write:o,clear:a,openTerminal:m=>{i=m}}}),Me=me("useMPDeviceStore",()=>{const n=h(localStorage.getItem("fileContent")||""),e=h(""),t=h(""),s=h(!1),r=h([]),i=h({name:"",path:"",children:[]});async function o(a,p){r.value=[a],t.value=a,n.value=p}async function l(a){r.value=[a],t.value=a,n.value=await Le(a)}function u(a){n.value=a}return{isProject:s,activeFiles:r,fileContent:n,fileName:e,filePath:t,fileTree:i,openFile:o,loadFile:l,setCode:u}}),kn={key:0,class:"material-icons"},$n={key:1,class:"material-icons"},Pn=H({__name:"IdeButtons",setup(n){const e=Me(),t=Ce(),{isProject:s,filePath:r,fileContent:i,fileTree:o}=re(e),{openFile:l}=e;let u=null;oe(()=>{s.value||(u=setInterval(()=>{localStorage.setItem("fileContent",i.value)},1e3))}),yt(()=>{u&&clearInterval(u)});async function a(){const f=await yn();if(f&&(await xn(f,t.write,()=>{s.value&&(r.value="",i.value=""),o.value={name:"empty",path:"",children:[]}}),t.clear(),s.value)){const c=await En();l("/main.py",c),o.value=await gn()}}function p(){G.value?(bn(),s.value&&(r.value="",i.value="",o.value={name:"empty",path:"",children:[]})):a()}const v=h(!1);function m(){zn(i.value)}return(f,c)=>{const _=le;return b(),P("div",null,[C(_,{type:"button",class:Z(["w-9 h-9 mr-1 text-white",d(G)?v.value?"bg-red-500":"bg-green-500":"bg-gray-600"]),rounded:"",text:"",onClick:c[0]||(c[0]=z=>p()),onMouseover:c[1]||(c[1]=z=>v.value=!0),onMouseleave:c[2]||(c[2]=z=>v.value=!1)},{default:U(()=>[v.value&&d(G)?(b(),P("span",kn,"close")):(b(),P("span",$n,"cable"))]),_:1},8,["class"]),C(_,{id:"#run",type:"button",class:"w-9 h-9 mr-1",variant:d(j)||!d(G)?"outlined":void 0,severity:"info",rounded:"",onClick:m,disabled:d(j)||!d(G),loading:d(j)},{default:U(()=>c[5]||(c[5]=[x("span",{class:"material-icons"},"play_arrow",-1)])),_:1},8,["variant","disabled","loading"]),C(_,{type:"button",class:"w-9 h-9 mr-1",variant:!d(j)||!d(G)?"outlined":void 0,severity:"danger",rounded:"",onClick:c[3]||(c[3]=z=>d(_n)()),disabled:!d(j)||!d(G)},{default:U(()=>c[6]||(c[6]=[x("span",{class:"material-icons"},"stop",-1)])),_:1},8,["variant","disabled"]),C(_,{type:"button",class:"w-9 h-9",variant:"outlined",severity:"secondary",rounded:"",onClick:c[4]||(c[4]=z=>d(it)(d(r),d(i))),disabled:d(ie)||d(j)||!d(G),loading:d(ie)},{default:U(()=>c[7]||(c[7]=[x("span",{class:"material-icons"},"save",-1)])),_:1},8,["disabled","loading"])])}}}),Ln={class:"relative flex h-full"},Tn=H({__name:"CodeView",setup(n){const e=Me(),{fileContent:t}=re(e);return(s,r)=>(b(),P("div",Ln,[C(Lt,{modelValue:d(t),"onUpdate:modelValue":r[0]||(r[0]=i=>xt(t)?t.value=i:null)},null,8,["modelValue"]),r[1]||(r[1]=x("div",{id:"#editor",class:"absolute top-10 left-10"},null,-1)),C(Pn,{class:"absolute bottom-2 right-2"})]))}}),Cn={class:"flex flex-col h-full"},Mn={class:"flex px-2 w-full bg-zinc-900 text-white h-6 justify-between items-center"},Dn=H({__name:"TerminalView",setup(n){const e=h(!1),t=Ce(),{output:s}=re(t);function r(o){let l=o.key;if(l==="Enter")l=`
\r`;else if(l==="Backspace")l="\b";else if(l.length>1)return;Sn(l)}const i=h(null);return oe(()=>{t.openTerminal(i.value)}),(o,l)=>{const u=le;return b(),P("div",Cn,[x("div",Mn,[l[4]||(l[4]=x("span",{class:"material-icons"},"terminal",-1)),C(u,{onClick:l[0]||(l[0]=a=>d(t).clear()),class:"w-4 h-4 text-white",link:""},{default:U(()=>l[3]||(l[3]=[x("span",{class:"material-icons",style:{"font-size":"16px"}},"cleaning_services",-1)])),_:1})]),x("pre",{class:"h-full font-mono overflow-auto p-2 text-white bg-black",ref_key:"el",ref:i,tabindex:"0",onKeydown:r,onFocus:l[1]||(l[1]=a=>e.value=!0),onBlur:l[2]||(l[2]=a=>e.value=!1)},[l[5]||(l[5]=Ae("      ")),x("span",null,he(d(s)),1),x("span",{class:Z([{caret:e.value},"bg-white"])}," ",2),l[6]||(l[6]=Ae(`
    `))],544)])}}}),In=we(Dn,[["__scopeId","data-v-e7400225"]]),Rn="/assets/pibody-yUFwsQv7.png",An={class:"color-picker select-none w-32"},Fn={class:"slider-container"},Bn={class:"slider-container"},On=H({__name:"ColorPicker",props:{modelValue:{required:!0,default:{r:0,g:0,b:0}},modelModifiers:{}},emits:["update:modelValue"],setup(n){const e=bt(n,"modelValue"),{h:t,s}=p(e.value.r,e.value.g,e.value.b),r=h(t/360),i=h(),o=h(s/100),l=h();let u=!1,a=!1;function p(g,w,M){g/=255,w/=255,M/=255;const y=Math.max(g,w,M),D=Math.min(g,w,M),V=y-D;let B=0;V!==0&&(y===g?B=(w-M)/V%6:y===w?B=(M-g)/V+2:B=(g-w)/V+4,B=Math.round(B*60),B<0&&(B+=360));const W=(y+D)/2,K=V===0?0:V/(1-Math.abs(2*W-1));return{h:B,s:K*100,l:W*100}}function v(g,w,M){g=g*360%360,w/=100,M/=100;const y=(1-Math.abs(2*M-1))*w,D=y*(1-Math.abs(g/60%2-1)),V=M-y/2;let B=0,W=0,K=0;return 0<=g&&g<60?(B=y,W=D,K=0):60<=g&&g<120?(B=D,W=y,K=0):120<=g&&g<180?(B=0,W=y,K=D):180<=g&&g<240?(B=0,W=D,K=y):240<=g&&g<300?(B=D,W=0,K=y):300<=g&&g<=360&&(B=y,W=0,K=D),{r:Math.round((B+V)*255),g:Math.round((W+V)*255),b:Math.round((K+V)*255)}}function m(g,w,M){const y=(1-M+w)/2;let D;return y===0||y===1?D=0:D=(1-M-w)/(1-Math.abs(2*y-1)),{h:g,s:D*100,l:y*100}}const f=ne(()=>{const{h:g,s:w,l:M}=m(r.value,1-o.value,0),{r:y,g:D,b:V}=v(g,w,M);return e.value={r:y,g:D,b:V},`hsl(${g}turn, ${w}%, ${M}%)`}),c=g=>{a=!a,z(g),window.addEventListener("pointermove",z),window.addEventListener("pointerup",_)},_=()=>{a=!1,window.removeEventListener("pointermove",z),window.removeEventListener("pointerup",_)},z=g=>{if(a){const w=l.value.getBoundingClientRect(),M=Math.min(w.width,Math.max(0,g.clientX-w.left));o.value=M/w.width}},I=g=>{u=!u,E(g),window.addEventListener("pointermove",E),window.addEventListener("pointerup",F)},F=()=>{u=!1,window.removeEventListener("pointermove",E),window.removeEventListener("pointerup",F)},E=g=>{if(u){const w=i.value.getBoundingClientRect(),M=Math.min(w.width,Math.max(0,g.clientX-w.left));r.value=M/w.width}};return(g,w)=>(b(),P("div",An,[x("div",Fn,[x("div",{class:"hue-slider",style:{background:"linear-gradient(to right, red, yellow, lime, cyan, blue, magenta, red)"},onPointerdown:I,onPointerup:F,onPointermove:E,ref_key:"hueRef",ref:i},[x("div",{class:"slider-handle",style:Y({left:`${r.value*100}%`})},null,4)],544)]),x("div",Bn,[x("div",{class:"saturation-slider",style:Y({background:`linear-gradient(to right, white, hsl(${r.value}turn, 100%, 50%))`}),onPointerdown:c,onPointerup:_,onPointermove:z,ref_key:"saturationRef",ref:l},[x("div",{class:"slider-handle",style:Y({left:`${o.value*100}%`})},null,4)],36)]),We(x("div",{class:"color-preview",style:Y({backgroundColor:`${f.value}`})},null,4),[[St,!1]])]))}}),Un=we(On,[["__scopeId","data-v-53a96f93"]]);function jn(n){return _t()?(zt(n),!0):!1}const Vn=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const Nn=Object.prototype.toString,Xn=n=>Nn.call(n)==="[object Object]",Hn=()=>{};function Ve(n){return Array.isArray(n)?n:[n]}const De=Vn?window:void 0;function rt(n){var e;const t=Ge(n);return(e=t==null?void 0:t.$el)!=null?e:t}function pe(...n){let e,t,s,r;if(typeof n[0]=="string"||Array.isArray(n[0])?([t,s,r]=n,e=De):[e,t,s,r]=n,!e)return Hn;t=Ve(t),s=Ve(s);const i=[],o=()=>{i.forEach(p=>p()),i.length=0},l=(p,v,m,f)=>(p.addEventListener(v,m,f),()=>p.removeEventListener(v,m,f)),u=ge(()=>[rt(e),Ge(r)],([p,v])=>{if(o(),!p)return;const m=Xn(v)?{...v}:v;i.push(...t.flatMap(f=>s.map(c=>l(p,f,c,m))))},{immediate:!0,flush:"post"}),a=()=>{u(),o()};return jn(a),a}const Wn={page:n=>[n.pageX,n.pageY],client:n=>[n.clientX,n.clientY],screen:n=>[n.screenX,n.screenY],movement:n=>n instanceof Touch?null:[n.movementX,n.movementY]};function Gn(n={}){const{type:e="page",touch:t=!0,resetOnTouchEnds:s=!1,initialValue:r={x:0,y:0},window:i=De,target:o=i,scroll:l=!0,eventFilter:u}=n;let a=null,p=0,v=0;const m=h(r.x),f=h(r.y),c=h(null),_=typeof e=="function"?e:Wn[e],z=y=>{const D=_(y);a=y,D&&([m.value,f.value]=D,c.value="mouse"),i&&(p=i.scrollX,v=i.scrollY)},I=y=>{if(y.touches.length>0){const D=_(y.touches[0]);D&&([m.value,f.value]=D,c.value="touch")}},F=()=>{if(!a||!i)return;const y=_(a);a instanceof MouseEvent&&y&&(m.value=y[0]+i.scrollX-p,f.value=y[1]+i.scrollY-v)},E=()=>{m.value=r.x,f.value=r.y},g=u?y=>u(()=>z(y),{}):y=>z(y),w=u?y=>u(()=>I(y),{}):y=>I(y),M=u?()=>u(()=>F(),{}):()=>F();if(o){const y={passive:!0};pe(o,["mousemove","dragover"],g,y),t&&e!=="movement"&&(pe(o,["touchstart","touchmove"],w,y),s&&pe(o,"touchend",E,y)),l&&e==="page"&&pe(i,"scroll",M,{passive:!0})}return{x:m,y:f,sourceType:c}}function at(n,e={}){const{handleOutside:t=!0,window:s=De}=e,r=e.type||"page",{x:i,y:o,sourceType:l}=Gn(e),u=h(n??(s==null?void 0:s.document.body)),a=h(0),p=h(0),v=h(0),m=h(0),f=h(0),c=h(0),_=h(!0);let z=()=>{};return s&&(z=ge([u,i,o],()=>{const I=rt(u);if(!I||!(I instanceof Element))return;const{left:F,top:E,width:g,height:w}=I.getBoundingClientRect();v.value=F+(r==="page"?s.pageXOffset:0),m.value=E+(r==="page"?s.pageYOffset:0),f.value=w,c.value=g;const M=i.value-v.value,y=o.value-m.value;_.value=g===0||w===0||M<0||y<0||M>g||y>w,(t||!_.value)&&(a.value=M,p.value=y)},{immediate:!0}),pe(document,"mouseleave",()=>{_.value=!0})),{x:i,y:o,sourceType:l,elementX:a,elementY:p,elementPositionX:v,elementPositionY:m,elementHeight:f,elementWidth:c,isOutside:_,stop:z}}const Yn="/assets/yellow_led-TydLrbQ8.jpg";function ee(n){return{state:h(0),mode:n}}const Kn={ref:"theref"},qn={class:"rounded-lg overflow-hidden relative"},Jn=["src"],Qn={key:1,class:"absolute top-0 left-0"},Zn=H({__name:"LED",setup(n,{expose:e}){const{isOutside:t}=at(Ye("theref")),s=h({r:255,g:0,b:0}),r=h({visible:!1,toggle:f=>{}});function i(f){s.value=f.color.value}function o(f){r.value.toggle(f)}const l=ne(()=>`
0 0 3px 3px rgba(${s.value.r}, ${s.value.g}, ${s.value.b}, ${v.state.value*.7}),
0 0 5px 5px rgba(${s.value.r}, ${s.value.g}, ${s.value.b}, ${v.state.value*.5}),
0 0 7px 7px rgba(${s.value.r}, ${s.value.g}, ${s.value.b}, ${v.state.value*.3})
`),u=ne(()=>`radial-gradient(circle, rgb(${s.value.r}, ${s.value.g}, ${s.value.b}) 40%, #000 90%)`),a=ne(()=>`rgb(${s.value.r}, ${s.value.g}, ${s.value.b})`),p=ne(()=>`rgba(${s.value.r}, ${s.value.g}, ${s.value.b}, 0.7)`),v=ee("output"),m=ee("air");return e({pin2:v,pin3:m,updateSettings:i,settings:{color:s}}),(f,c)=>{const _=le,z=Et;return b(),P("div",Kn,[x("div",qn,[x("img",{src:d(Yn),alt:"LED"},null,8,Jn),x("div",{class:"absolute top-[10px] left-[30px] rounded-full h-[19px] w-[19px]",style:Y({background:a.value})},null,4),x("div",{class:"absolute top-[12px] left-[32px] rounded-full h-[15px] w-[15px]",style:Y({background:u.value})},null,4),d(v).state.value?(b(),P("div",{key:0,class:"absolute top-2 left-7 rounded-full h-6 w-6 p-0 border-none absolute top-0 left-0 overflow-hidden",style:Y({boxShadow:l.value,background:p.value})},null,4)):J("",!0),!d(t)||r.value.visible?(b(),P("div",Qn,[C(_,{type:"button",class:"w-6 h-6 bg-black",rounded:"",onClick:o,onPointerdown:c[0]||(c[0]=de(()=>{},["stop"]))},{default:U(()=>c[2]||(c[2]=[x("span",{class:"material-icons"},"palette",-1)])),_:1})])):J("",!0),C(z,{ref_key:"cp",ref:r},{default:U(()=>[C(Un,{modelValue:s.value,"onUpdate:modelValue":c[1]||(c[1]=I=>s.value=I)},null,8,["modelValue"])]),_:1},512)])],512)}}}),es=we(Zn,[["__scopeId","data-v-1fc5df45"]]),ts="/assets/push_button-DvCvYEel.jpg",ns={ref:"theref"},ss={class:"rounded-lg overflow-hidden relative"},is=["src"],rs=H({__name:"PushButton",setup(n,{expose:e}){const{isOutside:t}=at(Ye("theref")),s=ee("input"),r=ee("air"),i=h(""),o=h(!1);function l(m){i.value=m.shortcut.value}const u=m=>{!o.value&&m.key.toUpperCase()===i.value&&(s.state.value=1)},a=m=>{!o.value&&m.key.toUpperCase()===i.value&&(s.state.value=0)},p=m=>{o.value&&m.key==="Escape"&&(i.value="",o.value=!1,window.removeEventListener("keydown",p)),o.value&&/^[A-Za-z0-9]$/.test(m.key)&&(i.value=m.key.toUpperCase(),o.value=!1,window.removeEventListener("keydown",p))},v=m=>{m.stopPropagation(),o.value=!0,window.addEventListener("keydown",p)};return oe(()=>{window.addEventListener("keydown",u),window.addEventListener("keyup",a)}),kt(()=>{window.removeEventListener("keydown",u),window.removeEventListener("keyup",a)}),e({pin2:s,pin3:r,updateSettings:l,settings:{shortcut:i}}),(m,f)=>(b(),P("div",ns,[x("div",ss,[x("img",{src:d(ts),alt:"Push Button"},null,8,is),x("button",{class:Z(["absolute top-[27px] left-[27px] rounded-full w-[25px] h-[25px]",d(s).state.value?"bg-green-500":"bg-purple-500"]),onPointerdown:f[0]||(f[0]=c=>d(s).state.value=1),onPointerup:f[1]||(f[1]=c=>d(s).state.value=0),onPointerleave:f[2]||(f[2]=c=>d(s).state.value=0)},he(i.value),35),!d(t)||o.value?(b(),P("button",{key:0,onClick:v,onPointerdown:f[3]||(f[3]=de(()=>{},["stop"])),class:"absolute w-full h-4 text-xs top-0 left-0 bg-black/[0.8] text-white rounded-lg"},he(o.value?"Press a key...":i.value?"Set shortcut":"Add shortcut"),33)):J("",!0)])],512))}}),as="/assets/potentiometer-CklP_JJ1.jpg",os={class:"rounded-lg overflow-hidden relative"},ls=["src"],us={class:"absolute rounded-full top-5 left-8 w-10 h-10"},cs={key:0,class:"absolute bottom-0 left-0 flex items-center"},ps=H({__name:"Potentiometer",setup(n,{expose:e}){const t=ne(()=>a.state.value*270-135),s=h(!1);let r=!1,i=0;const o=m=>{m.stopPropagation(),r=!r,i=m.clientX,s.value=r,window.addEventListener("pointermove",u),window.addEventListener("pointerup",l)},l=()=>{r=!1,s.value=r,window.removeEventListener("pointermove",u),window.removeEventListener("pointerup",l)},u=m=>{if(r){const f=(m.clientX-i)/20;i=m.clientX,a.state.value=Math.min(1,Math.max(0,a.state.value+f/2))}},a=ee("input"),p=ee("air");function v(m){a.state.value=m.rotation.value}return e({pin2:a,pin3:p,updateSettings:v,settings:{rotation:a.state}}),(m,f)=>(b(),P("div",null,[x("div",os,[x("img",{src:d(as),alt:"Potentiometer"},null,8,ls),x("button",us,[x("div",null,[x("div",{class:"top-0 left-0 relative w-10 h-10 rounded-full bg-rose-600 flex items-center justify-center",onPointerdown:o,style:Y(`transform: rotate(${t.value}deg)`)},f[1]||(f[1]=[x("div",{class:"absolute top-0 left-4.5 w-1 h-5 bg-white"},null,-1),x("div",{class:"absolute inset-0 flex items-center justify-center pointer-events-none"},null,-1)]),36)])]),s.value?(b(),P("div",cs,[We(x("input",{type:"range",min:"0",max:"1",step:"0.01","onUpdate:modelValue":f[0]||(f[0]=c=>d(a).state.value=c),class:"w-full cursor-pointer"},null,512),[[$t,d(a).state.value]])])):J("",!0)])]))}}),fs=H({__name:"Module",setup(n,{expose:e}){const t=ee("air"),s=ee("air");return e({pin2:t,pin3:s}),(r,i)=>(b(),P("div"))}}),Ne=Ce(),{fileContent:ds}=re(Me()),hs=(n,e)=>{const t=Math.max(0,Math.min(n.x+n.w,e.x+e.w)-Math.max(n.x,e.x)),s=Math.max(0,Math.min(n.y+n.h,e.y+e.h)-Math.max(n.y,e.y));return t*s},vs=me("emulator",()=>{const e={x:0,y:0,w:0,h:0,is:fs,on:-1,ref:{pin2:{state:{value:0},mode:"none"},pin3:{state:{value:0},mode:"none"}},style:{},class:""},t=ot(),s=ce([es,rs,ps]),r=ce([]),i=h(!1),o=h(null),l=h(null),u=h(!1),a=h(!1),p=h(!1),v={x:203,y:48,w:40,h:20},m={x:242,y:40,w:8,h:8},f=ce({}),c=ce([{id:"A",pin2:0,pin3:1,pin2State:0,pin3State:0,with:e,x:69,y:49,w:80,h:80,style:{},class:""},{id:"B",pin2:2,pin3:3,pin2State:0,pin3State:0,with:e,x:69,y:152,w:80,h:80,style:{},class:""},{id:"C",pin2:28,pin3:22,pin2State:0,pin3State:0,with:e,x:69,y:255,w:80,h:80,style:{},class:""},{id:"D",pin2:4,pin3:5,pin2State:0,pin3State:0,with:e,x:297,y:49,w:80,h:80,style:{},class:""},{id:"E",pin2:6,pin3:7,pin2State:0,pin3State:0,with:e,x:297,y:152,w:80,h:80,style:{},class:""},{id:"F",pin2:26,pin3:27,pin2State:0,pin3State:0,with:e,x:297,y:255,w:80,h:80,style:{},class:""}]),_={0:0,1:0,2:1,3:1,28:2,22:2,4:3,5:3,6:4,7:4,26:5,27:5};function z(k){const $={x:0,y:0,w:80,h:80,is:k.is,on:0,ref:{updateSettings:q=>{}},class:"",style:{}};r.push($);const R=k.ref.settings;return ze(()=>{$.ref.updateSettings(R)}),$}function I(k,$,R){return Q=>{if(!k)return;k.x=Q.clientX-$,k.y=Q.clientY-R;const L=[0,0,0,0,0,0];for(const[T,X]of c.entries())L[T]=hs(k,X);let S=0;for(let T=1;T<L.length;T++)L[T]>L[S]&&(S=T);L[S]==0?l.value=null:l.value=S,i.value=k.y>400}}function F(k,$){$.x=c[k].x,$.y=c[k].y,c[k].with=$,$.on=k,ze(()=>{$.ref.pin2.mode==="output"&&($.ref.pin2.state.value=c[k].pin2State),$.ref.pin3.mode==="output"&&($.ref.pin3.state.value=c[k].pin3State)})}function E(k){c[k].with=e}let g,w;function M(){u.value=!0,t.clearDisplay(),g=new Worker(new URL("/assets/mpWorker-bT8ErQvc.js",import.meta.url),{type:"module"}),a.value=!0,g.onmessage=k=>{const{command:$,data:R,sharedBuffer:q,sharedArrayInterrupt:Q}=k.data;if($==="error")Ne.write(R),p.value=!1,D.value=!1;else if($==="finished")console.log("Finished"),p.value=!1;else if($==="initialized")console.log("Inited"),u.value=!1,w=Q;else if($==="output")Ne.write(R);else if($==="on"){const{pin:L}=R,S=c[_[L]];L===S.pin2&&(S.pin2State=1,S.with.ref.pin2.state.value=1),L===S.pin3&&(S.pin3State=1,S.with.ref.pin3.state.value=1)}else if($==="off"){const{pin:L}=R,S=c[_[L]];L===S.pin2&&(S.pin2State=0,S.with.ref.pin2.state.value=0),L===S.pin3&&(S.pin3State=0,S.with.ref.pin3.state.value=0)}else if($==="value"){const{pin:L}=R,S=c[_[L]];let T;L===S.pin2&&(T=S.with.ref.pin2.state.value),L===S.pin3&&(T=S.with.ref.pin3.state.value);const X=new Int32Array(q);Atomics.store(X,1,T),Atomics.store(X,0,1),Atomics.notify(X,0,1)}else if($==="duty_u16"){const{pin:L,duty_u16:S}=R,T=c[_[L]];L===T.pin2&&(T.pin2State=S/65535,T.with.ref.pin2.state.value=S/65535),L===T.pin3&&(T.pin3State=S/65535,T.with.ref.pin3.state.value=S/65535)}else if($==="adc read_u16"){const{pin:L}=R,S=c[_[L]];let T;L===S.pin2&&(T=S.with.ref.pin2.state.value),L===S.pin3&&(T=S.with.ref.pin3.state.value);const X=new Int32Array(q);Atomics.store(X,1,T*65535),Atomics.store(X,0,1),Atomics.notify(X,0,1)}else if($==="display_text"){const{text:L,x:S,y:T}=R;t.writeText(L,S,T)}else $==="clear_display"&&t.clearDisplay()}}function y(){p.value=!0,w[0]=0,g.postMessage({command:"runPython",code:ds.value})}const D=h(!1);function V(){D.value=!0,w[0]=2}function B(){g.terminate(),p.value=!1,u.value=!1,a.value=!1,g.onmessage=null}function W(k,$){const R=c[k].with,q=c[$].with;F($,R),F(k,q)}function K(k,$,R,q){k.style={zIndex:"2"};const Q=c[R];o.value=R;const L=q.clientX-k.x,S=q.clientY-k.y,T=I(k,L,S),X=k.x,Ee=k.y,ye=()=>{l.value===null?(i.value&&(Q.with=e,r.splice($,1)),k.x=X,k.y=Ee):W(R,l.value),document.removeEventListener("pointermove",T),document.removeEventListener("pointerup",ye),i.value=!1,o.value=null,l.value=null,k.style={zIndex:"1"}};document.addEventListener("pointermove",T),document.addEventListener("pointerup",ye)}function lt(k,$,R){if(R.currentTarget instanceof HTMLElement){const T=R.currentTarget,X=T.parentElement.parentElement,{top:Ee,left:ye,width:ut,height:ct}=T.getBoundingClientRect(),{top:pt,left:ft}=X.getBoundingClientRect();f.x=ye-ft,f.y=Ee-pt,f.w=ut,f.h=ct}f.is=k,ze(()=>{f.ref.updateSettings($.settings)});const q=R.clientX-f.x,Q=R.clientY-f.y,L=I(f,q,Q),S=()=>{if(f){if(l.value===null)i.value&&(f.x=0,f.y=0,f.is=e);else{const T=r.indexOf(c[l.value].with);T>-1&&r.splice(T,1),E(l.value),F(l.value,z(f))}l.value=null,f.is=e,f.x=0,f.y=0,i.value=!1,document.removeEventListener("pointermove",L),document.removeEventListener("pointerup",S)}};document.addEventListener("pointermove",L),document.addEventListener("pointerup",S)}return{usb:v,onLED:m,NoneModule:e,maxAreaIndex:l,fromSlotIndex:o,toDelete:i,slots:c,moduleComponents:s,modules:r,addModuleToSlot:F,removeModuleFromSlot:E,dragged:f,startDragFromSlot:K,startDragFromModuleList:lt,connect:M,run:y,stop:V,disconnect:B,isRunning:p,isStopping:D,isLoading:u,isConnected:a,newPiModule:z}}),ot=me("useST7789",()=>{const n=h(""),e=h(0),t=h(0),s=h("#000000");function r(o,l,u,a){n.value+=o+`\r
`,e.value=l,t.value=u,a&&(s.value=a)}function i(){n.value="",e.value=0,t.value=0,s.value="#000000"}return{text:n,x:e,y:t,textColor:s,writeText:r,clearDisplay:i}}),ms=["width","height"],te=12,gs=H({__name:"Display",setup(n){const e=h(112),t=h(160),s=h(null),r=h(null),i=h(0),o=ot();o.text||(o.text="");function l(p){const v=p.deltaY>0?1:-1;i.value+=v*te,i.value=Math.max(0,i.value);const{lines:m,visibleLines:f}=u();console.log(m.length,i.value),i.value=Math.min(m.length*te,i.value),console.log("Lines: ",m),a(m,f)}function u(){const p=[];let v=0;return r.value&&o.text&&(String(o.text).split(`
`).forEach(f=>{let c="";f.split(" ").forEach(z=>{const I=c+z+" ";r.value.measureText(I).width>e.value?(p.push(c),c=z+" "):c=I}),p.push(c)}),v=Math.ceil(t.value/te)),{lines:p,visibleLines:v}}function a(p,v){if(r.value){r.value.fillStyle="#FFFFFF",r.value.fillRect(0,0,e.value,t.value),r.value.fillStyle=String(o.textColor)||"#000000",r.value.font="12px Monaco";const m=Math.floor(i.value/te);console.log("Lines: ",p);for(let f=0;f<v;f++){const c=m+f;if(c<p.length){const _=(f+1)*te-i.value%te;r.value.fillText(p[c],0,_)}}}else console.warn("Canvas context is not initialized.")}return ge(()=>[o.text,o.textColor],()=>{const{lines:p,visibleLines:v}=u();i.value=Math.max(0,(p.length-v)*te),console.log(i.value,p.length,v),a(p,v)}),oe(async()=>{if(await ze(),console.log("onMounted called"),!s.value){console.error("Canvas element not found!");return}if(r.value=s.value.getContext("2d"),r.value){console.log("Canvas context successfully initialized."),r.value.fillStyle="#FFFFFF",r.value.fillRect(0,0,e.value,t.value),console.log("Initial text:",o.text);const{lines:p,visibleLines:v}=u();console.log("Lines:",p,"Visible Lines:",v),i.value=0,a(p,v)}else console.error("Failed to initialize canvas context.")}),(p,v)=>(b(),P("div",{class:"display-container",onWheel:l},[x("canvas",{ref_key:"canvas",ref:s,width:e.value,height:t.value,style:{border:"1px solid black",width:"112px",height:"160px"}},null,8,ms)],32))}}),ws=we(gs,[["__scopeId","data-v-d275b0d1"]]),ys={class:"h-full parent relative flex flex-col border-t border-surface overflow-auto min-w-[448px] select-none"},xs={id:"pibody",class:"relative h-[450px] flex-shrink-0 max-h-[calc(100%-100px)] overflow-auto"},bs={class:"absolute top-0 right-2"},Ss={class:"material-icons"},_s={class:"material-icons"},zs=H({__name:"SimulationView",setup(n){const e=vs(),{maxAreaIndex:t,isLoading:s,isStopping:r,isRunning:i,isConnected:o,fromSlotIndex:l,toDelete:u,slots:a,dragged:p,moduleComponents:v,modules:m}=re(e),f=ce([]);e.connect();function c(){o.value?e.run():e.connect()}return(_,z)=>{const I=Je,F=le;return b(),P("div",ys,[x("div",xs,[C(I,{src:d(Rn),width:"384px",draggable:"false",class:"absolute pt-4 min-w-[384px]",style:{left:"32px",top:"0px"}},null,8,["src"]),C(ws,{class:"absolute top-[213px] left-[167px] w-[112px] h-[160px]"}),x("div",bs,[C(F,{id:"#run",type:"button",class:"w-9 h-9 mr-1",severity:"info",rounded:"",onClick:c,disabled:d(s)||d(i)},{default:U(()=>[x("span",Ss,he(d(s)?"hourglass_top":"play_arrow"),1)]),_:1},8,["disabled"]),C(F,{type:"button",class:"w-9 h-9 mr-1",variant:d(i)?void 0:"outlined",severity:"danger",rounded:"",onClick:z[0]||(z[0]=E=>d(e).stop()),disabled:!d(i)||!d(o)},{default:U(()=>[x("span",_s,he(d(r)?"hourglass_top":"stop"),1)]),_:1},8,["variant","disabled"])]),(b(!0),P(se,null,fe(d(a),(E,g)=>(b(),P("div",{key:g,class:Z(["absolute w-20 h-20 border rounded-lg text-center",[{"bg-green-200/[0.5]":d(t)==g,"bg-blue-200/[0.5]":d(l)==g},E.class]]),style:Y([E.style,{left:E.x+"px",top:E.y+"px"}])},null,6))),128)),x("div",{class:"absolute",style:Y({left:d(e).onLED.x+"px",top:d(e).onLED.y+"px",width:d(e).onLED.w+"px",height:d(e).onLED.h+"px"})},null,4)]),(b(!0),P(se,null,fe(d(m),(E,g)=>(b(),P("div",{key:g},[(b(),N(Se(E.is),{style:Y([E.style,{left:E.x+"px",top:E.y+"px"}]),class:Z([E.class,"absolute w-20 h-20 border-sm rounded-xl overflow-hidden"]),onPointerdown:[w=>d(e).startDragFromSlot(E,g,E.on,w),z[1]||(z[1]=de(w=>w.preventDefault(),["prevent"]))],ref_for:!0,ref:w=>E.ref=w},null,40,["style","class","onPointerdown"]))]))),128)),x("div",{class:Z(["w-full overflow-auto flex flex-wrap bg-white gap-2 flex-grow justify-center",{"bg-rose-500":d(u)}])},[(b(!0),P(se,null,fe(d(v),(E,g)=>(b(),N(Se(E),{ref_for:!0,ref:w=>f.push(w),onPointerdown:[w=>d(e).startDragFromModuleList(E,f[g],w),z[2]||(z[2]=de(w=>w.preventDefault(),["prevent"]))],class:"w-20 h-20 border-sm cursor-move"},null,40,["onPointerdown"]))),256))],2),(b(),N(Se(d(p).is),{ref:E=>d(p).ref=E,onDragover:z[3]||(z[3]=de(E=>E.preventDefault(),["prevent"])),style:Y({left:d(p).x+"px",top:d(p).y+"px",position:"absolute",zIndex:2}),class:"dragged w-20 m-2 h-20 border-sm rounded-xl text-center overflow-hidden bg-purple-700"},null,40,["style"]))])}}}),Es=we(zs,[["__scopeId","data-v-b1b5b454"]]),Ie=me("useLessonStore",()=>{const n=h(null),e=h(null);function t(i){i!=null&&(n.value=i,e.value=0)}function s(i){n.value!=null&&(n.value.steps=i)}function r(i){n.value!=null&&(e.value=i)}return{lesson:n,stepIndex:e,setLesson:t,setSteps:s,changeStep:r}}),ks={class:"mx-auto flex items-center justify-between p-2 px-6 w-full bg-white"},$s={class:"flex flex-1 items-center"},Ps={key:1,class:"flex items-center gap-1"},Ls={class:"flex items-center gap-1"},Ts={class:"flex flex-1 justify-end items-center gap-2"},Cs=H({__name:"LessonHeader",setup(n){const{locale:e}=Ke(),t=qe(),s=Ie(),{lesson:r,stepIndex:i}=re(s),{changeStep:o,setSteps:l}=s,u=h(!1);function a(c){switch(c){case"article":return"pi pi-align-left";case"code":return"pi pi-code";case"question":return"pi pi-question";case"matching":return"pi pi-arrows-h";case"open":return"pi pi-pencil";default:return"pi pi-align-left"}}async function p(){if(!u.value){u.value=!0;try{const{data:c}=await Tt.getProjectStepsByID(t.params.id.toString()),_=[];for(const z of c){const I=await Ct(z,e.value,!1);_.push(I)}l(_)}catch(c){alert(c)}finally{u.value=!1}}}oe(p),ge(e,p,{immediate:!0});const v=h(),m=h([{label:"Profile",icon:"pi pi-user"},{label:"Log out",icon:"pi pi-sign-out"}]),f=c=>{v.value.toggle(c)};return(c,_)=>{const z=Je,I=le,F=Ut,E=Ot;return b(),P("div",ks,[x("div",$s,[C(z,{src:d(Ft),width:"32"},null,8,["src"]),_[1]||(_[1]=x("p",{class:"text-xl font-semibold px-2 mr-4"},"Artisan",-1)),C(I,{id:"#projects",icon:"pi pi-angle-left",label:c.$t("projects"),severity:"secondary",variant:"text",onClick:_[0]||(_[0]=g=>d(Pt).push({name:"projects"})),size:"small"},null,8,["label"])]),u.value||d(r)==null?(b(),N(F,{key:0,shape:"circle",size:"2rem",class:"mr-2"})):(b(),P("div",Ps,[x("div",Ls,[(b(!0),P(se,null,fe(d(r).steps,(g,w)=>(b(),N(I,{key:g.id,icon:a(g.type),rounded:"",severity:d(i)==w?void 0:"secondary",variant:d(i)==w?void 0:"outlined",onClick:M=>d(o)(w),class:"h-8 w-8"},null,8,["icon","severity","variant","onClick"]))),128))])])),x("div",Ts,[C(Bt),C(I,{type:"button",icon:"pi pi-ellipsis-v",onClick:f,"aria-haspopup":"true","aria-controls":"overlay_menu",size:"small",variant:"outlined",severity:"secondary",class:"border border-slate-300 bg-slate-50",style:{width:"34px"}}),C(E,{ref_key:"menu",ref:v,id:"overlay_menu",model:m.value,popup:!0},null,8,["model"])])])}}}),Ms={class:"flex flex-col p-4 gap-4 overflow-scroll h-full justify-between bg-white"},Ds={key:0},Is={key:1,class:"flex"},Rs=H({__name:"LessonDiv",setup(n){const e=Ie(),{lesson:t,stepIndex:s}=re(e),{changeStep:r}=e,i=ne(()=>{var u;return s.value==null?null:((u=t.value)==null?void 0:u.steps[s.value])??null});async function o(){s.value!=null&&r(s.value-1)}async function l(){s.value!=null&&r(s.value+1)}return(u,a)=>{const p=le;return b(),P("div",Ms,[i.value?(b(),P("div",Ds,[i.value.type=="article"?(b(),N(d(Mt),{key:0,step:i.value},null,8,["step"])):i.value.type=="code"?(b(),N(d(Dt),{key:1,step:i.value},null,8,["step"])):i.value.type=="matching"?(b(),N(d(It),{key:2,step:i.value},null,8,["step"])):i.value.type=="open"?(b(),N(d(Rt),{key:3,step:i.value},null,8,["step"])):i.value.type=="question"?(b(),N(d(At),{key:4,step:i.value},null,8,["step"])):J("",!0)])):J("",!0),d(t)!=null&&d(t).steps!=null&&d(t).steps.length>0&&i.value?(b(),P("div",Is,[d(s)!==0?(b(),N(p,{key:0,label:"Previous",icon:"pi pi-angle-left",size:"small",onClick:o})):J("",!0),d(s)<d(t).steps.length-1?(b(),N(p,{key:1,label:"Next",icon:"pi pi-angle-right",iconPos:"right",size:"small",class:"ml-auto self-end",onClick:l})):J("",!0)])):J("",!0)])}}}),As={class:"flex bg-surface-0",style:{height:"calc(100vh - 52px)"}},Fs={class:"flex justify-center h-full"},Bs={class:"max-w-[400px] w-full"},Xs=H({__name:"LessonView",setup(n){const{locale:e}=Ke(),t=qe(),s=Ie(),{setLesson:r}=s,i=h(!1);async function o(){if(!i.value){i.value=!0;try{const{data:l}=await jt.getProjectByID(t.params.id.toString()),u=await Vt(l,e.value);r(u)}finally{i.value=!1}}}return oe(o),ge(e,o),(l,u)=>{const a=Ze,p=Qe;return b(),P(se,null,[C(Cs),x("div",As,[C(p,{class:"w-full rounded-none"},{default:U(()=>[C(a,{size:30,minSize:10,class:"max-w-[450px] w-full animate-fadeinleft animate-once animate-duration-1000 animate-ease-in-out"},{default:U(()=>[C(Es)]),_:1}),C(a,{size:40,minSize:10,class:Z({"animate-fadeindown animate-once animate-duration-1000 animate-ease-in-out":!0})},{default:U(()=>[C(p,{layout:"vertical",class:"h-full w-full"},{default:U(()=>[C(a,{size:65,minSize:10},{default:U(()=>[C(Tn)]),_:1}),C(a,{size:35,minSize:10},{default:U(()=>[C(In)]),_:1})]),_:1})]),_:1}),C(a,{size:30,minSize:10,class:Z(["max-w-md mx-auto",{"animate-fadeinright animate-once animate-duration-1000 animate-ease-in-out":!0}])},{default:U(()=>[x("div",Fs,[x("div",Bs,[i.value?J("",!0):(b(),N(Rs,{key:0}))])])]),_:1})]),_:1})])],64)}}});export{Xs as default};
