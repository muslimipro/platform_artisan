import{s as T}from"./index-C7X-J-Qf.js";import{s as D}from"./index-B6KUmJMy.js";import{d as B,a5 as U,a3 as A,G as F,u as Y,r as f,p as j,o as d,f as v,w as n,e as u,b as t,g as N,t as k,h as S,q,s as h,_ as P,a as R,A as x,ay as z,c as G,j as c,F as H}from"./index-DcyBeJgC.js";import{s as C}from"./index-gHHiHdoU.js";import{a as L,s as O}from"./index-DmQEPo33.js";import{s as J}from"./index-dDCPORGv.js";import{_ as K}from"./VerifyEmailDialog.vue_vue_type_script_setup_true_lang-DfdeiVAC.js";import{S as Q}from"./index-aHnXE6gR.js";import{u as W}from"./profile-Dwrl7aX4.js";import"./index-C5SrmfWd.js";import"./index-BHfeFhRm.js";import"./index-seXcSKnd.js";const X={class:"text-blue-500"},Z={class:"flex flex-col gap-1"},ee={class:"flex gap-1 justify-end"},ae=B({__name:"VerifyNewEmailDialog",props:U({email:{}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(V){const g=V,p=A(V,"modelValue"),{t:_}=F(),r=Y(),s=f(!1),a=f(0);let m;const l=()=>{a.value=60,m=setInterval(()=>{a.value>0?a.value--:clearInterval(m)},1e3)};async function e(){s.value=!0;try{await Q.changeEmail(g.email),r.add({severity:"success",summary:_("pages.settings.verificationEmailSent"),life:2e3}),l()}catch(o){console.log(o),r.add({severity:"error",summary:_("pages.settings.emailInvalid"),detail:o,life:2e3})}finally{s.value=!1}}return j(()=>{clearInterval(m)}),(o,y)=>{const b=q("i18n-t"),E=h,$=C,w=P;return d(),v(w,{visible:p.value,"onUpdate:visible":y[0]||(y[0]=I=>p.value=I),modal:"",draggable:!1,class:"m-4 max-w-md",header:o.$t("dialog.verifyYourEmail")},{footer:n(()=>[u("div",Z,[u("div",ee,[t(E,{label:a.value>0?`${o.$t("pages.login.resendIn")} ${a.value}s`:o.$t("dialog.sendVerificationEmail"),onClick:e,loading:s.value,disabled:s.value||a.value>0},null,8,["label","loading","disabled"])]),a.value>0?(d(),v($,{key:0,severity:"success"},{default:n(()=>[N(k(o.$t("pages.settings.weHaveSentLinkToVerifyEmail")),1)]),_:1})):S("",!0)])]),default:n(()=>[u("div",null,[t(b,{keypath:"dialog.confirmEmailAddress"},{email:n(()=>[u("span",X,k(g.email),1)]),_:1})])]),_:1},8,["visible","header"])}}}),se={class:"flex flex-col gap-2"},le={class:"flex flex-wrap sm:flex-nowrap gap-2"},oe={class:"flex flex-col gap-1"},_e=B({__name:"ChangeEmail",setup(V){const g=R(),{user:p}=x(g),_=W(),{verified:r}=x(_),s=f(""),a=f(!1),m=f(!1);return z(()=>{var l;s.value=((l=p.value)==null?void 0:l.email)??""}),(l,e)=>{const o=L,y=J,b=O,E=C,$=h,w=D,I=T;return d(),G(H,null,[t(I,{class:"flex-grow",header:l.$t("pages.settings.changeEmail")},{default:n(()=>[u("div",se,[u("div",le,[u("div",oe,[t(b,null,{default:n(()=>[t(o,{class:"pi pi-envelope"}),t(y,{id:"email",autocomplete:"off",variant:"filled",placeholder:"Email",modelValue:s.value,"onUpdate:modelValue":e[0]||(e[0]=i=>s.value=i),disabled:c(r),class:"w-full sm:w-96"},null,8,["modelValue","disabled"])]),_:1}),t(E,{for:"email",severity:c(r)?"success":"error",size:"small",variant:"simple"},{default:n(()=>[N(k(c(r)?l.$t("pages.settings.yourEmailIsVerified"):l.$t("pages.settings.yourEmailIsNotVerified")),1)]),_:1},8,["severity"])]),c(r)?S("",!0):(d(),v(w,{key:0,severity:"danger"},{default:n(()=>{var i;return[((i=c(p))==null?void 0:i.email)==s.value?(d(),v($,{key:0,label:l.$t("pages.settings.verifyYourEmail"),onClick:e[1]||(e[1]=M=>a.value=!0)},null,8,["label"])):(d(),v($,{key:1,label:l.$t("pages.settings.verifyYourNewEmail"),onClick:e[2]||(e[2]=M=>m.value=!0),severity:"info"},null,8,["label"]))]}),_:1}))])])]),_:1},8,["header"]),t(K,{modelValue:a.value,"onUpdate:modelValue":e[3]||(e[3]=i=>a.value=i)},null,8,["modelValue"]),t(ae,{modelValue:m.value,"onUpdate:modelValue":e[4]||(e[4]=i=>m.value=i),email:s.value},null,8,["modelValue","email"])],64)}}});export{_e as default};
