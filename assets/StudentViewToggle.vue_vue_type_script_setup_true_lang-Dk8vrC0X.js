import{s as ge}from"./index-Bid53Dqw.js";import{a as P,r as b,R as oe,o as le,b as a,i as c,Q as ne,s as M,u as ve,c as D,I as fe,e as S,g as e,w as $,f as y,P as T,h as m,t as L,K as g,_ as se,n as te,F as ye,l as ae,m as be,bj as he,H as we,p as ke,$ as Ce}from"./index-Bzt9KOfG.js";import{s as Se}from"./index-BErXl6Bn.js";import{s as $e}from"./index-DHTb8XB-.js";import{s as xe}from"./index-BBP-spGk.js";import{i as Ve}from"./index-3p5Uw1Xh.js";import{S as E}from"./index-DdP9G9LQ.js";import{a as je}from"./http-j2rGyWLF.js";import{u as ze}from"./profile-CKxb-yIb.js";import{T as Le}from"./index-BTAl2Za4.js";import{s as Te}from"./index-D6NmrNAk.js";const es=P({__name:"LocaleSwitcher",setup(U){const i=b([{locale:"en",label:"Eng"},{locale:"ru",label:"Рус"},{locale:"kk",label:"Қаз"}]),{locale:o}=oe(),p=b(i.value[0]);le(()=>{const t=localStorage.getItem("selectedLanguage"),l=i.value.find(u=>u.locale===t)||i.value[0];p.value=l,o.value=l.locale});const v=t=>{const l=(t==null?void 0:t.locale)??i.value[0].locale;o.value=l,localStorage.setItem("selectedLanguage",l)};return(t,l)=>{const u=ge;return a(),c(u,{modelValue:p.value,"onUpdate:modelValue":[l[0]||(l[0]=_=>p.value=_),v],"dropdown-icon":"pi pi-globe",options:i.value,optionLabel:"label",checkmark:"",highlightOnSelect:!0,size:"small"},null,8,["modelValue","options"])}}}),Ue={class:"relative overflow-hidden w-full border-0 bg-transparent flex items-start p-2 pl-4 rounded-none cursor-pointer transition-colors duration-200"},Be={class:"inline-flex flex-col items-start"},Ie={class:"font-bold"},Me={class:"text-sm"},De={key:0,class:"flex flex-col gap-1 px-2"},Ee=["href","onClick"],Pe={class:"ml-2"},Re=["href","target"],Fe={class:"ml-2"},Ne={class:"flex justify-between items-center mb-8"},Oe={class:"flex justify-end gap-2"},ss=P({__name:"UserMenu",setup(U){const i=ne(),{user:o}=M(i),p=ve(),v=ae(),{t}=oe(),l=b(),{width:u}=Ve(),_=D(()=>u.value<640),B=D(()=>{const r=[{label:t("header.menu.settings"),icon:"pi pi-cog",route:"/settings/edit-profile"},{label:t("logOut"),icon:"pi pi-sign-out",command:async()=>{await v.replace({name:"login"}),await je.logout(),i.logout()}}],s=[{label:t("projects"),icon:"pi pi-stop",route:"/projects"},{label:t("modules"),icon:"pi pi-circle",route:"/modules"}];return _.value?[...s,...r]:r}),h=r=>{l.value.toggle(r)};async function w(r){const{data:s}=await E.changeView(r);i.setToken(s),i.setUser(s),window.location.reload()}const x=b(""),k=b(!1),V=b(!1);async function ie(){if(x.value.length!=0){V.value=!0;try{const{data:r}=await E.joinClass(x.value);k.value=!1,window.location.reload(),p.add({severity:"success",summary:r.message,life:2e3})}catch(r){p.add({severity:"error",summary:r.response.data.error,detail:r,life:2e3})}finally{V.value=!1}}}const R=ze(),{fetchProfile:F}=R,{verified:N,profile:O,loading:re}=M(R),A=()=>{re.value||F()};return le(()=>{F(),window.addEventListener("focus",A)}),fe(()=>{window.removeEventListener("focus",A)}),(r,s)=>{const d=be,ue=xe,ce=he,pe=we("router-link"),de=$e,me=Se,_e=ke,I=Ce;return a(),S(ye,null,[e(N)?(a(),c(d,{key:1,type:"button",icon:"pi pi-ellipsis-v",onClick:h,"aria-haspopup":"true","aria-controls":"overlay_menu",size:"small",variant:"outlined",severity:"secondary",class:"border border-slate-300 bg-slate-50",style:{width:"34px"}})):(a(),c(ue,{key:0,value:"1",severity:"danger",size:"small"},{default:$(()=>[y(d,{type:"button",icon:"pi pi-ellipsis-v",onClick:h,"aria-haspopup":"true","aria-controls":"overlay_menu",size:"small",variant:"outlined",severity:"secondary",class:"border border-slate-300 bg-slate-50",style:{width:"34px"}})]),_:1})),y(de,{ref_key:"menu",ref:l,id:"overlay_menu",model:B.value,popup:!0},{start:$(()=>{var n,C,j,z,H,K,Q,W,q,G,J,X,Y,Z;return[T((a(),S("button",Ue,[m("span",Be,[m("span",Ie,L((n=e(o))==null?void 0:n.email),1),m("span",Me,L((C=e(o))==null?void 0:C.user_type),1)])])),[[I]]),["school_manager","super_admin"].includes(((j=e(o))==null?void 0:j.origin_user_type)??"student")?g("",!0):(a(),S("div",De,[((z=e(o))==null?void 0:z.user_type)!="teacher"&&((H=e(o))==null?void 0:H.origin_user_type)!="student"?(a(),c(d,{key:0,label:"Teacher mode",class:"w-full",size:"small",onClick:s[0]||(s[0]=f=>w("teacher"))})):g("",!0),((K=e(o))==null?void 0:K.user_type)!="student"?(a(),c(d,{key:1,label:"Student mode",class:"w-full",size:"small",onClick:s[1]||(s[1]=f=>w("student")),severity:"info"})):g("",!0),!["student","teacher"].includes(((Q=e(o))==null?void 0:Q.origin_user_type)??"student")&&((W=e(o))==null?void 0:W.user_type)!=((q=e(o))==null?void 0:q.origin_user_type)?(a(),c(d,{key:2,label:`${(G=e(o))==null?void 0:G.origin_user_type.replace(/_/g," ").replace(/^./,f=>f.toUpperCase())} mode`,class:"w-full",size:"small",onClick:s[2]||(s[2]=f=>{var ee;return w(((ee=e(o))==null?void 0:ee.origin_user_type)??"student")}),severity:"help"},null,8,["label"])):g("",!0),((J=e(o))==null?void 0:J.origin_user_type)=="student"&&((X=e(O))==null?void 0:X.class_name)==null?(a(),c(d,{key:3,label:e(t)("pages.settings.joinClass"),icon:"pi pi-user-plus",size:"small",variant:"outlined",onClick:s[3]||(s[3]=f=>k.value=!0)},null,8,["label"])):g("",!0),((Y=e(o))==null?void 0:Y.origin_user_type)=="student"&&((Z=e(O))==null?void 0:Z.class_name)!=null?(a(),c(d,{key:4,label:e(t)("pages.teacher.schedule"),icon:"pi pi-calendar-plus",size:"small",variant:"outlined",onClick:s[4]||(s[4]=f=>r.$router.push("/student/schedule"))},null,8,["label"])):g("",!0)]))]}),item:$(({item:n,props:C})=>[n.route?(a(),c(pe,{key:0,to:n.route},{default:$(({href:j,navigate:z})=>[T((a(),S("a",se({href:j},C.action,{onClick:z}),[m("span",{class:te(n.icon)},null,2),m("span",Pe,L(n.label),1),!e(N)&&n.route.includes("settings")?(a(),c(ce,{key:0,value:"1",severity:"danger",size:"small"})):g("",!0)],16,Ee)),[[I]])]),_:2},1032,["to"])):T((a(),S("a",se({key:1,href:n.url,target:n.target},C.action),[m("span",{class:te(n.icon)},null,2),m("span",Fe,L(n.label),1)],16,Re)),[[I]])]),_:1},8,["model"]),y(_e,{visible:k.value,"onUpdate:visible":s[7]||(s[7]=n=>k.value=n),modal:"",header:e(t)("pages.settings.joinClassByCode"),closable:!1},{default:$(()=>[m("div",Ne,[y(me,{type:"text",modelValue:x.value,"onUpdate:modelValue":s[5]||(s[5]=n=>x.value=n),placeholder:e(t)("pages.settings.enterCode")},null,8,["modelValue","placeholder"])]),m("div",Oe,[y(d,{type:"button",label:e(t)("pages.settings.cancel"),severity:"secondary",onClick:s[6]||(s[6]=n=>k.value=!1)},null,8,["label"]),y(d,{type:"button",label:e(t)("pages.settings.join"),onClick:ie,loading:V.value,disabled:V.value},null,8,["label","loading","disabled"])])]),_:1},8,["visible","header"])],64)}}}),ts=P({__name:"StudentViewToggle",props:{path:{}},setup(U){const i=U,o=ae(),p=ne(),{user:v}=M(p),t=D({get:()=>{var l;return((l=v.value)==null?void 0:l.user_type)==="student"},set:async l=>{var _;const{data:u}=await E.changeView(l?"student":((_=v.value)==null?void 0:_.origin_user_type)??"student");p.setToken(u),p.setUser(u),i.path?o.push({path:i.path}):window.location.reload()}});return(l,u)=>{var h;const _=Te,B=Le;return["editor","contributor"].includes(((h=e(v))==null?void 0:h.origin_user_type)??"")?T((a(),c(_,{key:0,modelValue:t.value,"onUpdate:modelValue":u[0]||(u[0]=w=>t.value=w)},null,8,["modelValue"])),[[B,"Student view"]]):g("",!0)}}});export{ts as _,es as a,ss as b};
