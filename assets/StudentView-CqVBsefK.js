import{s as J}from"./index-Ckj4A1D4.js";import{s as O,a as Q,b as W,c as X}from"./index-efEfXI3S.js";import{s as Z}from"./index-B-eDnhFb.js";import{s as ee}from"./index-DD6cAyMr.js";import{s as te}from"./index-C8ETRGhG.js";import{a as V,r as v,o as F,b as l,k as d,e as g,F as q,j as D,P as se,g as N,p as U,q as E,u as ae,D as le,R as ne,w as u,t as a,f as c,h as s,i as b,l as oe,x as re}from"./index-DDfugreB.js";import{s as L}from"./index-C4sXkJzK.js";import{T as y}from"./teacherApi-D0AoltyX.js";import{T as ie}from"./index-CdRQ17Hd.js";import"./index-D79PoGmM.js";import"./index-Biqx1ryJ.js";import"./index-BFRD64py.js";import"./index-BeV3JA3Y.js";import"./index-W-X6oPzm.js";import"./http-C8PwKR2v.js";const ce={key:1,class:"flex flex-wrap gap-2"},ue=V({__name:"ProjectDetails",props:{id:{},projectId:{}},setup(A){const p=A,k=U(),f=v(null),m=v(!1);async function _(){if(!m.value){m.value=!0;try{const{data:t}=await y.getStudentProjectSteps(p.id,p.projectId);f.value=t??null}catch(t){console.log(t)}finally{m.value=!1}}}F(_);function S(t,r){if(t!="completed")return t=="attempted"?"warn":(t=="started","secondary")}function n(t,r){if(t!="completed")return t=="attempted"||t=="started"?"outlined":void 0}function h(t,r){switch(t){case"article":return"pi pi-align-left";case"code":return r?"pi pi-hashtag":"pi pi-code";case"question":return"pi pi-question";case"matching":return"pi pi-arrows-h";case"open":return"pi pi-pencil";default:return"pi pi-align-left"}}return(t,r)=>{var x;const $=L,j=E,P=ie;return m.value?(l(),d($,{key:0,class:"flex justify-center"})):(l(),g("div",ce,[(l(!0),g(q,null,D((x=f.value)==null?void 0:x.steps,o=>se((l(),d(j,{key:o.id,icon:h(o.step_type,o.skip_submit),rounded:"",severity:S(o.status),variant:n(o.status),class:"h-8 min-w-8 w-8",onClick:r[0]||(r[0]=I=>N(k).push({name:"project",params:{id:p.projectId}}))},null,8,["icon","severity","variant"])),[[P,{value:o.name&&o.name.length>0?o.name:o.id.toString()},void 0,{top:!0}]])),128))]))}}}),de={key:1},pe={key:2,class:"flex flex-col items-start px-8 pb-4 gap-4"},fe={class:"w-full flex justify-between items-center"},me={class:"flex gap-4"},ve={class:"flex flex-col gap-2"},_e={class:"flex gap-4 items-center"},ge={class:"pl-1 text-3xl"},ye={class:"text-lg text-gray-500"},he={class:"pl-1 text-sm"},xe={class:"flex flex-col items-end"},we={class:"text-xl"},be={class:"text-3xl"},ke={key:1,class:"flex flex-col gap-2 w-full"},Se={class:"text-gray-500 text-xl"},$e={class:"w-24 h-16 rounded-lg overflow-hidden"},je=["src"],Pe={class:"flex flex-col gap-2 pl-4 w-56 items-start"},Ce={class:"text-lg"},Ne={class:"flex gap-1"},Ae={class:"flex-grow mr-2"},Ke=V({__name:"StudentView",setup(A){const p=ae(),k=le(),f=re(),m=U(),{t:_}=ne(),S=["Youngling","Padawan","Knight","Master"],n=v(null),h=v([]),t=v(!1),r=v(!1);async function $(){if(!t.value){t.value=!0;try{const{data:e}=await y.getStudent(Number(f.params.id));n.value=e??null}catch(e){console.log(e)}finally{t.value=!1}}}async function j(){if(!r.value){r.value=!0;try{const{data:e}=await y.getStudentProjects(Number(f.params.id));h.value=e??[]}catch(e){console.log(e)}finally{r.value=!1}}}F(()=>{$(),j()});function P(){k.require({message:_("pages.teacher.areYouSureExpelStudent"),header:_("pages.teacher.confirmation"),icon:"pi pi-exclamation-triangle",rejectProps:{label:_("pages.teacher.cancel"),severity:"secondary",outlined:!0},acceptProps:{label:_("pages.teacher.expel"),severity:"danger"},accept:()=>{x()}})}async function x(){try{const{data:e}=await y.expelStudentFromClass(Number(f.params.id));m.go(-1),p.add({severity:"success",summary:e.message,life:2e3})}catch(e){p.add({severity:"error",summary:e.response.data.error,detail:e,life:2e3})}}const o=v(!1);async function I(){try{o.value=!0;const{data:e}=await y.levelUpStudent(Number(f.params.id));window.location.reload(),p.add({severity:"success",summary:e.message,life:2e3})}catch(e){p.add({severity:"error",summary:e.response.data.error,detail:e,life:2e3})}finally{o.value=!1}}return(e,T)=>{const B=L,C=E,R=te,w=ee,z=Z,M=O,Y=Q,H=W,K=X,G=J;return l(),d(G,{class:"flex-grow flex flex-col gap-2"},{default:u(()=>[t.value?(l(),d(B,{key:0,class:"flex justify-center"})):n.value?(l(),g("div",pe,[c(C,{label:e.$t("pages.teacher.back"),icon:"pi pi-angle-left",severity:"info",variant:"outlined",onClick:T[0]||(T[0]=i=>N(m).go(-1))},null,8,["label"]),s("div",fe,[s("div",me,[c(R,{image:n.value.small_avatar_url.length>0?n.value.small_avatar_url:void 0,shape:"circle",class:"w-[102px] h-[102px]"},null,8,["image"]),s("div",ve,[s("div",_e,[s("div",ge,a(n.value.name),1),s("div",ye,a(S[n.value.level]),1),c(C,{label:"Level Up",icon:"pi pi-arrow-up","icon-pos":"right",severity:"info",size:"small",loading:o.value,disabled:n.value.level>1,onClick:I},null,8,["loading","disabled"])]),s("div",he,a(e.$t("pages.teacher.since"))+" "+a(n.value.created_time.split("T")[0]),1),c(w,{class:"ml-1 w-fit"},{default:u(()=>[b(a(n.value.access_type),1)]),_:1})])]),s("div",xe,[s("div",we,a(n.value.class_name),1),s("div",be,a(n.value.xp)+" "+a(e.$t("pages.teacher.xp")),1)])]),r.value?(l(),d(B,{key:0,class:"flex justify-center"})):(l(),g("div",ke,[s("div",Se,a(e.$t("pages.teacher.projects"))+":",1),c(K,{expandIcon:"pi pi-angle-down",collapseIcon:"pi pi-angle-up",lazy:!0,multiple:!0},{default:u(()=>[(l(!0),g(q,null,D(h.value,i=>(l(),d(H,{key:i.id,value:i.id},{default:u(()=>[c(M,{class:"flex gap-2 items-center rounded-lg"},{default:u(()=>[s("div",$e,[s("img",{src:i.source_url,class:"w-full h-full object-cover"},null,8,je)]),s("div",Pe,[s("div",Ce,a(i.name),1),s("div",Ne,[i.layer>0?(l(),d(w,{key:0,severity:"warn"},{default:u(()=>[b(a(e.$t("pages.teacher.level"))+" - "+a(i.layer),1)]),_:2},1024)):oe("",!0),i.is_guidable?(l(),d(w,{key:1},{default:u(()=>[b(a(e.$t("pages.projects.learn")),1)]),_:1})):(l(),d(w,{key:2,severity:"info"},{default:u(()=>[b(a(e.$t("pages.projects.practice")),1)]),_:1}))])]),s("div",Ae,[c(z,{value:i.student_progress,pt:{root:{class:"bg-gray-200"},value:{class:"bg-cyan-500"}}},null,8,["value"])])]),_:2},1024),c(Y,null,{default:u(()=>[c(ue,{id:Number(N(f).params.id),"project-id":Number(i.id)},null,8,["id","project-id"])]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:1})])),c(C,{label:e.$t("pages.teacher.expelFromClass"),icon:"pi pi-user-minus",severity:"danger",class:"self-end",onClick:P},null,8,["label"])])):(l(),g("div",de,a(e.$t("pages.teacher.noStudentFound")),1))]),_:1})}}});export{Ke as default};
