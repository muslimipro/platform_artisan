import{d as T,ag as z,a as V,ah as F,r as w,o as e,f as p,w as q,e as m,j as d,c as o,h as g,aj as A,b as j,t as Q,ac as E,k as H,s as O,H as U,ai as G,u as J,p as K,m as W,Q as X,F as C,i as M,N as Y}from"./index-Bsd047Aq.js";import{s as Z}from"./index-C9xqUn05.js";import{_ as ee}from"./AHeader.vue_vue_type_script_setup_true_lang-BQlaGMtE.js";import{a as te}from"./logo-CxLuufCm.js";import{a as $,t as L}from"./types-CWd8LSeE.js";import{P as oe}from"./pibody-BwAjMvHk.js";import{u as se}from"./editor-store-reO1fCbx.js";import{u as ae,m as re}from"./useSortable-gWK_6efh.js";import"./LocaleSwitcher.vue_vue_type_script_setup_true_lang-B2YsTQDW.js";import"./index-CY5xbM8P.js";import"./index-DwYpAXns.js";import"./index-CuqUGYXy.js";import"./StudentViewToggle.vue_vue_type_script_setup_true_lang-BH0lEvEq.js";import"./index-CUKdH7Pw.js";import"./index-Cn_YktQ8.js";import"./index-DfB7l4g0.js";const le={key:0,class:"absolute top-0 right-0"},ne={key:0,class:"bg-yellow-500 text-white text-sm w-full px-2 py-[1px] rounded-bl-xl rounded-tr-xl"},ie={key:1,class:"bg-green-500 text-white text-sm px-2 py-[1px] rounded-bl-xl rounded-tr-xl"},de={key:0,class:"bg-green-500 text-white text-sm w-full px-2 py-[1px] rounded-bl-xl rounded-tr-xl"},ue={key:1,class:"bg-purple-500 text-white text-sm w-full px-2 py-[1px] rounded-bl-xl rounded-tr-xl"},ce={key:2,class:"bg-blue-500 text-white text-sm w-full px-2 py-[1px] rounded-bl-xl rounded-tr-xl"},me={key:3,class:"bg-red-500 text-white text-sm w-full px-2 py-[1px] rounded-bl-xl rounded-tr-xl"},pe={class:"w-32 h-32 overflow-clip rounded-xl"},fe={class:"flex flex-col justify-between items-center px-4 py-1"},xe={class:"pb-1 font-medium text-lg text-center line-clamp-2"},ve={class:"flex"},N=T({__name:"ModuleCard",props:{module:{}},emits:["after-remove"],setup(D,{emit:b}){const k=H(),v=z(),R=V(),{user:i}=F(R),u=w(!1),s=D,B=b;function l(){v.require({message:"Are you sure you want to Delete?",header:"Confirmation",icon:"pi pi-exclamation-triangle",rejectProps:{label:"Cancel",severity:"secondary",outlined:!0},acceptProps:{label:"Delete",severity:"danger"},accept:()=>{_()}})}async function _(){u.value=!0;try{await $.deleteModuleByID(s.module.id),B("after-remove")}catch(c){console.log(c)}finally{u.value=!1}}function f(){k.push(`/module/${s.module.id}/edit`)}return(c,h)=>{const I=te,t=O,a=U("RouterLink");return e(),p(a,{to:u.value?"":`/module/${s.module.id}`},{default:q(()=>{var n,x,y,r,P,S;return[m("div",{class:A(["p-0 w-32 relative",((n=d(i))==null?void 0:n.user_type)=="editor"?"h-56":"h-40"])},[((x=d(i))==null?void 0:x.user_type)=="editor"?(e(),o("div",le,[s.module.editing_status=="inreview"?(e(),o("div",ne," In review")):(e(),o("div",ie,"Published"))])):g("",!0),((y=d(i))==null?void 0:y.user_type)=="editor"?(e(),o("div",{key:1,class:A(["absolute left-0",((r=d(i))==null?void 0:r.user_type)=="editor"?"bottom-24":"bottom-8"])},[s.module.access_type=="freemium"?(e(),o("div",de,"Free")):s.module.access_type=="premium"?(e(),o("div",ue,"Premium")):s.module.access_type=="demo"?(e(),o("div",ce,"Demo")):s.module.access_type=="hackaton"?(e(),o("div",me,"Hackaton ")):g("",!0)],2)):g("",!0),m("div",pe,[j(I,{alt:"user header",src:s.module.cover_image.length>0?s.module.cover_image:d(oe),width:"128",height:"128",class:"animate-fadein animate-once animate-duration-1000 animate-ease-in-out"},null,8,["src"])]),m("div",fe,[m("div",xe,Q(s.module.title),1),m("div",ve,[((P=d(i))==null?void 0:P.user_type)=="editor"?(e(),p(t,{key:0,icon:"pi pi-pen-to-square",severity:"info",variant:"text",rounded:"","aria-label":"Edit",onClick:E(f,["prevent"])})):g("",!0),((S=d(i))==null?void 0:S.user_type)=="editor"?(e(),p(t,{key:1,icon:"pi pi-trash",severity:"danger",variant:"text",rounded:"","aria-label":"Remove",onClick:E(l,["prevent"]),disabled:u.value,loading:u.value},null,8,["disabled","loading"])):g("",!0)])])],2)]}),_:1},8,["to"])}}}),_e={class:"flex flex-col min-h-screen bg-slate-50"},he={class:"border border-dashed rounded-xl border-green-400 overflow-hidden h-fit"},ye={key:1,class:"flex flex-wrap justify-center gap-8 px-4 sm:px-12 py-6"},Le=T({__name:"ModulesView",setup(D){const b=G("el"),k=J(),{locale:v}=K(),R=H(),i=se(),{addLesson:u}=i,s=V(),{user:B}=F(s),l=w([]),_=w(0),f=w(!1),c=w(!1);ae(b,l,{onUpdate:t=>{re(l.value,t.oldIndex,t.newIndex,t),Y(async()=>{const a=[];l.value.map(n=>{const x=parseInt(n.id,10);a.push(x)});try{await $.changeModulesOrder(a),k.add({severity:"success",summary:"Modules order saved!",life:2e3})}catch(n){k.add({severity:"error",summary:"Order set error!",detail:n,life:2e3})}})}});async function h(){if(!f.value){f.value=!0;try{const{data:t}=await $.getModules();f.value=!1,l.value=[],_.value=t.length;for(const a of t){const n=await L(a,v.value);l.value.push(n)}}catch(t){console.log(t)}finally{f.value=!1}}}W(h),X(v,h);async function I(){c.value=!0;try{const{data:t}=await $.createModule(),a=await L(t,v.value);u(a),R.push(`/module/${a.id}/edit`)}catch(t){console.log(t)}finally{c.value=!1}}return(t,a)=>{var y;const n=Z,x=O;return e(),o("div",_e,[j(ee),((y=d(B))==null?void 0:y.user_type)=="editor"?(e(),o("div",{key:0,ref_key:"el",ref:b,class:"flex flex-wrap justify-center gap-8 px-4 sm:px-12 py-6"},[(e(!0),o(C,null,M(l.value,r=>(e(),p(N,{key:r.id,module:r,onAfterRemove:h},null,8,["module"]))),128)),(e(!0),o(C,null,M(_.value-l.value.length,r=>(e(),p(n,{key:r,width:"128px",height:"128px",class:"rounded-xl shadow-sm"}))),128)),m("div",he,[j(x,{variant:"text",style:{width:"128px",height:"128px"},class:"bg-green-50",onClick:I,loading:c.value,disabled:c.value},{icon:q(()=>a[0]||(a[0]=[m("i",{class:"pi pi-plus text-xl"},null,-1)])),_:1},8,["loading","disabled"])])],512)):(e(),o("div",ye,[(e(!0),o(C,null,M(l.value,r=>(e(),p(N,{key:r.id,module:r,onAfterRemove:h},null,8,["module"]))),128)),(e(!0),o(C,null,M(_.value-l.value.length,r=>(e(),p(n,{key:r,width:"128px",height:"128px",class:"rounded-xl shadow-sm"}))),128))]))])}}});export{Le as default};
