var ct=Object.defineProperty;var pt=(n,e,t)=>e in n?ct(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var B=(n,e,t)=>pt(n,typeof e!="symbol"?e+"":e,t);import{J as Ne,aB as dt,aC as ft,M as me,aM as ge,aN as Re,i as ht,D as T,E as M,a4 as ue,aa as we,V as ye,W as be,m as xe,I as b,X as re,a0 as We,F as vt,e as g,aw as fe,ac as G,an as te,o as _e,aO as mt,T as V,_ as K,af as y,al as J,ai as Ee,aP as gt,ah as Ae,Y as pe,aQ as wt,c as ee,aR as N,a6 as Ye,au as yt,aS as bt,aT as xt,w as ze,t as je,aU as Ge,G as ce,aV as St,aW as _t,aX as Et,ao as zt,r as oe,n as Se}from"./index-BzwGzcTW.js";import{b as Pt,_ as he,a as Lt,t as $t}from"./dto-CnTnK2Ls.js";import{a as kt}from"./logo-DAC_l6Ja.js";import{P as Tt}from"./pibody-B70zHXNr.js";var Ct=function(e){var t=e.dt;return`
.p-splitter {
    display: flex;
    flex-wrap: nowrap;
    border: 1px solid `.concat(t("splitter.border.color"),`;
    background: `).concat(t("splitter.background"),`;
    border-radius: `).concat(t("border.radius.md"),`;
    color: `).concat(t("splitter.color"),`;
}

.p-splitter-vertical {
    flex-direction: column;
}

.p-splitter-gutter {
    flex-grow: 0;
    flex-shrink: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 1;
    background: `).concat(t("splitter.gutter.background"),`;
}

.p-splitter-gutter-handle {
    border-radius: `).concat(t("splitter.handle.border.radius"),`;
    background: `).concat(t("splitter.handle.background"),`;
    transition: outline-color `).concat(t("splitter.transition.duration"),", box-shadow ").concat(t("splitter.transition.duration"),`;
    outline-color: transparent;
}

.p-splitter-gutter-handle:focus-visible {
    box-shadow: `).concat(t("splitter.handle.focus.ring.shadow"),`;
    outline: `).concat(t("splitter.handle.focus.ring.width")," ").concat(t("splitter.handle.focus.ring.style")," ").concat(t("splitter.handle.focus.ring.color"),`;
    outline-offset: `).concat(t("splitter.handle.focus.ring.offset"),`;
}

.p-splitter-horizontal.p-splitter-resizing {
    cursor: col-resize;
    user-select: none;
}

.p-splitter-vertical.p-splitter-resizing {
    cursor: row-resize;
    user-select: none;
}

.p-splitter-horizontal > .p-splitter-gutter > .p-splitter-gutter-handle {
    height: `).concat(t("splitter.handle.size"),`;
    width: 100%;
}

.p-splitter-vertical > .p-splitter-gutter > .p-splitter-gutter-handle {
    width: `).concat(t("splitter.handle.size"),`;
    height: 100%;
}

.p-splitter-horizontal > .p-splitter-gutter {
    cursor: col-resize;
}

.p-splitter-vertical > .p-splitter-gutter {
    cursor: row-resize;
}

.p-splitterpanel {
    flex-grow: 1;
    overflow: hidden;
}

.p-splitterpanel-nested {
    display: flex;
}

.p-splitterpanel .p-splitter {
    flex-grow: 1;
    border: 0 none;
}
`)},Mt={root:function(e){var t=e.props;return["p-splitter p-component","p-splitter-"+t.layout]},gutter:"p-splitter-gutter",gutterHandle:"p-splitter-gutter-handle"},Dt={root:function(e){var t=e.props;return[{display:"flex","flex-wrap":"nowrap"},t.layout==="vertical"?{"flex-direction":"column"}:""]}},It=Ne.extend({name:"splitter",theme:Ct,classes:Mt,inlineStyles:Dt}),Rt={name:"BaseSplitter",extends:We,props:{layout:{type:String,default:"horizontal"},gutterSize:{type:Number,default:4},stateKey:{type:String,default:null},stateStorage:{type:String,default:"session"},step:{type:Number,default:5}},style:It,provide:function(){return{$pcSplitter:this,$parentInstance:this}}};function Fe(n){return Ut(n)||Bt(n)||Ft(n)||At()}function At(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ft(n,e){if(n){if(typeof n=="string")return ke(n,e);var t={}.toString.call(n).slice(8,-1);return t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set"?Array.from(n):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?ke(n,e):void 0}}function Bt(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function Ut(n){if(Array.isArray(n))return ke(n)}function ke(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,s=Array(e);t<e;t++)s[t]=n[t];return s}var Ot={name:"Splitter",extends:Rt,inheritAttrs:!1,emits:["resizestart","resizeend","resize"],dragging:!1,mouseMoveListener:null,mouseUpListener:null,touchMoveListener:null,touchEndListener:null,size:null,gutterElement:null,startPos:null,prevPanelElement:null,nextPanelElement:null,nextPanelSize:null,prevPanelSize:null,panelSizes:null,prevPanelIndex:null,timer:null,mutationObserver:null,data:function(){return{prevSize:null,isRTL:!1}},mounted:function(){this.initializePanels(),this.updateDirection(),this.observeDirectionChanges()},beforeUnmount:function(){this.clear(),this.unbindMouseListeners(),this.mutationObserver&&this.mutationObserver.disconnect()},methods:{updateDirection:function(){this.isRTL=!!this.$el.closest('[dir="rtl"]')},observeDirectionChanges:function(){var e=this,t=document.documentElement,s={attributes:!0,attributeFilter:["dir"]};this.mutationObserver=new MutationObserver(function(){e.updateDirection()}),this.mutationObserver.observe(t,s)},isSplitterPanel:function(e){return e.type.name==="SplitterPanel"},initializePanels:function(){var e=this;if(this.panels&&this.panels.length){var t=!1;if(this.isStateful()&&(t=this.restoreState()),!t){var s=Fe(this.$el.children).filter(function(i){return i.getAttribute("data-pc-name")==="splitterpanel"}),r=[];this.panels.map(function(i,a){var o=i.props&&i.props.size?i.props.size:null,u=o||100/e.panels.length;r[a]=u,s[a].style.flexBasis="calc("+u+"% - "+(e.panels.length-1)*e.gutterSize+"px)"}),this.panelSizes=r,this.prevSize=parseFloat(r[0]).toFixed(4)}}},onResizeStart:function(e,t,s){this.gutterElement=e.currentTarget||e.target.parentElement,this.size=this.horizontal?dt(this.$el):ft(this.$el),s||(this.dragging=!0,this.startPos=this.layout==="horizontal"?e.pageX||e.changedTouches[0].pageX:e.pageY||e.changedTouches[0].pageY),this.prevPanelElement=this.gutterElement.previousElementSibling,this.nextPanelElement=this.gutterElement.nextElementSibling,s?(this.prevPanelSize=this.horizontal?me(this.prevPanelElement,!0):ge(this.prevPanelElement,!0),this.nextPanelSize=this.horizontal?me(this.nextPanelElement,!0):ge(this.nextPanelElement,!0)):(this.prevPanelSize=100*(this.horizontal?me(this.prevPanelElement,!0):ge(this.prevPanelElement,!0))/this.size,this.nextPanelSize=100*(this.horizontal?me(this.nextPanelElement,!0):ge(this.nextPanelElement,!0))/this.size),this.prevPanelIndex=t,this.$emit("resizestart",{originalEvent:e,sizes:this.panelSizes}),this.$refs.gutter[t].setAttribute("data-p-gutter-resizing",!0),this.$el.setAttribute("data-p-resizing",!0)},onResize:function(e,t,s){var r,i,a;s?this.horizontal?(i=100*(this.prevPanelSize+t)/this.size,a=100*(this.nextPanelSize-t)/this.size):(i=100*(this.prevPanelSize-t)/this.size,a=100*(this.nextPanelSize+t)/this.size):(this.horizontal?this.isRTL?r=(this.startPos-e.pageX)*100/this.size:r=(e.pageX-this.startPos)*100/this.size:r=(e.pageY-this.startPos)*100/this.size,i=this.prevPanelSize+r,a=this.nextPanelSize-r),this.validateResize(i,a)&&(this.prevPanelElement.style.flexBasis="calc("+i+"% - "+(this.panels.length-1)*this.gutterSize+"px)",this.nextPanelElement.style.flexBasis="calc("+a+"% - "+(this.panels.length-1)*this.gutterSize+"px)",this.panelSizes[this.prevPanelIndex]=i,this.panelSizes[this.prevPanelIndex+1]=a,this.prevSize=parseFloat(i).toFixed(4)),this.$emit("resize",{originalEvent:e,sizes:this.panelSizes})},onResizeEnd:function(e){this.isStateful()&&this.saveState(),this.$emit("resizeend",{originalEvent:e,sizes:this.panelSizes}),this.$refs.gutter.forEach(function(t){return t.setAttribute("data-p-gutter-resizing",!1)}),this.$el.setAttribute("data-p-resizing",!1),this.clear()},repeat:function(e,t,s){this.onResizeStart(e,t,!0),this.onResize(e,s,!0)},setTimer:function(e,t,s){var r=this;this.timer||(this.timer=setInterval(function(){r.repeat(e,t,s)},40))},clearTimer:function(){this.timer&&(clearInterval(this.timer),this.timer=null)},onGutterKeyUp:function(){this.clearTimer(),this.onResizeEnd()},onGutterKeyDown:function(e,t){switch(e.code){case"ArrowLeft":{this.layout==="horizontal"&&this.setTimer(e,t,this.step*-1),e.preventDefault();break}case"ArrowRight":{this.layout==="horizontal"&&this.setTimer(e,t,this.step),e.preventDefault();break}case"ArrowDown":{this.layout==="vertical"&&this.setTimer(e,t,this.step*-1),e.preventDefault();break}case"ArrowUp":{this.layout==="vertical"&&this.setTimer(e,t,this.step),e.preventDefault();break}}},onGutterMouseDown:function(e,t){this.onResizeStart(e,t),this.bindMouseListeners()},onGutterTouchStart:function(e,t){this.onResizeStart(e,t),this.bindTouchListeners(),e.preventDefault()},onGutterTouchMove:function(e){this.onResize(e),e.preventDefault()},onGutterTouchEnd:function(e){this.onResizeEnd(e),this.unbindTouchListeners(),e.preventDefault()},bindMouseListeners:function(){var e=this;this.mouseMoveListener||(this.mouseMoveListener=function(t){return e.onResize(t)},document.addEventListener("mousemove",this.mouseMoveListener)),this.mouseUpListener||(this.mouseUpListener=function(t){e.onResizeEnd(t),e.unbindMouseListeners()},document.addEventListener("mouseup",this.mouseUpListener))},bindTouchListeners:function(){var e=this;this.touchMoveListener||(this.touchMoveListener=function(t){return e.onResize(t.changedTouches[0])},document.addEventListener("touchmove",this.touchMoveListener)),this.touchEndListener||(this.touchEndListener=function(t){e.resizeEnd(t),e.unbindTouchListeners()},document.addEventListener("touchend",this.touchEndListener))},validateResize:function(e,t){if(e>100||e<0||t>100||t<0)return!1;var s=Re(this.panels[this.prevPanelIndex],"minSize");if(this.panels[this.prevPanelIndex].props&&s&&s>e)return!1;var r=Re(this.panels[this.prevPanelIndex+1],"minSize");return!(this.panels[this.prevPanelIndex+1].props&&r&&r>t)},unbindMouseListeners:function(){this.mouseMoveListener&&(document.removeEventListener("mousemove",this.mouseMoveListener),this.mouseMoveListener=null),this.mouseUpListener&&(document.removeEventListener("mouseup",this.mouseUpListener),this.mouseUpListener=null)},unbindTouchListeners:function(){this.touchMoveListener&&(document.removeEventListener("touchmove",this.touchMoveListener),this.touchMoveListener=null),this.touchEndListener&&(document.removeEventListener("touchend",this.touchEndListener),this.touchEndListener=null)},clear:function(){this.dragging=!1,this.size=null,this.startPos=null,this.prevPanelElement=null,this.nextPanelElement=null,this.prevPanelSize=null,this.nextPanelSize=null,this.gutterElement=null,this.prevPanelIndex=null},isStateful:function(){return this.stateKey!=null},getStorage:function(){switch(this.stateStorage){case"local":return window.localStorage;case"session":return window.sessionStorage;default:throw new Error(this.stateStorage+' is not a valid value for the state storage, supported values are "local" and "session".')}},saveState:function(){ht(this.panelSizes)&&this.getStorage().setItem(this.stateKey,JSON.stringify(this.panelSizes))},restoreState:function(){var e=this,t=this.getStorage(),s=t.getItem(this.stateKey);if(s){this.panelSizes=JSON.parse(s);var r=Fe(this.$el.children).filter(function(i){return i.getAttribute("data-pc-name")==="splitterpanel"});return r.forEach(function(i,a){i.style.flexBasis="calc("+e.panelSizes[a]+"% - "+(e.panels.length-1)*e.gutterSize+"px)"}),!0}return!1},resetState:function(){this.initializePanels()}},computed:{panels:function(){var e=this,t=[];return this.$slots.default().forEach(function(s){e.isSplitterPanel(s)?t.push(s):s.children instanceof Array&&s.children.forEach(function(r){e.isSplitterPanel(r)&&t.push(r)})}),t},gutterStyle:function(){return this.horizontal?{width:this.gutterSize+"px"}:{height:this.gutterSize+"px"}},horizontal:function(){return this.layout==="horizontal"},getPTOptions:function(){var e;return{context:{nested:(e=this.$parentInstance)===null||e===void 0?void 0:e.nestedState}}}}},Xt=["onMousedown","onTouchstart","onTouchmove","onTouchend"],Vt=["aria-orientation","aria-valuenow","onKeydown"];function Ht(n,e,t,s,r,i){return T(),M("div",xe({class:n.cx("root"),style:n.sx("root"),"data-p-resizing":!1},n.ptmi("root",i.getPTOptions)),[(T(!0),M(ue,null,we(i.panels,function(a,o){return T(),M(ue,{key:o},[(T(),ye(be(a),{tabindex:"-1"})),o!==i.panels.length-1?(T(),M("div",xe({key:0,ref_for:!0,ref:"gutter",class:n.cx("gutter"),role:"separator",tabindex:"-1",onMousedown:function(l){return i.onGutterMouseDown(l,o)},onTouchstart:function(l){return i.onGutterTouchStart(l,o)},onTouchmove:function(l){return i.onGutterTouchMove(l,o)},onTouchend:function(l){return i.onGutterTouchEnd(l,o)},"data-p-gutter-resizing":!1},n.ptm("gutter")),[b("div",xe({class:n.cx("gutterHandle"),tabindex:"0",style:[i.gutterStyle],"aria-orientation":n.layout,"aria-valuenow":r.prevSize,onKeyup:e[0]||(e[0]=function(){return i.onGutterKeyUp&&i.onGutterKeyUp.apply(i,arguments)}),onKeydown:function(l){return i.onGutterKeyDown(l,o)},ref_for:!0},n.ptm("gutterHandle")),null,16,Vt)],16,Xt)):re("",!0)],64)}),128))],16)}Ot.render=Ht;var Nt={root:function(e){var t=e.instance;return["p-splitterpanel",{"p-splitterpanel-nested":t.isNested}]}},Wt=Ne.extend({name:"splitterpanel",classes:Nt}),Yt={name:"BaseSplitterPanel",extends:We,props:{size:{type:Number,default:null},minSize:{type:Number,default:null}},style:Wt,provide:function(){return{$pcSplitterPanel:this,$parentInstance:this}}},jt={name:"SplitterPanel",extends:Yt,inheritAttrs:!1,data:function(){return{nestedState:null}},computed:{isNested:function(){var e=this;return this.$slots.default().some(function(t){return e.nestedState=t.type.name==="Splitter"?!0:null,e.nestedState})},getPTOptions:function(){return{context:{nested:this.isNested}}}}};function Gt(n,e,t,s,r,i){return T(),M("div",xe({ref:"container",class:n.cx("root")},n.ptmi("root",i.getPTOptions)),[vt(n.$slots,"default")],16)}jt.render=Gt;function $e(n){return new Promise(e=>setTimeout(e,n))}class Kt{constructor(){B(this,"_lock",Promise.resolve());this._lock=Promise.resolve()}acquire(){let e;const t=new Promise(r=>e=r),s=this._lock.then(()=>e);return this._lock=this._lock.then(()=>t),s}}class Me{constructor(){B(this,"mutex");B(this,"inTransaction");B(this,"receivedData");B(this,"activityCallback");B(this,"receiveCallback");B(this,"disconnectCallback");B(this,"writeChunk");B(this,"emit");B(this,"info");B(this,"prevRecvCbk");if(new.target===Me)throw new Error("Cannot instantiate abstract class Transport");this.mutex=new Kt,this.inTransaction=!1,this.receivedData="",this.activityCallback=()=>{},this.receiveCallback=()=>{},this.disconnectCallback=()=>{},this.prevRecvCbk=e=>{},this.writeChunk=128,this.emit=!1,this.info={}}async getInfo(){return this.info}async write(e){const s=new TextEncoder().encode(e);try{if(s.byteLength==0)await this.writeBytes(s),this.activityCallback();else{let r=0;for(;r<s.byteLength;){const i=s.slice(r,r+this.writeChunk);await this.writeBytes(i),this.activityCallback(),r+=this.writeChunk}}}catch(r){throw r}}onActivity(e){this.activityCallback=e}onReceive(e){this.receiveCallback=e}onDisconnect(e){this.disconnectCallback=e}async startTransaction(){await $e(10);const e=await this.mutex.acquire();return this.prevRecvCbk=this.receiveCallback,this.inTransaction=!0,this.receivedData="",this.receiveCallback=t=>{this.receivedData+=t,this.emit&&this.prevRecvCbk&&this.prevRecvCbk(t)},()=>{this.prevRecvCbk&&(this.receiveCallback=this.prevRecvCbk,this.receiveCallback(this.receivedData)),this.receivedData="",this.inTransaction=!1,e()}}async readExactly(e,t=5e3){if(!this.inTransaction)throw new Error("Not in transaction");let s=Date.now()+t;for(;t<=0||Date.now()<s;){if(this.receivedData.length>=e){const i=this.receivedData.substring(0,e);return this.receivedData=this.receivedData.substring(e),i}const r=this.receivedData.length;await $e(10),this.receivedData.length>r&&(s=Date.now()+t)}throw new Error("Timeout")}async readUntil(e,t=5e3){if(!this.inTransaction)throw new Error("Not in transaction");const s=Date.now();let r=0;for(;t<=0||r<t;){const i=this.receivedData.indexOf(e)+e.length;if(i>=e.length){const a=this.receivedData.substring(0,i);return this.receivedData=this.receivedData.substring(i),a}await $e(10),r=Date.now()-s}throw new Error("Timeout reached before finding the ending sequence")}}class qt extends Me{constructor(){super();B(this,"port");B(this,"reader");B(this,"writer");B(this,"serial");if(this.port=void 0,this.reader=null,this.writer=null,"serial"in navigator)this.serial=navigator.serial;else throw new Error("WebSerial not available")}async requestAccess(){var i,a,o,u;const r={filters:[{usbVendorId:11914,usbProductId:5}]};this.port=await((i=this.serial)==null?void 0:i.requestPort(r));try{const l=(a=this.port)==null?void 0:a.getInfo();this.info={vid:(o=l==null?void 0:l.usbVendorId)==null?void 0:o.toString(16).padStart(4,"0"),pid:(u=l==null?void 0:l.usbProductId)==null?void 0:u.toString(16).padStart(4,"0")}}catch(l){throw l}}async connect(){var t,s;if(!this.port)throw new Error("Port is not available");await this.port.open({baudRate:115200}),this.reader=((t=this.port.readable)==null?void 0:t.getReader())||null,this.writer=((s=this.port.writable)==null?void 0:s.getWriter())||null,this.reader&&this.listen()}async disconnect(){if(!this.reader||!this.port)throw new Error("No active connection to disconnect from");try{await this.reader.cancel()}catch{}await this.port.forget()}async writeBytes(t){if(!this.writer)throw new Error("Writer is not initialized");await this.writer.write(t)}async listen(){if(!this.reader)throw new Error("Reader is not initialized");const t=new TextDecoder;await this.write(""),await this.write("");try{for(;;){const{value:s,done:r}=await this.reader.read();if(r||!s)break;this.receiveCallback(t.decode(s))}}catch(s){throw console.log("disconnect callback"),this.disconnectCallback(),s}}async flushInput(){if(!this.reader)throw new Error("Reader is not initialized");this.receivedData=""}}class se{constructor(e){B(this,"port");B(this,"end");this.port=e,this.end=async()=>{}}static async begin(e,t=!1){var r;const s=new se(e);await s.enterRawRepl(t);try{await s.exec("import sys,os")}catch(i){throw await((r=s.end)==null?void 0:r.call(s)),i}return s}async interruptProgram(){await this.port.write("")}async enterRawRepl(e=!1){const t=await this.port.startTransaction();try{await this.interruptProgram(),await this.port.flushInput(),await this.port.write("\r"),await this.port.readUntil(`raw REPL; CTRL-B to exit\r
`),e&&(await this.port.write(""),await this.port.readUntil("OK")),this.end=async()=>{try{await this.port.write(""),await this.port.readUntil(`>\r
`),await this.port.readUntil(">>> ")}finally{t()}}}catch(s){throw t(),s}}async exec(e,t=5e3,s=!1){if(e.length===0)return"";await this.port.write(e),await this.port.write(""),await this.port.readUntil("OK"),this.port.emit=s,s&&this.port.prevRecvCbk(this.port.receivedData);const r=(await this.port.readUntil("",t)).slice(0,-1),i=(await this.port.readUntil("",t)).slice(0,-1);if(i.length)throw new Error(i);return r}async readFile(e){const t=await this.exec(`
try:
 import binascii
 h=lambda x: binascii.hexlify(x).decode()
 h(b'')
except:
 h=lambda b: ''.join('{:02x}'.format(byte) for byte in b)
with open('${e}','rb') as f:
 while 1:
  b=f.read(64)
  if not b:break
  print(h(b),end='')
`);return t.length?new Uint8Array(t.match(/../g).map(s=>parseInt(s,16))):new Uint8Array}async writeFile(e,t,s=128,r=!1){if(typeof t=="string"){const u=new TextEncoder;t=new Uint8Array(u.encode(t))}const i=u=>Array.from(u).map(l=>l.toString(16).padStart(2,"0")).join(""),a=u=>{u=new Uint8Array(u);let l="b'";for(const d of u)d>=32&&d<=126?d===92||d===39?l+="\\"+String.fromCharCode(d):l+=String.fromCharCode(d):l+="\\x"+d.toString(16).padStart(2,"0");return l+="'",l},o=r?e:".viper.tmp";await this.exec(`
try:
 import binascii
 h=binascii.unhexlify
 h('')
except:
 h=lambda s: bytes(int(s[i:i+2], 16) for i in range(0, len(s), 2))
f=open('${o}','wb')
w=lambda d: f.write(h(d))
o=f.write
`);for(let u=0;u<t.byteLength;u+=s){const l=t.slice(u,u+s),d="w('"+i(l)+"')",p="o("+a(l)+")";d.length<p.length?await this.exec(d):await this.exec(p)}r?await this.exec("f.close()"):await this.exec(`f.close()
try: os.remove('${e}')
except: pass
os.rename('${o}','${e}')
`)}async getDeviceInfo(){const e=await this.exec(`
try: u=os.uname()
except: u=('','','','',sys.platform)
try: v=sys.version.split(';')[1].strip()
except: v='MicroPython '+u[2]
mpy=getattr(sys.implementation, '_mpy', 0)
sp=':'.join(sys.path)
d=[u[4],u[2],u[0],v,mpy>>10,mpy&0xFF,(mpy>>8)&3,sp]
print('|'.join(str(x) for x in d))
`);let[t,s,r,i,a,o,u,l]=e.trim().split("|");const d=l.split(":");try{a=["","x86","x64","armv6","armv6m","armv7m","armv7em","armv7emsp","armv7emdp","xtensa","xtensawin","rv32imc"][parseInt(a)]}catch{a=""}let p=parseInt(o,10);const w=parseInt(u,10);return p||(p="py"),{machine:t,release:s,sysname:r,version:i,mpy_arch:a,mpy_ver:p,mpy_sub:w,sys_path:d}}async touchFile(e){await this.exec(`
f=open('${e}','wb')
f.close()
`)}async moveFile(e,t){await this.exec(`os.rename('${e}', '${t}')`)}async makeDir(e){await this.exec(`os.mkdir('${e}')`)}async makePath(e){await this.exec(`
p=''
for d in '${e}'.split('/'):
 if not d: continue
 p += '/'+d
 try: os.mkdir(p)
 except OSError as e:
  if e.args[0] not in (17, 20): raise
`)}async removeFile(e){await this.exec(`
try:
 os.remove('${e}')
except OSError as e:
 if e.args[0] == 39:
  throw new Error('Directory not empty')
 else:
  throw e
`)}async removeDir(e){await this.exec(`
try:
 os.rmdir('${e}')
except OSError as e:
 if e.args[0] == 39:
  throw new Error('Directory not empty')
 else:
  throw e
`)}async getFsStats(e="/"){return(await this.exec(`
s = os.statvfs('${e}')
fs = s[1] * s[2]
ff = s[3] * s[0]
fu = fs - ff
print('%s|%s|%s'%(fu,ff,fs))
`)).trim().split("|")}async getFiles(){return await this.exec(`
def walk(p):
 for n in os.listdir(p if p else '/'):
  fn=p+'/'+n
  try: s=os.stat(fn)
  except: s=(0,)*7
  try:
   if s[0] & 0x4000 == 0:
    print('f|'+fn+'|'+str(s[6]))
   elif n not in ('.','..'):
    print('d|'+fn+'|'+str(s[6]))
    walk(fn)
  except:
   print('f|'+p+'/???|'+str(s[6]))
walk('')
`)}async readSysInfoMD(){return await this.exec(`
import gc
gc.collect()
mu = gc.mem_alloc()
mf = gc.mem_free()
ms = mu + mf
uname=os.uname()
p=print
def size_fmt(size):
 suffixes = ['B','KiB','MiB','GiB','TiB']
 i = 0
 while size > 1024 and i < len(suffixes)-1:
  i += 1
  size //= 1024
 return "%d%s" % (size, suffixes[i])
p('## Machine')
p('- Name: \`'+uname.machine+'\`')
try:
 gc.collect()
 import microcontroller as uc
 p('- CPU: \`%s @ %s MHz\`' % (sys.platform, uc.cpu.frequency // 1_000_000))
 p('- UID: \`%s\`' % (uc.cpu.uid.hex(),))
 p('- Temp.: \`%s Â°C\`' % (uc.cpu.temperature,))
 p('- Voltage: \`%s V\`' % (uc.cpu.voltage,))
except:
 try:
  gc.collect()
  import machine
  p('- CPU: \`%s @ %s MHz\`' % (sys.platform, machine.freq() // 1_000_000))
 except:
  p('- CPU: \`'+sys.platform+'\`')
p()
p('## System')
p('- Version: \`'+sys.version.split(";")[1].strip()+'\`')
if ms:
 p('- Memory use:  \`%s / %s, free: %d%%\`' % (size_fmt(mu), size_fmt(ms), (mf * 100) // ms))
`)}}const Te=g(!1);g(Qe());const Y=g(!1),Jt=g(!1),Qt=g(),O=g(!1),Be=g(!1),Ke=g(!1),qe=g(),de=g(!1),Ue=g(!1),Zt=g(!1),en=g(),ne=g(!1),Oe=g(!1),tn=g(!1),nn=g();let R=null;function sn(n){return new Promise(e=>setTimeout(e,n))}async function rn(n){try{de.value=!0,Ue.value=!1,await n(),Ue.value=!0}catch(e){Zt.value=!0,en.value=e}finally{de.value=!1}}async function an(n){try{ne.value=!0,Oe.value=!1,await n(),Oe.value=!0}catch(e){tn.value=!0,nn.value=e}finally{ne.value=!1}}function ae(n){return"children"in n}function Je(n){if(n){n.children.sort((e,t)=>ae(e)&&!ae(t)?-1:!ae(e)&&ae(t)?1:e.name.localeCompare(t.name));for(const e of n.children)ae(e)&&Je(e)}}async function on(){if(!R)return{name:"",path:"",children:[]};const n=await se.begin(R,!0),e=await n.getFiles();await n.end();const t=ln(e);return Je(t),t}function ln(n){const e={name:"",path:"",children:[]},t=n.trim().split(`
`),s={"":e};for(const r of t){const[i,a,o]=r.split("|"),u=a.split("/"),l=u[u.length-1],d=u.slice(0,-1).join("/")||"";if(i==="f"){const p={name:l,path:a,size:parseInt(o)};s[d]&&s[d].children.push(p)}else if(i==="d"){const p={name:l,path:a,children:[]};s[a]=p,s[d]&&s[d].children.push(p)}}return e}function Xe(n,e){let t=!1;const s=n.trim().split(`
`),r=i=>{const[a,o,u]=i.split("|");return o===e};return s.find(r)&&(t=!0),t}function Qe(){return/(iPad|iPhone|iPod)/g.test(navigator.userAgent)?(console.error("WebSerial is not available on iOS"),!1):window.isSecureContext?"serial"in navigator||"usb"in navigator?!0:(console.error("Try Chrome, Edge, Opera, Brave","WebSerial and WebUSB are not supported"),!1):(console.error("WebSerial cannot be accessed with unsecure connection"),!1)}async function un(){let n;if(n=new qt,!Qe())return null;try{await n.requestAccess()}catch(e){return Qt.value=e,null}return n}async function cn(n,e,t){try{await n.connect(),Y.value=!0}catch{Te.value=!1,Y.value=!1,O.value=!1,ne.value=!1,de.value=!1,Jt.value=!0;return}n.onReceive(e),n.onDisconnect(()=>{t(),Y.value=!1,O.value=!1,ne.value=!1,de.value=!1,Te.value=!1}),R=n}async function pn(){R==null||R.disconnect(),R=null,Te.value=!1,Y.value=!1,O.value=!1,de.value=!1,ne.value=!1}async function dn(n){if(R)if(O.value)await R.write(n);else{const e=await R.mutex.acquire();try{await R.write(n)}finally{e()}}}async function fn(){if(!R)return"";try{await R.write("\r"),O.value=!1}catch(n){Ke.value=!0,O.value=!1,qe.value=n}}async function hn(n){if(!R||(O.value&&await R.write("\r"),n.length===0))return;const e=!0,t=-1,s=await se.begin(R,e);try{Be.value=!1,O.value=!0;const r=!0;await sn(10),await s.exec(n,t,r),Be.value=!0}catch(r){let i;r instanceof Error?i=r.message:i=String(r),i.includes("KeyboardInterrupt")||(Ke.value=!0,qe.value=r)}finally{R.emit=!1,O.value=!1}await s.end()}async function Ce(n){if(!R)return"";let e="";const t=await se.begin(R);return await rn(async()=>{const s=await t.readFile(n);e=new TextDecoder("utf-8",{fatal:!0}).decode(s)}),t.end(),e}async function vn(){if(!R)return"";const n=await se.begin(R),e=await n.getFiles();await n.end();let t="";return Xe(e,"/main.py")?t=await Ce("/main.py"):Xe(e,"/code.py")?t=await Ce("/code.py"):(t="",await Ze("/main.py",t)),t}async function Ze(n,e){if(!R)return;const t=await se.begin(R);await an(async()=>await t.writeFile(n,e)),t.end()}const De=fe("useTerminalStore",()=>{const n=g("");let e="";const t=65536;let s=null;const r=g(0);let i=null;const a=w=>{for(let f=0;f<w.length;f++){let h=w[f];h==="\b"?r.value=Math.max(0,r.value-1):h==="\x1B"?(h=w[++f],h==="["&&(h=w[++f],h==="K"&&(e=e.slice(0,r.value)+n.value.slice(r.value+1),o()))):(e+=h,e.length>t&&(e=e.slice(e.length-t,e.length)),o())}},o=()=>{s||(s=setTimeout(()=>{u(),s=null},1))},u=()=>{n.value=e,r.value=n.value.length,d()},l=()=>{n.value="",e="",r.value=0,s&&(clearTimeout(s),s=null)},d=()=>{i&&(i.scrollTop=i.scrollHeight)};return{output:n,caret:r,write:a,clear:l,openTerminal:w=>{i=w}}}),Pe=fe("useMPDeviceStore",()=>{const n=g(localStorage.getItem("fileContent")||""),e=g(""),t=g(""),s=g(!1),r=g([]),i=g({name:"",path:"",children:[]});async function a(l,d){r.value=[l],t.value=l,n.value=d}async function o(l){r.value=[l],t.value=l,n.value=await Ce(l)}function u(l){n.value=l}return{isProject:s,activeFiles:r,fileContent:n,fileName:e,filePath:t,fileTree:i,openFile:a,loadFile:o,setCode:u}}),mn={key:0,class:"material-icons"},gn={key:1,class:"material-icons"},wn=G({__name:"IdeButtons",setup(n){const e=Pe(),t=De(),{isProject:s,filePath:r,fileContent:i,fileTree:a}=te(e),{openFile:o}=e;let u=null;_e(()=>{s.value||(u=setInterval(()=>{localStorage.setItem("fileContent",i.value)},1e3))}),mt(()=>{u&&clearInterval(u)});async function l(){const f=await un();if(f&&(await cn(f,t.write,()=>{s.value&&(r.value="",i.value=""),a.value={name:"empty",path:"",children:[]}}),t.clear(),s.value)){const h=await vn();o("/main.py",h),a.value=await on()}}function d(){Y.value?(pn(),s.value&&(r.value="",i.value="",a.value={name:"empty",path:"",children:[]})):l()}const p=g(!1);function w(){hn(i.value)}return(f,h)=>{const E=Ee;return T(),M("div",null,[V(E,{type:"button",class:J(["w-9 h-9 mr-1 text-white",y(Y)?p.value?"bg-red-500":"bg-green-500":"bg-gray-600"]),rounded:"",text:"",onClick:h[0]||(h[0]=_=>d()),onMouseover:h[1]||(h[1]=_=>p.value=!0),onMouseleave:h[2]||(h[2]=_=>p.value=!1)},{default:K(()=>[p.value&&y(Y)?(T(),M("span",mn,"close")):(T(),M("span",gn,"cable"))]),_:1},8,["class"]),V(E,{id:"#run",type:"button",class:"w-9 h-9 mr-1",variant:y(O)||!y(Y)?"outlined":void 0,severity:"info",rounded:"",onClick:w,disabled:y(O)||!y(Y),loading:y(O)},{default:K(()=>h[5]||(h[5]=[b("span",{class:"material-icons"},"play_arrow",-1)])),_:1},8,["variant","disabled","loading"]),V(E,{type:"button",class:"w-9 h-9 mr-1",variant:!y(O)||!y(Y)?"outlined":void 0,severity:"danger",rounded:"",onClick:h[3]||(h[3]=_=>y(fn)()),disabled:!y(O)||!y(Y)},{default:K(()=>h[6]||(h[6]=[b("span",{class:"material-icons"},"stop",-1)])),_:1},8,["variant","disabled"]),V(E,{type:"button",class:"w-9 h-9",variant:"outlined",severity:"secondary",rounded:"",onClick:h[4]||(h[4]=_=>y(Ze)(y(r),y(i))),disabled:y(ne)||y(O)||!y(Y),loading:y(ne)},{default:K(()=>h[7]||(h[7]=[b("span",{class:"material-icons"},"save",-1)])),_:1},8,["disabled","loading"])])}}}),yn={class:"relative flex h-full"},Es=G({__name:"CodeView",setup(n){const e=Pe(),{fileContent:t}=te(e);return(s,r)=>(T(),M("div",yn,[V(Pt,{modelValue:y(t),"onUpdate:modelValue":r[0]||(r[0]=i=>gt(t)?t.value=i:null)},null,8,["modelValue"]),r[1]||(r[1]=b("div",{id:"#editor",class:"absolute top-10 left-10"},null,-1)),V(wn,{class:"absolute bottom-2 right-2"})]))}}),bn={class:"flex flex-col h-full"},xn={class:"flex px-2 w-full bg-zinc-900 text-white h-6 justify-between items-center"},Sn=G({__name:"TerminalView",setup(n){const e=g(!1),t=De(),{output:s}=te(t);function r(a){let o=a.key;if(o==="Enter")o=`
\r`;else if(o==="Backspace")o="\b";else if(o.length>1)return;dn(o)}const i=g(null);return _e(()=>{t.openTerminal(i.value)}),(a,o)=>{const u=Ee;return T(),M("div",bn,[b("div",xn,[o[4]||(o[4]=b("span",{class:"material-icons"},"terminal",-1)),V(u,{onClick:o[0]||(o[0]=l=>y(t).clear()),class:"w-4 h-4 text-white",link:""},{default:K(()=>o[3]||(o[3]=[b("span",{class:"material-icons",style:{"font-size":"16px"}},"cleaning_services",-1)])),_:1})]),b("pre",{class:"h-full font-mono overflow-auto p-2 text-white bg-black",ref_key:"el",ref:i,tabindex:"0",onKeydown:r,onFocus:o[1]||(o[1]=l=>e.value=!0),onBlur:o[2]||(o[2]=l=>e.value=!1)},[o[5]||(o[5]=Ae("")),b("span",null,pe(y(s)),1),b("span",{class:J([{caret:e.value},"bg-white"])}," ",2),o[6]||(o[6]=Ae(`
    `))],544)])}}}),zs=he(Sn,[["__scopeId","data-v-61224fc2"]]),_n={class:"color-picker select-none w-32"},En={class:"slider-container"},zn={class:"slider-container"},Pn=G({__name:"ColorPicker",props:{modelValue:{required:!0,default:{r:0,g:0,b:0}},modelModifiers:{}},emits:["update:modelValue"],setup(n){const e=wt(n,"modelValue"),{h:t,s}=d(e.value.r,e.value.g,e.value.b),r=g(t/360),i=g(),a=g(s/100),o=g();let u=!1,l=!1;function d(v,c,x){v/=255,c/=255,x/=255;const m=Math.max(v,c,x),D=Math.min(v,c,x),X=m-D;let F=0;X!==0&&(m===v?F=(c-x)/X%6:m===c?F=(x-v)/X+2:F=(v-c)/X+4,F=Math.round(F*60),F<0&&(F+=360));const W=(m+D)/2,j=X===0?0:X/(1-Math.abs(2*W-1));return{h:F,s:j*100,l:W*100}}function p(v,c,x){v=v*360%360,c/=100,x/=100;const m=(1-Math.abs(2*x-1))*c,D=m*(1-Math.abs(v/60%2-1)),X=x-m/2;let F=0,W=0,j=0;return 0<=v&&v<60?(F=m,W=D,j=0):60<=v&&v<120?(F=D,W=m,j=0):120<=v&&v<180?(F=0,W=m,j=D):180<=v&&v<240?(F=0,W=D,j=m):240<=v&&v<300?(F=D,W=0,j=m):300<=v&&v<=360&&(F=m,W=0,j=D),{r:Math.round((F+X)*255),g:Math.round((W+X)*255),b:Math.round((j+X)*255)}}function w(v,c,x){const m=(1-x+c)/2;let D;return m===0||m===1?D=0:D=(1-x-c)/(1-Math.abs(2*m-1)),{h:v,s:D*100,l:m*100}}const f=ee(()=>{const{h:v,s:c,l:x}=w(r.value,1-a.value,0),{r:m,g:D,b:X}=p(v,c,x);return e.value={r:m,g:D,b:X},`hsl(${v}turn, ${c}%, ${x}%)`}),h=v=>{l=!l,_(v),window.addEventListener("pointermove",_),window.addEventListener("pointerup",E)},E=()=>{l=!1,window.removeEventListener("pointermove",_),window.removeEventListener("pointerup",E)},_=v=>{if(l){const c=o.value.getBoundingClientRect(),x=Math.min(c.width,Math.max(0,v.clientX-c.left));a.value=x/c.width}},A=v=>{u=!u,z(v),window.addEventListener("pointermove",z),window.addEventListener("pointerup",C)},C=()=>{u=!1,window.removeEventListener("pointermove",z),window.removeEventListener("pointerup",C)},z=v=>{if(u){const c=i.value.getBoundingClientRect(),x=Math.min(c.width,Math.max(0,v.clientX-c.left));r.value=x/c.width}};return(v,c)=>(T(),M("div",_n,[b("div",En,[b("div",{class:"hue-slider",style:{background:"linear-gradient(to right, red, yellow, lime, cyan, blue, magenta, red)"},onPointerdown:A,onPointerup:C,onPointermove:z,ref_key:"hueRef",ref:i},[b("div",{class:"slider-handle",style:N({left:`${r.value*100}%`})},null,4)],544)]),b("div",zn,[b("div",{class:"saturation-slider",style:N({background:`linear-gradient(to right, white, hsl(${r.value}turn, 100%, 50%))`}),onPointerdown:h,onPointerup:E,onPointermove:_,ref_key:"saturationRef",ref:o},[b("div",{class:"slider-handle",style:N({left:`${a.value*100}%`})},null,4)],36)]),Ye(b("div",{class:"color-preview",style:N({backgroundColor:`${f.value}`})},null,4),[[yt,!1]])]))}}),Ln=he(Pn,[["__scopeId","data-v-53a96f93"]]);function $n(n){return bt()?(xt(n),!0):!1}const kn=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const Tn=Object.prototype.toString,Cn=n=>Tn.call(n)==="[object Object]",Mn=()=>{};function Ve(n){return Array.isArray(n)?n:[n]}const Ie=kn?window:void 0;function et(n){var e;const t=je(n);return(e=t==null?void 0:t.$el)!=null?e:t}function le(...n){let e,t,s,r;if(typeof n[0]=="string"||Array.isArray(n[0])?([t,s,r]=n,e=Ie):[e,t,s,r]=n,!e)return Mn;t=Ve(t),s=Ve(s);const i=[],a=()=>{i.forEach(d=>d()),i.length=0},o=(d,p,w,f)=>(d.addEventListener(p,w,f),()=>d.removeEventListener(p,w,f)),u=ze(()=>[et(e),je(r)],([d,p])=>{if(a(),!d)return;const w=Cn(p)?{...p}:p;i.push(...t.flatMap(f=>s.map(h=>o(d,f,h,w))))},{immediate:!0,flush:"post"}),l=()=>{u(),a()};return $n(l),l}const Dn={page:n=>[n.pageX,n.pageY],client:n=>[n.clientX,n.clientY],screen:n=>[n.screenX,n.screenY],movement:n=>n instanceof Touch?null:[n.movementX,n.movementY]};function In(n={}){const{type:e="page",touch:t=!0,resetOnTouchEnds:s=!1,initialValue:r={x:0,y:0},window:i=Ie,target:a=i,scroll:o=!0,eventFilter:u}=n;let l=null,d=0,p=0;const w=g(r.x),f=g(r.y),h=g(null),E=typeof e=="function"?e:Dn[e],_=m=>{const D=E(m);l=m,D&&([w.value,f.value]=D,h.value="mouse"),i&&(d=i.scrollX,p=i.scrollY)},A=m=>{if(m.touches.length>0){const D=E(m.touches[0]);D&&([w.value,f.value]=D,h.value="touch")}},C=()=>{if(!l||!i)return;const m=E(l);l instanceof MouseEvent&&m&&(w.value=m[0]+i.scrollX-d,f.value=m[1]+i.scrollY-p)},z=()=>{w.value=r.x,f.value=r.y},v=u?m=>u(()=>_(m),{}):m=>_(m),c=u?m=>u(()=>A(m),{}):m=>A(m),x=u?()=>u(()=>C(),{}):()=>C();if(a){const m={passive:!0};le(a,["mousemove","dragover"],v,m),t&&e!=="movement"&&(le(a,["touchstart","touchmove"],c,m),s&&le(a,"touchend",z,m)),o&&e==="page"&&le(i,"scroll",x,{passive:!0})}return{x:w,y:f,sourceType:h}}function tt(n,e={}){const{handleOutside:t=!0,window:s=Ie}=e,r=e.type||"page",{x:i,y:a,sourceType:o}=In(e),u=g(n??(s==null?void 0:s.document.body)),l=g(0),d=g(0),p=g(0),w=g(0),f=g(0),h=g(0),E=g(!0);let _=()=>{};return s&&(_=ze([u,i,a],()=>{const A=et(u);if(!A||!(A instanceof Element))return;const{left:C,top:z,width:v,height:c}=A.getBoundingClientRect();p.value=C+(r==="page"?s.pageXOffset:0),w.value=z+(r==="page"?s.pageYOffset:0),f.value=c,h.value=v;const x=i.value-p.value,m=a.value-w.value;E.value=v===0||c===0||x<0||m<0||x>v||m>c,(t||!E.value)&&(l.value=x,d.value=m)},{immediate:!0}),le(document,"mouseleave",()=>{E.value=!0})),{x:i,y:a,sourceType:o,elementX:l,elementY:d,elementPositionX:p,elementPositionY:w,elementHeight:f,elementWidth:h,isOutside:E,stop:_}}const Rn="/assets/yellow_led-TydLrbQ8.jpg";function ie(n){return{state:g(0),mode:n}}const Le=(n={})=>{const{mode0:e="gnd",mode1:t="power",mode2:s="air",mode3:r="air",setShared:i=()=>{},getShared:a=()=>{}}=n,o=ie(e),u=ie(t),l=ie(s),d=ie(r);return{pin0:o,pin1:u,pin2:l,pin3:d,setShared:i,getShared:a}},An={ref:"theref"},Fn={class:"rounded-lg overflow-hidden relative"},Bn=["src"],Un={key:1,class:"absolute top-0 left-0"},On=G({__name:"LED",setup(n,{expose:e}){const{isOutside:t}=tt(Ge("theref")),s=Le({mode2:"input",setShared:w=>{i.value=w.color.value},getShared:()=>({color:i})});e(s);const{pin2:r}=s,i=g({r:255,g:0,b:0}),a=g({visible:!1,toggle:w=>{}});function o(w){a.value.toggle(w)}const u=ee(()=>`
0 0 3px 3px rgba(${i.value.r}, ${i.value.g}, ${i.value.b}, ${r.state.value*.7}),
0 0 5px 5px rgba(${i.value.r}, ${i.value.g}, ${i.value.b}, ${r.state.value*.5}),
0 0 7px 7px rgba(${i.value.r}, ${i.value.g}, ${i.value.b}, ${r.state.value*.3})
`),l=ee(()=>`radial-gradient(circle, rgb(${i.value.r}, ${i.value.g}, ${i.value.b}) 40%, #000 90%)`),d=ee(()=>`rgb(${i.value.r}, ${i.value.g}, ${i.value.b})`),p=ee(()=>`rgba(${i.value.r}, ${i.value.g}, ${i.value.b}, 0.7)`);return(w,f)=>{const h=Ee,E=St;return T(),M("div",An,[b("div",Fn,[b("img",{src:y(Rn),alt:"LED"},null,8,Bn),b("div",{class:"absolute top-[10px] left-[30px] rounded-full h-[19px] w-[19px]",style:N({background:d.value})},null,4),b("div",{class:"absolute top-[12px] left-[32px] rounded-full h-[15px] w-[15px]",style:N({background:l.value})},null,4),y(r).state.value?(T(),M("div",{key:0,class:"absolute top-2 left-7 rounded-full h-6 w-6 p-0 border-none absolute top-0 left-0 overflow-hidden",style:N({boxShadow:u.value,background:p.value})},null,4)):re("",!0),!y(t)||a.value.visible?(T(),M("div",Un,[V(h,{type:"button",class:"w-6 h-6 bg-black",rounded:"",onClick:o,onPointerdown:f[0]||(f[0]=ce(()=>{},["stop"]))},{default:K(()=>f[2]||(f[2]=[b("span",{class:"material-icons"},"palette",-1)])),_:1})])):re("",!0),V(E,{ref_key:"cp",ref:a},{default:K(()=>[V(Ln,{modelValue:i.value,"onUpdate:modelValue":f[1]||(f[1]=_=>i.value=_)},null,8,["modelValue"])]),_:1},512)])],512)}}}),Xn=he(On,[["__scopeId","data-v-799d0c28"]]),Vn="/assets/push_button-DvCvYEel.jpg",Hn={ref:"theref"},Nn={class:"rounded-lg overflow-hidden relative"},Wn=["src"],Yn=G({__name:"PushButton",setup(n,{expose:e}){const{isOutside:t}=tt(Ge("theref")),s=Le({mode2:"input",setShared:p=>{i.value=p},getShared:()=>i.value});e(s);const{pin2:r}=s,i=g(""),a=g(!1),o=p=>{!a.value&&p.key.toUpperCase()===i.value&&(r.state.value=1)},u=p=>{!a.value&&p.key.toUpperCase()===i.value&&(r.state.value=0)},l=p=>{a.value&&p.key==="Escape"&&(i.value="",a.value=!1,window.removeEventListener("keydown",l)),a.value&&/^[A-Za-z0-9]$/.test(p.key)&&(i.value=p.key.toUpperCase(),a.value=!1,window.removeEventListener("keydown",l))},d=p=>{p.stopPropagation(),a.value=!0,window.addEventListener("keydown",l)};return _e(()=>{window.addEventListener("keydown",o),window.addEventListener("keyup",u)}),_t(()=>{window.removeEventListener("keydown",o),window.removeEventListener("keyup",u)}),(p,w)=>(T(),M("div",Hn,[b("div",Nn,[b("img",{src:y(Vn),alt:"Push Button"},null,8,Wn),b("button",{class:J(["absolute top-[27px] left-[27px] rounded-full w-[25px] h-[25px]",y(r).state.value?"bg-green-500":"bg-purple-500"]),onPointerdown:w[0]||(w[0]=f=>y(r).state.value=1),onPointerup:w[1]||(w[1]=f=>y(r).state.value=0),onPointerleave:w[2]||(w[2]=f=>y(r).state.value=0)},pe(i.value),35),!y(t)||a.value?(T(),M("button",{key:0,onClick:d,onPointerdown:w[3]||(w[3]=ce(()=>{},["stop"])),class:"absolute w-full h-4 text-xs top-0 left-0 bg-black/[0.8] text-white rounded-lg"},pe(a.value?"Press a key...":i.value?"Set shortcut":"Add shortcut"),33)):re("",!0)])],512))}}),jn="/assets/potentiometer-CklP_JJ1.jpg",Gn={class:"rounded-lg overflow-hidden relative"},Kn=["src"],qn={class:"absolute rounded-full top-5 left-8 w-10 h-10"},Jn={key:0,class:"absolute bottom-0 left-0 flex items-center"},Qn=G({__name:"Potentiometer",setup(n,{expose:e}){const t=Le({mode2:"input",setShared:p=>{s.state.value=p},getShared:()=>s.state.value});e(t);const{pin2:s}=t,r=ee(()=>s.state.value*6/8-3/8),i=g(!1);let a=!1,o=0;const u=p=>{p.stopPropagation(),p.preventDefault(),a=!a,o=p.clientX,i.value=a,window.addEventListener("pointermove",d),window.addEventListener("pointerup",l)},l=()=>{a=!1,i.value=a,window.removeEventListener("pointermove",d),window.removeEventListener("pointerup",l)},d=p=>{if(a){const w=(p.clientX-o)/20;o=p.clientX,s.state.value=Math.min(1,Math.max(0,s.state.value+w/2))}};return(p,w)=>(T(),M("div",null,[b("div",Gn,[b("img",{src:y(jn),alt:"Potentiometer"},null,8,Kn),b("button",qn,[b("div",null,[b("div",{class:"top-0 left-0 relative w-10 h-10 rounded-full bg-rose-600 flex items-center justify-center",onPointerdown:u,style:N(`transform: rotate(${r.value}turn)`)},w[1]||(w[1]=[b("div",{class:"absolute top-0 left-4.5 w-1 h-5 bg-white"},null,-1),b("div",{class:"absolute inset-0 flex items-center justify-center pointer-events-none"},null,-1)]),36)])]),i.value?(T(),M("div",Jn,[Ye(b("input",{type:"range",min:"0",max:"1",step:"0.01","onUpdate:modelValue":w[0]||(w[0]=f=>y(s).state.value=f),class:"w-full cursor-pointer"},null,512),[[Et,y(s).state.value]])])):re("",!0)])]))}}),Zn="/assets/encoder-BbdKADqm.jpg",es="/assets/encoder_knob-Du3tJHEr.png",ts={class:"rounded-lg overflow-hidden relative"},ns=["src"],ss=["src"],is={key:0,class:"absolute bg-blue-500 top-0 left-4.5 w-1 h-1"},rs={class:"absolute bottom-1 left-[25px] flex items-center"},as=G({__name:"Encoder",setup(n,{expose:e}){const t=Le({mode1:"input",mode2:"input",setShared:c=>{u.value=c},getShared:()=>u.value});e(t);const{pin0:s,pin1:r,pin2:i,pin3:a}=t,o=ee(()=>s.state.value===0&&r.state.value>0),u=g(0),l=g(!1);let d=!1,p=0,w=0,f=0,h=0,E=0,_=null;const A=c=>{if(c.stopPropagation(),c.preventDefault(),h=Math.atan2(c.clientY-w,c.clientX-p)/(2*Math.PI)+1/4,E=u.value,d=!d,l.value=d,c.currentTarget instanceof HTMLElement){const m=c.currentTarget.getBoundingClientRect();p=m.left+m.width/2,w=m.top+m.height/2}window.addEventListener("pointermove",v),window.addEventListener("pointerup",z)},C=()=>{if(!_)return;let c=f-u.value;c>.5&&(c-=1),c<-.5&&(c+=1);const x=.1;Math.abs(c)>.001?(u.value+=c*x,u.value>1&&(u.value-=1),u.value<0&&(u.value+=1),_=requestAnimationFrame(C)):(u.value=f,cancelAnimationFrame(_),_=null)},z=()=>{const c=.041666666666666664;f=Math.round(u.value/c)*c,_||(_=requestAnimationFrame(C)),d=!1,l.value=d,window.removeEventListener("pointermove",v),window.removeEventListener("pointerup",z)},v=c=>{if(d){let m=Math.atan2(c.clientY-w,c.clientX-p)/(2*Math.PI)+1/4-h;f=E+m,console.log(h,m,u.value,f),_||(_=requestAnimationFrame(C))}};return ze(u,()=>{i.state.value=Math.abs(u.value*96%4)<2?1:0,a.state.value=Math.abs((u.value*96+95)%4)<2?1:0,console.log(i.state.value),console.log(a.state.value)}),(c,x)=>(T(),M("div",null,[b("div",ts,[b("img",{src:y(Zn),alt:"Potentiometer"},null,8,ns),b("button",{class:"absolute rounded-full top-3 left-6 w-14 h-14",onPointerdown:A},[b("img",{class:"top-0 left-0 w-14 h-14",src:y(es),style:N(`transform: rotate(${u.value}turn)`)},null,12,ss),o.value?(T(),M("div",is)):re("",!0)],32),b("div",rs,[b("div",{class:J(["w-1 h-1 rounded-full",y(i).state.value?"bg-rose-500":"bg-transparent"])},null,2),x[0]||(x[0]=b("div",{class:"w-1 h-1 bg-transparent"},null,-1)),b("div",{class:J(["w-1 h-1 rounded-full",y(a).state.value?"bg-rose-500":"bg-transparent"])},null,2)])])]))}}),os=G({__name:"Module",setup(n,{expose:e}){const t=ie("air"),s=ie("air");return e({pin2:t,pin3:s}),(r,i)=>(T(),M("div"))}}),nt=fe("useLessonStore",()=>{const n=st(),{slots:e}=te(n),{locale:t}=zt(),s=Pe(),{fileContent:r}=te(s),{setCode:i}=s,a=g(null),o=g(null),u=g(!1),l=g(0);function d(z){z!=null&&(a.value=z,o.value=0)}function p(z){a.value!=null&&(a.value.steps=z)}async function w(z){if(a.value==null)return;if(o.value=z,_(),a.value.steps[o.value].title==""){u.value=!0;const{data:c}=await Lt.getStepByID(a.value.steps[o.value].id),x=await $t(c,t.value,!1);a.value.steps[z]=x,u.value=!1}const v=a.value.steps[o.value];v.type=="code"&&(v.inner.platformAction=="code2ide"&&i(v.inner.starting??""),v.inner.platformAction=="light-up"&&v.inner.highlights!=null&&f(v.inner.highlights))}function f(z){l.value=0;const v=z[l.value];v.slot==null||v.module==null||h(v.slot)}function h(z){const v=(z??"A").charCodeAt(0)-65;e.value[v].class="bg-yellow-200/[0.5]"}function E(){if(a.value==null||o.value==null)return;const v=a.value.steps[o.value].inner.highlights??null;if(v==null)return;if(l.value=l.value+1,l.value>=v.length){l.value=0;return}const c=v[l.value];c.slot==null||c.module==null||h(c.slot)}function _(){for(let z=0;z<=5;z++)e.value[z].class=""}function A(){console.log(`runCodePressed: ${r.value}`)}function C(z,v){if(console.log(`modulePutted: ${z}`,v),a.value==null||o.value==null)return;const x=a.value.steps[o.value].inner.highlights??null;if(x==null)return;const m=x[l.value];(m.slot??"A").charCodeAt(0)-65==z&&m.module==v&&(_(),E())}return{lesson:a,stepIndex:o,stepLoading:u,setLesson:d,setSteps:p,changeStep:w,runCodePressed:A,modulePutted:C}}),He=De(),{fileContent:ls}=te(Pe()),us=(n,e)=>{const t=Math.max(0,Math.min(n.x+n.w,e.x+e.w)-Math.max(n.x,e.x)),s=Math.max(0,Math.min(n.y+n.h,e.y+e.h)-Math.max(n.y,e.y));return t*s},st=fe("emulator",()=>{const n=oe([]),e=oe([Xn,Yn,Qn,as]),s={x:0,y:0,w:0,h:0,is:os,on:-1,ref:{pin2:{state:{value:0},mode:"none"},pin3:{state:{value:0},mode:"none"}},style:{},class:""},r=it(),i=g(!1),a=g(null),o=g(null),u=g(!1),l=g(!1),d=g(!1),p={x:203,y:48,w:40,h:20},w={x:242,y:40,w:8,h:8},f=oe({}),h=oe([{id:"A",pin2:0,pin3:1,pin2State:0,pin3State:0,with:s,x:69,y:49,w:80,h:80,style:{},class:""},{id:"B",pin2:2,pin3:3,pin2State:0,pin3State:0,with:s,x:69,y:152,w:80,h:80,style:{},class:""},{id:"C",pin2:28,pin3:22,pin2State:0,pin3State:0,with:s,x:69,y:255,w:80,h:80,style:{},class:""},{id:"D",pin2:4,pin3:5,pin2State:0,pin3State:0,with:s,x:297,y:49,w:80,h:80,style:{},class:""},{id:"E",pin2:6,pin3:7,pin2State:0,pin3State:0,with:s,x:297,y:152,w:80,h:80,style:{},class:""},{id:"F",pin2:26,pin3:27,pin2State:0,pin3State:0,with:s,x:297,y:255,w:80,h:80,style:{},class:""}]),E={0:0,1:0,2:1,3:1,28:2,22:2,4:3,5:3,6:4,7:4,26:5,27:5};function _(P){const L={x:0,y:0,w:80,h:80,is:P.is,on:0,ref:{setShared:H=>{}},class:"",style:{}};n.push(L);const I=P.ref.getShared();return Se(()=>{L.ref.setShared(I)}),L}function A(P,L,I){return q=>{if(!P)return;P.x=q.clientX-L,P.y=q.clientY-I;const $=[0,0,0,0,0,0];for(const[k,U]of h.entries())$[k]=us(P,U);let S=0;for(let k=1;k<$.length;k++)$[k]>$[S]&&(S=k);$[S]==0?o.value=null:o.value=S,i.value=P.y>400}}function C(P,L){L.x=h[P].x,L.y=h[P].y,h[P].with=L,L.on=P,Se(()=>{L.ref.pin2.mode==="output"&&(L.ref.pin2.state.value=h[P].pin2State),L.ref.pin3.mode==="output"&&(L.ref.pin3.state.value=h[P].pin3State)});const I=nt(),{modulePutted:H}=I;H(P,h[P].with.is.__name)}function z(P){h[P].with=s}let v,c;function x(){u.value=!0,r.clearDisplay(),v=new Worker(new URL("/assets/mpWorker-7i6aPlnQ.js",import.meta.url),{type:"module"}),l.value=!0,v.onmessage=P=>{const{command:L,data:I,sharedBuffer:H,sharedArrayInterrupt:q}=P.data;if(L==="error")He.write(I),d.value=!1,D.value=!1;else if(L==="finished")console.log("Finished"),d.value=!1;else if(L==="initialized")console.log("Inited"),u.value=!1,c=q;else if(L==="output")He.write(I);else if(L==="on"){const{pin:$}=I,S=h[E[$]];$===S.pin2&&(S.pin2State=1,S.with.ref.pin2.state.value=1),$===S.pin3&&(S.pin3State=1,S.with.ref.pin3.state.value=1)}else if(L==="off"){const{pin:$}=I,S=h[E[$]];$===S.pin2&&(S.pin2State=0,S.with.ref.pin2.state.value=0),$===S.pin3&&(S.pin3State=0,S.with.ref.pin3.state.value=0)}else if(L==="value"){const{pin:$}=I,S=h[E[$]];let k;$===S.pin2&&(k=S.with.ref.pin2.state.value),$===S.pin3&&(k=S.with.ref.pin3.state.value);const U=new Int32Array(H);Atomics.store(U,1,k),Atomics.store(U,0,1),Atomics.notify(U,0,1)}else if(L==="duty_u16"){const{pin:$,duty_u16:S}=I,k=h[E[$]];$===k.pin2&&(k.pin2State=S/65535,k.with.ref.pin2.state.value=S/65535),$===k.pin3&&(k.pin3State=S/65535,k.with.ref.pin3.state.value=S/65535)}else if(L==="adc read_u16"){const{pin:$}=I,S=h[E[$]];let k;$===S.pin2&&(k=S.with.ref.pin2.state.value),$===S.pin3&&(k=S.with.ref.pin3.state.value);const U=new Int32Array(H);Atomics.store(U,1,k*65535),Atomics.store(U,0,1),Atomics.notify(U,0,1)}else if(L==="display_text"){const{text:$,x:S,y:k}=I;r.writeText($,S,k)}else if(L==="clear_display")r.clearDisplay();else if(L==="i2c_read"){const{addr:$,nbytes:S,sharedBuffer:k}=I,U=new Int32Array(k);console.log(`I2C Read from Address: ${$}, Bytes: ${S}`);for(let Q=0;Q<S;Q++)U[Q+1]=Math.floor(Math.random()*256);Atomics.store(U,0,1),Atomics.notify(U,0,1)}}}function m(){d.value=!0,c[0]=0,v.postMessage({command:"runPython",code:ls.value})}const D=g(!1);function X(){D.value=!0,c[0]=2}function F(){v.terminate(),d.value=!1,u.value=!1,l.value=!1,v.onmessage=null}function W(P,L){const I=h[P].with,H=h[L].with;C(L,I),C(P,H)}function j(P,L,I,H){P.style={zIndex:"2"};const q=h[I];a.value=I;const $=H.clientX-P.x,S=H.clientY-P.y,k=A(P,$,S),U=P.x,Q=P.y,ve=()=>{o.value===null?(i.value&&(q.with=s,n.splice(L,1)),P.x=U,P.y=Q):W(I,o.value),document.removeEventListener("pointermove",k),document.removeEventListener("pointerup",ve),i.value=!1,a.value=null,o.value=null,P.style={zIndex:"1"}};document.addEventListener("pointermove",k),document.addEventListener("pointerup",ve)}function rt(P,L,I){if(I.currentTarget instanceof HTMLElement){const k=I.currentTarget,U=k.parentElement.parentElement,{top:Q,left:ve,width:at,height:ot}=k.getBoundingClientRect(),{top:lt,left:ut}=U.getBoundingClientRect();f.x=ve-ut,f.y=Q-lt,f.w=at,f.h=ot}f.is=P,Se(()=>{f.ref.setShared(L.getShared())});const H=I.clientX-f.x,q=I.clientY-f.y,$=A(f,H,q),S=()=>{if(f){if(o.value===null)i.value&&(f.x=0,f.y=0,f.is=s);else{const k=n.indexOf(h[o.value].with);k>-1&&n.splice(k,1),z(o.value),C(o.value,_(f))}o.value=null,f.is=s,f.x=0,f.y=0,i.value=!1,document.removeEventListener("pointermove",$),document.removeEventListener("pointerup",S)}};document.addEventListener("pointermove",$),document.addEventListener("pointerup",S)}return{usb:p,onLED:w,NoneModule:s,maxAreaIndex:o,fromSlotIndex:a,toDelete:i,slots:h,moduleComponents:e,modules:n,addModuleToSlot:C,removeModuleFromSlot:z,dragged:f,startDragFromSlot:j,startDragFromModuleList:rt,connect:x,run:m,stop:X,disconnect:F,isRunning:d,isStopping:D,isLoading:u,isConnected:l,newPiModule:_}}),it=fe("useST7789",()=>{const n=g(""),e=g(0),t=g(0),s=g("#000000");function r(a,o,u,l){n.value+=a+`\r
`,e.value=o,t.value=u,l&&(s.value=l)}function i(){n.value="",e.value=0,t.value=0,s.value="#000000"}return{text:n,x:e,y:t,textColor:s,writeText:r,clearDisplay:i}}),cs=["width","height"],Z=12,ps=G({__name:"Display",setup(n){const e=g(112),t=g(160),s=g(null),r=g(null),i=g(0),a=it();a.text||(a.text="");function o(d){const p=d.deltaY>0?1:-1;i.value+=p*Z,i.value=Math.max(0,i.value);const{lines:w,visibleLines:f}=u();console.log(w.length,i.value),i.value=Math.min(w.length*Z,i.value),l(w,f)}function u(){const d=[];let p=0;return r.value&&a.text&&(String(a.text).split(`
`).forEach(f=>{let h="";f.split(" ").forEach(_=>{const A=h+_+" ";r.value.measureText(A).width>e.value?(d.push(h),h=_+" "):h=A}),d.push(h)}),p=Math.ceil(t.value/Z)),{lines:d,visibleLines:p}}function l(d,p){if(r.value){r.value.fillStyle="#FFFFFF",r.value.fillRect(0,0,e.value,t.value),r.value.fillStyle=String(a.textColor)||"#000000",r.value.font="12px Monaco";const w=Math.floor(i.value/Z);for(let f=0;f<p;f++){const h=w+f;if(h<d.length){const E=(f+1)*Z-i.value%Z;r.value.fillText(d[h],0,E)}}}else console.warn("Canvas context is not initialized.")}return ze(()=>[a.text,a.textColor],()=>{const{lines:d,visibleLines:p}=u();i.value=Math.max(0,(d.length-p)*Z),console.log(i.value,d.length,p),l(d,p)}),_e(async()=>{if(await Se(),console.log("onMounted called"),!s.value){console.error("Canvas element not found!");return}if(r.value=s.value.getContext("2d"),r.value){console.log("Canvas context successfully initialized."),r.value.fillStyle="#FFFFFF",r.value.fillRect(0,0,e.value,t.value),console.log("Initial text:",a.text);const{lines:d,visibleLines:p}=u();console.log("Lines:",d,"Visible Lines:",p),i.value=0,l(d,p)}else console.error("Failed to initialize canvas context.")}),(d,p)=>(T(),M("div",{class:"display-container",onWheel:o},[b("canvas",{ref_key:"canvas",ref:s,width:e.value,height:t.value,style:{border:"1px solid black",width:"112px",height:"160px"}},null,8,cs)],32))}}),ds=he(ps,[["__scopeId","data-v-7ff5a871"]]),fs={class:"h-full parent relative flex flex-col border-t border-surface overflow-auto select-none"},hs={id:"pibody",class:"relative h-[450px] flex-shrink-0 max-h-[calc(100%-100px)] overflow-auto"},vs={class:"absolute top-4 right-1 flex flex-col gap-1"},ms={class:"material-icons"},gs={class:"material-icons"},ws=G({__name:"SimulationView",setup(n){const e=nt(),{runCodePressed:t}=e,s=st(),{maxAreaIndex:r,isLoading:i,isStopping:a,isRunning:o,isConnected:u,fromSlotIndex:l,toDelete:d,slots:p,dragged:w,moduleComponents:f,modules:h}=te(s),E=oe([]);s.connect();function _(){u.value?(s.run(),t()):s.connect()}return(A,C)=>{const z=kt,v=Ee;return T(),M("div",fs,[b("div",hs,[V(z,{src:y(Tt),width:"384px",draggable:"false",class:"absolute pt-4 min-w-[384px]",style:{left:"32px",top:"0px"}},null,8,["src"]),V(ds,{class:"absolute top-[213px] left-[167px] w-[112px] h-[160px]"}),b("div",vs,[V(v,{id:"#run",type:"button",class:"w-9 h-9 mr-1",severity:"info",rounded:"",onClick:_,disabled:y(i)||y(o)},{default:K(()=>[b("span",ms,pe(y(i)?"hourglass_top":"play_arrow"),1)]),_:1},8,["disabled"]),V(v,{type:"button",class:"w-9 h-9 mr-1",variant:y(o)?void 0:"outlined",severity:"danger",rounded:"",onClick:C[0]||(C[0]=c=>y(s).stop()),disabled:!y(o)||!y(u)},{default:K(()=>[b("span",gs,pe(y(a)?"hourglass_top":"stop"),1)]),_:1},8,["variant","disabled"])]),(T(!0),M(ue,null,we(y(p),(c,x)=>(T(),M("div",{key:x,class:J(["absolute w-20 h-20 border rounded-lg text-center",[{"bg-green-200/[0.5]":y(r)==x,"bg-blue-200/[0.5]":y(l)==x},c.class]]),style:N([c.style,{left:c.x+"px",top:c.y+"px"}])},null,6))),128)),b("div",{class:"absolute",style:N({left:y(s).onLED.x+"px",top:y(s).onLED.y+"px",width:y(s).onLED.w+"px",height:y(s).onLED.h+"px"})},null,4)]),(T(!0),M(ue,null,we(y(h),(c,x)=>(T(),M("div",{key:x},[(T(),ye(be(c.is),{style:N([c.style,{left:c.x+"px",top:c.y+"px"}]),class:J([c.class,"absolute w-20 h-20 border-sm rounded-xl overflow-hidden"]),onPointerdown:[m=>y(s).startDragFromSlot(c,x,c.on,m),C[1]||(C[1]=ce(m=>m.preventDefault(),["prevent"]))],ref_for:!0,ref:m=>c.ref=m},null,40,["style","class","onPointerdown"]))]))),128)),b("div",{class:J(["w-full overflow-auto flex flex-wrap bg-white gap-2 flex-grow justify-center",{"bg-rose-500":y(d)}])},[(T(!0),M(ue,null,we(y(f),(c,x)=>(T(),ye(be(c),{ref_for:!0,ref:m=>E.push(m),onPointerdown:[m=>y(s).startDragFromModuleList(c,E[x],m),C[2]||(C[2]=ce(m=>m.preventDefault(),["prevent"]))],class:"w-20 h-20 border-sm cursor-move"},null,40,["onPointerdown"]))),256))],2),(T(),ye(be(y(w).is),{ref:c=>y(w).ref=c,onDragover:C[3]||(C[3]=ce(c=>c.preventDefault(),["prevent"])),style:N({left:y(w).x+"px",top:y(w).y+"px",position:"absolute",zIndex:2}),class:"dragged w-20 m-2 h-20 border-sm rounded-xl text-center overflow-hidden bg-purple-700"},null,40,["style"]))])}}}),Ps=he(ws,[["__scopeId","data-v-9d625462"]]);export{Ps as S,zs as T,Es as _,jt as a,Ot as s,nt as u};
