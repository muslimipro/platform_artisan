import{s as E,a as K}from"./index-CMfQ5IVr.js";import{a as A,s as L}from"./index-BJk7I2-9.js";import{s as F}from"./index-BErXl6Bn.js";import{a as I,L as O,M as P,u as R,r as v,E as j,b as _,i as k,w as o,h as n,t as u,f as l,m as M,p as q,s as z,e as x,g as b,K as G,D as B,l as H,aK as J}from"./index-Bzt9KOfG.js";import{u as N}from"./useTeacherStore-C9elwidm.js";import{s as Q}from"./index-CI3NqVC7.js";import{T as D}from"./teacherApi-CCh-ZTdz.js";import"./index-Bid53Dqw.js";import"./index-DN6JhKxi.js";import"./index-BO_BlL6V.js";import"./index-BG5ZSxDp.js";import"./index-BVwihbXD.js";import"./index-ADFpD9ce.js";import"./index-DbdWTsGi.js";import"./index-DbQeVANJ.js";import"./index-CV6ojNDB.js";import"./http-j2rGyWLF.js";const W={class:"flex flex-col gap-1"},X={class:"flex flex-col"},Y={class:"font-bold text-sm mb-1"},Z={class:"flex gap-2 justify-end"},ee=I({__name:"EditClassDialog",props:O({selectedClass:{}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(w){const c=P(w,"modelValue"),m=w,r=R(),T=N(),{loadClasses:y}=T,i=v(""),d=v(!1);j(()=>m.selectedClass,e=>{i.value="",e&&(i.value=e.name)},{immediate:!0});async function f(){d.value=!0;try{const{data:e}=await D.createClass(i.value);await y(),r.add({severity:"success",summary:e.message,life:2e3}),c.value=!1}catch(e){r.add({severity:"error",summary:e.response.data.error,detail:e,life:2e3})}finally{d.value=!1}}async function $(){if(m.selectedClass){d.value=!0;try{const{data:e}=await D.updateClassById(m.selectedClass.id,i.value);await y(),r.add({severity:"success",summary:e.message,life:2e3}),c.value=!1}catch(e){r.add({severity:"error",summary:e.response.data.error,detail:e,life:2e3})}finally{d.value=!1}}}return(e,a)=>{const t=F,g=Q,h=M,V=q;return _(),k(V,{visible:c.value,"onUpdate:visible":a[2]||(a[2]=p=>c.value=p),modal:"",draggable:!1,class:"m-4 max-w-md",header:m.selectedClass?e.$t("pages.teacher.editClass"):e.$t("pages.teacher.addClass")},{default:o(()=>[n("div",W,[n("div",X,[n("div",Y,u(e.$t("pages.teacher.name")),1),l(t,{type:"text",modelValue:i.value,"onUpdate:modelValue":a[0]||(a[0]=p=>i.value=p)},null,8,["modelValue"])]),l(g),n("div",Z,[l(h,{label:e.$t("pages.teacher.cancel"),severity:"secondary",onClick:a[1]||(a[1]=p=>c.value=!1)},null,8,["label"]),m.selectedClass==null?(_(),k(h,{key:0,label:e.$t("pages.teacher.create"),onClick:f,loading:d.value,disabled:d.value},null,8,["label","loading","disabled"])):(_(),k(h,{key:1,label:e.$t("pages.teacher.save"),onClick:$,loading:d.value,disabled:d.value},null,8,["label","loading","disabled"]))])])]),_:1},8,["visible","header"])}}}),ae={class:"flex-grow min-w-0 pb-4 mb-4 bg-white rounded-md border"},se={class:"flex items-center"},le={class:"flex-grow flex gap-2 items-center"},te={key:0,class:"text-2xl"},oe={class:"flex gap-2"},we=I({__name:"ClassesView",setup(w){const c=H(),m=v(),r=v();(()=>{r.value={global:{value:null,matchMode:J.CONTAINS}}})();const y=N(),{classes:i,isLoading:d}=z(y),f=v(!1),$=v(null);function e(a){f.value=!0,$.value=a}return(a,t)=>{const g=M,h=A,V=F,p=L,C=E,S=K;return _(),x("div",ae,[l(S,{ref_key:"dt",ref:m,filters:r.value,"onUpdate:filters":t[2]||(t[2]=s=>r.value=s),value:b(i),dataKey:"id",loading:b(d),scrollable:"",globalFilterFields:["name","email"],class:"rounded-md overflow-hidden w-full",paginator:"",rows:10,rowsPerPageOptions:[5,10,25]},{header:o(()=>[n("div",se,[n("div",le,[b(i)?(_(),x("div",te,u(a.$t("pages.teacher.classes"))+" - "+u(b(i).length),1)):G("",!0)]),l(g,{label:a.$t("pages.teacher.addClass"),icon:"pi pi-plus",variant:"outlined",class:"mr-2",onClick:t[0]||(t[0]=s=>e(null))},null,8,["label"]),l(p,null,{default:o(()=>[l(h,null,{default:o(()=>t[4]||(t[4]=[n("i",{class:"pi pi-search"},null,-1)])),_:1}),l(V,{modelValue:r.value.global.value,"onUpdate:modelValue":t[1]||(t[1]=s=>r.value.global.value=s),placeholder:a.$t("pages.teacher.search")},null,8,["modelValue","placeholder"])]),_:1})])]),empty:o(()=>[B(u(a.$t("pages.teacher.noClassesFound")),1)]),loading:o(()=>[B(u(a.$t("pages.teacher.loadingClasses")),1)]),default:o(()=>[l(C,{field:"name",header:a.$t("pages.teacher.name"),sortable:""},{body:o(({data:s})=>[n("div",null,u(`${s.name}`),1)]),_:1},8,["header"]),l(C,{field:"creator_name",header:a.$t("pages.teacher.classTeacher"),sortable:""},{body:o(({data:s})=>[n("div",null,u(`${s.creator_name??s.creator_email}`),1)]),_:1},8,["header"]),l(C,{field:"student_count",header:a.$t("pages.teacher.students"),sortable:""},{body:o(({data:s})=>[n("div",null,u(`${s.student_count}`),1)]),_:1},8,["header"]),l(C,{exportable:!1},{body:o(({data:s})=>[n("div",oe,[l(g,{icon:"pi pi-pencil",outlined:"",rounded:"",severity:"warn",onClick:U=>e(s)},null,8,["onClick"]),l(g,{icon:"pi pi-angle-right",outlined:"",rounded:"",severity:"info",onClick:U=>b(c).push({name:"teacher-class",params:{id:s.id}})},null,8,["onClick"])])]),_:1})]),_:1},8,["filters","value","loading"]),l(ee,{"model-value":f.value,"onUpdate:modelValue":t[3]||(t[3]=s=>f.value=s),"selected-class":$.value},null,8,["model-value","selected-class"])])}}});export{we as default};
