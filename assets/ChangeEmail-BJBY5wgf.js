import{s as T}from"./index-BbIkPId2.js";import{s as D}from"./index-B1ulWbFR.js";import{d as B,ar as U,ap as A,p as F,u as Y,r as f,q as j,o as d,f as v,w as r,e as u,b as t,g as C,t as k,h as N,v as q,s as S,_ as P,a as R,C as x,ay as z,c as H,j as c,F as L}from"./index-CFTsbYyj.js";import{s as h}from"./index-ShhDbwX4.js";import{a as O,s as G}from"./index-Bh2w5Fai.js";import{s as J}from"./index-jL52Hg50.js";import{_ as K}from"./VerifyEmailDialog.vue_vue_type_script_setup_true_lang-Ch4rCAPG.js";import{S as Q}from"./index-ClYofCuR.js";import{u as W}from"./profile-jq0yU__9.js";import"./index-B3U6P8R9.js";import"./index-DM2DgLdl.js";import"./index-BBwnMfvS.js";const X={class:"text-blue-500"},Z={class:"flex flex-col gap-1"},ee={class:"flex gap-1 justify-end"},ae=B({__name:"VerifyNewEmailDialog",props:U({email:{}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup($){const g=$,p=A($,"modelValue"),{locale:V,t:m}=F(),i=Y(),n=f(!1),s=f(0);let e;const a=()=>{s.value=60,e=setInterval(()=>{s.value>0?s.value--:clearInterval(e)},1e3)};async function b(){n.value=!0;try{await Q.changeEmail(V.value,g.email),i.add({severity:"success",summary:m("pages.settings.verificationEmailSent"),life:2e3}),a()}catch(o){console.log(o),i.add({severity:"error",summary:m("pages.settings.emailInvalid"),detail:o,life:2e3})}finally{n.value=!1}}return j(()=>{clearInterval(e)}),(o,_)=>{const E=q("i18n-t"),y=S,w=h,I=P;return d(),v(I,{visible:p.value,"onUpdate:visible":_[0]||(_[0]=l=>p.value=l),modal:"",draggable:!1,class:"m-4 max-w-md",header:o.$t("dialog.verifyYourEmail")},{footer:r(()=>[u("div",Z,[u("div",ee,[t(y,{label:s.value>0?`${o.$t("pages.login.resendIn")} ${s.value}s`:o.$t("dialog.sendVerificationEmail"),onClick:b,loading:n.value,disabled:n.value||s.value>0},null,8,["label","loading","disabled"])]),s.value>0?(d(),v(w,{key:0,severity:"success"},{default:r(()=>[C(k(o.$t("pages.settings.weHaveSentLinkToVerifyEmail")),1)]),_:1})):N("",!0)])]),default:r(()=>[u("div",null,[t(E,{keypath:"dialog.confirmEmailAddress"},{email:r(()=>[u("span",X,k(g.email),1)]),_:1})])]),_:1},8,["visible","header"])}}}),se={class:"flex flex-col gap-2"},le={class:"flex flex-wrap sm:flex-nowrap gap-2"},oe={class:"flex flex-col gap-1"},_e=B({__name:"ChangeEmail",setup($){const g=R(),{user:p}=x(g),V=W(),{verified:m}=x(V),i=f(""),n=f(!1),s=f(!1);return z(()=>{var e;i.value=((e=p.value)==null?void 0:e.email)??""}),(e,a)=>{const b=O,o=J,_=G,E=h,y=S,w=D,I=T;return d(),H(L,null,[t(I,{class:"flex-grow",header:e.$t("pages.settings.changeEmail")},{default:r(()=>[u("div",se,[u("div",le,[u("div",oe,[t(_,null,{default:r(()=>[t(b,{class:"pi pi-envelope"}),t(o,{id:"email",autocomplete:"off",variant:"filled",placeholder:"Email",modelValue:i.value,"onUpdate:modelValue":a[0]||(a[0]=l=>i.value=l),disabled:c(m),class:"w-full sm:w-96"},null,8,["modelValue","disabled"])]),_:1}),t(E,{for:"email",severity:c(m)?"success":"error",size:"small",variant:"simple"},{default:r(()=>[C(k(c(m)?e.$t("pages.settings.yourEmailIsVerified"):e.$t("pages.settings.yourEmailIsNotVerified")),1)]),_:1},8,["severity"])]),c(m)?N("",!0):(d(),v(w,{key:0,severity:"danger"},{default:r(()=>{var l;return[((l=c(p))==null?void 0:l.email)==i.value?(d(),v(y,{key:0,label:e.$t("pages.settings.verifyYourEmail"),onClick:a[1]||(a[1]=M=>n.value=!0)},null,8,["label"])):(d(),v(y,{key:1,label:e.$t("pages.settings.verifyYourNewEmail"),onClick:a[2]||(a[2]=M=>s.value=!0),severity:"info"},null,8,["label"]))]}),_:1}))])])]),_:1},8,["header"]),t(K,{modelValue:n.value,"onUpdate:modelValue":a[3]||(a[3]=l=>n.value=l)},null,8,["modelValue"]),t(ae,{modelValue:s.value,"onUpdate:modelValue":a[4]||(a[4]=l=>s.value=l),email:i.value},null,8,["modelValue","email"])],64)}}});export{_e as default};
