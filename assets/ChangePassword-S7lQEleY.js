import{s as $}from"./index-NSrTkxkf.js";import{h as C,z as m,s as N}from"./index-BkPkxQlT.js";import{d as j,u as A,r as P,o as e,f as p,w as r,b as o,e as a,t as l,c as i,i as w,F as g,h as v,j as L,s as q}from"./index-BrzV52kK.js";import{s as D}from"./index-C1jqfSjH.js";import{s as E}from"./index-DVoyl1Ph.js";import{s as O}from"./index-vFl1xP0w.js";import{S as T}from"./index-D9VAoJc2.js";import"./index-CwqgLNmY.js";import"./index-BDdjUtpa.js";import"./index-DC3aJJ4r.js";import"./index-CtEdbVY0.js";import"./index-CibvUuR_.js";const Z={class:"flex flex-col gap-1"},G={for:"old_password"},H={class:"my-0 flex flex-col gap-1"},I={class:"flex flex-col gap-1"},J={for:"new_password"},K={class:"my-0 flex flex-col gap-1"},Q={class:"flex flex-col gap-1"},R={for:"confirm_password"},U={class:"my-0 flex flex-col gap-1"},cs=j({__name:"ChangePassword",setup(W){const h=A(),n=P(!1),M=P({old_password:"",new_password:""}),V=C(m.object({old_password:m.string().min(1,{message:"Old password is required."}).max(100,{message:"Maximum 100 characters."}),new_password:m.string().min(8,{message:"Minimum 8 characters."}).max(100,{message:"Maximum 100 characters."}).refine(s=>/[a-z]/.test(s),{message:"Must have a lowercase letter."}).refine(s=>/[A-Z]/.test(s),{message:"Must have an uppercase letter."}).refine(s=>/[0-9]/.test(s),{message:"Must have a number."}),confirm_password:m.string()}).refine(s=>s.new_password===s.confirm_password,{message:"Passwords must match",path:["confirm_password"]})),z=async s=>{if(!n.value&&s.valid){n.value=!0;try{await T.changePassword(s.states.old_password.value,s.states.new_password.value),h.add({severity:"success",summary:"Password saved successfully",life:2e3})}catch(y){h.add({severity:"error",summary:"Password save failed!",detail:y,life:2e3})}finally{n.value=!1}}};return(s,y)=>{const f=O,u=E,_=D,B=q,F=N,S=$;return e(),p(S,{class:"flex-grow",header:s.$t("pages.settings.changePassword")},{default:r(()=>[o(F,{initialValues:M.value,resolver:L(V),onSubmit:z,class:"flex flex-col gap-2"},{default:r(t=>{var b,x,k;return[a("div",Z,[o(u,{variant:"on"},{default:r(()=>[o(f,{id:"old_password",name:"old_password",feedback:!1,toggleMask:"",fluid:"",class:"w-full sm:w-96"}),a("label",G,l(s.$t("pages.settings.oldPassword")),1)]),_:1}),(b=t.old_password)!=null&&b.invalid?(e(),p(_,{key:0,severity:"error",size:"small",variant:"simple"},{default:r(()=>[a("ul",H,[(e(!0),i(g,null,w(t.old_password.errors,(d,c)=>(e(),i("li",{key:c},l(d.message),1))),128))])]),_:2},1024)):v("",!0)]),a("div",I,[o(u,{variant:"on"},{default:r(()=>[o(f,{id:"new_password",name:"new_password",feedback:!1,toggleMask:"",fluid:"",class:"w-full sm:w-96"}),a("label",J,l(s.$t("pages.settings.newPassword")),1)]),_:1}),(x=t.new_password)!=null&&x.invalid?(e(),p(_,{key:0,severity:"error",size:"small",variant:"simple"},{default:r(()=>[a("ul",K,[(e(!0),i(g,null,w(t.new_password.errors,(d,c)=>(e(),i("li",{key:c},l(d.message),1))),128))])]),_:2},1024)):v("",!0)]),a("div",Q,[o(u,{variant:"on"},{default:r(()=>[o(f,{id:"confirm_password",name:"confirm_password",feedback:!1,toggleMask:"",fluid:"",class:"w-full sm:w-96"}),a("label",R,l(s.$t("pages.settings.confirmPassword")),1)]),_:1}),(k=t.confirm_password)!=null&&k.invalid?(e(),p(_,{key:0,severity:"error",size:"small",variant:"simple"},{default:r(()=>[a("ul",U,[(e(!0),i(g,null,w(t.confirm_password.errors,(d,c)=>(e(),i("li",{key:c},l(d.message),1))),128))])]),_:2},1024)):v("",!0)]),o(B,{type:"submit",label:s.$t("pages.settings.savePassword"),class:"w-fit",loading:n.value,disabled:n.value},null,8,["label","loading","disabled"])]}),_:1},8,["initialValues","resolver"])]),_:1},8,["header"])}}});export{cs as default};
