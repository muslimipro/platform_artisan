import{u as q,s as G,S as J,_ as K,T as Q,a as U}from"./SimulationView-BcQTZa5L.js";import{ac as N,ao as T,ag as W,ap as R,ae as E,an as B,e as L,o as A,w as F,D as s,E as _,I as l,T as a,af as e,V as i,a4 as H,aa as Z,_ as w,a6 as ee,Y as M,ai as O,a2 as te,c as se,X as j,al as ae}from"./index-CWUNhQcE.js";import{s as ne}from"./index-iod-wkUq.js";import{s as oe,a as le,t as ie}from"./types-CVDl5fln.js";import{L as re,a as ce}from"./logo-Db3w56_L.js";import{_ as ue}from"./LocaleSwitcher.vue_vue_type_script_setup_true_lang-d6gJApLN.js";import{a as pe,t as de}from"./dto-b17w84_a.js";import{_ as fe,a as me,M as _e,b as ve,c as ye}from"./QuestionStep.vue_vue_type_script_setup_true_lang-DHxODSuN.js";import{h as he}from"./http-8dPoYH0A.js";import"./pibody-B70zHXNr.js";import"./index-N5zE1uUk.js";const ge={class:"mx-auto flex items-center justify-between p-2 px-6 w-full bg-white"},we={class:"flex flex-1 items-center"},xe={key:1,class:"flex items-center gap-1"},be={class:"flex items-center gap-1"},ke={class:"flex flex-1 justify-end items-center gap-2"},Se={class:"relative overflow-hidden w-full border-0 bg-transparent flex items-start p-2 pl-4 rounded-none cursor-pointer transition-colors duration-200"},$e={class:"inline-flex flex-col items-start"},ze={class:"font-bold"},Pe={class:"text-sm"},je=N({__name:"LessonHeader",setup(I){const{locale:d}=T(),v=W(),x=R(),r=E(),{user:n}=B(r),o=q(),{lesson:c,stepIndex:t,stepLoading:u}=B(o),{changeStep:S,setSteps:$}=o,z=L(!1);function y(m){switch(m){case"article":return"pi pi-align-left";case"code":return"pi pi-code";case"question":return"pi pi-question";case"matching":return"pi pi-arrows-h";case"open":return"pi pi-pencil";default:return"pi pi-align-left"}}async function h(){if(!z.value){z.value=!0;try{const{data:m}=await pe.getProjectStepsByID(x.params.id.toString()),g=[];for(const[V,b]of m.entries())if(V==0){const C=await de(b,d.value,!1);g.push(C)}else{const C={id:b.id.toString(),title:"",type:b.step_type,progress:"nothing",inner:{contents:[]}};g.push(C)}$(g)}catch(m){alert(m)}finally{z.value=!1}}}A(h),F(d,h,{immediate:!1});const f=L(),p=L([{label:"Log out",icon:"pi pi-sign-out",command:()=>{r.logout(),v.replace({name:"login"})}}]),D=m=>{f.value.toggle(m)};return(m,g)=>{const V=ce,b=O,C=oe,X=ne,Y=te;return s(),_("div",ge,[l("div",we,[a(V,{src:e(re),width:"32"},null,8,["src"]),g[1]||(g[1]=l("p",{class:"text-xl font-semibold px-2 mr-4"},"Artisan",-1)),a(b,{id:"#projects",icon:"pi pi-angle-left",label:m.$t("projects"),severity:"secondary",variant:"text",onClick:g[0]||(g[0]=P=>e(v).push({name:"projects"})),size:"small"},null,8,["label"])]),z.value||e(c)==null?(s(),i(C,{key:0,shape:"circle",size:"2rem",class:"mr-2"})):(s(),_("div",xe,[l("div",be,[(s(!0),_(H,null,Z(e(c).steps,(P,k)=>(s(),i(b,{key:P.id,icon:y(P.type),rounded:"",severity:e(t)==k?void 0:"secondary",variant:e(t)==k?void 0:"outlined",onClick:Re=>e(S)(k),class:"h-8 w-8",disabled:e(u),loading:k==e(t)&&e(u)},null,8,["icon","severity","variant","onClick","disabled","loading"]))),128))])])),l("div",ke,[a(ue),a(b,{type:"button",icon:"pi pi-ellipsis-v",onClick:D,"aria-haspopup":"true","aria-controls":"overlay_menu",size:"small",variant:"outlined",severity:"secondary",class:"border border-slate-300 bg-slate-50",style:{width:"34px"}}),a(X,{ref_key:"menu",ref:f,id:"overlay_menu",model:p.value,popup:!0},{start:w(()=>{var P,k;return[ee((s(),_("button",Se,[l("span",$e,[l("span",ze,M((P=e(n))==null?void 0:P.email),1),l("span",Pe,M((k=e(n))==null?void 0:k.user_type),1)])])),[[Y]])]}),_:1},8,["model"])])])}}}),Ce={submitStep:Le};async function Le(I,d,v,x){try{return await he.put(`/student/${I}/step/${d}/language/${v}`,{student_answer:x})}catch(r){throw console.log(r),r}}const Ie={class:"flex flex-col p-4 gap-4 overflow-scroll h-full justify-between bg-white"},Be={key:0},De={key:1,class:"flex"},Ve=N({__name:"LessonDiv",setup(I){const{locale:d}=T(),v=E(),{user:x}=B(v),r=q(),{lesson:n,stepIndex:o}=B(r),{changeStep:c}=r,t=se(()=>{var y;return o.value==null?null:((y=n.value)==null?void 0:y.steps[o.value])??null});async function u(){o.value!=null&&c(o.value-1)}async function S(){o.value!=null&&c(o.value+1)}const $=L(!1);async function z(){var y,h,f;$.value=!0;try{let p;switch((y=t.value)==null?void 0:y.type){case"code":p={code:""};break;case"open":p={open:t.value.inner.answer};break;case"question":p={question:[!0,!0,!1]};break;case"matching":p={match:[{key:"dog",value:"b"},{key:"a",value:"animal"},{key:"c",value:"d"}]};break;default:p={};break}const{data:D}=await Ce.submitStep(((h=x.value)==null?void 0:h.user_id)??"",((f=t.value)==null?void 0:f.id)??"",d.value,p);console.log(D.status)}catch(p){alert(p)}finally{$.value=!1}}return(y,h)=>{const f=O;return s(),_("div",Ie,[t.value?(s(),_("div",Be,[t.value.type=="article"?(s(),i(e(fe),{key:0,step:t.value,isPreview:!1},null,8,["step"])):t.value.type=="code"?(s(),i(e(me),{key:1,step:t.value,isPreview:!1},null,8,["step"])):t.value.type=="matching"?(s(),i(e(_e),{key:2,step:t.value,isPreview:!1},null,8,["step"])):t.value.type=="open"?(s(),i(e(ve),{key:3,step:t.value,isPreview:!1},null,8,["step"])):t.value.type=="question"?(s(),i(e(ye),{key:4,step:t.value,isPreview:!1},null,8,["step"])):j("",!0),h[0]||(h[0]=l("br",null,null,-1)),a(f,{label:"Submit",icon:"pi pi-check",iconPos:"right",severity:"info",size:"small",class:"self-start",onClick:z,disabled:$.value,loading:$.value},null,8,["disabled","loading"])])):j("",!0),e(n)!=null&&e(n).steps!=null&&e(n).steps.length>0&&t.value?(s(),_("div",De,[e(o)!==0?(s(),i(f,{key:0,label:"Previous",icon:"pi pi-angle-left",size:"small",onClick:u})):j("",!0),e(o)<e(n).steps.length-1?(s(),i(f,{key:1,label:"Next",icon:"pi pi-angle-right",iconPos:"right",size:"small",class:"ml-auto self-end",onClick:S})):j("",!0)])):j("",!0)])}}}),qe={key:1,class:"h-[51px]"},Ne={class:"flex bg-surface-0",style:{height:"calc(100vh - 52px)"}},Te={class:"flex justify-center h-full"},Me={class:"max-w-[400px] w-full"},Ue=N({__name:"LessonView",setup(I){const{locale:d}=T(),v=R(),x=q(),{setLesson:r}=x,n=L(!1);async function o(){if(!n.value){n.value=!0;try{const{data:c}=await le.getProjectByID(v.params.id.toString()),t=await ie(c,d.value);r(t)}catch(c){alert(c)}finally{n.value=!1}}}return A(o),F(d,o),(c,t)=>{const u=U,S=G;return s(),_(H,null,[n.value?(s(),_("div",qe)):(s(),i(je,{key:0})),l("div",Ne,[a(S,{class:"w-full rounded-none"},{default:w(()=>[a(u,{size:33,minSize:10,class:"max-w-[467px] w-full"},{default:w(()=>[a(J)]),_:1}),a(u,{size:34,minSize:10},{default:w(()=>[a(S,{layout:"vertical",class:"h-full w-full"},{default:w(()=>[a(u,{size:65,minSize:10},{default:w(()=>[a(K)]),_:1}),a(u,{size:35,minSize:10},{default:w(()=>[a(Q)]),_:1})]),_:1})]),_:1}),a(u,{size:33,minSize:10,class:ae(["max-w-md mx-auto",{"animate-fadeinright animate-once animate-duration-1000 animate-ease-in-out":!0}])},{default:w(()=>[l("div",Te,[l("div",Me,[n.value?j("",!0):(s(),i(Ve,{key:0}))])])]),_:1})]),_:1})])],64)}}});export{Ue as default};
