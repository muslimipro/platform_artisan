import{s as I}from"./index-DDH0otCN.js";import{s as h}from"./index-Bfhu61Ft.js";import{d as k,ar as D,ap as M,p as S,u as T,r as g,o as u,f as _,w as n,b as s,e as p,t as x,v as U,s as B,a0 as F,a as Y,C as z,az as A,c as j,j as d,g as q,h as O,F as P}from"./index-Bys-p59Q.js";import{s as R}from"./index-DG8TrzZm.js";import{a as G,s as H}from"./index-CNLIXpue.js";import{s as J}from"./index-DWmrnhHm.js";import{_ as K}from"./VerifyEmailDialog.vue_vue_type_script_setup_true_lang-B_uDAR6N.js";import{S as L}from"./index-BHBPjwF6.js";import"./index-CA6QAd1l.js";import"./index-BrlTtmpA.js";import"./index-CqQi59sS.js";const Q={class:"text-blue-500"},W=k({__name:"VerifyNewEmailDialog",props:D({email:{}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(y){const c=y,l=M(y,"modelValue"),{locale:t}=S(),r=T(),o=g(!1);async function a(){o.value=!0;try{await L.changeEmail(t.value,c.email),r.add({severity:"success",summary:"Verification email sent!",life:2e3})}catch(e){console.log(e),r.add({severity:"error",summary:"Email is invalid!",detail:e,life:2e3})}finally{o.value=!1}}return(e,f)=>{const V=U("i18n-t"),b=B,$=F;return u(),_($,{visible:l.value,"onUpdate:visible":f[0]||(f[0]=v=>l.value=v),modal:"",draggable:!1,class:"m-4 max-w-md",header:e.$t("dialog.verifyYourEmail")},{footer:n(()=>[s(b,{label:e.$t("dialog.sendVerificationEmail"),onClick:a,disabled:o.value,loading:o.value},null,8,["label","disabled","loading"])]),default:n(()=>[p("div",null,[s(V,{keypath:"dialog.confirmEmailAddress"},{email:n(()=>[p("span",Q,x(c.email),1)]),_:1})])]),_:1},8,["visible","header"])}}}),X={class:"flex flex-col gap-2"},Z={class:"flex flex-wrap sm:flex-nowrap gap-2"},ee={class:"flex flex-col gap-1"},pe=k({__name:"ChangeEmail",setup(y){const c=Y(),{user:l}=z(c),t=g(""),r=g(!1),o=g(!1);return A(()=>{var a;t.value=((a=l.value)==null?void 0:a.email)??""}),(a,e)=>{const f=G,V=J,b=H,$=R,v=B,C=h,N=I;return u(),j(P,null,[s(N,{class:"flex-grow",header:a.$t("pages.settings.changeEmail")},{default:n(()=>{var m,w;return[p("div",X,[p("div",Z,[p("div",ee,[s(b,null,{default:n(()=>{var i;return[s(f,{class:"pi pi-envelope"}),s(V,{id:"email",autocomplete:"off",variant:"filled",placeholder:"Email",modelValue:t.value,"onUpdate:modelValue":e[0]||(e[0]=E=>t.value=E),disabled:(i=d(l))==null?void 0:i.verified,class:"w-full sm:w-96"},null,8,["modelValue","disabled"])]}),_:1}),s($,{for:"email",severity:(m=d(l))!=null&&m.verified?"success":"error",size:"small",variant:"simple"},{default:n(()=>{var i;return[q(x((i=d(l))!=null&&i.verified?a.$t("pages.settings.yourEmailIsVerified"):a.$t("pages.settings.yourEmailIsNotVerified")),1)]}),_:1},8,["severity"])]),(w=d(l))!=null&&w.verified?O("",!0):(u(),_(C,{key:0,severity:"danger"},{default:n(()=>{var i;return[((i=d(l))==null?void 0:i.email)==t.value?(u(),_(v,{key:0,label:a.$t("pages.settings.verifyYourEmail"),onClick:e[1]||(e[1]=E=>r.value=!0)},null,8,["label"])):(u(),_(v,{key:1,label:a.$t("pages.settings.verifyYourNewEmail"),onClick:e[2]||(e[2]=E=>o.value=!0),severity:"info"},null,8,["label"]))]}),_:1}))])])]}),_:1},8,["header"]),s(K,{modelValue:r.value,"onUpdate:modelValue":e[3]||(e[3]=m=>r.value=m)},null,8,["modelValue"]),s(W,{modelValue:o.value,"onUpdate:modelValue":e[4]||(e[4]=m=>o.value=m),email:t.value},null,8,["modelValue","email"])],64)}}});export{pe as default};
