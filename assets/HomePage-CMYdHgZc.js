import{s as q}from"./index-BQ-htkvG.js";import{s as G}from"./index-Bd-ljPhE.js";import{s as J}from"./index-BruGhK6t.js";import{s as K}from"./index-BA9Js00F.js";import{d as Q,v as W,u as X,x as Y,a as Z,y as D,r as l,m as ee,z as se,A as te,o as e,c as i,b as c,j as oe,F as u,i as p,f as m,w as x,e as re,g as j,t as b,h as g,B as ne,k as ie,C as ae,s as le}from"./index-BRYS-vcQ.js";import{s as ce}from"./index-6mejDcUA.js";import{_ as de}from"./AHeader.vue_vue_type_script_setup_true_lang-Dg25dJJi.js";import{_ as $}from"./ProjectCard.vue_vue_type_script_setup_true_lang-BlZzSgOj.js";import{a as P}from"./index-BrfVjc9R.js";import{u as ue}from"./editor-store-LsyOYmWE.js";import{t as L}from"./types-Db7bbyJA.js";import{u as pe,m as me}from"./useSortable-BkShMj6I.js";import"./logo-D5iHQcJv.js";import"./index-DvRQtqX3.js";import"./LocaleSwitcher.vue_vue_type_script_setup_true_lang-3z7NXoMq.js";import"./index-BONpjZaH.js";import"./index-CwmpDcMI.js";import"./index-ByAGox7M.js";import"./index-BI2AGJnZ.js";import"./index-Df5aeo5u.js";import"./StudentViewToggle.vue_vue_type_script_setup_true_lang-D_e5fFSH.js";import"./index-B66HduS2.js";import"./index-B_FzxdIN.js";import"./index-CXh-xjcX.js";import"./index-Cu6Erxkx.js";import"./profile-DexA0tEb.js";import"./index-D7LiWKXz.js";import"./index-Bev4xJwQ.js";import"./pibody-BwAjMvHk.js";const fe={class:"flex flex-col min-h-screen bg-slate-50"},ge={key:1,class:"border border-dashed rounded-xl border-green-400 overflow-hidden"},ve={key:0,class:"flex px-4 sm:px-12"},he={key:1,class:"flex px-4 sm:px-12"},xe={key:3,class:"flex px-4 sm:px-12"},_e={key:4,class:"flex flex-wrap justify-center gap-8 px-4 sm:px-12 pb-8"},Xe=Q({__name:"HomePage",setup(ye){const C=W("el"),S=X(),{locale:R}=Y(),I=ie(),M=ue(),{addLesson:N}=M,V=Z(),{user:E}=D(V),d=l([]),_=l([]),y=l([]),k=l([0,0,0,0,0,0]),w=l([0,0,0,0,0,0]),f=l(!1),v=l(!1);pe(C,d,{onUpdate:s=>{me(d.value,s.oldIndex,s.newIndex,s),ae(async()=>{const t=[];d.value.map(n=>{const r=parseInt(n.id,10);t.push(r)});try{const{data:n}=await P.changeProjectsOrder(t);S.add({severity:"success",summary:n.message,life:2e3})}catch(n){S.add({severity:"error",summary:n.response.data.error,detail:n,life:2e3})}})}});async function h(){if(!f.value){f.value=!0;try{const{data:s}=await P.getProjects();f.value=!1,d.value=[],_.value=[],y.value=[],k.value=[0,0,0,0,0,0],w.value=[0,0,0,0,0,0];for(const t of s)t.is_guidable?k.value[t.layer]++:w.value[t.layer]++;for(const t of s){const n=await L(t);t.layer>0&&d.value.push(n),n.is_guidable?_.value.push(n):y.value.push(n)}}catch(s){console.log(s)}finally{f.value=!1}}}ee(h),se(R,h);async function F(){v.value=!0;try{const{data:s}=await P.createProject(),t=await L(s);N(t),I.push(`/project/${t.id}/edit`)}catch(s){console.log(s)}finally{v.value=!1}}const O=te(()=>{const s=new Map,t=new Map;for(const r of _.value)s.has(r.layer)||s.set(r.layer,[]),s.get(r.layer).push(r);for(const r of y.value)t.has(r.layer)||t.set(r.layer,[]),t.get(r.layer).push(r);const n=[];for(let r=1;r<=5;r++)n.push({id:r,guided:s.get(r)||[],unguided:t.get(r)||[]});return n}),H=["secondary","success","info","warn","danger","contrast"];return(s,t)=>{var A;const n=ce,r=le,B=K,U=J,T=G,z=q;return e(),i("div",fe,[c(de,{class:"sticky top-0 z-10 mb-4"}),["editor","contributor"].includes(((A=oe(E))==null?void 0:A.user_type)??"")?(e(),i("div",{key:0,ref_key:"el",ref:C,class:"flex flex-wrap justify-center gap-8 px-4 sm:px-12 py-8"},[(e(!0),i(u,null,p(d.value,o=>(e(),m($,{key:o.id,project:o,onAfterRemove:h},null,8,["project"]))),128)),f.value?(e(),m(n,{key:0})):(e(),i("div",ge,[c(r,{variant:"text",style:{width:"300px",height:"234px"},class:"bg-green-50",onClick:F,loading:v.value,disabled:v.value},{icon:x(()=>t[0]||(t[0]=[re("i",{class:"pi pi-plus text-3xl"},null,-1)])),_:1},8,["loading","disabled"])]))],512)):(e(!0),i(u,{key:1},p(O.value,o=>(e(),i("div",{key:o.id,class:"flex flex-col gap-2"},[o.guided.length>0||o.unguided.length>0?(e(),i("div",ve,[c(B),c(U,{class:"min-w-fit text-2xl px-4",severity:H[o.id]},{default:x(()=>[j(b(o.id>0?`Level -
          ${o.id-1}`:"Other"),1)]),_:2},1032,["severity"]),c(B)])):g("",!0),o.guided.length>0?(e(),i("div",he,[c(T,{class:"min-w-fit pr-4",size:"small",severity:"success"},{default:x(()=>[j(b(s.$t("pages.projects.learn")),1)]),_:1})])):g("",!0),o.guided.length>0?(e(),i("div",{key:2,class:ne(["flex flex-wrap justify-center gap-8 px-4 sm:px-12",{"pb-8":o.unguided.length==0}])},[(e(!0),i(u,null,p(o.guided,a=>(e(),m($,{key:a.id,project:a,id:a.id},null,8,["project","id"]))),128)),(e(!0),i(u,null,p(k.value[o.id]-o.guided.length,a=>(e(),m(z,{key:a,width:"300px",height:"234px",class:"rounded-xl shadow-sm"}))),128))],2)):g("",!0),o.unguided.length>0?(e(),i("div",xe,[c(T,{class:"min-w-fit pr-4",size:"small",severity:"info"},{default:x(()=>[j(b(s.$t("pages.projects.practice")),1)]),_:1})])):g("",!0),o.unguided.length>0?(e(),i("div",_e,[(e(!0),i(u,null,p(o.unguided,a=>(e(),m($,{key:a.id,project:a,onAfterRemove:h},null,8,["project"]))),128)),(e(!0),i(u,null,p(w.value[o.id]-o.unguided.length,a=>(e(),m(z,{key:a,width:"300px",height:"234px",class:"rounded-xl shadow-sm"}))),128))])):g("",!0)]))),128))])}}});export{Xe as default};
