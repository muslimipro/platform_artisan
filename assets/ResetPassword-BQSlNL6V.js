import{z as R,a as p,s as j}from"./index-YENhsrMZ.js";import{s as L}from"./index-7L9ZvRB2.js";import{s as N}from"./index-C6aXlJFk.js";import{s as S}from"./index-DuLDkgh7.js";import{d as E,u as T,r as h,o,c as l,b as a,e,j as k,w as i,t as n,f as M,F as u,i as P,h as $,n as q,k as A,s as D}from"./index-BpBbGszO.js";import{_ as Z}from"./AuthHeader.vue_vue_type_script_setup_true_lang-ZFHZkOFq.js";import{a as G}from"./index-UK8IJmyp.js";import"./logo-B2cwv9nE.js";import"./index-DlipmIb-.js";import"./LocaleSwitcher.vue_vue_type_script_setup_true_lang-DT5LPdKG.js";import"./index-CdQdI1Nf.js";import"./index-B4O3qd6P.js";const H={class:"card flex flex-col items-center pt-4"},I={class:"flex flex-1 items-center justify-center my-4"},J={class:"text-4xl font-semibold px-2 mr-4"},K={class:"flex flex-col gap-1"},O={for:"password"},Q={class:"my-0 flex flex-col gap-1"},U={class:"flex flex-col gap-1"},W={for:"confirm_password"},X={class:"my-0 flex flex-col gap-1"},ps=E({__name:"ResetPassword",setup(Y){const f=T(),z=q(),_=A(),r=h(!1),V=h({password:""}),B=R(p.object({password:p.string().min(8,{message:"Minimum 8 characters."}).max(100,{message:"Maximum 100 characters."}).refine(s=>/[a-z]/.test(s),{message:"Must have a lowercase letter."}).refine(s=>/[A-Z]/.test(s),{message:"Must have an uppercase letter."}).refine(s=>/[0-9]/.test(s),{message:"Must have a number."}),confirm_password:p.string()}).refine(s=>s.password===s.confirm_password,{message:"Passwords must match",path:["confirm_password"]})),F=async s=>{if(!r.value&&s.valid){r.value=!0;try{await G.resetPassword(z.query.token,s.states.password.value),_.replace({name:"login"}),f.add({severity:"success",summary:"Password changed successfully",life:3e3})}catch(c){console.log(c),f.add({severity:"error",summary:"Expired or invalid token",life:3e3})}finally{r.value=!1}}};return(s,c)=>{const g=D,w=S,v=N,y=L,C=j;return o(),l(u,null,[a(Z),e("div",H,[a(g,{label:s.$t("pages.login.backToLogin"),variant:"outlined",icon:"pi pi-arrow-left",size:"small",onClick:c[0]||(c[0]=t=>k(_).replace({name:"login"}))},null,8,["label"]),a(C,{initialValues:V.value,resolver:k(B),onSubmit:F,class:"flex flex-col gap-4 w-full sm:w-80 sm:px-0 px-8"},{default:i(t=>{var x,b;return[e("div",I,[e("p",J,n(s.$t("pages.login.newPassword")),1)]),e("div",K,[a(v,{variant:"on"},{default:i(()=>[a(w,{id:"password",name:"password",feedback:!1,toggleMask:"",fluid:""}),e("label",O,n(s.$t("pages.login.newPassword")),1)]),_:1}),(x=t.password)!=null&&x.invalid?(o(),M(y,{key:0,severity:"error",size:"small",variant:"simple"},{default:i(()=>[e("ul",Q,[(o(!0),l(u,null,P(t.password.errors,(m,d)=>(o(),l("li",{key:d},n(m.message),1))),128))])]),_:2},1024)):$("",!0)]),e("div",U,[a(v,{variant:"on"},{default:i(()=>[a(w,{id:"confirm_password",name:"confirm_password",feedback:!1,toggleMask:"",fluid:""}),e("label",W,n(s.$t("pages.login.confirmPassword")),1)]),_:1}),(b=t.confirm_password)!=null&&b.invalid?(o(),M(y,{key:0,severity:"error",size:"small",variant:"simple"},{default:i(()=>[e("ul",X,[(o(!0),l(u,null,P(t.confirm_password.errors,(m,d)=>(o(),l("li",{key:d},n(m.message),1))),128))])]),_:2},1024)):$("",!0)]),a(g,{type:"submit",label:s.$t("pages.login.save"),loading:r.value,disabled:r.value},null,8,["label","loading","disabled"])]}),_:1},8,["initialValues","resolver"])])],64)}}});export{ps as default};
