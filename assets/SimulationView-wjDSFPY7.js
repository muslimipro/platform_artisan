import{a as M,s as ee,o as z,I as ae,r as T,b as p,e as h,P as N,V as W,g as e,h as n,f as g,i as C,w as L,K as B,n as F,G as ie,m as X,p as ve,W as H,t as E,D as te,E as me,C as xe,J as k,F as V,k as j,S as re,U as ue,c as q,A as Z,N as ye,X as se}from"./index-CTzBRDkF.js";import{_ as he,t as we,u as Y,v as be,o as ge,w as ne,m as _e,M as ke,x as $e,y as Ce,z as Se,A as Pe,B as Ie,C as Le}from"./pibody-DGx0zvdP.js";import{s as Te}from"./index-DpB8_Bbd.js";import{u as de,a as ce,i as O,b as P,c as A,s as Fe,d as G,e as J,f as Me,r as De,g as Ee,p as Be,h as Ve,j as Re,l as Ae,k as Ne,m as je,w as ze}from"./stores-CiaYhZ9g.js";import{s as Oe}from"./index-DHNHenM9.js";import{_ as K}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{T as Ue}from"./index-B2qWy8WJ.js";import{s as We}from"./index-UttTpJwS.js";import{P as He}from"./pibody-BwAjMvHk.js";import{a as Xe}from"./index-CWSLGCMt.js";const Ye={class:"border flex justify-center items-center rounded mb-2 space-x-2"},Ke={key:0,class:"material-icons"},qe={key:1,class:"material-icons"},Ge={class:"flex items-center gap-4 mb-8"},Je={class:"flex justify-end gap-2"},Qe=M({__name:"IdeButtons",setup(S){const t=de(),v=ce(),{isProject:x,filePath:d,fileContent:m,fileTree:f}=ee(t),{openFile:s}=t;let l=null;z(()=>{x.value||(l=setInterval(()=>{localStorage.setItem("fileContent",m.value)},1e3))}),ae(()=>{l&&clearInterval(l)});async function c(){const r=await Be();if(r&&(await Ve(r,v.write,()=>{x.value&&(d.value="",m.value=""),f.value={name:"empty",path:"",children:[]}}),Re(),v.clear(),x.value)){const u=await Ae();s("/main.py",u),f.value=await Ne()}}function i(){P.value?(Me(),x.value&&(d.value="",m.value="",f.value={name:"empty",path:"",children:[]})):c()}const o=T(!1);function w(){De(m.value)}function y(r){return/\.[^\/\\]+$/.test(r)?r:`${r}.py`}const a=T(!1);function b(r,u){r?Ee(r,u):a.value=!0}function _(){a.value=!1}function $(){const r=y(d.value);b(r,m.value),a.value=!1}return(r,u)=>{const I=X,pe=Te,fe=ve;return p(),h("div",null,[N(n("div",Ye,[u[7]||(u[7]=n("p",null,"Updating",-1)),n("div",null,[g(e(Oe),{class:"w-7 h-7"})])],512),[[W,e(O)]]),n("div",null,[e(P)?(p(),C(I,{key:0,id:"#run",type:"button",class:"w-9 h-9 mr-1",variant:e(A)||!e(P)?"outlined":void 0,severity:"info",rounded:"",onClick:w,disabled:e(A)||!e(P),loading:e(A)},{default:L(()=>u[8]||(u[8]=[n("span",{class:"material-icons"},"play_arrow",-1)])),_:1},8,["variant","disabled","loading"])):B("",!0),e(P)?(p(),C(I,{key:1,type:"button",class:"w-9 h-9 mr-1",variant:!e(A)||!e(P)?"outlined":void 0,severity:"danger",rounded:"",onClick:u[0]||(u[0]=D=>e(Fe)()),disabled:!e(A)||!e(P)},{default:L(()=>u[9]||(u[9]=[n("span",{class:"material-icons"},"stop",-1)])),_:1},8,["variant","disabled"])):B("",!0),e(P)?(p(),C(I,{key:2,type:"button",class:"w-9 h-9",variant:"outlined",severity:"secondary",rounded:"",onClick:u[1]||(u[1]=D=>b(e(d),e(m))),disabled:e(G)||e(J)||e(O)||e(A)||!e(P),loading:e(G)||e(J)||e(O)},{default:L(()=>u[10]||(u[10]=[n("span",{class:"material-icons"},"save",-1)])),_:1},8,["disabled","loading"])):B("",!0),g(I,{type:"button",class:F(["w-9 h-9 mr-1 text-white",e(P)?o.value?"bg-red-500":"bg-green-500":"bg-gray-600"]),rounded:"",text:"",onClick:u[2]||(u[2]=D=>i()),onMouseover:u[3]||(u[3]=D=>o.value=!0),onMouseleave:u[4]||(u[4]=D=>o.value=!1),loading:e(G)||e(J)||e(O)},{default:L(()=>[o.value&&e(P)?(p(),h("span",Ke,"close")):(p(),h("span",qe,"cable"))]),_:1},8,["class","loading"])]),g(fe,{visible:a.value,"onUpdate:visible":u[6]||(u[6]=D=>a.value=D),modal:"",header:"File Name",style:{width:"25rem"}},{default:L(()=>[n("div",Ge,[g(pe,{id:"filename",modelValue:e(d),"onUpdate:modelValue":u[5]||(u[5]=D=>ie(d)?d.value=D:null),class:"flex-auto",autocomplete:"off"},null,8,["modelValue"])]),n("div",Je,[g(I,{type:"button",label:"Cancel",severity:"secondary",onClick:_}),g(I,{disabled:!e(d),type:"button",label:"Save",onClick:$},null,8,["disabled"])])]),_:1},8,["visible"])])}}}),Ze={class:"relative flex h-full"},et={class:"absolute bottom-2 left-2"},tt={class:"material-icons"},st={class:"material-icons"},Dt=M({__name:"CodeView",props:{disabled:{type:Boolean,default:!1}},emits:["run","stop"],setup(S,{emit:t}){const v=we(),x=S,d=Y(),{isLoading:m,isStopping:f,isRunning:s,isConnected:l}=d,c=t;function i(){l.value?d.run():d.connect(),c("run")}function o(){d.stop(),c("stop")}const w=de(),{fileContent:y}=ee(w);return(a,b)=>{const _=X;return p(),h("div",Ze,[g(he,H({modelValue:e(y),"onUpdate:modelValue":b[0]||(b[0]=$=>ie(y)?y.value=$:null)},e(v),{disabled:x.disabled}),null,16,["modelValue","disabled"]),b[1]||(b[1]=n("div",{id:"#editor",class:"absolute top-10 left-10"},null,-1)),n("div",et,[g(_,{id:"#run",type:"button",class:"w-9 h-9 mr-1",severity:"info",rounded:"",onClick:i,disabled:e(m)||e(s)},{default:L(()=>[n("span",tt,E(e(m)?"hourglass_top":"play_arrow"),1)]),_:1},8,["disabled"]),g(_,{type:"button",class:"w-9 h-9 mr-1",variant:e(s)?void 0:"outlined",severity:"danger",rounded:"",onClick:o,disabled:!e(s)||!e(l)},{default:L(()=>[n("span",st,E(e(f)?"hourglass_top":"stop"),1)]),_:1},8,["variant","disabled"])]),e(je)?(p(),C(Qe,{key:0,class:"absolute bottom-2 right-2"})):B("",!0)])}}}),nt={class:"flex flex-col h-full"},ot={class:"flex px-2 w-full bg-zinc-900 text-white h-6 justify-between items-center"},lt=M({__name:"TerminalView",setup(S){const t=T(!1),v=ce(),{output:x}=ee(v);function d(f){let s=f.key;if(s==="Enter")s=`
\r`;else if(s==="Backspace")s="\b";else if(s.length>1)return;ze(s)}const m=T(null);return z(()=>{v.openTerminal(m.value)}),(f,s)=>{const l=X;return p(),h("div",nt,[n("div",ot,[s[4]||(s[4]=n("span",{class:"material-icons"},"terminal",-1)),g(l,{onClick:s[0]||(s[0]=c=>e(v).clear()),class:"w-4 h-4 text-white",link:""},{default:L(()=>s[3]||(s[3]=[n("span",{class:"material-icons",style:{"font-size":"16px"}},"cleaning_services",-1)])),_:1})]),n("pre",{class:"h-full font-mono overflow-auto p-2 text-white bg-black",ref_key:"el",ref:m,tabindex:"0",onKeydown:d,onFocus:s[1]||(s[1]=c=>t.value=!0),onBlur:s[2]||(s[2]=c=>t.value=!1)},[s[5]||(s[5]=te("")),n("span",null,E(e(x)),1),n("span",{class:F([{caret:t.value},"bg-white"])}," ",2),s[6]||(s[6]=te(`
    `))],544)])}}}),Et=K(lt,[["__scopeId","data-v-094662a6"]]),at=["width","height"],R=12,it=M({__name:"Display",setup(S){const t=T(112),v=T(160),x=T(null),d=T(null),m=T(0),f=be();f.text.value||(f.text.value="");function s(i){const o=i.deltaY>0?1:-1;m.value+=o*R,m.value=Math.max(0,m.value);const{lines:w,visibleLines:y}=l();m.value=Math.min(w.length*R,m.value),c(w,y)}function l(){const i=[];let o=0;return d.value&&f.text.value&&(String(f.text.value).split(`
`).forEach(y=>{let a="";y.split(" ").forEach(_=>{const $=a+_+" ";d.value.measureText($).width>t.value?(i.push(a),a=_+" "):a=$}),i.push(a)}),o=Math.ceil(v.value/R)),{lines:i,visibleLines:o}}function c(i,o){if(d.value){d.value.fillStyle="#FFFFFF",d.value.fillRect(0,0,t.value,v.value),d.value.fillStyle=String(f.textColor.value)||"#000000",d.value.font="12px Monaco";const w=Math.floor(m.value/R);for(let y=0;y<o;y++){const a=w+y;if(a<i.length){const b=(y+1)*R-m.value%R;d.value.fillText(i[a],0,b)}}}}return me([f.text,f.textColor],()=>{const{lines:i,visibleLines:o}=l();m.value=Math.max(0,(i.length-o)*R),c(i,o)}),z(async()=>{if(await xe(),!!x.value&&(d.value=x.value.getContext("2d"),d.value)){d.value.fillStyle="#FFFFFF",d.value.fillRect(0,0,t.value,v.value);const{lines:i,visibleLines:o}=l();m.value=0,c(i,o)}}),(i,o)=>(p(),h("div",{class:"display-container",onWheel:s},[n("canvas",{ref_key:"canvas",ref:x,width:t.value,height:v.value,style:{border:"1px solid black",width:"112px",height:"160px"}},null,8,at)],32))}}),rt=K(it,[["__scopeId","data-v-a28fe913"]]),oe=M({__name:"PinInfo",props:{pin:{},withPin:{},isLeft:{type:Boolean}},setup(S){return(t,v)=>(p(),h(V,null,[n("div",{class:F(["flex",t.isLeft?"flex-row":"flex-row-reverse"])},[n("div",{style:k({background:e(ge)}),class:"text-center font-mono px-1 mr-1"},E(e(ne)[t.pin.id].name),5),(p(!0),h(V,null,j(e(ne)[t.pin.id].able,x=>(p(),h("div",{style:k({background:x.color}),class:"text-center font-mono px-1 mr-1"},E(x.name),5))),256))],2),n("div",{class:F(["flex my-1 mb-3",t.isLeft?"flex-row":"flex-row-reverse"])},[n("div",{style:k({background:`${e(_e)[t.pin.mode]}`}),class:"text-center px-4 mr-1 rounded-lg"},E(e(ke)[t.pin.mode]),5),n("div",{style:k(e($e)(t.pin,t.withPin)),class:"text-center px-4 mr-1 rounded-lg bg-black"},E(e(Ce)(t.pin,t.withPin)),5)],2)],64))}}),ut=["id"],dt=M({__name:"Slot",props:{slot:{},index:{}},setup(S){const{isOutside:t}=Xe(re("theref")),v=Y(),{maxAreaIndex:x,fromSlotIndex:d,settings:m}=v,f=S.index<3;return(s,l)=>(p(),h(V,null,[n("div",{id:`slot-${s.slot.id}`,ref:"theref",class:F(["absolute w-20 h-20 rounded-lg text-center",[{"bg-green-200/[0.5]":e(x)==s.index,"bg-blue-200/[0.5]":e(d)==s.index},s.slot.class]]),style:k([s.slot.style,e(Se)(s.slot)])},[!e(t)&&e(m).showPinInfo?(p(),h("div",{key:0,class:"absolute w-fit whitespace-nowrap text-white flex flex-col text-xs bg-black/70",style:k(f?"left:100%":"right:100%")},[g(oe,{pin:s.slot.pin2,withPin:s.slot.with.pin2,isLeft:f},null,8,["pin","withPin"]),g(oe,{pin:s.slot.pin3,withPin:s.slot.with.pin3,isLeft:f},null,8,["pin","withPin"])],4)):B("",!0)],14,ut),e(t)?B("",!0):(p(),C(ue,{key:0,to:"#pibody"}))],64))}}),ct=["width","height"],pt=["points","stroke"],Q=3,le=14,U=10,ft=M({__name:"Connector",props:{start:{},end:{},style:{}},setup(S){const t=Y(),v=S,x=q(()=>{const{start:l,end:c}=v,i=40,o=[{x:l.x,y:l.y}];return o.push({x:l.x,y:l.y-i}),o.push({x:(c.x+l.x)/2,y:l.y-i}),o.push({x:(c.x+l.x)/2,y:c.y-c.yOffset}),o.push({x:c.x,y:c.y-c.yOffset}),o.push({x:c.x,y:c.y}),o}),d=[{color:"orange",offset:-Q,end:-le/2},{color:"red",offset:0,end:0},{color:"saddlebrown",offset:Q,end:le/2}],m=q(()=>{const l=x.value,c=[];return d.forEach(i=>{const o=i.offset,w=i.end;let y="";for(let _=0;_<l.length-2;_++){const $=l[_];y+=`${$.x-f.value.x-o},${$.y-f.value.y-o} `}const a=l[l.length-2];y+=`${a.x-f.value.x+o},${a.y-f.value.y-o} `;const b=l[l.length-1];y+=`${b.x-f.value.x+w},${b.y-f.value.y+3} `,c.push({color:i.color,points:y})}),c}),f=q(()=>{const l=[],c=[];for(const a of x.value)l.push(a.x),c.push(a.y);const i=Math.min(...l)-U,o=Math.min(...c)-U,w=Math.max(...l)+U,y=Math.max(...c)+U;return{x:i,y:o,w:w-i,h:y-o}}),s=l=>{v.end.at!==t.pinNone&&t.moveConnectorEnd(v,l)};return(l,c)=>(p(),h(V,null,[n("div",{class:"absolute bg-black cursor-move",style:k([v.style,{left:v.end.x-12+"px",top:v.end.y+"px",width:v.end.w+"px",height:v.end.h+"px"}]),onPointerdown:[c[0]||(c[0]=Z(i=>i.preventDefault(),["prevent"])),s]},null,36),n("div",{class:"absolute pointer-events-none",style:k([v.style,e(Pe)(f.value)])},[(p(),h("svg",{xmlns:"http://www.w3.org/2000/svg",width:f.value.w,height:f.value.h},[(p(!0),h(V,null,j(m.value,(i,o)=>(p(),h("polyline",{key:o,points:i.points,stroke:i.color,fill:"none","stroke-width":Q,"stroke-linejoin":"round","stroke-linecap":"round"},null,8,pt))),128))],8,ct))],4)],64))}}),vt=K(ft,[["__scopeId","data-v-7bde02f1"]]),mt=M({__name:"Canvas",setup(S){const t=re("canvasEl");return z(async()=>{t.value&&(await Ie(t.value),requestAnimationFrame(Le))}),(v,x)=>(p(),h("canvas",{ref_key:"canvasEl",ref:t},null,512))}}),xt={id:"emulator",class:"h-full parent relative flex flex-col items-center border-t border-surface overflow-auto select-none"},yt={id:"pibody",class:"relative h-[450px] flex-shrink-0 max-h-[calc(100%-100px)] overflow-x-hidden overflow-y-auto w-[450px]"},ht={class:"absolute top-4 right-1 flex flex-col gap-1"},wt={class:"material-icons"},bt={id:"module-list",class:"relative h-full w-full"},gt={class:"max-h-fit w-full overflow-auto flex flex-wrap gap-2 justify-center items-start mt-2",style:{"touch-action":"none",padding:"15px 0 15px 0"}},_t=M({__name:"SimulationView",setup(S){const t=Y(),{isConnected:v,toDelete:x,slots:d,moduleComponents:m,modules:f,isConnect8or9:s,chosenPin8or9:l,pin8:c,pin9:i,settings:o}=t;t.connect(),ae(()=>{t.stop()});let w=[""];return ye(()=>{w=t.slotHasList(),t.clearSlots()}),z(()=>{t.putModuleList(w)}),(y,a)=>{const b=We,_=X,$=Ue;return p(),h("div",xt,[n("div",yt,[g(b,{src:e(He),width:"384px",draggable:"false",class:"absolute pt-4 min-w-[384px]",style:{left:"32px",top:"0px"}},null,8,["src"]),g(rt,{class:"absolute top-[217px] left-[168px] w-[112px] h-[160px]"}),n("div",ht,[N((p(),C(_,{type:"button",class:F(["w-9 h-9 mr-1",e(o).showPinInfo?"bg-green-500":"bg-gray-500"]),rounded:"",onClick:a[0]||(a[0]=r=>e(t).setSettings({showPinInfo:!e(o).showPinInfo}))},{default:L(()=>[n("span",wt,E((e(o).showPinInfo,"help_center")),1)]),_:1},8,["class"])),[[$,`Pin Information: ${e(o).showPinInfo?"On":"Off"}`,void 0,{left:!0}]]),N((p(),C(_,{type:"button",class:"w-9 h-9 mr-1 bg-gray-500",rounded:"",onClick:a[1]||(a[1]=r=>e(t).reset())},{default:L(()=>a[4]||(a[4]=[n("span",{class:"material-icons"},"restart_alt",-1)])),_:1})),[[$,"Reset pibody",void 0,{left:!0}]])]),(p(!0),h(V,null,j(e(d),(r,u)=>(p(),C(dt,{slot:r,index:u},null,8,["slot","index"]))),256)),e(v)?(p(),h("div",{key:0,class:"absolute bg-black",style:k({left:e(t).usb.x+"px",top:e(t).usb.y-70+"px",width:e(t).usb.w+"px",height:e(t).usb.h+50+"px"})},null,4)):B("",!0),n("div",{class:"absolute",style:k({left:e(t).onLED.x+"px",top:e(t).onLED.y+"px",width:e(t).onLED.w+"px",height:e(t).onLED.h+"px"})},null,4),N(n("div",{class:"absolute flex items-center justify-center animate-bounce-up z-10 pointer-events-none",style:k({left:e(t).helpArrows[8].x+"px",top:e(t).helpArrows[8].y+"px"})},[n("span",{class:F(["icon-arrow-down text-5xl",[e(l)===e(c)?"text-green-500":"text-gray-500",e(t).helpArrows[8].class]]),style:k(e(t).helpArrows[8].style)},null,6),a[5]||(a[5]=n("span",{class:"absolute text-white font-bold -mt-2"},"8",-1))],4),[[W,e(t).helpArrows[8].visible||e(s)]]),N(n("div",{class:"absolute flex items-center justify-center animate-bounce-down z-10 pointer-events-none",style:k({left:e(i).x-10+"px",top:e(i).y+8+"px"})},[n("span",{class:F(["icon-arrow-up text-5xl",e(l)===e(i)?"text-green-500":"text-gray-500"]),style:k(e(t).helpArrows[9].style)},null,6),a[6]||(a[6]=n("span",{class:"absolute text-white font-bold -mt-2"},"9",-1))],4),[[W,e(t).helpArrows[9].visible||e(s)]]),g(mt,{class:"absolute top-0 left-0 z-10 w-full h-full pointer-events-none"})]),n("div",bt,[n("div",gt,[(p(!0),h(V,null,j(e(m),r=>(p(),C(se(r.is),H({class:r.class,style:r.style,ref_for:!0},r,{onPointerdown:[u=>e(t).startDragFromModuleList(r,u),a[2]||(a[2]=Z(u=>u.preventDefault(),["prevent"]))],class:"flex-none w-20 h-20 cursor-move"}),null,16,["class","style","onPointerdown"]))),256))]),N(n("div",{class:F(["absolute top-0 left-0 h-full w-full",{"bg-red-500/[0.8]":e(x)}])},a[7]||(a[7]=[n("div",{class:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2"},[n("span",{class:"material-icons",style:{"font-size":"100px"}},"delete")],-1)]),2),[[W,e(x)]])]),(p(!0),h(V,null,j(e(f),(r,u)=>(p(),C(ue,{defer:"",to:r.dragging?"#emulator":"#pibody",key:r.id},[r.putOn8or9?(p(),C(vt,H({key:0,ref_for:!0},r.connector),null,16)):B("",!0),(p(),C(se(r.is),H({class:r.class,style:[r.style,{left:r.x+"px",top:r.y+"px"}],ref_for:!0},r,{onPointerdown:[I=>e(t).startDragFromSlot(r,u,r.on,I),a[3]||(a[3]=Z(I=>I.preventDefault(),["prevent"]))],class:"absolute w-20 h-20 rounded-xl cursor-move",style:{"touch-action":"none"}}),null,16,["class","style","onPointerdown"]))],8,["to"]))),128))])}}}),Bt=K(_t,[["__scopeId","data-v-e41e3d50"]]);export{Bt as S,Et as T,Dt as _};
