var ht=Object.defineProperty;var vt=(n,e,t)=>e in n?ht(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var O=(n,e,t)=>vt(n,typeof e!="symbol"?e+"":e,t);import{J as He,aB as mt,aC as gt,M as be,aM as _e,aN as Be,i as wt,D as E,E as k,a4 as ve,aa as Se,V as ae,W as ke,m as Ee,I as g,X as K,a0 as We,F as yt,e as m,aw as we,ac as R,an as le,o as ye,aO as xt,af as f,_ as te,T as Z,al as ee,ai as Le,aP as bt,ah as Oe,Y as ie,aQ as _t,c as se,aR as V,a6 as Ge,au as St,aS as Et,aT as $t,w as Q,t as Ke,aU as De,G as me,aV as Lt,aW as Je,r as U,aX as Pt,ao as zt,n as $e,aY as kt}from"./index-CWUNhQcE.js";import{b as Ct,_ as W,a as Tt,t as Mt}from"./dto-b17w84_a.js";import{a as Dt}from"./logo-Db3w56_L.js";import{P as It}from"./pibody-B70zHXNr.js";var At=function(e){var t=e.dt;return`
.p-splitter {
    display: flex;
    flex-wrap: nowrap;
    border: 1px solid `.concat(t("splitter.border.color"),`;
    background: `).concat(t("splitter.background"),`;
    border-radius: `).concat(t("border.radius.md"),`;
    color: `).concat(t("splitter.color"),`;
}

.p-splitter-vertical {
    flex-direction: column;
}

.p-splitter-gutter {
    flex-grow: 0;
    flex-shrink: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 1;
    background: `).concat(t("splitter.gutter.background"),`;
}

.p-splitter-gutter-handle {
    border-radius: `).concat(t("splitter.handle.border.radius"),`;
    background: `).concat(t("splitter.handle.background"),`;
    transition: outline-color `).concat(t("splitter.transition.duration"),", box-shadow ").concat(t("splitter.transition.duration"),`;
    outline-color: transparent;
}

.p-splitter-gutter-handle:focus-visible {
    box-shadow: `).concat(t("splitter.handle.focus.ring.shadow"),`;
    outline: `).concat(t("splitter.handle.focus.ring.width")," ").concat(t("splitter.handle.focus.ring.style")," ").concat(t("splitter.handle.focus.ring.color"),`;
    outline-offset: `).concat(t("splitter.handle.focus.ring.offset"),`;
}

.p-splitter-horizontal.p-splitter-resizing {
    cursor: col-resize;
    user-select: none;
}

.p-splitter-vertical.p-splitter-resizing {
    cursor: row-resize;
    user-select: none;
}

.p-splitter-horizontal > .p-splitter-gutter > .p-splitter-gutter-handle {
    height: `).concat(t("splitter.handle.size"),`;
    width: 100%;
}

.p-splitter-vertical > .p-splitter-gutter > .p-splitter-gutter-handle {
    width: `).concat(t("splitter.handle.size"),`;
    height: 100%;
}

.p-splitter-horizontal > .p-splitter-gutter {
    cursor: col-resize;
}

.p-splitter-vertical > .p-splitter-gutter {
    cursor: row-resize;
}

.p-splitterpanel {
    flex-grow: 1;
    overflow: hidden;
}

.p-splitterpanel-nested {
    display: flex;
}

.p-splitterpanel .p-splitter {
    flex-grow: 1;
    border: 0 none;
}
`)},Rt={root:function(e){var t=e.props;return["p-splitter p-component","p-splitter-"+t.layout]},gutter:"p-splitter-gutter",gutterHandle:"p-splitter-gutter-handle"},Ft={root:function(e){var t=e.props;return[{display:"flex","flex-wrap":"nowrap"},t.layout==="vertical"?{"flex-direction":"column"}:""]}},Bt=He.extend({name:"splitter",theme:At,classes:Rt,inlineStyles:Ft}),Ot={name:"BaseSplitter",extends:We,props:{layout:{type:String,default:"horizontal"},gutterSize:{type:Number,default:4},stateKey:{type:String,default:null},stateStorage:{type:String,default:"session"},step:{type:Number,default:5}},style:Bt,provide:function(){return{$pcSplitter:this,$parentInstance:this}}};function Ue(n){return Xt(n)||jt(n)||qt(n)||Ut()}function Ut(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qt(n,e){if(n){if(typeof n=="string")return Ce(n,e);var t={}.toString.call(n).slice(8,-1);return t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set"?Array.from(n):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Ce(n,e):void 0}}function jt(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function Xt(n){if(Array.isArray(n))return Ce(n)}function Ce(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,s=Array(e);t<e;t++)s[t]=n[t];return s}var Vt={name:"Splitter",extends:Ot,inheritAttrs:!1,emits:["resizestart","resizeend","resize"],dragging:!1,mouseMoveListener:null,mouseUpListener:null,touchMoveListener:null,touchEndListener:null,size:null,gutterElement:null,startPos:null,prevPanelElement:null,nextPanelElement:null,nextPanelSize:null,prevPanelSize:null,panelSizes:null,prevPanelIndex:null,timer:null,mutationObserver:null,data:function(){return{prevSize:null,isRTL:!1}},mounted:function(){this.initializePanels(),this.updateDirection(),this.observeDirectionChanges()},beforeUnmount:function(){this.clear(),this.unbindMouseListeners(),this.mutationObserver&&this.mutationObserver.disconnect()},methods:{updateDirection:function(){this.isRTL=!!this.$el.closest('[dir="rtl"]')},observeDirectionChanges:function(){var e=this,t=document.documentElement,s={attributes:!0,attributeFilter:["dir"]};this.mutationObserver=new MutationObserver(function(){e.updateDirection()}),this.mutationObserver.observe(t,s)},isSplitterPanel:function(e){return e.type.name==="SplitterPanel"},initializePanels:function(){var e=this;if(this.panels&&this.panels.length){var t=!1;if(this.isStateful()&&(t=this.restoreState()),!t){var s=Ue(this.$el.children).filter(function(i){return i.getAttribute("data-pc-name")==="splitterpanel"}),o=[];this.panels.map(function(i,r){var a=i.props&&i.props.size?i.props.size:null,l=a||100/e.panels.length;o[r]=l,s[r].style.flexBasis="calc("+l+"% - "+(e.panels.length-1)*e.gutterSize+"px)"}),this.panelSizes=o,this.prevSize=parseFloat(o[0]).toFixed(4)}}},onResizeStart:function(e,t,s){this.gutterElement=e.currentTarget||e.target.parentElement,this.size=this.horizontal?mt(this.$el):gt(this.$el),s||(this.dragging=!0,this.startPos=this.layout==="horizontal"?e.pageX||e.changedTouches[0].pageX:e.pageY||e.changedTouches[0].pageY),this.prevPanelElement=this.gutterElement.previousElementSibling,this.nextPanelElement=this.gutterElement.nextElementSibling,s?(this.prevPanelSize=this.horizontal?be(this.prevPanelElement,!0):_e(this.prevPanelElement,!0),this.nextPanelSize=this.horizontal?be(this.nextPanelElement,!0):_e(this.nextPanelElement,!0)):(this.prevPanelSize=100*(this.horizontal?be(this.prevPanelElement,!0):_e(this.prevPanelElement,!0))/this.size,this.nextPanelSize=100*(this.horizontal?be(this.nextPanelElement,!0):_e(this.nextPanelElement,!0))/this.size),this.prevPanelIndex=t,this.$emit("resizestart",{originalEvent:e,sizes:this.panelSizes}),this.$refs.gutter[t].setAttribute("data-p-gutter-resizing",!0),this.$el.setAttribute("data-p-resizing",!0)},onResize:function(e,t,s){var o,i,r;s?this.horizontal?(i=100*(this.prevPanelSize+t)/this.size,r=100*(this.nextPanelSize-t)/this.size):(i=100*(this.prevPanelSize-t)/this.size,r=100*(this.nextPanelSize+t)/this.size):(this.horizontal?this.isRTL?o=(this.startPos-e.pageX)*100/this.size:o=(e.pageX-this.startPos)*100/this.size:o=(e.pageY-this.startPos)*100/this.size,i=this.prevPanelSize+o,r=this.nextPanelSize-o),this.validateResize(i,r)&&(this.prevPanelElement.style.flexBasis="calc("+i+"% - "+(this.panels.length-1)*this.gutterSize+"px)",this.nextPanelElement.style.flexBasis="calc("+r+"% - "+(this.panels.length-1)*this.gutterSize+"px)",this.panelSizes[this.prevPanelIndex]=i,this.panelSizes[this.prevPanelIndex+1]=r,this.prevSize=parseFloat(i).toFixed(4)),this.$emit("resize",{originalEvent:e,sizes:this.panelSizes})},onResizeEnd:function(e){this.isStateful()&&this.saveState(),this.$emit("resizeend",{originalEvent:e,sizes:this.panelSizes}),this.$refs.gutter.forEach(function(t){return t.setAttribute("data-p-gutter-resizing",!1)}),this.$el.setAttribute("data-p-resizing",!1),this.clear()},repeat:function(e,t,s){this.onResizeStart(e,t,!0),this.onResize(e,s,!0)},setTimer:function(e,t,s){var o=this;this.timer||(this.timer=setInterval(function(){o.repeat(e,t,s)},40))},clearTimer:function(){this.timer&&(clearInterval(this.timer),this.timer=null)},onGutterKeyUp:function(){this.clearTimer(),this.onResizeEnd()},onGutterKeyDown:function(e,t){switch(e.code){case"ArrowLeft":{this.layout==="horizontal"&&this.setTimer(e,t,this.step*-1),e.preventDefault();break}case"ArrowRight":{this.layout==="horizontal"&&this.setTimer(e,t,this.step),e.preventDefault();break}case"ArrowDown":{this.layout==="vertical"&&this.setTimer(e,t,this.step*-1),e.preventDefault();break}case"ArrowUp":{this.layout==="vertical"&&this.setTimer(e,t,this.step),e.preventDefault();break}}},onGutterMouseDown:function(e,t){this.onResizeStart(e,t),this.bindMouseListeners()},onGutterTouchStart:function(e,t){this.onResizeStart(e,t),this.bindTouchListeners(),e.preventDefault()},onGutterTouchMove:function(e){this.onResize(e),e.preventDefault()},onGutterTouchEnd:function(e){this.onResizeEnd(e),this.unbindTouchListeners(),e.preventDefault()},bindMouseListeners:function(){var e=this;this.mouseMoveListener||(this.mouseMoveListener=function(t){return e.onResize(t)},document.addEventListener("mousemove",this.mouseMoveListener)),this.mouseUpListener||(this.mouseUpListener=function(t){e.onResizeEnd(t),e.unbindMouseListeners()},document.addEventListener("mouseup",this.mouseUpListener))},bindTouchListeners:function(){var e=this;this.touchMoveListener||(this.touchMoveListener=function(t){return e.onResize(t.changedTouches[0])},document.addEventListener("touchmove",this.touchMoveListener)),this.touchEndListener||(this.touchEndListener=function(t){e.resizeEnd(t),e.unbindTouchListeners()},document.addEventListener("touchend",this.touchEndListener))},validateResize:function(e,t){if(e>100||e<0||t>100||t<0)return!1;var s=Be(this.panels[this.prevPanelIndex],"minSize");if(this.panels[this.prevPanelIndex].props&&s&&s>e)return!1;var o=Be(this.panels[this.prevPanelIndex+1],"minSize");return!(this.panels[this.prevPanelIndex+1].props&&o&&o>t)},unbindMouseListeners:function(){this.mouseMoveListener&&(document.removeEventListener("mousemove",this.mouseMoveListener),this.mouseMoveListener=null),this.mouseUpListener&&(document.removeEventListener("mouseup",this.mouseUpListener),this.mouseUpListener=null)},unbindTouchListeners:function(){this.touchMoveListener&&(document.removeEventListener("touchmove",this.touchMoveListener),this.touchMoveListener=null),this.touchEndListener&&(document.removeEventListener("touchend",this.touchEndListener),this.touchEndListener=null)},clear:function(){this.dragging=!1,this.size=null,this.startPos=null,this.prevPanelElement=null,this.nextPanelElement=null,this.prevPanelSize=null,this.nextPanelSize=null,this.gutterElement=null,this.prevPanelIndex=null},isStateful:function(){return this.stateKey!=null},getStorage:function(){switch(this.stateStorage){case"local":return window.localStorage;case"session":return window.sessionStorage;default:throw new Error(this.stateStorage+' is not a valid value for the state storage, supported values are "local" and "session".')}},saveState:function(){wt(this.panelSizes)&&this.getStorage().setItem(this.stateKey,JSON.stringify(this.panelSizes))},restoreState:function(){var e=this,t=this.getStorage(),s=t.getItem(this.stateKey);if(s){this.panelSizes=JSON.parse(s);var o=Ue(this.$el.children).filter(function(i){return i.getAttribute("data-pc-name")==="splitterpanel"});return o.forEach(function(i,r){i.style.flexBasis="calc("+e.panelSizes[r]+"% - "+(e.panels.length-1)*e.gutterSize+"px)"}),!0}return!1},resetState:function(){this.initializePanels()}},computed:{panels:function(){var e=this,t=[];return this.$slots.default().forEach(function(s){e.isSplitterPanel(s)?t.push(s):s.children instanceof Array&&s.children.forEach(function(o){e.isSplitterPanel(o)&&t.push(o)})}),t},gutterStyle:function(){return this.horizontal?{width:this.gutterSize+"px"}:{height:this.gutterSize+"px"}},horizontal:function(){return this.layout==="horizontal"},getPTOptions:function(){var e;return{context:{nested:(e=this.$parentInstance)===null||e===void 0?void 0:e.nestedState}}}}},Nt=["onMousedown","onTouchstart","onTouchmove","onTouchend"],Yt=["aria-orientation","aria-valuenow","onKeydown"];function Ht(n,e,t,s,o,i){return E(),k("div",Ee({class:n.cx("root"),style:n.sx("root"),"data-p-resizing":!1},n.ptmi("root",i.getPTOptions)),[(E(!0),k(ve,null,Se(i.panels,function(r,a){return E(),k(ve,{key:a},[(E(),ae(ke(r),{tabindex:"-1"})),a!==i.panels.length-1?(E(),k("div",Ee({key:0,ref_for:!0,ref:"gutter",class:n.cx("gutter"),role:"separator",tabindex:"-1",onMousedown:function(u){return i.onGutterMouseDown(u,a)},onTouchstart:function(u){return i.onGutterTouchStart(u,a)},onTouchmove:function(u){return i.onGutterTouchMove(u,a)},onTouchend:function(u){return i.onGutterTouchEnd(u,a)},"data-p-gutter-resizing":!1},n.ptm("gutter")),[g("div",Ee({class:n.cx("gutterHandle"),tabindex:"0",style:[i.gutterStyle],"aria-orientation":n.layout,"aria-valuenow":o.prevSize,onKeyup:e[0]||(e[0]=function(){return i.onGutterKeyUp&&i.onGutterKeyUp.apply(i,arguments)}),onKeydown:function(u){return i.onGutterKeyDown(u,a)},ref_for:!0},n.ptm("gutterHandle")),null,16,Yt)],16,Nt)):K("",!0)],64)}),128))],16)}Vt.render=Ht;var Wt={root:function(e){var t=e.instance;return["p-splitterpanel",{"p-splitterpanel-nested":t.isNested}]}},Gt=He.extend({name:"splitterpanel",classes:Wt}),Kt={name:"BaseSplitterPanel",extends:We,props:{size:{type:Number,default:null},minSize:{type:Number,default:null}},style:Gt,provide:function(){return{$pcSplitterPanel:this,$parentInstance:this}}},Jt={name:"SplitterPanel",extends:Kt,inheritAttrs:!1,data:function(){return{nestedState:null}},computed:{isNested:function(){var e=this;return this.$slots.default().some(function(t){return e.nestedState=t.type.name==="Splitter"?!0:null,e.nestedState})},getPTOptions:function(){return{context:{nested:this.isNested}}}}};function Zt(n,e,t,s,o,i){return E(),k("div",Ee({ref:"container",class:n.cx("root")},n.ptmi("root",i.getPTOptions)),[yt(n.$slots,"default")],16)}Jt.render=Zt;function ze(n){return new Promise(e=>setTimeout(e,n))}class Qt{constructor(){O(this,"_lock",Promise.resolve());this._lock=Promise.resolve()}acquire(){let e;const t=new Promise(o=>e=o),s=this._lock.then(()=>e);return this._lock=this._lock.then(()=>t),s}}class Ie{constructor(){O(this,"mutex");O(this,"inTransaction");O(this,"receivedData");O(this,"activityCallback");O(this,"receiveCallback");O(this,"disconnectCallback");O(this,"writeChunk");O(this,"emit");O(this,"info");O(this,"prevRecvCbk");if(new.target===Ie)throw new Error("Cannot instantiate abstract class Transport");this.mutex=new Qt,this.inTransaction=!1,this.receivedData="",this.activityCallback=()=>{},this.receiveCallback=()=>{},this.disconnectCallback=()=>{},this.prevRecvCbk=e=>{},this.writeChunk=128,this.emit=!1,this.info={}}async getInfo(){return this.info}async write(e){const s=new TextEncoder().encode(e);try{if(s.byteLength==0)await this.writeBytes(s),this.activityCallback();else{let o=0;for(;o<s.byteLength;){const i=s.slice(o,o+this.writeChunk);await this.writeBytes(i),this.activityCallback(),o+=this.writeChunk}}}catch(o){throw o}}onActivity(e){this.activityCallback=e}onReceive(e){this.receiveCallback=e}onDisconnect(e){this.disconnectCallback=e}async startTransaction(){await ze(10);const e=await this.mutex.acquire();return this.prevRecvCbk=this.receiveCallback,this.inTransaction=!0,this.receivedData="",this.receiveCallback=t=>{this.receivedData+=t,this.emit&&this.prevRecvCbk&&this.prevRecvCbk(t)},()=>{this.prevRecvCbk&&(this.receiveCallback=this.prevRecvCbk,this.receiveCallback(this.receivedData)),this.receivedData="",this.inTransaction=!1,e()}}async readExactly(e,t=5e3){if(!this.inTransaction)throw new Error("Not in transaction");let s=Date.now()+t;for(;t<=0||Date.now()<s;){if(this.receivedData.length>=e){const i=this.receivedData.substring(0,e);return this.receivedData=this.receivedData.substring(e),i}const o=this.receivedData.length;await ze(10),this.receivedData.length>o&&(s=Date.now()+t)}throw new Error("Timeout")}async readUntil(e,t=5e3){if(!this.inTransaction)throw new Error("Not in transaction");const s=Date.now();let o=0;for(;t<=0||o<t;){const i=this.receivedData.indexOf(e)+e.length;if(i>=e.length){const r=this.receivedData.substring(0,i);return this.receivedData=this.receivedData.substring(i),r}await ze(10),o=Date.now()-s}throw new Error("Timeout reached before finding the ending sequence")}}class en extends Ie{constructor(){super();O(this,"port");O(this,"reader");O(this,"writer");O(this,"serial");if(this.port=void 0,this.reader=null,this.writer=null,"serial"in navigator)this.serial=navigator.serial;else throw new Error("WebSerial not available")}async requestAccess(){var i,r,a,l;const o={filters:[{usbVendorId:11914,usbProductId:5}]};this.port=await((i=this.serial)==null?void 0:i.requestPort(o));try{const u=(r=this.port)==null?void 0:r.getInfo();this.info={vid:(a=u==null?void 0:u.usbVendorId)==null?void 0:a.toString(16).padStart(4,"0"),pid:(l=u==null?void 0:u.usbProductId)==null?void 0:l.toString(16).padStart(4,"0")}}catch(u){throw u}}async connect(){var t,s;if(!this.port)throw new Error("Port is not available");await this.port.open({baudRate:115200}),this.reader=((t=this.port.readable)==null?void 0:t.getReader())||null,this.writer=((s=this.port.writable)==null?void 0:s.getWriter())||null,this.reader&&this.listen()}async disconnect(){if(!this.reader||!this.port)throw new Error("No active connection to disconnect from");try{await this.reader.cancel()}catch{}await this.port.forget()}async writeBytes(t){if(!this.writer)throw new Error("Writer is not initialized");await this.writer.write(t)}async listen(){if(!this.reader)throw new Error("Reader is not initialized");const t=new TextDecoder;await this.write(""),await this.write("");try{for(;;){const{value:s,done:o}=await this.reader.read();if(o||!s)break;this.receiveCallback(t.decode(s))}}catch(s){throw console.log("disconnect callback"),this.disconnectCallback(),s}}async flushInput(){if(!this.reader)throw new Error("Reader is not initialized");this.receivedData=""}}class ce{constructor(e){O(this,"port");O(this,"end");this.port=e,this.end=async()=>{}}static async begin(e,t=!1){var o;const s=new ce(e);await s.enterRawRepl(t);try{await s.exec("import sys,os")}catch(i){throw await((o=s.end)==null?void 0:o.call(s)),i}return s}async interruptProgram(){await this.port.write("")}async enterRawRepl(e=!1){const t=await this.port.startTransaction();try{await this.interruptProgram(),await this.port.flushInput(),await this.port.write("\r"),await this.port.readUntil(`raw REPL; CTRL-B to exit\r
`),e&&(await this.port.write(""),await this.port.readUntil("OK")),this.end=async()=>{try{await this.port.write(""),await this.port.readUntil(`>\r
`),await this.port.readUntil(">>> ")}finally{t()}}}catch(s){throw t(),s}}async exec(e,t=5e3,s=!1){if(e.length===0)return"";await this.port.write(e),await this.port.write(""),await this.port.readUntil("OK"),this.port.emit=s,s&&this.port.prevRecvCbk(this.port.receivedData);const o=(await this.port.readUntil("",t)).slice(0,-1),i=(await this.port.readUntil("",t)).slice(0,-1);if(i.length)throw new Error(i);return o}async readFile(e){const t=await this.exec(`
try:
 import binascii
 h=lambda x: binascii.hexlify(x).decode()
 h(b'')
except:
 h=lambda b: ''.join('{:02x}'.format(byte) for byte in b)
with open('${e}','rb') as f:
 while 1:
  b=f.read(64)
  if not b:break
  print(h(b),end='')
`);return t.length?new Uint8Array(t.match(/../g).map(s=>parseInt(s,16))):new Uint8Array}async writeFile(e,t,s=128,o=!1){if(typeof t=="string"){const l=new TextEncoder;t=new Uint8Array(l.encode(t))}const i=l=>Array.from(l).map(u=>u.toString(16).padStart(2,"0")).join(""),r=l=>{l=new Uint8Array(l);let u="b'";for(const p of l)p>=32&&p<=126?p===92||p===39?u+="\\"+String.fromCharCode(p):u+=String.fromCharCode(p):u+="\\x"+p.toString(16).padStart(2,"0");return u+="'",u},a=o?e:".viper.tmp";await this.exec(`
try:
 import binascii
 h=binascii.unhexlify
 h('')
except:
 h=lambda s: bytes(int(s[i:i+2], 16) for i in range(0, len(s), 2))
f=open('${a}','wb')
w=lambda d: f.write(h(d))
o=f.write
`);for(let l=0;l<t.byteLength;l+=s){const u=t.slice(l,l+s),p="w('"+i(u)+"')",c="o("+r(u)+")";p.length<c.length?await this.exec(p):await this.exec(c)}o?await this.exec("f.close()"):await this.exec(`f.close()
try: os.remove('${e}')
except: pass
os.rename('${a}','${e}')
`)}async getDeviceInfo(){const e=await this.exec(`
try: u=os.uname()
except: u=('','','','',sys.platform)
try: v=sys.version.split(';')[1].strip()
except: v='MicroPython '+u[2]
mpy=getattr(sys.implementation, '_mpy', 0)
sp=':'.join(sys.path)
d=[u[4],u[2],u[0],v,mpy>>10,mpy&0xFF,(mpy>>8)&3,sp]
print('|'.join(str(x) for x in d))
`);let[t,s,o,i,r,a,l,u]=e.trim().split("|");const p=u.split(":");try{r=["","x86","x64","armv6","armv6m","armv7m","armv7em","armv7emsp","armv7emdp","xtensa","xtensawin","rv32imc"][parseInt(r)]}catch{r=""}let c=parseInt(a,10);const w=parseInt(l,10);return c||(c="py"),{machine:t,release:s,sysname:o,version:i,mpy_arch:r,mpy_ver:c,mpy_sub:w,sys_path:p}}async touchFile(e){await this.exec(`
f=open('${e}','wb')
f.close()
`)}async moveFile(e,t){await this.exec(`os.rename('${e}', '${t}')`)}async makeDir(e){await this.exec(`os.mkdir('${e}')`)}async makePath(e){await this.exec(`
p=''
for d in '${e}'.split('/'):
 if not d: continue
 p += '/'+d
 try: os.mkdir(p)
 except OSError as e:
  if e.args[0] not in (17, 20): raise
`)}async removeFile(e){await this.exec(`
try:
 os.remove('${e}')
except OSError as e:
 if e.args[0] == 39:
  throw new Error('Directory not empty')
 else:
  throw e
`)}async removeDir(e){await this.exec(`
try:
 os.rmdir('${e}')
except OSError as e:
 if e.args[0] == 39:
  throw new Error('Directory not empty')
 else:
  throw e
`)}async getFsStats(e="/"){return(await this.exec(`
s = os.statvfs('${e}')
fs = s[1] * s[2]
ff = s[3] * s[0]
fu = fs - ff
print('%s|%s|%s'%(fu,ff,fs))
`)).trim().split("|")}async getFiles(){return await this.exec(`
def walk(p):
 for n in os.listdir(p if p else '/'):
  fn=p+'/'+n
  try: s=os.stat(fn)
  except: s=(0,)*7
  try:
   if s[0] & 0x4000 == 0:
    print('f|'+fn+'|'+str(s[6]))
   elif n not in ('.','..'):
    print('d|'+fn+'|'+str(s[6]))
    walk(fn)
  except:
   print('f|'+p+'/???|'+str(s[6]))
walk('')
`)}async readSysInfoMD(){return await this.exec(`
import gc
gc.collect()
mu = gc.mem_alloc()
mf = gc.mem_free()
ms = mu + mf
uname=os.uname()
p=print
def size_fmt(size):
 suffixes = ['B','KiB','MiB','GiB','TiB']
 i = 0
 while size > 1024 and i < len(suffixes)-1:
  i += 1
  size //= 1024
 return "%d%s" % (size, suffixes[i])
p('## Machine')
p('- Name: \`'+uname.machine+'\`')
try:
 gc.collect()
 import microcontroller as uc
 p('- CPU: \`%s @ %s MHz\`' % (sys.platform, uc.cpu.frequency // 1_000_000))
 p('- UID: \`%s\`' % (uc.cpu.uid.hex(),))
 p('- Temp.: \`%s °C\`' % (uc.cpu.temperature,))
 p('- Voltage: \`%s V\`' % (uc.cpu.voltage,))
except:
 try:
  gc.collect()
  import machine
  p('- CPU: \`%s @ %s MHz\`' % (sys.platform, machine.freq() // 1_000_000))
 except:
  p('- CPU: \`'+sys.platform+'\`')
p()
p('## System')
p('- Version: \`'+sys.version.split(";")[1].strip()+'\`')
if ms:
 p('- Memory use:  \`%s / %s, free: %d%%\`' % (size_fmt(mu), size_fmt(ms), (mf * 100) // ms))
`)}}const Te=m(!1);m(tt());const N=m(!1),tn=m(!1),nn=m(),Y=m(!1),qe=m(!1),Ze=m(!1),Qe=m(),ge=m(!1),je=m(!1),sn=m(!1),on=m(),ue=m(!1),Xe=m(!1),rn=m(!1),an=m();let I=null;function ln(n){return new Promise(e=>setTimeout(e,n))}async function un(n){try{ge.value=!0,je.value=!1,await n(),je.value=!0}catch(e){sn.value=!0,on.value=e}finally{ge.value=!1}}async function cn(n){try{ue.value=!0,Xe.value=!1,await n(),Xe.value=!0}catch(e){rn.value=!0,an.value=e}finally{ue.value=!1}}function de(n){return"children"in n}function et(n){if(n){n.children.sort((e,t)=>de(e)&&!de(t)?-1:!de(e)&&de(t)?1:e.name.localeCompare(t.name));for(const e of n.children)de(e)&&et(e)}}async function pn(){if(!I)return{name:"",path:"",children:[]};const n=await ce.begin(I,!0),e=await n.getFiles();await n.end();const t=dn(e);return et(t),t}function dn(n){const e={name:"",path:"",children:[]},t=n.trim().split(`
`),s={"":e};for(const o of t){const[i,r,a]=o.split("|"),l=r.split("/"),u=l[l.length-1],p=l.slice(0,-1).join("/")||"";if(i==="f"){const c={name:u,path:r,size:parseInt(a)};s[p]&&s[p].children.push(c)}else if(i==="d"){const c={name:u,path:r,children:[]};s[r]=c,s[p]&&s[p].children.push(c)}}return e}function Ve(n,e){let t=!1;const s=n.trim().split(`
`),o=i=>{const[r,a,l]=i.split("|");return a===e};return s.find(o)&&(t=!0),t}function tt(){return/(iPad|iPhone|iPod)/g.test(navigator.userAgent)?(console.error("WebSerial is not available on iOS"),!1):window.isSecureContext?"serial"in navigator||"usb"in navigator?!0:(console.error("Try Chrome, Edge, Opera, Brave","WebSerial and WebUSB are not supported"),!1):(console.error("WebSerial cannot be accessed with unsecure connection"),!1)}async function fn(){let n;if(n=new en,!tt())return null;try{await n.requestAccess()}catch(e){return nn.value=e,null}return n}async function hn(n,e,t){try{await n.connect(),N.value=!0}catch{Te.value=!1,N.value=!1,Y.value=!1,ue.value=!1,ge.value=!1,tn.value=!0;return}n.onReceive(e),n.onDisconnect(()=>{I==null||I.disconnect(),I=null,t(),N.value=!1,Y.value=!1,ue.value=!1,ge.value=!1,Te.value=!1}),I=n}async function vn(){I==null||I.disconnect(),I=null,Te.value=!1,N.value=!1,Y.value=!1,ge.value=!1,ue.value=!1}async function mn(n){if(I)if(Y.value)await I.write(n);else{const e=await I.mutex.acquire();try{await I.write(n)}finally{e()}}}async function gn(){if(!I)return"";try{await I.write("\r"),Y.value=!1}catch(n){Ze.value=!0,Y.value=!1,Qe.value=n}}async function wn(n){if(!I||(Y.value&&await I.write("\r"),n.length===0))return;const e=!0,t=-1,s=await ce.begin(I,e);try{qe.value=!1,Y.value=!0;const o=!0;await ln(10),await s.exec(n,t,o),qe.value=!0}catch(o){let i;o instanceof Error?i=o.message:i=String(o),i.includes("KeyboardInterrupt")||(Ze.value=!0,Qe.value=o)}finally{I.emit=!1,Y.value=!1}await s.end()}async function Me(n){if(!I)return"";let e="";const t=await ce.begin(I);return await un(async()=>{const s=await t.readFile(n);e=new TextDecoder("utf-8",{fatal:!0}).decode(s)}),t.end(),e}async function yn(){if(!I)return"";const n=await ce.begin(I),e=await n.getFiles();await n.end();let t="";return Ve(e,"/main.py")?t=await Me("/main.py"):Ve(e,"/code.py")?t=await Me("/code.py"):(t="",await nt("/main.py",t)),t}async function nt(n,e){if(!I)return;const t=await ce.begin(I);await cn(async()=>await t.writeFile(n,e)),t.end()}const Ae=we("useTerminalStore",()=>{const n=m("");let e="";const t=65536;let s=null;const o=m(0);let i=null;const r=w=>{for(let b=0;b<w.length;b++){let h=w[b];h==="\b"?o.value=Math.max(0,o.value-1):h==="\x1B"?(h=w[++b],h==="["&&(h=w[++b],h==="K"&&(e=e.slice(0,o.value)+n.value.slice(o.value+1),a()))):(e+=h,e.length>t&&(e=e.slice(e.length-t,e.length)),a())}},a=()=>{s||(s=setTimeout(()=>{l(),s=null},1))},l=()=>{n.value=e,o.value=n.value.length,p()},u=()=>{n.value="",e="",o.value=0,s&&(clearTimeout(s),s=null)},p=()=>{i&&(i.scrollTop=i.scrollHeight)};return{output:n,caret:o,write:r,clear:u,openTerminal:w=>{i=w}}}),Pe=we("useMPDeviceStore",()=>{const n=m(localStorage.getItem("fileContent")||""),e=m(""),t=m(""),s=m(!1),o=m([]),i=m({name:"",path:"",children:[]});async function r(u,p){o.value=[u],t.value=u,n.value=p}async function a(u){o.value=[u],t.value=u,n.value=await Me(u)}function l(u){n.value=u}return{isProject:s,activeFiles:o,fileContent:n,fileName:e,filePath:t,fileTree:i,openFile:r,loadFile:a,setCode:l}}),xn={key:0,class:"material-icons"},bn={key:1,class:"material-icons"},_n=R({__name:"IdeButtons",setup(n){const e=Pe(),t=Ae(),{isProject:s,filePath:o,fileContent:i,fileTree:r}=le(e),{openFile:a}=e;let l=null;ye(()=>{s.value||(l=setInterval(()=>{localStorage.setItem("fileContent",i.value)},1e3))}),xt(()=>{l&&clearInterval(l)});async function u(){const b=await fn();if(b&&(await hn(b,t.write,()=>{s.value&&(o.value="",i.value=""),r.value={name:"empty",path:"",children:[]}}),t.clear(),s.value)){const h=await yn();a("/main.py",h),r.value=await pn()}}function p(){N.value?(vn(),s.value&&(o.value="",i.value="",r.value={name:"empty",path:"",children:[]})):u()}const c=m(!1);function w(){wn(i.value)}return(b,h)=>{const C=Le;return E(),k("div",null,[f(N)?(E(),ae(C,{key:0,id:"#run",type:"button",class:"w-9 h-9 mr-1",variant:f(Y)||!f(N)?"outlined":void 0,severity:"info",rounded:"",onClick:w,disabled:f(Y)||!f(N),loading:f(Y)},{default:te(()=>h[5]||(h[5]=[g("span",{class:"material-icons"},"play_arrow",-1)])),_:1},8,["variant","disabled","loading"])):K("",!0),f(N)?(E(),ae(C,{key:1,type:"button",class:"w-9 h-9 mr-1",variant:!f(Y)||!f(N)?"outlined":void 0,severity:"danger",rounded:"",onClick:h[0]||(h[0]=M=>f(gn)()),disabled:!f(Y)||!f(N)},{default:te(()=>h[6]||(h[6]=[g("span",{class:"material-icons"},"stop",-1)])),_:1},8,["variant","disabled"])):K("",!0),f(N)?(E(),ae(C,{key:2,type:"button",class:"w-9 h-9",variant:"outlined",severity:"secondary",rounded:"",onClick:h[1]||(h[1]=M=>f(nt)(f(o),f(i))),disabled:f(ue)||f(Y)||!f(N),loading:f(ue)},{default:te(()=>h[7]||(h[7]=[g("span",{class:"material-icons"},"save",-1)])),_:1},8,["disabled","loading"])):K("",!0),Z(C,{type:"button",class:ee(["w-9 h-9 mr-1 text-white",f(N)?c.value?"bg-red-500":"bg-green-500":"bg-gray-600"]),rounded:"",text:"",onClick:h[2]||(h[2]=M=>p()),onMouseover:h[3]||(h[3]=M=>c.value=!0),onMouseleave:h[4]||(h[4]=M=>c.value=!1)},{default:te(()=>[c.value&&f(N)?(E(),k("span",xn,"close")):(E(),k("span",bn,"cable"))]),_:1},8,["class"])])}}}),Sn={class:"relative flex h-full"},Li=R({__name:"CodeView",setup(n){const e=Pe(),{fileContent:t}=le(e);return(s,o)=>(E(),k("div",Sn,[Z(Ct,{modelValue:f(t),"onUpdate:modelValue":o[0]||(o[0]=i=>bt(t)?t.value=i:null)},null,8,["modelValue"]),o[1]||(o[1]=g("div",{id:"#editor",class:"absolute top-10 left-10"},null,-1)),Z(_n,{class:"absolute bottom-2 right-2"})]))}}),En={class:"flex flex-col h-full"},$n={class:"flex px-2 w-full bg-zinc-900 text-white h-6 justify-between items-center"},Ln=R({__name:"TerminalView",setup(n){const e=m(!1),t=Ae(),{output:s}=le(t);function o(r){let a=r.key;if(a==="Enter")a=`
\r`;else if(a==="Backspace")a="\b";else if(a.length>1)return;mn(a)}const i=m(null);return ye(()=>{t.openTerminal(i.value)}),(r,a)=>{const l=Le;return E(),k("div",En,[g("div",$n,[a[4]||(a[4]=g("span",{class:"material-icons"},"terminal",-1)),Z(l,{onClick:a[0]||(a[0]=u=>f(t).clear()),class:"w-4 h-4 text-white",link:""},{default:te(()=>a[3]||(a[3]=[g("span",{class:"material-icons",style:{"font-size":"16px"}},"cleaning_services",-1)])),_:1})]),g("pre",{class:"h-full font-mono overflow-auto p-2 text-white bg-black",ref_key:"el",ref:i,tabindex:"0",onKeydown:o,onFocus:a[1]||(a[1]=u=>e.value=!0),onBlur:a[2]||(a[2]=u=>e.value=!1)},[a[5]||(a[5]=Oe("")),g("span",null,ie(f(s)),1),g("span",{class:ee([{caret:e.value},"bg-white"])}," ",2),a[6]||(a[6]=Oe(`
    `))],544)])}}}),Pi=W(Ln,[["__scopeId","data-v-61224fc2"]]),Pn={class:"color-picker select-none w-32"},zn={class:"slider-container"},kn={class:"slider-container"},Cn=R({__name:"ColorPicker",props:{modelValue:{required:!0,default:{r:0,g:0,b:0}},modelModifiers:{}},emits:["update:modelValue"],setup(n){const e=_t(n,"modelValue"),{h:t,s}=p(e.value.r,e.value.g,e.value.b),o=m(t/360),i=m(),r=m(s/100),a=m();let l=!1,u=!1;function p(d,v,_){d/=255,v/=255,_/=255;const y=Math.max(d,v,_),A=Math.min(d,v,_),H=y-A;let F=0;H!==0&&(y===d?F=(v-_)/H%6:y===v?F=(_-d)/H+2:F=(d-v)/H+4,F=Math.round(F*60),F<0&&(F+=360));const G=(y+A)/2,J=H===0?0:H/(1-Math.abs(2*G-1));return{h:F,s:J*100,l:G*100}}function c(d,v,_){d=d*360%360,v/=100,_/=100;const y=(1-Math.abs(2*_-1))*v,A=y*(1-Math.abs(d/60%2-1)),H=_-y/2;let F=0,G=0,J=0;return 0<=d&&d<60?(F=y,G=A,J=0):60<=d&&d<120?(F=A,G=y,J=0):120<=d&&d<180?(F=0,G=y,J=A):180<=d&&d<240?(F=0,G=A,J=y):240<=d&&d<300?(F=A,G=0,J=y):300<=d&&d<=360&&(F=y,G=0,J=A),{r:Math.round((F+H)*255),g:Math.round((G+H)*255),b:Math.round((J+H)*255)}}function w(d,v,_){const y=(1-_+v)/2;let A;return y===0||y===1?A=0:A=(1-_-v)/(1-Math.abs(2*y-1)),{h:d,s:A*100,l:y*100}}const b=se(()=>{const{h:d,s:v,l:_}=w(o.value,1-r.value,0),{r:y,g:A,b:H}=c(d,v,_);return e.value={r:y,g:A,b:H},`hsl(${d}turn, ${v}%, ${_}%)`}),h=d=>{u=!u,M(d),window.addEventListener("pointermove",M),window.addEventListener("pointerup",C)},C=()=>{u=!1,window.removeEventListener("pointermove",M),window.removeEventListener("pointerup",C)},M=d=>{if(u){const v=a.value.getBoundingClientRect(),_=Math.min(v.width,Math.max(0,d.clientX-v.left));r.value=_/v.width}},D=d=>{l=!l,T(d),window.addEventListener("pointermove",T),window.addEventListener("pointerup",B)},B=()=>{l=!1,window.removeEventListener("pointermove",T),window.removeEventListener("pointerup",B)},T=d=>{if(l){const v=i.value.getBoundingClientRect(),_=Math.min(v.width,Math.max(0,d.clientX-v.left));o.value=_/v.width}};return(d,v)=>(E(),k("div",Pn,[g("div",zn,[g("div",{class:"hue-slider",style:{background:"linear-gradient(to right, red, yellow, lime, cyan, blue, magenta, red)"},onPointerdown:D,onPointerup:B,onPointermove:T,ref_key:"hueRef",ref:i},[g("div",{class:"slider-handle",style:V({left:`${o.value*100}%`})},null,4)],544)]),g("div",kn,[g("div",{class:"saturation-slider",style:V({background:`linear-gradient(to right, white, hsl(${o.value}turn, 100%, 50%))`}),onPointerdown:h,onPointerup:C,onPointermove:M,ref_key:"saturationRef",ref:a},[g("div",{class:"slider-handle",style:V({left:`${r.value*100}%`})},null,4)],36)]),Ge(g("div",{class:"color-preview",style:V({backgroundColor:`${b.value}`})},null,4),[[St,!1]])]))}}),Tn=W(Cn,[["__scopeId","data-v-53a96f93"]]);function Mn(n){return Et()?($t(n),!0):!1}const Dn=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const In=Object.prototype.toString,An=n=>In.call(n)==="[object Object]",Rn=()=>{};function Ne(n){return Array.isArray(n)?n:[n]}const Re=Dn?window:void 0;function st(n){var e;const t=Ke(n);return(e=t==null?void 0:t.$el)!=null?e:t}function fe(...n){let e,t,s,o;if(typeof n[0]=="string"||Array.isArray(n[0])?([t,s,o]=n,e=Re):[e,t,s,o]=n,!e)return Rn;t=Ne(t),s=Ne(s);const i=[],r=()=>{i.forEach(p=>p()),i.length=0},a=(p,c,w,b)=>(p.addEventListener(c,w,b),()=>p.removeEventListener(c,w,b)),l=Q(()=>[st(e),Ke(o)],([p,c])=>{if(r(),!p)return;const w=An(c)?{...c}:c;i.push(...t.flatMap(b=>s.map(h=>a(p,b,h,w))))},{immediate:!0,flush:"post"}),u=()=>{l(),r()};return Mn(u),u}const Fn={page:n=>[n.pageX,n.pageY],client:n=>[n.clientX,n.clientY],screen:n=>[n.screenX,n.screenY],movement:n=>n instanceof Touch?null:[n.movementX,n.movementY]};function Bn(n={}){const{type:e="page",touch:t=!0,resetOnTouchEnds:s=!1,initialValue:o={x:0,y:0},window:i=Re,target:r=i,scroll:a=!0,eventFilter:l}=n;let u=null,p=0,c=0;const w=m(o.x),b=m(o.y),h=m(null),C=typeof e=="function"?e:Fn[e],M=y=>{const A=C(y);u=y,A&&([w.value,b.value]=A,h.value="mouse"),i&&(p=i.scrollX,c=i.scrollY)},D=y=>{if(y.touches.length>0){const A=C(y.touches[0]);A&&([w.value,b.value]=A,h.value="touch")}},B=()=>{if(!u||!i)return;const y=C(u);u instanceof MouseEvent&&y&&(w.value=y[0]+i.scrollX-p,b.value=y[1]+i.scrollY-c)},T=()=>{w.value=o.x,b.value=o.y},d=l?y=>l(()=>M(y),{}):y=>M(y),v=l?y=>l(()=>D(y),{}):y=>D(y),_=l?()=>l(()=>B(),{}):()=>B();if(r){const y={passive:!0};fe(r,["mousemove","dragover"],d,y),t&&e!=="movement"&&(fe(r,["touchstart","touchmove"],v,y),s&&fe(r,"touchend",T,y)),a&&e==="page"&&fe(i,"scroll",_,{passive:!0})}return{x:w,y:b,sourceType:h}}function Fe(n,e={}){const{handleOutside:t=!0,window:s=Re}=e,o=e.type||"page",{x:i,y:r,sourceType:a}=Bn(e),l=m(n??(s==null?void 0:s.document.body)),u=m(0),p=m(0),c=m(0),w=m(0),b=m(0),h=m(0),C=m(!0);let M=()=>{};return s&&(M=Q([l,i,r],()=>{const D=st(l);if(!D||!(D instanceof Element))return;const{left:B,top:T,width:d,height:v}=D.getBoundingClientRect();c.value=B+(o==="page"?s.pageXOffset:0),w.value=T+(o==="page"?s.pageYOffset:0),b.value=v,h.value=d;const _=i.value-c.value,y=r.value-w.value;C.value=d===0||v===0||_<0||y<0||_>d||y>v,(t||!C.value)&&(u.value=_,p.value=y)},{immediate:!0}),fe(document,"mouseleave",()=>{C.value=!0})),{x:i,y:r,sourceType:a,elementX:u,elementY:p,elementPositionX:c,elementPositionY:w,elementHeight:b,elementWidth:h,isOutside:C,stop:M}}const On="/assets/yellow_led-TydLrbQ8.jpg";function q(n){const e=m(0),t=m(0);return{state:e,freq:t,mode:n}}const pe=(n={})=>{const{mode0:e="gnd",mode1:t="power",mode2:s="air",mode3:o="air",setShared:i=()=>{},getShared:r=()=>{}}=n,a=q(e),l=q(t),u=q(s),p=q(o);return{pin0:a,pin1:l,pin2:u,pin3:p,setShared:i,getShared:r}},Un={ref:"theref"},qn={class:"rounded-lg overflow-hidden relative"},jn=["src"],Xn={key:1,class:"absolute top-0 left-0"},Vn=R({__name:"LED",setup(n,{expose:e}){const{isOutside:t}=Fe(De("theref")),s=pe({mode2:"input",setShared:w=>{i.value=w.color.value},getShared:()=>({color:i})});e(s);const{pin2:o}=s,i=m({r:255,g:0,b:0}),r=m({visible:!1,toggle:w=>{}});function a(w){r.value.toggle(w)}const l=se(()=>`
0 0 3px 3px rgba(${i.value.r}, ${i.value.g}, ${i.value.b}, ${o.state.value*.7}),
0 0 5px 5px rgba(${i.value.r}, ${i.value.g}, ${i.value.b}, ${o.state.value*.5}),
0 0 7px 7px rgba(${i.value.r}, ${i.value.g}, ${i.value.b}, ${o.state.value*.3})
`),u=se(()=>`radial-gradient(circle, rgb(${i.value.r}, ${i.value.g}, ${i.value.b}) 40%, #000 90%)`),p=se(()=>`rgb(${i.value.r}, ${i.value.g}, ${i.value.b})`),c=se(()=>`rgba(${i.value.r}, ${i.value.g}, ${i.value.b}, 0.7)`);return(w,b)=>{const h=Le,C=Lt;return E(),k("div",Un,[g("div",qn,[g("img",{src:f(On),alt:"LED"},null,8,jn),g("div",{class:"absolute top-[10px] left-[30px] rounded-full h-[19px] w-[19px]",style:V({background:p.value})},null,4),g("div",{class:"absolute top-[12px] left-[32px] rounded-full h-[15px] w-[15px]",style:V({background:u.value})},null,4),f(o).state.value?(E(),k("div",{key:0,class:"absolute top-2 left-7 rounded-full h-6 w-6 p-0 border-none absolute top-0 left-0 overflow-hidden",style:V({boxShadow:l.value,background:c.value})},null,4)):K("",!0),!f(t)||r.value.visible?(E(),k("div",Xn,[Z(h,{type:"button",class:"w-6 h-6 bg-black",rounded:"",onClick:a,onPointerdown:b[0]||(b[0]=me(()=>{},["stop"]))},{default:te(()=>b[2]||(b[2]=[g("span",{class:"material-icons"},"palette",-1)])),_:1})])):K("",!0),Z(C,{ref_key:"cp",ref:r},{default:te(()=>[Z(Tn,{modelValue:i.value,"onUpdate:modelValue":b[1]||(b[1]=M=>i.value=M)},null,8,["modelValue"])]),_:1},512)])],512)}}}),Nn=W(Vn,[["__scopeId","data-v-799d0c28"]]),Yn="/assets/touch_sensor-CfCsQfvI.jpg",Hn={class:"button-control"},Wn=["src"],Gn=R({__name:"TouchSensor",setup(n,{expose:e}){const t=m(q("input")),s=m(q("air"));function o(){}function i(){}return e({pin2:t,pin3:s}),(r,a)=>(E(),k("div",Hn,[g("div",{class:"button-actions",onMousedown:o,onMouseup:i,onMouseleave:i},[g("img",{src:f(Yn),alt:"Touch Sensor",class:"button-image"},null,8,Wn)],32)]))}}),Kn=W(Gn,[["__scopeId","data-v-d0afa6cd"]]),Jn="/assets/push_button-DvCvYEel.jpg",Zn={ref:"theref"},Qn={class:"rounded-lg overflow-hidden relative"},es=["src"],ts=R({__name:"PushButton",setup(n,{expose:e}){const{isOutside:t}=Fe(De("theref")),s=pe({mode2:"input",setShared:c=>{i.value=c},getShared:()=>i.value});e(s);const{pin2:o}=s,i=m(""),r=m(!1),a=c=>{!r.value&&c.key.toUpperCase()===i.value&&(o.state.value=1)},l=c=>{!r.value&&c.key.toUpperCase()===i.value&&(o.state.value=0)},u=c=>{r.value&&c.key==="Escape"&&(i.value="",r.value=!1,window.removeEventListener("keydown",u)),r.value&&/^[A-Za-z0-9]$/.test(c.key)&&(i.value=c.key.toUpperCase(),r.value=!1,window.removeEventListener("keydown",u))},p=c=>{c.stopPropagation(),r.value=!0,window.addEventListener("keydown",u)};return ye(()=>{window.addEventListener("keydown",a),window.addEventListener("keyup",l)}),Je(()=>{window.removeEventListener("keydown",a),window.removeEventListener("keyup",l)}),(c,w)=>(E(),k("div",Zn,[g("div",Qn,[g("img",{src:f(Jn),alt:"Push Button"},null,8,es),g("button",{class:ee(["absolute top-[27px] left-[27px] rounded-full w-[25px] h-[25px]",f(o).state.value?"bg-green-500":"bg-purple-500"]),onPointerdown:w[0]||(w[0]=b=>f(o).state.value=1),onPointerup:w[1]||(w[1]=b=>f(o).state.value=0),onPointerleave:w[2]||(w[2]=b=>f(o).state.value=0)},ie(i.value),35),!f(t)||r.value?(E(),k("button",{key:0,onClick:p,onPointerdown:w[3]||(w[3]=me(()=>{},["stop"])),class:"absolute w-full h-4 text-xs top-0 left-0 bg-black/[0.8] text-white rounded-lg"},ie(r.value?"Press a key...":i.value?"Set shortcut":"Add shortcut"),33)):K("",!0)])],512))}}),ns="/assets/climate_sensor-BFoyC3X2.jpg",ss={class:"led-container"},is=["src"],os=R({__name:"ClimateSensor",setup(n,{expose:e}){const t=U(q("output")),s=U(q("air"));return e({pin2:t,pin3:s}),Q(t,()=>{t.state}),(o,i)=>(E(),k("div",null,[g("div",ss,[g("img",{src:f(ns),alt:"LED",class:"led-image"},null,8,is)])]))}}),rs=W(os,[["__scopeId","data-v-890fa9fe"]]),as={class:"rounded-lg overflow-hidden relative"},ls={class:"module"},us={class:"distance"},cs=R({__name:"DistanceSensor",setup(n){const e=m({x:10,y:10}),t={x:50,y:50},s=se(()=>{const p=e.value.x-t.x,c=e.value.y-t.y;return Math.sqrt(p*p+c*c).toFixed(1)});let o=!1,i=0,r=0;const a=p=>{p.stopPropagation(),o=!0,i=p.clientX-e.value.x,r=p.clientY-e.value.y,window.addEventListener("pointermove",l),window.addEventListener("pointerup",u)},l=p=>{o&&(e.value.x=p.clientX-i,e.value.y=p.clientY-r)},u=()=>{o=!1,window.removeEventListener("pointermove",l),window.removeEventListener("pointerup",u)};return(p,c)=>(E(),k("div",as,[g("div",ls,[g("div",{class:"sensor",style:V({left:t.x+"px",top:t.y+"px"})},[g("div",us,ie(s.value)+" units",1)],4),g("div",{class:"draggable",style:V({left:e.value.x+"px",top:e.value.y+"px"}),onPointerdown:a},null,36)])]))}}),ps=W(cs,[["__scopeId","data-v-48899fab"]]),ds="/assets/light_sensor-eM0m1ojf.jpg",fs={class:"led-container"},hs=["src"],vs={key:0,class:"led-light"},ms=R({__name:"LightSensor",setup(n,{expose:e}){const t=U(q("output")),s=U(q("air"));return e({pin2:t,pin3:s}),Q(t,()=>{t.state}),(o,i)=>(E(),k("div",null,[g("div",fs,[g("img",{src:f(ds),alt:"LED",class:"led-image"},null,8,hs),t.state?(E(),k("div",vs)):K("",!0)])]))}}),gs=W(ms,[["__scopeId","data-v-be2cc944"]]),ws="/assets/switch-ChSLRb35.jpg",ys={ref:"theref"},xs={class:"rounded-lg overflow-hidden relative"},bs=["src"],_s={class:"absolute top-7 left-[55px]"},Ss=R({__name:"Switch",setup(n,{expose:e}){const{isOutside:t}=Fe(De("theref")),s=pe({mode2:"input",setShared:c=>{i.value=c},getShared:()=>i.value});e(s);const{pin2:o}=s,i=m(""),r=m(!1),a=c=>{!r.value&&c.key.toUpperCase()===i.value&&(o.state.value=1-o.state.value)},l=c=>{r.value&&c.key==="Escape"&&(i.value="",r.value=!1,window.removeEventListener("keydown",l)),r.value&&/^[A-Za-z0-9]$/.test(c.key)&&(i.value=c.key.toUpperCase(),r.value=!1,window.removeEventListener("keydown",l))},u=c=>{c.stopPropagation(),r.value=!0,window.addEventListener("keydown",l)},p=c=>{c.stopPropagation(),console.log("toggle"),o.state.value=1-o.state.value};return ye(()=>{window.addEventListener("keydown",a)}),Je(()=>{window.removeEventListener("keydown",a)}),(c,w)=>(E(),k("div",ys,[g("div",xs,[g("img",{src:f(ws),alt:"Toggle Switch"},null,8,bs),g("button",{class:"absolute top-[20px] left-[32px] w-[16px] h-[40px]",onPointerdown:p},[g("div",{class:ee(["absolute w-[5px] h-[5px] bg-black cursor-pointer border-none",f(o).state.value?"bg-green-500":"bg-rose-500"]),style:V({top:(f(o).state.value?"14":"21")+"px",left:"5px"})},null,6)],32),g("div",_s,ie(i.value),1),!f(t)||r.value?(E(),k("button",{key:0,onClick:u,onPointerdown:w[0]||(w[0]=me(()=>{},["stop"])),class:"absolute w-full h-4 text-xs top-0 left-0 bg-black/[0.8] text-white rounded-lg"},ie(r.value?"Press a key...":i.value?"Set shortcut":"Add shortcut"),33)):K("",!0)])],512))}}),Es=W(Ss,[["__scopeId","data-v-435cd17d"]]),$s="/assets/color_sensor-BfpGiqXy.jpg",Ls={class:"led-container"},Ps=["src"],zs=R({__name:"ColorSensor",setup(n,{expose:e}){const t=U(q("output")),s=U(q("air"));return e({pin2:t,pin3:s}),Q(t,()=>{t.state}),(o,i)=>(E(),k("div",null,[g("div",Ls,[g("img",{src:f($s),alt:"LED",class:"led-image"},null,8,Ps)])]))}}),ks=W(zs,[["__scopeId","data-v-789f161c"]]),Cs="/assets/gyro-B0eg3n6B.jpg",Ts={class:"led-container"},Ms=["src"],Ds=R({__name:"Gyro",setup(n,{expose:e}){const t=U(q("output")),s=U(q("air"));return e({pin2:t,pin3:s}),Q(t,()=>{t.state}),(o,i)=>(E(),k("div",null,[g("div",Ts,[g("img",{src:f(Cs),alt:"LED",class:"led-image"},null,8,Ms)])]))}}),Is=W(Ds,[["__scopeId","data-v-7365a5be"]]),As="/assets/potentiometer-CklP_JJ1.jpg",Rs={class:"rounded-lg overflow-hidden relative"},Fs=["src"],Bs={class:"absolute rounded-full top-5 left-8 w-10 h-10"},Os={key:0,class:"absolute bottom-0 left-0 flex items-center"},Us=R({__name:"Potentiometer",setup(n,{expose:e}){const t=pe({mode2:"input",setShared:c=>{s.state.value=c},getShared:()=>s.state.value});e(t);const{pin2:s}=t,o=se(()=>s.state.value*6/8-3/8),i=m(!1);let r=!1,a=0;const l=c=>{c.stopPropagation(),c.preventDefault(),r=!r,a=c.clientX,i.value=r,window.addEventListener("pointermove",p),window.addEventListener("pointerup",u)},u=()=>{r=!1,i.value=r,window.removeEventListener("pointermove",p),window.removeEventListener("pointerup",u)},p=c=>{if(r){const w=(c.clientX-a)/20;a=c.clientX,s.state.value=Math.min(1,Math.max(0,s.state.value+w/2))}};return(c,w)=>(E(),k("div",null,[g("div",Rs,[g("img",{src:f(As),alt:"Potentiometer"},null,8,Fs),g("button",Bs,[g("div",null,[g("div",{class:"top-0 left-0 relative w-10 h-10 rounded-full bg-rose-600 flex items-center justify-center",onPointerdown:l,style:V(`transform: rotate(${o.value}turn)`)},w[1]||(w[1]=[g("div",{class:"absolute top-0 left-4.5 w-1 h-5 bg-white"},null,-1),g("div",{class:"absolute inset-0 flex items-center justify-center pointer-events-none"},null,-1)]),36)])]),i.value?(E(),k("div",Os,[Ge(g("input",{type:"range",min:"0",max:"1",step:"0.01","onUpdate:modelValue":w[0]||(w[0]=b=>f(s).state.value=b),class:"w-full cursor-pointer"},null,512),[[Pt,f(s).state.value]])])):K("",!0)])]))}}),qs="/assets/encoder-BbdKADqm.jpg",js="/assets/encoder_knob-Du3tJHEr.png",Xs={class:"rounded-lg overflow-hidden relative"},Vs=["src"],Ns=["src"],Ys={key:0,class:"absolute bg-blue-500 top-3 left-6 w-1 h-1"},Hs={class:"absolute bottom-1 left-[25px] flex items-center"},Ws=R({__name:"Encoder",setup(n,{expose:e}){const t=pe({mode1:"input",mode2:"input",setShared:v=>{l.value=v},getShared:()=>l.value});e(t);const{pin0:s,pin1:o,pin2:i,pin3:r}=t,a=se(()=>s.state.value===0&&o.state.value>0),l=m(0),u=m(!1);let p=!1,c=0,w=0,b=0,h=0,C=0,M=null;const D=v=>{if(v.stopPropagation(),v.preventDefault(),h=Math.atan2(v.clientY-w,v.clientX-c)/(2*Math.PI)+1/4,C=l.value,p=!p,u.value=p,v.currentTarget instanceof HTMLElement){const y=v.currentTarget.getBoundingClientRect();c=y.left+y.width/2,w=y.top+y.height/2}window.addEventListener("pointermove",d),window.addEventListener("pointerup",T)},B=()=>{if(!M)return;let v=b-l.value;v>.5&&(v-=1),v<-.5&&(v+=1);const _=.1;Math.abs(v)>.001?(l.value+=v*_,l.value>1&&(l.value-=1),l.value<0&&(l.value+=1),M=requestAnimationFrame(B)):(l.value=b,cancelAnimationFrame(M),M=null)},T=()=>{const v=.041666666666666664;b=Math.round(l.value/v)*v,M||(M=requestAnimationFrame(B)),p=!1,u.value=p,window.removeEventListener("pointermove",d),window.removeEventListener("pointerup",T)},d=v=>{if(p){let y=Math.atan2(v.clientY-w,v.clientX-c)/(2*Math.PI)+1/4-h;b=C+y,M||(M=requestAnimationFrame(B))}};return Q(l,()=>{i.state.value=Math.abs(l.value*96%4)<2?1:0,r.state.value=Math.abs((l.value*96+95)%4)<2?1:0}),(v,_)=>(E(),k("div",null,[g("div",Xs,[g("img",{src:f(qs),alt:"Potentiometer"},null,8,Vs),g("button",{class:"absolute rounded-full top-3 left-[22px] w-14 h-14",onPointerdown:D},[g("img",{class:"top-0 left-0 w-14 h-14",src:f(js),style:V(`transform: rotate(${l.value}turn)`)},null,12,Ns),a.value?(E(),k("div",Ys)):K("",!0)],32),g("div",Hs,[g("div",{class:ee(["w-1 h-1 rounded-full",f(i).state.value?"bg-rose-500":"bg-transparent"])},null,2),_[0]||(_[0]=g("div",{class:"w-1 h-1 bg-transparent"},null,-1)),g("div",{class:ee(["w-1 h-1 rounded-full",f(r).state.value?"bg-rose-500":"bg-transparent"])},null,2)])])]))}}),Gs="/assets/microphone-BjeZeCno.jpg",Ks={class:"led-container"},Js=["src"],Zs=R({__name:"Microphone",setup(n,{expose:e}){const t=U(q("output")),s=U(q("air"));return e({pin2:t,pin3:s}),Q(t,()=>{t.state}),(o,i)=>(E(),k("div",null,[g("div",Ks,[g("img",{src:f(Gs),alt:"LED",class:"led-image"},null,8,Js)])]))}}),Qs=W(Zs,[["__scopeId","data-v-d09e68f8"]]),ei="/assets/joystick-Ok9Z0V--.jpg",ti={class:"led-container"},ni=["src"],si=R({__name:"Joystick",setup(n,{expose:e}){const t=U(q("output")),s=U(q("air"));return e({pin2:t,pin3:s}),Q(t,()=>{t.state}),(o,i)=>(E(),k("div",null,[g("div",ti,[g("img",{src:f(ei),alt:"LED",class:"led-image"},null,8,ni)])]))}}),ii=W(si,[["__scopeId","data-v-ccf2f074"]]),oi="/assets/buzzer-Dl6pLH91.jpg",ri={class:"rounded-lg overflow-hidden relative"},ai=["src"],li=R({__name:"Buzzer",setup(n,{expose:e}){const t=pe({mode2:"output"});e(t);const{pin2:s}=t,o=new AudioContext,i=o.createOscillator();let r=o.createGain();return i.type="triangle",i.frequency.value=0,r.gain.value=0,i.connect(r).connect(o.destination),i.start(),Q([s.freq,s.state],()=>{i.frequency.value=s.freq.value,r.gain.value=s.state.value}),(a,l)=>(E(),k("div",null,[g("div",ri,[g("img",{src:f(oi),alt:"Buzzer"},null,8,ai)])]))}}),he=R({__name:"Module",setup(n,{expose:e}){const t=pe({mode2:"output"});return e(t),(s,o)=>(E(),k("div"))}}),it=we("useLessonStore",()=>{const n=ot(),{slots:e}=le(n),{locale:t}=zt(),s=Pe(),{fileContent:o}=le(s),{setCode:i}=s,r=m(null),a=m(null),l=m(!1),u=m(0);function p(T){T!=null&&(r.value=T,a.value=0)}function c(T){r.value!=null&&(r.value.steps=T)}async function w(T){if(r.value==null)return;if(a.value=T,M(),r.value.steps[a.value].title==""){l.value=!0;const{data:v}=await Tt.getStepByID(r.value.steps[a.value].id),_=await Mt(v,t.value,!1);r.value.steps[T]=_,l.value=!1}const d=r.value.steps[a.value];d.type=="code"&&(d.inner.platformAction=="code2ide"&&i(d.inner.starting??""),d.inner.platformAction=="light-up"&&d.inner.highlights!=null&&b(d.inner.highlights))}function b(T){u.value=0;const d=T[u.value];d.slot==null||d.module==null||h(d.slot)}function h(T){const d=(T??"A").charCodeAt(0)-65;e.value[d].class="bg-yellow-200/[0.5]"}function C(){if(r.value==null||a.value==null)return;const d=r.value.steps[a.value].inner.highlights??null;if(d==null)return;if(u.value=u.value+1,u.value>=d.length){u.value=0;return}const v=d[u.value];v.slot==null||v.module==null||h(v.slot)}function M(){for(let T=0;T<=5;T++)e.value[T].class=""}function D(){console.log(`runCodePressed: ${o.value}`)}function B(T,d){if(console.log(`modulePutted: ${T}`,d),r.value==null||a.value==null)return;const _=r.value.steps[a.value].inner.highlights??null;if(_==null)return;const y=_[u.value];(y.slot??"A").charCodeAt(0)-65==T&&y.module==d&&(M(),C())}return{lesson:r,stepIndex:a,stepLoading:l,setLesson:p,setSteps:c,changeStep:w,runCodePressed:D,modulePutted:B}}),Ye=Ae(),{fileContent:ui}=le(Pe()),ci={LED:Nn,PB:ts,LS:gs,TS:Kn,PTM:Us,NCD:Ws,MT:he,MCP:Qs,CLM:rs,GS:Is,BZ:li,CLR:ks,JS:ii,DS:ps,SW:Es,OLD:he,LDT:he,"":he},pi={A:0,B:1,C:2,D:3,E:4,F:5},di=(n,e)=>{const t=Math.max(0,Math.min(n.x+n.w,e.x+e.w)-Math.max(n.x,e.x)),s=Math.max(0,Math.min(n.y+n.h,e.y+e.h)-Math.max(n.y,e.y));return t*s},ot=we("emulator",()=>{const n=U([]),e=U([D("LED"),D("PB"),D("PTM"),D("NCD"),D("BZ"),D("SW")]),s={x:0,y:0,w:0,h:0,is:he,on:-1,ref:{pin2:{state:{value:0},mode:"none"},pin3:{state:{value:0},mode:"none"}},style:{},class:"",type:"",dragging:!1},o=rt(),i=m(!1),r=m(null),a=m(null),l=m(!1),u=m(!1),p=m(!1),c={x:203,y:48,w:40,h:20},w={x:242,y:40,w:8,h:8},b=U({}),h=U([{id:"A",pin2:0,pin3:1,pin2State:0,pin3State:0,pin2Freq:0,pin3Freq:0,with:s,x:69,y:49,w:80,h:80,style:{},class:""},{id:"B",pin2:2,pin3:3,pin2State:0,pin3State:0,pin2Freq:0,pin3Freq:0,with:s,x:69,y:152,w:80,h:80,style:{},class:""},{id:"C",pin2:28,pin3:22,pin2State:0,pin3State:0,pin2Freq:0,pin3Freq:0,with:s,x:69,y:255,w:80,h:80,style:{},class:""},{id:"D",pin2:4,pin3:5,pin2State:0,pin3State:0,pin2Freq:0,pin3Freq:0,with:s,x:297,y:49,w:80,h:80,style:{},class:""},{id:"E",pin2:6,pin3:7,pin2State:0,pin3State:0,pin2Freq:0,pin3Freq:0,with:s,x:297,y:152,w:80,h:80,style:{},class:""},{id:"F",pin2:26,pin3:27,pin2State:0,pin3State:0,pin2Freq:0,pin3Freq:0,with:s,x:297,y:255,w:80,h:80,style:{},class:""}]),C={0:0,1:0,2:1,3:1,28:2,22:2,4:3,5:3,6:4,7:4,26:5,27:5};function M(S,P){const $=D(S);n.push($);const j=pi[P];v(j),d(j,$)}function D(S){return{x:0,y:0,w:80,h:80,is:ci[S],on:0,ref:{setShared:j=>{}},class:"",style:{},type:S,dragging:!1}}function B(S){const P={x:0,y:0,w:80,h:80,is:S.is,on:0,ref:{setShared:j=>{}},class:"",style:{},type:S.type,dragging:!1},$=S.ref.getShared();return $e(()=>{P.ref.setShared($)}),P}function T(S,P,$){return ne=>{if(!S)return;S.x=ne.clientX-P,S.y=ne.clientY-$;const z=[0,0,0,0,0,0];for(const[L,X]of h.entries())z[L]=di(S,X);let x=0;for(let L=1;L<z.length;L++)z[L]>z[x]&&(x=L);z[x]==0?a.value=null:a.value=x,i.value=S.y>400}}function d(S,P){P.x=h[S].x,P.y=h[S].y,h[S].with=P,P.on=S,$e(()=>{console.log(P.ref),P.ref.pin2.mode==="output"&&(P.ref.pin2.state.value=h[S].pin2State),P.ref.pin3.mode==="output"&&(P.ref.pin3.state.value=h[S].pin3State)});const $=it(),{modulePutted:j}=$;j(S,h[S].with.type)}function v(S){h[S].with=s}let _,y;function A(){l.value=!0,o.clearDisplay(),_=new Worker(new URL("/assets/mpWorker-CQKO_Uys.js",import.meta.url),{type:"module"}),u.value=!0,_.onmessage=S=>{const{command:P,data:$,sharedBuffer:j,sharedArrayInterrupt:ne}=S.data;if(P==="error")Ye.write($),p.value=!1,F.value=!1;else if(P==="finished")console.log("Finished"),p.value=!1;else if(P==="initialized")console.log("Inited"),l.value=!1,y=ne;else if(P==="output")Ye.write($);else if(P==="toggle"){const{pin:z}=$,x=h[C[z]];z===x.pin2&&(x.pin2State=1-x.pin2State,x.with.ref.pin2.state.value=1-x.with.ref.pin2.state.value),z===x.pin3&&(x.pin3State=1-x.pin3State,x.with.ref.pin3.state.value=1-x.with.ref.pin3.state.value)}else if(P==="on"){const{pin:z}=$,x=h[C[z]];z===x.pin2&&(x.pin2State=1,x.with.ref.pin2.state.value=1),z===x.pin3&&(x.pin3State=1,x.with.ref.pin3.state.value=1)}else if(P==="off"){const{pin:z}=$,x=h[C[z]];z===x.pin2&&(x.pin2State=0,x.with.ref.pin2.state.value=0),z===x.pin3&&(x.pin3State=0,x.with.ref.pin3.state.value=0)}else if(P==="value"){const{pin:z}=$,x=h[C[z]];let L;z===x.pin2&&(L=x.with.ref.pin2.state.value),z===x.pin3&&(L=x.with.ref.pin3.state.value);const X=new Int32Array(j);Atomics.store(X,1,L),Atomics.store(X,0,1),Atomics.notify(X,0,1)}else if(P==="pwm freq"){const{pin:z,freq:x}=$,L=h[C[z]];z===L.pin2&&(L.pin2Freq=x,L.with.ref.pin2.freq.value=x),z===L.pin3&&(L.pin3Freq=x,L.with.ref.pin3.freq.value=x)}else if(P==="pwm duty_u16"){const{pin:z,duty_u16:x}=$,L=h[C[z]];z===L.pin2&&(L.pin2State=x/65535,L.with.ref.pin2.state.value=x/65535),z===L.pin3&&(L.pin3State=x/65535,L.with.ref.pin3.state.value=x/65535)}else if(P==="adc read_u16"){const{pin:z}=$,x=h[C[z]];let L;z===x.pin2&&(L=x.with.ref.pin2.state.value),z===x.pin3&&(L=x.with.ref.pin3.state.value);const X=new Int32Array(j);Atomics.store(X,1,L*65535),Atomics.store(X,0,1),Atomics.notify(X,0,1)}else if(P==="display_text"){const{text:z,x,y:L}=$;o.writeText(z,x,L)}else if(P==="clear_display")o.clearDisplay();else if(P==="i2c_read"){const{addr:z,nbytes:x,sharedBuffer:L}=$,X=new Int32Array(L);console.log(`I2C Read from Address: ${z}, Bytes: ${x}`);for(let oe=0;oe<x;oe++)X[oe+1]=Math.floor(Math.random()*256);Atomics.store(X,0,1),Atomics.notify(X,0,1)}}}function H(){p.value=!0,y[0]=0,_.postMessage({command:"runPython",code:ui.value})}const F=m(!1);function G(){F.value=!0,y[0]=2}function J(){_.terminate(),p.value=!1,l.value=!1,u.value=!1,_.onmessage=null}function at(S,P){const $=h[S].with,j=h[P].with;d(P,$),d(S,j)}function lt(S,P,$,j){S.dragging=!0,S.style.zIndex="2";const ne=h[$];r.value=$;const z=j.clientX-S.x,x=j.clientY-S.y,L=T(S,z,x),X=S.x,oe=S.y,xe=()=>{a.value===null?(i.value&&(ne.with=s,n.splice(P,1)),S.x=X,S.y=oe):at($,a.value),document.removeEventListener("pointermove",L),document.removeEventListener("pointerup",xe),i.value=!1,r.value=null,a.value=null,S.style.zIndex="1",S.dragging=!1};document.addEventListener("pointermove",L),document.addEventListener("pointerup",xe)}function ut(S,P){const $=U(B(S));if($.dragging=!0,$.style.zIndex="2",P.currentTarget instanceof HTMLElement){const L=P.currentTarget,X=L.parentElement.parentElement,{top:oe,left:xe,width:ct,height:pt}=L.getBoundingClientRect(),{top:dt,left:ft}=X.getBoundingClientRect();$.x=xe-ft,$.y=oe-dt,$.w=ct,$.h=pt}$.is=S.is,$.type=S.type,n.push($),$e(()=>{$.ref.setShared(S.ref.getShared())});const j=P.clientX-$.x,ne=P.clientY-$.y,z=T($,j,ne),x=()=>{if($){if(a.value===null){if(i.value){const L=n.indexOf($);L>-1&&n.splice(L,1)}}else{const L=n.indexOf(h[a.value].with);L>-1&&n.splice(L,1),v(a.value),d(a.value,$)}a.value=null,i.value=!1,$.dragging=!1,$.style.zIndex="1",document.removeEventListener("pointermove",z),document.removeEventListener("pointerup",x)}};document.addEventListener("pointermove",z),document.addEventListener("pointerup",x)}return{usb:c,onLED:w,NoneModule:s,maxAreaIndex:a,fromSlotIndex:r,toDelete:i,slots:h,moduleComponents:e,modules:n,addModuleToSlot:d,newModuleToSlot:M,removeModuleFromSlot:v,dragged:b,startDragFromSlot:lt,startDragFromModuleList:ut,connect:A,run:H,stop:G,disconnect:J,isRunning:p,isStopping:F,isLoading:l,isConnected:u}}),rt=we("useST7789",()=>{const n=m(""),e=m(0),t=m(0),s=m("#000000");function o(r,a,l,u){n.value+=r+`\r
`,e.value=a,t.value=l,u&&(s.value=u)}function i(){n.value="",e.value=0,t.value=0,s.value="#000000"}return{text:n,x:e,y:t,textColor:s,writeText:o,clearDisplay:i}}),fi=["width","height"],re=12,hi=R({__name:"Display",setup(n){const e=m(112),t=m(160),s=m(null),o=m(null),i=m(0),r=rt();r.text||(r.text="");function a(p){const c=p.deltaY>0?1:-1;i.value+=c*re,i.value=Math.max(0,i.value);const{lines:w,visibleLines:b}=l();i.value=Math.min(w.length*re,i.value),u(w,b)}function l(){const p=[];let c=0;return o.value&&r.text&&(String(r.text).split(`
`).forEach(b=>{let h="";b.split(" ").forEach(M=>{const D=h+M+" ";o.value.measureText(D).width>e.value?(p.push(h),h=M+" "):h=D}),p.push(h)}),c=Math.ceil(t.value/re)),{lines:p,visibleLines:c}}function u(p,c){if(o.value){o.value.fillStyle="#FFFFFF",o.value.fillRect(0,0,e.value,t.value),o.value.fillStyle=String(r.textColor)||"#000000",o.value.font="12px Monaco";const w=Math.floor(i.value/re);for(let b=0;b<c;b++){const h=w+b;if(h<p.length){const C=(b+1)*re-i.value%re;o.value.fillText(p[h],0,C)}}}else console.warn("Canvas context is not initialized.")}return Q(()=>[r.text,r.textColor],()=>{const{lines:p,visibleLines:c}=l();i.value=Math.max(0,(p.length-c)*re),u(p,c)}),ye(async()=>{if(await $e(),console.log("onMounted called"),!s.value){console.error("Canvas element not found!");return}if(o.value=s.value.getContext("2d"),o.value){console.log("Canvas context successfully initialized."),o.value.fillStyle="#FFFFFF",o.value.fillRect(0,0,e.value,t.value),console.log("Initial text:",r.text);const{lines:p,visibleLines:c}=l();console.log("Lines:",p,"Visible Lines:",c),i.value=0,u(p,c)}else console.error("Failed to initialize canvas context.")}),(p,c)=>(E(),k("div",{class:"display-container",onWheel:a},[g("canvas",{ref_key:"canvas",ref:s,width:e.value,height:t.value,style:{border:"1px solid black",width:"112px",height:"160px"}},null,8,fi)],32))}}),vi=W(hi,[["__scopeId","data-v-6d3c5eb8"]]),mi={id:"pibody",class:"relative h-[450px] flex-shrink-0 max-h-[calc(100%-100px)] overflow-auto"},gi={class:"absolute top-4 right-1 flex flex-col gap-1"},wi={class:"material-icons"},yi={class:"material-icons"},xi=R({__name:"SimulationView",setup(n){const e=it(),{runCodePressed:t}=e,s=ot(),{maxAreaIndex:o,isLoading:i,isStopping:r,isRunning:a,isConnected:l,fromSlotIndex:u,toDelete:p,slots:c,dragged:w,moduleComponents:b,modules:h}=le(s);U([]),s.connect();function C(){l.value?(s.run(),t()):s.connect()}return(M,D)=>{const B=Dt,T=Le;return E(),k("div",{id:"emulator",class:ee(["h-full parent relative flex flex-col border-t border-surface overflow-auto select-none",{"bg-rose-500":f(p)}])},[g("div",mi,[Z(B,{src:f(It),width:"384px",draggable:"false",class:"absolute pt-4 min-w-[384px]",style:{left:"32px",top:"0px"}},null,8,["src"]),Z(vi,{class:"absolute top-[213px] left-[167px] w-[112px] h-[160px]"}),g("div",gi,[Z(T,{id:"#run",type:"button",class:"w-9 h-9 mr-1",severity:"info",rounded:"",onClick:C,disabled:f(i)||f(a)},{default:te(()=>[g("span",wi,ie(f(i)?"hourglass_top":"play_arrow"),1)]),_:1},8,["disabled"]),Z(T,{type:"button",class:"w-9 h-9 mr-1",variant:f(a)?void 0:"outlined",severity:"danger",rounded:"",onClick:D[0]||(D[0]=d=>f(s).stop()),disabled:!f(a)||!f(l)},{default:te(()=>[g("span",yi,ie(f(r)?"hourglass_top":"stop"),1)]),_:1},8,["variant","disabled"])]),(E(!0),k(ve,null,Se(f(c),(d,v)=>(E(),k("div",{key:v,class:ee(["absolute w-20 h-20 border rounded-lg text-center",[{"bg-green-200/[0.5]":f(o)==v,"bg-blue-200/[0.5]":f(u)==v},d.class]]),style:V([d.style,{left:d.x+"px",top:d.y+"px"}])},null,6))),128)),f(l)?(E(),k("div",{key:0,class:"absolute bg-black",style:V({left:f(s).usb.x+"px",top:f(s).usb.y-70+"px",width:f(s).usb.w+"px",height:f(s).usb.h+50+"px"})},null,4)):K("",!0),g("div",{class:"absolute",style:V({left:f(s).onLED.x+"px",top:f(s).onLED.y+"px",width:f(s).onLED.w+"px",height:f(s).onLED.h+"px"})},null,4)]),g("div",{class:ee(["max-h-fit w-full overflow-auto flex flex-wrap gap-2 justify-center items-start",{"bg-rose-500":f(p)}])},[(E(!0),k(ve,null,Se(f(b),d=>(E(),ae(ke(d.is),{ref_for:!0,ref:v=>d.ref=v,onPointerdown:[v=>f(s).startDragFromModuleList(d,v),D[1]||(D[1]=me(v=>v.preventDefault(),["prevent"]))],class:"flex-none w-20 h-20 border-sm cursor-move"},null,40,["onPointerdown"]))),256))],2),(E(!0),k(ve,null,Se(f(h),(d,v)=>(E(),ae(kt,{to:d.dragging?"#emulator":"#pibody",key:v},[(E(),ae(ke(d.is),{style:V([d.style,{left:d.x+"px",top:d.y+"px"}]),class:ee([d.class,"absolute w-20 h-20 border-sm rounded-xl overflow-hidden"]),onPointerdown:[_=>f(s).startDragFromSlot(d,v,d.on,_),D[2]||(D[2]=me(_=>_.preventDefault(),["prevent"]))],ref_for:!0,ref:_=>d.ref=_},null,40,["style","class","onPointerdown"]))],8,["to"]))),128))],2)}}}),zi=W(xi,[["__scopeId","data-v-f5feb196"]]);export{zi as S,Pi as T,Li as _,Jt as a,Vt as s,it as u};
