import{z as N,a as c,s as P,_ as T,b as E}from"./AuthHeader.vue_vue_type_script_setup_true_lang-BTKLh7ea.js";import{d as I,u as q,a as D,r as w,c as u,b as e,e as a,w as i,f as d,F as b,g as R,s as A,o as l,h as k,i as U,t as h,j as S,k as G}from"./index-CXOwPGdy.js";import{s as H}from"./index-CBT3LGg4.js";import{s as J}from"./index-rZYChDSN.js";import{s as K}from"./LocaleSwitcher.vue_vue_type_script_setup_true_lang-n4cL8gx1.js";import{L as O,s as Q}from"./logo-2b8tI7rb.js";import{h as W}from"./http-OZ8xEx_I.js";const X={login:Y};async function Y(p,n){try{return await W.post("/login",{email:p,password_hash:n})}catch(t){throw console.log(t),t}}const Z={class:"card flex flex-col items-center pt-4"},ss={class:"flex flex-1 items-center justify-center my-4"},es={class:"flex flex-col gap-1"},as={class:"flex flex-col gap-1"},ts={class:"my-0 px-4 flex flex-col gap-1"},us=I({__name:"LoginPage",setup(p){const n=q(),t=R(),f=D(),o=w(!1),V=w({email:"",password:""}),L=N(c.object({email:c.string().min(1,{message:"Email is required."}).max(30,{message:"Maximum 30 characters."}),password:c.string().min(1,{message:"Password is required."}).max(30,{message:"Maximum 30 characters."})})),z=async m=>{if(!o.value&&m.valid){o.value=!0;try{const{data:s}=await X.login(m.states.email.value,m.states.password.value);f.setToken(s),f.setUser(s),t.push({name:"projects"}),n.add({severity:"success",summary:"Success",life:3e3})}catch(s){n.add({severity:"error",summary:s.toString(),life:3e3})}finally{o.value=!1}}};return(m,s)=>{const B=Q,F=K,g=J,_=H,$=E,v=A,j=P;return l(),u(b,null,[e(T),a("div",Z,[e(j,{initialValues:V.value,resolver:d(L),onSubmit:z,class:"flex flex-col gap-4 w-full sm:w-60 mx-6"},{default:i(r=>{var x,y;return[a("div",ss,[e(B,{src:d(O),width:"32"},null,8,["src"]),s[1]||(s[1]=a("p",{class:"text-xl font-semibold px-2 mr-4"},"Artisan",-1))]),a("div",es,[e(g,{variant:"on"},{default:i(()=>[e(F,{id:"email",name:"email",type:"text",fluid:""}),s[2]||(s[2]=a("label",{for:"email"},"Email",-1))]),_:1}),(x=r.username)!=null&&x.invalid?(l(),k(_,{key:0,severity:"error",size:"small",variant:"simple"},{default:i(()=>[U(h(r.username.error.message),1)]),_:2},1024)):S("",!0)]),a("div",as,[e(g,{variant:"on"},{default:i(()=>[e($,{id:"password",name:"password",feedback:!1,toggleMask:"",fluid:""}),s[3]||(s[3]=a("label",{for:"password"},"Password",-1))]),_:1}),(y=r.password)!=null&&y.invalid?(l(),k(_,{key:0,severity:"error",size:"small",variant:"simple"},{default:i(()=>[a("ul",ts,[(l(!0),u(b,null,G(r.password.errors,(C,M)=>(l(),u("li",{key:M},h(C.message),1))),128))])]),_:2},1024)):S("",!0)]),e(v,{type:"submit",label:"Login",loading:o.value,disabled:o.value},null,8,["loading","disabled"])]}),_:1},8,["initialValues","resolver"]),e(v,{severity:"secondary",variant:"link",label:"Don't have an account?",onClick:s[0]||(s[0]=r=>d(t).push({name:"signup"}))})])],64)}}});export{us as default};
