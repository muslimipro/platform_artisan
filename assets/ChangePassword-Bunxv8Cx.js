import{s as C}from"./index-BbIkPId2.js";import{h as N,z as m,s as j}from"./index-BnplMAOR.js";import{d as A,u as L,r as P,p as q,o as e,f as p,w as r,b as t,e as a,t as l,c as i,i as w,F as g,h as v,j as D,s as E}from"./index-CFTsbYyj.js";import{s as I}from"./index-ShhDbwX4.js";import{s as O}from"./index-CGu4SBjN.js";import{s as T}from"./index-DmWez8LS.js";import{S as Z}from"./index-ClYofCuR.js";import"./index-B3U6P8R9.js";import"./index-DM2DgLdl.js";import"./index-hiW_kLsS.js";import"./index-jL52Hg50.js";import"./index-BBwnMfvS.js";const G={class:"flex flex-col gap-1"},H={for:"old_password"},J={class:"my-0 flex flex-col gap-1"},K={class:"flex flex-col gap-1"},Q={for:"new_password"},R={class:"my-0 flex flex-col gap-1"},U={class:"flex flex-col gap-1"},W={for:"confirm_password"},X={class:"my-0 flex flex-col gap-1"},ps=A({__name:"ChangePassword",setup(Y){const h=L(),n=P(!1),{t:y}=q(),S=P({old_password:"",new_password:""}),F=N(m.object({old_password:m.string().min(1,{message:"Old password is required."}).max(100,{message:"Maximum 100 characters."}),new_password:m.string().min(8,{message:"Minimum 8 characters."}).max(100,{message:"Maximum 100 characters."}).refine(s=>/[a-z]/.test(s),{message:"Must have a lowercase letter."}).refine(s=>/[A-Z]/.test(s),{message:"Must have an uppercase letter."}).refine(s=>/[0-9]/.test(s),{message:"Must have a number."}),confirm_password:m.string()}).refine(s=>s.new_password===s.confirm_password,{message:"Passwords must match",path:["confirm_password"]})),V=async s=>{if(!n.value&&s.valid){n.value=!0;try{await Z.changePassword(s.states.old_password.value,s.states.new_password.value),h.add({severity:"success",summary:y("pages.settings.passwordSaved"),life:2e3})}catch(b){h.add({severity:"error",summary:y("pages.settings.passwordSaveFailed"),detail:b,life:2e3})}finally{n.value=!1}}};return(s,b)=>{const u=T,f=O,_=I,z=E,B=j,$=C;return e(),p($,{class:"flex-grow",header:s.$t("pages.settings.changePassword")},{default:r(()=>[t(B,{initialValues:S.value,resolver:D(F),onSubmit:V,class:"flex flex-col gap-2"},{default:r(o=>{var x,k,M;return[a("div",G,[t(f,{variant:"on"},{default:r(()=>[t(u,{id:"old_password",name:"old_password",feedback:!1,toggleMask:"",fluid:"",class:"w-full sm:w-96"}),a("label",H,l(s.$t("pages.settings.oldPassword")),1)]),_:1}),(x=o.old_password)!=null&&x.invalid?(e(),p(_,{key:0,severity:"error",size:"small",variant:"simple"},{default:r(()=>[a("ul",J,[(e(!0),i(g,null,w(o.old_password.errors,(d,c)=>(e(),i("li",{key:c},l(d.message),1))),128))])]),_:2},1024)):v("",!0)]),a("div",K,[t(f,{variant:"on"},{default:r(()=>[t(u,{id:"new_password",name:"new_password",feedback:!1,toggleMask:"",fluid:"",class:"w-full sm:w-96"}),a("label",Q,l(s.$t("pages.settings.newPassword")),1)]),_:1}),(k=o.new_password)!=null&&k.invalid?(e(),p(_,{key:0,severity:"error",size:"small",variant:"simple"},{default:r(()=>[a("ul",R,[(e(!0),i(g,null,w(o.new_password.errors,(d,c)=>(e(),i("li",{key:c},l(d.message),1))),128))])]),_:2},1024)):v("",!0)]),a("div",U,[t(f,{variant:"on"},{default:r(()=>[t(u,{id:"confirm_password",name:"confirm_password",feedback:!1,toggleMask:"",fluid:"",class:"w-full sm:w-96"}),a("label",W,l(s.$t("pages.settings.confirmPassword")),1)]),_:1}),(M=o.confirm_password)!=null&&M.invalid?(e(),p(_,{key:0,severity:"error",size:"small",variant:"simple"},{default:r(()=>[a("ul",X,[(e(!0),i(g,null,w(o.confirm_password.errors,(d,c)=>(e(),i("li",{key:c},l(d.message),1))),128))])]),_:2},1024)):v("",!0)]),t(z,{type:"submit",label:s.$t("pages.settings.savePassword"),class:"w-fit",loading:n.value,disabled:n.value},null,8,["label","loading","disabled"])]}),_:1},8,["initialValues","resolver"])]),_:1},8,["header"])}}});export{ps as default};
