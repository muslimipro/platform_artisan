import{I as _e,Z as re,J as Ce,K as Le,L as Se,M as $e,N as Be,q as fe,O as Ie,P as De,Q as de,R as Ee,b as o,k as S,w as V,e as l,S as P,f as x,T as te,U as Ae,V as Y,F as O,h as g,n as we,t as Re,l as B,W as Ve,X as Te,d as Pe,u as ze,r as d,c as ce,a as T,o as ne,G as M,j as oe,x as ge,s as ve,Y as Ne,g as s,_ as pe,E as Ue,i as le,D as Oe,$ as Ke,H as ue,a0 as je,p as Ge}from"./index-BEuVwAr8.js";import{s as me}from"./index-iN1AuD1Q.js";import{s as Me}from"./index-MRr3JDAz.js";import{L as Fe,d as We}from"./defaultConfirmDeleteOptions-Dzr4BSHL.js";import{u as he,c as He,a as qe}from"./vue-codemirror.esm-CdIqRNbs.js";import{S as Ze}from"./SimulationView-ZxvJJcwn.js";import{_ as Ye}from"./CodeViewer.vue_vue_type_script_setup_true_lang-B7SbfekE.js";import"./http-PePEMJWw.js";import{m as Xe}from"./mapLessonFromDto-Dmd7ExqT.js";import{U as G}from"./unitApi-DSbyspay.js";import{m as Je}from"./mapUnitFromDto-CYGc5n9V.js";import{s as Qe}from"./index-D6y-9tOf.js";import{s as et}from"./index-B68ca62K.js";import{s as tt}from"./index-BYv6yn4V.js";import{u as ye}from"./index-DF1O2LY1.js";import{_ as nt}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-BOe8HTYE.js";import"./index-BRCmLd1m.js";import"./index-BFWEgjsR.js";import"./CodeEditorView.vue_vue_type_script_setup_true_lang-B7Hu46u9.js";import"./runner-gHCm9fYt.js";import"./index-BcdmDF4L.js";var ot=function(e){var n=e.dt;return`
.p-drawer {
    display: flex;
    flex-direction: column;
    transform: translate3d(0px, 0px, 0px);
    position: relative;
    transition: transform 0.3s;
    background: `.concat(n("drawer.background"),`;
    color: `).concat(n("drawer.color"),`;
    border: 1px solid `).concat(n("drawer.border.color"),`;
    box-shadow: `).concat(n("drawer.shadow"),`;
}

.p-drawer-content {
    overflow-y: auto;
    flex-grow: 1;
    padding: `).concat(n("drawer.content.padding"),`;
}

.p-drawer-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    flex-shrink: 0;
    padding: `).concat(n("drawer.header.padding"),`;
}

.p-drawer-footer {
    padding: `).concat(n("drawer.footer.padding"),`;
}

.p-drawer-title {
    font-weight: `).concat(n("drawer.title.font.weight"),`;
    font-size: `).concat(n("drawer.title.font.size"),`;
}

.p-drawer-full .p-drawer {
    transition: none;
    transform: none;
    width: 100vw !important;
    height: 100vh !important;
    max-height: 100%;
    top: 0px !important;
    left: 0px !important;
    border-width: 1px;
}

.p-drawer-left .p-drawer-enter-from,
.p-drawer-left .p-drawer-leave-to {
    transform: translateX(-100%);
}

.p-drawer-right .p-drawer-enter-from,
.p-drawer-right .p-drawer-leave-to {
    transform: translateX(100%);
}

.p-drawer-top .p-drawer-enter-from,
.p-drawer-top .p-drawer-leave-to {
    transform: translateY(-100%);
}

.p-drawer-bottom .p-drawer-enter-from,
.p-drawer-bottom .p-drawer-leave-to {
    transform: translateY(100%);
}

.p-drawer-full .p-drawer-enter-from,
.p-drawer-full .p-drawer-leave-to {
    opacity: 0;
}

.p-drawer-full .p-drawer-enter-active,
.p-drawer-full .p-drawer-leave-active {
    transition: opacity 400ms cubic-bezier(0.25, 0.8, 0.25, 1);
}

.p-drawer-left .p-drawer {
    width: 20rem;
    height: 100%;
    border-inline-end-width: 1px;
}

.p-drawer-right .p-drawer {
    width: 20rem;
    height: 100%;
    border-inline-start-width: 1px;
}

.p-drawer-top .p-drawer {
    height: 10rem;
    width: 100%;
    border-block-end-width: 1px;
}

.p-drawer-bottom .p-drawer {
    height: 10rem;
    width: 100%;
    border-block-start-width: 1px;
}

.p-drawer-left .p-drawer-content,
.p-drawer-right .p-drawer-content,
.p-drawer-top .p-drawer-content,
.p-drawer-bottom .p-drawer-content {
    width: 100%;
    height: 100%;
}

.p-drawer-open {
    display: flex;
}

.p-overlay-mask:dir(rtl) {
    flex-direction: row-reverse;
}
`)},st={mask:function(e){var n=e.position,u=e.modal;return{position:"fixed",height:"100%",width:"100%",left:0,top:0,display:"flex",justifyContent:n==="left"?"flex-start":n==="right"?"flex-end":"center",alignItems:n==="top"?"flex-start":n==="bottom"?"flex-end":"center",pointerEvents:u?"auto":"none"}},root:{pointerEvents:"auto"}},at={mask:function(e){var n=e.instance,u=e.props,a=["left","right","top","bottom"],i=a.find(function(r){return r===u.position});return["p-drawer-mask",{"p-overlay-mask p-overlay-mask-enter":u.modal,"p-drawer-open":n.containerVisible,"p-drawer-full":n.fullScreen},i?"p-drawer-".concat(i):""]},root:function(e){var n=e.instance;return["p-drawer p-component",{"p-drawer-full":n.fullScreen}]},header:"p-drawer-header",title:"p-drawer-title",pcCloseButton:"p-drawer-close-button",content:"p-drawer-content",footer:"p-drawer-footer"},it=_e.extend({name:"drawer",theme:ot,classes:at,inlineStyles:st}),rt={name:"BaseDrawer",extends:Te,props:{visible:{type:Boolean,default:!1},position:{type:String,default:"left"},header:{type:null,default:null},baseZIndex:{type:Number,default:0},autoZIndex:{type:Boolean,default:!0},dismissable:{type:Boolean,default:!0},showCloseIcon:{type:Boolean,default:!0},closeButtonProps:{type:Object,default:function(){return{severity:"secondary",text:!0,rounded:!0}}},closeIcon:{type:String,default:void 0},modal:{type:Boolean,default:!0},blockScroll:{type:Boolean,default:!1}},style:it,provide:function(){return{$pcDrawer:this,$parentInstance:this}}},be={name:"Drawer",extends:rt,inheritAttrs:!1,emits:["update:visible","show","after-show","hide","after-hide"],data:function(){return{containerVisible:this.visible}},container:null,mask:null,content:null,headerContainer:null,footerContainer:null,closeButton:null,outsideClickListener:null,documentKeydownListener:null,watch:{dismissable:function(e){e?this.enableDocumentSettings():this.disableDocumentSettings()}},updated:function(){this.visible&&(this.containerVisible=this.visible)},beforeUnmount:function(){this.disableDocumentSettings(),this.mask&&this.autoZIndex&&re.clear(this.mask),this.container=null,this.mask=null},methods:{hide:function(){this.$emit("update:visible",!1)},onEnter:function(){this.$emit("show"),this.focus(),this.bindDocumentKeyDownListener(),this.autoZIndex&&re.set("modal",this.mask,this.baseZIndex||this.$primevue.config.zIndex.modal)},onAfterEnter:function(){this.enableDocumentSettings(),this.$emit("after-show")},onBeforeLeave:function(){this.modal&&!this.isUnstyled&&Ce(this.mask,"p-overlay-mask-leave")},onLeave:function(){this.$emit("hide")},onAfterLeave:function(){this.autoZIndex&&re.clear(this.mask),this.unbindDocumentKeyDownListener(),this.containerVisible=!1,this.disableDocumentSettings(),this.$emit("after-hide")},onMaskClick:function(e){this.dismissable&&this.modal&&this.mask===e.target&&this.hide()},focus:function(){var e=function(a){return a&&a.querySelector("[autofocus]")},n=this.$slots.header&&e(this.headerContainer);n||(n=this.$slots.default&&e(this.container),n||(n=this.$slots.footer&&e(this.footerContainer),n||(n=this.closeButton))),n&&Le(n)},enableDocumentSettings:function(){this.dismissable&&!this.modal&&this.bindOutsideClickListener(),this.blockScroll&&Se()},disableDocumentSettings:function(){this.unbindOutsideClickListener(),this.blockScroll&&$e()},onKeydown:function(e){e.code==="Escape"&&this.hide()},containerRef:function(e){this.container=e},maskRef:function(e){this.mask=e},contentRef:function(e){this.content=e},headerContainerRef:function(e){this.headerContainer=e},footerContainerRef:function(e){this.footerContainer=e},closeButtonRef:function(e){this.closeButton=e?e.$el:void 0},bindDocumentKeyDownListener:function(){this.documentKeydownListener||(this.documentKeydownListener=this.onKeydown,document.addEventListener("keydown",this.documentKeydownListener))},unbindDocumentKeyDownListener:function(){this.documentKeydownListener&&(document.removeEventListener("keydown",this.documentKeydownListener),this.documentKeydownListener=null)},bindOutsideClickListener:function(){var e=this;this.outsideClickListener||(this.outsideClickListener=function(n){e.isOutsideClicked(n)&&e.hide()},document.addEventListener("click",this.outsideClickListener))},unbindOutsideClickListener:function(){this.outsideClickListener&&(document.removeEventListener("click",this.outsideClickListener),this.outsideClickListener=null)},isOutsideClicked:function(e){return this.container&&!this.container.contains(e.target)}},computed:{fullScreen:function(){return this.position==="full"},closeAriaLabel:function(){return this.$primevue.config.locale.aria?this.$primevue.config.locale.aria.close:void 0}},directives:{focustrap:Be},components:{Button:fe,Portal:Ie,TimesIcon:De}},lt=["aria-modal"];function ut(t,e,n,u,a,i){var r=de("Button"),w=de("Portal"),c=Ee("focustrap");return o(),S(w,null,{default:V(function(){return[a.containerVisible?(o(),l("div",P({key:0,ref:i.maskRef,onMousedown:e[0]||(e[0]=function(){return i.onMaskClick&&i.onMaskClick.apply(i,arguments)}),class:t.cx("mask"),style:t.sx("mask",!0,{position:t.position,modal:t.modal})},t.ptm("mask")),[x(te,P({name:"p-drawer",onEnter:i.onEnter,onAfterEnter:i.onAfterEnter,onBeforeLeave:i.onBeforeLeave,onLeave:i.onLeave,onAfterLeave:i.onAfterLeave,appear:""},t.ptm("transition")),{default:V(function(){return[t.visible?Ae((o(),l("div",P({key:0,ref:i.containerRef,class:t.cx("root"),style:t.sx("root"),role:"complementary","aria-modal":t.modal},t.ptmi("root")),[t.$slots.container?Y(t.$slots,"container",{key:0,closeCallback:i.hide}):(o(),l(O,{key:1},[g("div",P({ref:i.headerContainerRef,class:t.cx("header")},t.ptm("header")),[Y(t.$slots,"header",{class:we(t.cx("title"))},function(){return[t.header?(o(),l("div",P({key:0,class:t.cx("title")},t.ptm("title")),Re(t.header),17)):B("",!0)]}),t.showCloseIcon?(o(),S(r,P({key:0,ref:i.closeButtonRef,type:"button",class:t.cx("pcCloseButton"),"aria-label":i.closeAriaLabel,unstyled:t.unstyled,onClick:i.hide},t.closeButtonProps,{pt:t.ptm("pcCloseButton"),"data-pc-group-section":"iconcontainer"}),{icon:V(function(p){return[Y(t.$slots,"closeicon",{},function(){return[(o(),S(Ve(t.closeIcon?"span":"TimesIcon"),P({class:[t.closeIcon,p.class]},t.ptm("pcCloseButton").icon),null,16,["class"]))]})]}),_:3},16,["class","aria-label","unstyled","onClick","pt"])):B("",!0)],16),g("div",P({ref:i.contentRef,class:t.cx("content")},t.ptm("content")),[Y(t.$slots,"default")],16),t.$slots.footer?(o(),l("div",P({key:0,ref:i.footerContainerRef,class:t.cx("footer")},t.ptm("footer")),[Y(t.$slots,"footer")],16)):B("",!0)],64))],16,lt)),[[c]]):B("",!0)]}),_:3},16,["onEnter","onAfterEnter","onBeforeLeave","onLeave","onAfterLeave"])],16)):B("",!0)]}),_:3})}be.render=ut;const se=Pe("lesson-store",()=>{const t=ze(),e=d(null),n=d(!1),u=d(!1),a=d(!1),i=d(!1),r=d(0),w=d([]),c=d(0),p=d([]),b=d("continue"),_=d(!1),y=d(!1),f=d(!1),v=d(!0),L=d(!1),D=d(!1),R=d(""),F=d(null),X=d(null),K=d([]),N=d([]),j=ce(()=>{var m;return f.value&&(((m=F.value)==null?void 0:m.modulesWerePut)??!0)&&v.value});async function W(m,k){try{n.value=!0;const{data:C}=await Fe.getLessonById(m,k);e.value=Xe(C)}catch(C){t.add({severity:"error",summary:C.response.data.error,life:2e3})}finally{n.value=!1}}async function J(m,k){try{u.value=!0;const{data:C}=await G.getUnitByIdandLessonId(m,k);return C}catch(C){t.add({severity:"error",summary:C.response.data.error,life:2e3})}finally{u.value=!1}}async function ae(){if(e.value!=null){a.value=!0,w.value=[],L.value=!1,D.value=!1,r.value=0,c.value=0;for(let m=0;m<e.value.pages.length;m++)p.value.push(0);b.value="continue",w.value.push(e.value.pages[r.value].groups[c.value]),await U(e.value.id),a.value=!1}}function H(m,k){let C="";if(R.value==""||k.content.starting!=""){C=`emulator-${k.id}`;const z=k.content.starting;X.value=he(C),X.value.setCode(z)}L.value=!0,R.value=C??R.value,m=="pibody"&&(D.value=!0,F.value=qe(R.value),K.value=k.data.neededModules,F.value.addNeededModules(K.value),C!=""&&(N.value=[]))}async function U(m){f.value=!1,_.value=!1;for(let k=0;k<w.value[c.value].units.length;k++){const C=w.value[c.value].units[k];["options","open","code","pibody"].includes(C.unitType)&&(b.value="check",_.value=!0);const z=await J(C.id,m);if(z){const I=Je(z);w.value[c.value].units[k].content=I==null?void 0:I.content,w.value[c.value].units[k].data=I==null?void 0:I.data,w.value[c.value].units[k].studentState=I==null?void 0:I.studentState,["code","pibody"].includes(C.unitType)&&(I.content.answer==""&&I.data.tests.lenght==0||(v.value=!1),H(C.unitType,I))}}b.value=="continue"&&await Q()}async function Q(){if(e.value!=null)try{i.value=!0,y.value=!1;for(const m of w.value[w.value.length-1].units){if(["code","pibody"].includes(m.unitType)&&m.data.tests.lenght>0){const k=he(R.value).code.value,C=await He(`${m.unitType}-${m.id}`,k,m.data.tests,m.data.includedCommands);if(y.value=C.correct,C.correct)await G.skipSubmitUnitByIdandLessonId(m.id,e.value.id);else{const{data:z}=await G.getUnitCodeHint(m.id,k);t.add({severity:"error",summary:z.hint})}}else{const{data:k}=await G.submitUnitByIdandLessonId(m.id,e.value.id,m.studentState.answer);y.value=k.correct}if(y.value==!1)break}y.value?(p.value[r.value]++,c.value>=e.value.pages[r.value].groups.length-1?r.value<e.value.pages.length-1?b.value="continue":b.value="finish":b.value="continue"):b.value="try-again"}finally{i.value=!1}}async function ie(){if(e.value!=null){if(c.value>=e.value.pages[r.value].groups.length-1){q();return}a.value=!0,c.value++,w.value.push(e.value.pages[r.value].groups[c.value]),await U(e.value.id),a.value=!1}}function A(m,k){if(e.value!=null){for(const[C,z]of w.value.entries())for(const[I,xe]of z.units.entries())if(xe.id==m){w.value[C].units[I].studentState.answer=k;break}}}async function h(){e.value!=null&&(b.value="check")}async function E(){e.value!=null&&(b.value="completed")}async function q(){e.value!=null&&(a.value=!0,r.value++,w.value=[],c.value=0,b.value="continue",w.value.push(e.value.pages[r.value].groups[c.value]),await U(e.value.id),a.value=!1)}function Z(m){f.value=m}function ee(){v.value=!0}async function $(m){if(R.value=="")return;const k=Number(R.value.split("-")[1]);A(k,m),await G.saveUnitByIdandLessonId(k,e.value.id,{answer:m})}return{selectedLesson:e,isLessonLoading:n,isUnitLoading:u,groups:w,groupIndex:c,isGroupLoading:a,isSubmitLoading:i,groupStatus:b,submitExist:_,correct:y,submitEnabled:j,pageProgress:p,showPibody:D,showCode:L,emulatorID:R,neededModules:K,slots:N,setSubmitable:Z,loadLessonById:W,loadUnitByIdandLessonId:J,loadInitialGroup:ae,submitGroup:Q,nextGroup:ie,saveAnswer:A,tryAgain:h,finishLesson:E,runCodePressed:ee,saveStudentIdeState:$}}),ke=T({__name:"MdViewer",props:{text:{}},setup(t){const e=t;return(n,u)=>{const a=de("v-md-preview");return o(),S(a,{text:e.text},null,8,["text"])}}}),dt=T({__name:"ArticleViewer",props:{article:{}},setup(t){const e=t;return(n,u)=>(o(),S(ke,{text:e.article.text},null,8,["text"]))}}),ct={class:"flex flex-col gap-4 pl-4"},pt=T({__name:"OptionsViewer",props:{optionsData:{},state:{}},emits:["save-answer"],setup(t,{emit:e}){const n=t,u=e,a=d(!1),i=d(!1),r=d(!1),w=d([]),c=d([]),p=d();return ne(()=>{var b,_,y,f,v,L;a.value=((b=n.optionsData)==null?void 0:b.shuffle)??!1,i.value=((_=n.optionsData)==null?void 0:_.feedback)??!1,r.value=((y=n.optionsData)==null?void 0:y.single)??!1,w.value=((f=n.optionsData)==null?void 0:f.options)??[],c.value=((v=n.state.answer)==null?void 0:v.options)??[],p.value=n.state.answer&&n.state.answer.options&&n.state.answer.options.length>0?(L=n.state)==null?void 0:L.answer.options[0]:void 0}),M([p,c,i],()=>{r.value&&p.value?u("save-answer",{options:[p.value],feedback:i.value}):u("save-answer",{options:c.value,feedback:i.value})},{deep:!0}),(b,_)=>{const y=et,f=Qe;return o(),l("div",ct,[(o(!0),l(O,null,oe(w.value,v=>(o(),l("div",{key:v.id,class:"flex gap-2 items-center"},[r.value?(o(),S(y,{key:0,modelValue:p.value,"onUpdate:modelValue":_[0]||(_[0]=L=>p.value=L),value:v.id},null,8,["modelValue","value"])):(o(),S(f,{key:1,modelValue:c.value,"onUpdate:modelValue":_[1]||(_[1]=L=>c.value=L),value:v.id},null,8,["modelValue","value"])),x(ke,{text:v.text},null,8,["text"])]))),128))])}}}),ft=T({__name:"OpenViewer",props:{state:{}},emits:["save-answer"],setup(t,{emit:e}){const n=t,u=e,a=d("");return ne(()=>{a.value=n.state.answer.open}),M(a,()=>{u("save-answer",{open:a.value})}),(i,r)=>{const w=tt;return o(),S(w,{type:"text",modelValue:a.value,"onUpdate:modelValue":r[0]||(r[0]=c=>a.value=c),class:"w-full",size:"small"},null,8,["modelValue"])}}}),vt={key:0,style:{position:"relative",width:"100%",height:"0","padding-bottom":"56.25%"}},mt=["src"],ht={key:1,style:{position:"relative","margin-left":"5%",width:"90%",height:"0","padding-bottom":"160%"}},wt=["src"],gt=T({__name:"VideoViewer",props:{video:{}},setup(t){const e=t;function n(u){return u.replace("shorts","embed")}return(u,a)=>e.video.url.includes("embed")?(o(),l("div",vt,[g("iframe",{credentialless:"",src:n(e.video.url),style:{position:"absolute",top:"0",left:"0",width:"100%",height:"100%"},frameborder:"0",allowfullscreen:"",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",referrerpolicy:"strict-origin-when-cross-origin"},null,8,mt)])):(o(),l("div",ht,[g("iframe",{credentialless:"",src:n(e.video.url??""),style:{position:"absolute",top:"0",left:"0",width:"100%",height:"100%"},frameborder:"0",allowfullscreen:"",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",referrerpolicy:"strict-origin-when-cross-origin"},null,8,wt)]))}}),yt={key:1,class:"flex-grow px-4 py-2"},bt=T({__name:"UnitCard",props:{unit:{},loading:{type:Boolean}},setup(t){const e=t,n=ge(),u=se(),{saveAnswer:a,setSubmitable:i}=u;function r(p){e.unit.unitType=="options"?i(p.options.length>0):e.unit.unitType=="open"&&i(p.open.length>0),a(e.unit.id,p),w(p)}const w=ye(p=>{c(p)},1e3,{maxWait:5e3});async function c(p){await G.saveUnitByIdandLessonId(e.unit.id,Number(n.params.id),{answer:p})}return(p,b)=>{const _=me;return o(),l("div",null,[p.loading?(o(),S(_,{key:0,class:"flex justify-center items-center w-10 h-full"})):(o(),l("div",yt,[e.unit.unitType=="article"?(o(),S(dt,{key:0,article:e.unit.content},null,8,["article"])):e.unit.unitType=="options"?(o(),S(pt,{key:1,"options-data":e.unit.content,state:e.unit.studentState,onSaveAnswer:r},null,8,["options-data","state"])):e.unit.unitType=="open"?(o(),S(ft,{key:2,state:e.unit.studentState,onSaveAnswer:r},null,8,["state"])):e.unit.unitType=="video"?(o(),S(gt,{key:3,video:e.unit.content},null,8,["video"])):B("",!0)]))])}}}),kt={key:1,class:"flex flex-col h-full w-full"},xt={class:"flex-grow flex flex-col gap-4 px-4 py-2"},_t=T({__name:"GroupCard",props:{group:{},loading:{type:Boolean}},setup(t){const e=t,n=d(null);return M(()=>e.loading,u=>{u===!1&&n.value&&requestAnimationFrame(()=>{var a;(a=n.value)==null||a.scrollIntoView({behavior:"smooth",block:"start"})})}),(u,a)=>{const i=me;return o(),l("div",{ref_key:"groupRef",ref:n},[u.loading?(o(),S(i,{key:0,class:"flex justify-center items-center w-10 h-full"})):(o(),l("div",kt,[g("div",xt,[(o(!0),l(O,null,oe(u.group.units,r=>(o(),S(bt,{key:r.id,unit:r},null,8,["unit"]))),128))])]))],512)}}}),Ct=T({__name:"UnitsView",props:{pages:{}},setup(t){const e=se(),{groups:n,isGroupLoading:u,showPibody:a}=ve(e),{loadInitialGroup:i}=e,r=d(null),w=d(null),c=d(0);function p(y){let f=y;for(;f&&f.parentElement;){const v=f.parentElement,D=getComputedStyle(v).overflowY;if(D==="auto"||D==="scroll")return v;f=v}return null}async function b(){await Ue();const y=p(r.value),f=w.value;if(!y||!f){c.value=0;return}const v=y.clientHeight,L=f.getBoundingClientRect().height,D=Math.max(0,v-L);c.value=D}function _(y,f){var D;const v=(D=n.value[n.value.length-1])==null?void 0:D.id;let L=null;y&&(y instanceof Element?L=y:y.$el instanceof Element&&(L=y.$el)),w.value=f.id===v?L:null}return ne(()=>{i(),b(),window.addEventListener("resize",b)}),Ne(()=>{window.removeEventListener("resize",b)}),M(()=>n.value.length,async()=>{await b()}),M(()=>u.value,async(y,f)=>{f===!0&&y===!1&&await b()}),(y,f)=>(o(),l("div",{ref_key:"rootEl",ref:r,class:we(["flex flex-col gap-8",s(a)?"":"max-w-screen-lg mx-auto"])},[(o(!0),l(O,null,oe(s(n),v=>(o(),l("div",{key:v.id,ref_for:!0,ref:L=>_(L,v)},[x(_t,{group:v,loading:s(u)&&v.id==s(n)[s(n).length-1].id},null,8,["group","loading"])]))),128)),g("div",{style:pe({height:c.value+"px"})},null,4)],2))}}),Lt={key:0,class:"flex justify-center items-center w-full min-h-24 px-8 gap-8"},St={key:1},$t={key:"correct",class:"flex justify-center items-center w-full min-h-24 px-8 gap-8 bg-green-100"},Bt={key:"incorrect",class:"flex justify-center items-center w-full min-h-24 px-8 gap-8 bg-red-100"},It={key:"no-submit",class:"flex justify-center items-center w-full min-h-24 px-8 gap-8"},Dt={key:"try-again",class:"flex justify-center items-center w-full min-h-24 px-8 gap-8 bg-gray-50"},Et={key:2},At={key:"correct",class:"flex justify-center items-center w-full min-h-24 px-8 gap-8 bg-green-100"},Rt={key:1,class:"flex justify-center items-center w-full min-h-24 px-8 gap-8"},Vt=T({__name:"NavigationBar",setup(t){const e=se(),{isSubmitLoading:n,groupStatus:u,isGroupLoading:a,submitExist:i,correct:r,submitEnabled:w}=ve(e),{submitGroup:c,nextGroup:p,tryAgain:b,finishLesson:_}=e;return(y,f)=>{const v=fe;return o(),l(O,null,[s(u)=="check"?(o(),l("div",Lt,[x(v,{label:"CHECK",icon:"pi pi-check","icon-pos":"right",size:"large",severity:"contrast",class:"w-56 rounded-3xl",onClick:s(c),loading:s(n),disabled:s(n)||!s(w)},null,8,["onClick","loading","disabled"])])):B("",!0),s(u)=="continue"?(o(),l("div",St,[x(te,{name:"pop",appear:"",mode:"out-in"},{default:V(()=>[s(i)&&s(r)?(o(),l("div",$t,[f[0]||(f[0]=g("div",{class:"text-lg font-bold flex items-center gap-2"},[g("span",{class:"text-3xl"},"🎉"),le(" Correct!")],-1)),x(v,{label:"CONTINUE",icon:"pi pi-arrow-right","icon-pos":"right",size:"large",class:"w-56 rounded-3xl",onClick:s(p),loading:s(a),disabled:s(a)},null,8,["onClick","loading","disabled"])])):s(i)&&!s(r)?(o(),l("div",Bt,[x(v,{label:"CONTINUE",icon:"pi pi-arrow-right","icon-pos":"right",size:"large",severity:"contrast",class:"w-56 rounded-3xl",onClick:s(p),loading:s(a),disabled:s(a)},null,8,["onClick","loading","disabled"])])):(o(),l("div",It,[x(v,{label:"CONTINUE",icon:"pi pi-arrow-right","icon-pos":"right",size:"large",severity:"contrast",class:"w-56 rounded-3xl",onClick:s(p),loading:s(a),disabled:s(a)},null,8,["onClick","loading","disabled"])]))]),_:1})])):B("",!0),x(te,{name:"shake",appear:""},{default:V(()=>[s(u)=="try-again"?(o(),l("div",Dt,[f[1]||(f[1]=g("div",{class:"text-lg font-bold flex items-center gap-2"},[g("span",{class:"text-3xl"},"⚠️"),le(" Incorrect!")],-1)),x(v,{label:"TRY AGAIN",icon:"pi pi-arrow-right","icon-pos":"right",size:"large",severity:"contrast",class:"w-56 rounded-3xl",onClick:s(b)},null,8,["onClick"])])):B("",!0)]),_:1}),s(u)=="finish"?(o(),l("div",Et,[s(i)&&s(r)?(o(),l("div",At,[f[2]||(f[2]=g("div",{class:"text-lg font-bold flex items-center gap-2"},[g("span",{class:"text-3xl"},"🎉"),le(" Correct!")],-1)),x(v,{label:"FINISH",icon:"pi pi-arrow-right","icon-pos":"right",size:"large",class:"w-56 rounded-3xl",onClick:s(_),loading:s(a),disabled:s(a)},null,8,["onClick","loading","disabled"])])):(o(),l("div",Rt,[x(v,{label:"FINISH",icon:"pi pi-arrow-right","icon-pos":"right",size:"large",class:"w-56 rounded-3xl",onClick:s(_)},null,8,["onClick"])]))])):B("",!0)],64)}}}),Tt=nt(Vt,[["__scopeId","data-v-fdc42d8d"]]),Pt={key:0,class:"h-screen flex flex-col items-center overflow-hidden relative"},zt={class:"fixed top-0 left-0 right-0 z-50 bg-white border-b border-gray-200 shadow-md max-w-[1920px] mx-auto"},Nt={class:"flex justify-between items-center w-full min-h-16 px-8 gap-8"},Ut={class:"flex items-center gap-4"},Ot={key:0,class:"flex flex-grow max-w-screen-lg items-center gap-4"},Kt={class:"flex-1 overflow-y-auto mt-16 mb-24 w-full"},jt={key:1,class:"flex justify-center"},Gt={key:2},Mt={class:"fixed bottom-0 left-0 right-0 z-50 bg-white shadow-md max-w-[1920px] mx-auto"},Ft={key:0,class:"absolute left-0 top-1/2 -translate-y-1/2"},Wt={class:"relative"},Ht={class:"absolute -right-0 top-1/2 -translate-y-1/2 w-5 h-10 z-10"},qt={key:1,class:"absolute right-0 top-1/2 -translate-y-1/2"},Zt={class:"relative"},Yt={class:"absolute -left-0 top-1/2 -translate-y-1/2 w-5 h-10 z-10"},Xt={key:0,class:"h-screen flex flex-col items-center justify-center overflow-hidden gap-10"},kn=T({__name:"LessonPage",setup(t){const e=ge(),n=Ge(),u=Oe(),a=se(),{isLessonLoading:i,selectedLesson:r,pageProgress:w,groupStatus:c,showPibody:p,showCode:b,emulatorID:_,neededModules:y,slots:f}=ve(a),{loadLessonById:v,runCodePressed:L,saveStudentIdeState:D,setSubmitable:R}=a;function F(){u.require({...We,header:"Close lesson",message:"Are you sure you want to exit lesson. All progress will be lost!",acceptProps:{label:"Close",severity:"danger"},accept:()=>K()})}function X(A){var E;const h=((E=r.value)==null?void 0:E.pages.reduce((q,Z)=>q+Z.groups.length,0))||1;return A/h*100}function K(){window.history.length>2?n.go(-1):e.query.route_id&&e.query.route_id!=""?n.push("/v2/route/"+e.query.route_id):n.push("/v2")}const N=d(!0),j=d(!0),W=d("");M([W,f],()=>{R(!0),J({code:W.value,slots:f.value})});const J=ye(A=>{D(A)},1e3,{maxWait:5e3});function ae(A){W.value=A.code}const H=d(16);function U(){const E=452-(window.innerWidth-1024)/2;H.value=E}ne(()=>{U(),v(Number(e.params.id),(e.query.route_id??"").toString()),window.addEventListener("resize",U)}),Ke(()=>{window.removeEventListener("resize",U)});const Q=ce(()=>window.innerWidth<=1920?"":"left: calc((-100vw + 1920px) / 2);"),ie=ce(()=>window.innerWidth<=1920?"":"right: calc((-100vw + 1920px) / 2);");return(A,h)=>{const E=fe,q=Me,Z=me,ee=be;return o(),l(O,null,[s(c)!="completed"?(o(),l("div",Pt,[g("div",zt,[g("div",Nt,[g("div",Ut,[x(E,{icon:"pi pi-times",variant:"text",severity:"contrast",onClick:F})]),s(r)?(o(),l("div",Ot,[(o(!0),l(O,null,oe(s(r).pages,($,m)=>(o(),l("div",{key:m,class:"h-full",style:pe({width:X($.groups.length)+"%"})},[x(q,{value:s(w)[m]/$.groups.length*100,"show-value":!1,class:"w-full rounded-full h-3"},null,8,["value"])],4))),128))])):B("",!0),h[9]||(h[9]=g("div",{class:"w-10"},null,-1))])]),g("div",Kt,[g("div",{class:"w-full h-full max-w-screen-lg mx-auto py-8",style:pe({paddingLeft:H.value+"px",paddingRight:H.value+"px"})},[s(i)?(o(),S(Z,{key:0,class:"flex justify-center"})):s(r)?(o(),l("div",Gt,[x(Ct,{pages:s(r).pages},null,8,["pages"])])):(o(),l("div",jt,"No lesson found"))],4)]),g("div",Mt,[x(Tt)]),s(p)?(o(),l("div",Ft,[x(E,{icon:"pi pi-chevron-right",severity:"secondary",onClick:h[0]||(h[0]=$=>j.value=!0),class:"w-5 rounded-tl-none rounded-bl-none rounded-tr-lg rounded-br-lg"}),x(ee,{visible:j.value,"onUpdate:visible":h[4]||(h[4]=$=>j.value=$),modal:!1,dismissable:!1,closeOnEscape:!1,class:"h-[calc(100vh-64px)] w-fit mt-16",pt:{root:{style:ie.value}}},{header:V(()=>h[10]||(h[10]=[g("div",null,null,-1)])),container:V(()=>[g("div",Wt,[g("div",Ht,[x(E,{icon:"pi pi-chevron-left",severity:"secondary",onClick:h[1]||(h[1]=$=>j.value=!1),class:"w-5 rounded-tl-lg rounded-bl-lg rounded-tr-none rounded-br-none"})]),(o(),S(s(Ze),{id:s(_),key:s(_),slots:s(f),"onUpdate:slots":h[2]||(h[2]=$=>ue(f)?f.value=$:null),neededModules:s(y),"onUpdate:neededModules":h[3]||(h[3]=$=>ue(y)?y.value=$:null),class:"w-full",horizontal:!1,autoPut:!0},null,8,["id","slots","neededModules"]))])]),_:1},8,["visible","pt"])])):B("",!0),s(b)?(o(),l("div",qt,[x(E,{icon:"pi pi-chevron-left",severity:"secondary",onClick:h[5]||(h[5]=$=>N.value=!0),class:"w-5 rounded-tl-lg rounded-bl-lg rounded-tr-none rounded-br-none"}),x(ee,{visible:N.value,"onUpdate:visible":h[8]||(h[8]=$=>N.value=$),header:"Drawer",modal:!1,dismissable:!1,closeOnEscape:!1,position:"right",class:"h-[calc(100vh-64px)] w-[452px] mt-16",pt:{root:{style:Q.value}}},{header:V(()=>h[11]||(h[11]=[g("div",null,null,-1)])),container:V(()=>[g("div",Zt,[g("div",Yt,[x(E,{icon:"pi pi-chevron-right",severity:"secondary",onClick:h[6]||(h[6]=$=>N.value=!1),class:"w-5 rounded-tl-none rounded-bl-none rounded-tr-lg rounded-br-lg"})]),(o(),S(je,null,[(o(),S(s(Ye),{id:s(_),key:s(_),connectbuttons:s(p),"onUpdate:connectbuttons":h[7]||(h[7]=$=>ue(p)?p.value=$:null),onRun:s(L),onSaveAnswer:ae},null,8,["id","connectbuttons","onRun"]))],1024))])]),_:1},8,["visible","pt"])])):B("",!0)])):B("",!0),x(te,{"enter-active-class":"transition duration-500 ease-out","enter-from-class":"opacity-0 scale-90","enter-to-class":"opacity-100 scale-100","leave-active-class":"transition duration-300 ease-in","leave-from-class":"opacity-100 scale-100","leave-to-class":"opacity-0 scale-90"},{default:V(()=>[s(c)=="completed"?(o(),l("div",Xt,[h[12]||(h[12]=g("div",{class:"text-5xl"},"⚡️",-1)),h[13]||(h[13]=g("div",{class:"flex flex-col items-center"},[g("div",{class:"text-4xl font-bold mb-8"},"Good work!"),g("div",{class:"text-md text-gray-500"},"TOTAL XP"),g("div",{class:"text-3xl font-bold"},"35")],-1)),g("div",null,[x(E,{label:"Continue",class:"rounded-full w-56 text-xl",onClick:K})])])):B("",!0)]),_:1})],64)}}});export{kn as default};
