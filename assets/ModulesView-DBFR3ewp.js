import{a as z,B as Q,Q as F,s as q,r as g,b as e,i as _,w as H,h as n,g as p,e as o,t as k,n as C,K as f,D as G,f as $,A as L,l as K,m as O,H as J,U as W,u as X,R as Y,o as Z,E as ee,F as M,k as B,C as te}from"./index-D3Xw5qxA.js";import{s as oe}from"./index-BM8y864Q.js";import{_ as se}from"./AHeader.vue_vue_type_script_setup_true_lang-JHkau7OH.js";import{s as le}from"./index-BMH0whIo.js";import{a as R,t as N}from"./types-CdUqMms_.js";import{P as re}from"./pibody-BwAjMvHk.js";import{u as ae}from"./editor-store-Bc9LYtR1.js";import{u as ne,m as ie}from"./useSortable-DMnLnWms.js";import"./logo-D1-3uCnC.js";import"./LocaleSwitcher.vue_vue_type_script_setup_true_lang-B8B4sz21.js";import"./index-DJdLyTK3.js";import"./index-ButxQo1H.js";import"./index-CXIZJphG.js";import"./index-xzdyhczQ.js";import"./index-DRYH8h8X.js";import"./StudentViewToggle.vue_vue_type_script_setup_true_lang-D20-3s7Y.js";import"./index-C4S87ejV.js";import"./index-BsfAQShN.js";import"./index-CuTGLVL7.js";import"./index-0_pX67_2.js";import"./http-BF3VYmLO.js";import"./profile-CNbQ_Ux3.js";import"./index-C9_llAIY.js";import"./index-BUPrWENi.js";import"./index-BOssJ-l5.js";import"./v4-CmTdKEVZ.js";import"./sortable.esm-FZSyJVGy.js";const de={key:0,class:"absolute top-0 right-0 text-sm"},ue={key:0,class:"flex items-center gap-1 bg-yellow-500 text-white w-full px-2 py-[1px] rounded-bl-xl rounded-tr-xl"},ce={key:0,class:"bg-green-500 text-white w-full px-2 py-[1px] rounded-bl-xl rounded-tr-xl"},pe={key:1,class:"bg-purple-500 text-white w-full px-2 py-[1px] rounded-bl-xl rounded-tr-xl"},me={key:2,class:"bg-blue-500 text-white w-full px-2 py-[1px] rounded-bl-xl rounded-tr-xl"},fe={key:3,class:"bg-red-500 text-white w-full px-2 py-[1px] rounded-bl-xl rounded-tr-xl"},xe={class:"bg-blue-500 text-white w-full px-2 py-[1px] rounded-tl-xl rounded-br-xl"},ye={class:"w-32 h-32 overflow-clip rounded-xl"},_e={class:"flex flex-col justify-between items-center px-4 py-1"},he={class:"pb-1 font-medium text-lg text-center line-clamp-2"},ve={key:0,class:"flex"},U=z({__name:"ModuleCard",props:{module:{}},emits:["after-remove"],setup(P,{emit:b}){const w=K(),D=Q(),I=F(),{user:c}=q(I),m=g(!1),t=P,A=b;function i(){D.require({message:"Are you sure you want to Delete?",header:"Confirmation",icon:"pi pi-exclamation-triangle",rejectProps:{label:"Cancel",severity:"secondary",outlined:!0},acceptProps:{label:"Delete",severity:"danger"},accept:()=>{h()}})}async function h(){m.value=!0;try{await R.deleteModuleByID(t.module.id),A("after-remove")}catch(u){console.log(u)}finally{m.value=!1}}function x(){w.push(`/module/${t.module.id}/edit`)}return(u,d)=>{const E=le,s=O,r=J("RouterLink");return e(),_(r,{to:m.value?"":`/module/${t.module.id}`},{default:H(()=>{var l,y,v,a,T,V,j;return[n("div",{class:C(["p-0 w-32 relative",((l=p(c))==null?void 0:l.user_type)=="editor"?"h-56":"h-40"])},[((y=p(c))==null?void 0:y.user_type)=="editor"?(e(),o("div",de,[["in_modify"].includes(t.module.stage)?(e(),o("div",ue,[d[0]||(d[0]=n("i",{class:"pi pi-clock",style:{"font-size":"12px"}},null,-1)),n("div",null,k(t.module.stage.replace(/_/g," ").replace(/^./,S=>S.toUpperCase())),1)])):["ready_for_publish","published"].includes(t.module.stage)?(e(),o("div",{key:1,class:C(["flex items-center gap-1 px-2 py-[1px] rounded-bl-xl rounded-tr-xl",t.module.stage=="published"?"bg-green-500 text-white":"bg-green-100 text-green-700"])},[d[1]||(d[1]=n("i",{class:"pi pi-check-circle",style:{"font-size":"12px"}},null,-1)),n("div",null,k(t.module.stage.split("_")[0].replace(/^./,S=>S.toUpperCase())),1)],2)):f("",!0)])):f("",!0),((v=p(c))==null?void 0:v.user_type)=="editor"?(e(),o("div",{key:1,class:C(["absolute left-0 text-sm",((a=p(c))==null?void 0:a.user_type)=="editor"?"bottom-24":"bottom-8"])},[t.module.access_type=="freemium"?(e(),o("div",ce,"Free")):t.module.access_type=="premium"?(e(),o("div",pe,"Premium")):t.module.access_type=="demo"?(e(),o("div",me,"Demo")):t.module.access_type=="hackaton"?(e(),o("div",fe,"Hackaton ")):f("",!0)],2)):f("",!0),((T=p(c))==null?void 0:T.user_type)=="editor"?(e(),o("div",{key:2,class:C(["absolute right-0 text-sm",((V=p(c))==null?void 0:V.user_type)=="editor"?"bottom-24":"bottom-8"])},[n("div",xe,[d[2]||(d[2]=G("By ")),n("span",null,k(u.module.creator_name.length>0?u.module.creator_name:u.module.created_by),1)])],2)):f("",!0),n("div",ye,[$(E,{alt:"user header",src:t.module.source_url.length>0?t.module.source_url:p(re),width:"128",height:"128",class:"animate-fadein animate-once animate-duration-1000 animate-ease-in-out"},null,8,["src"])]),n("div",_e,[n("div",he,k(t.module.title),1),((j=p(c))==null?void 0:j.user_type)=="editor"?(e(),o("div",ve,[$(s,{icon:t.module.is_editable?"pi pi-pen-to-square":"pi pi-eye",severity:"info",variant:"text",rounded:"","aria-label":"Edit",onClick:L(x,["prevent"])},null,8,["icon"]),t.module.is_editable?(e(),_(s,{key:0,icon:"pi pi-trash",severity:"danger",variant:"text",rounded:"","aria-label":"Remove",onClick:L(i,["prevent"]),disabled:m.value,loading:m.value},null,8,["disabled","loading"])):f("",!0)])):f("",!0)])],2)]}),_:1},8,["to"])}}}),ge={class:"flex flex-col min-h-screen bg-slate-50"},be={class:"border border-dashed rounded-xl border-green-400 overflow-hidden h-fit"},we={key:1,class:"flex flex-wrap justify-center gap-8 px-4 sm:px-12 py-6"},We=z({__name:"ModulesView",setup(P){const b=W("el"),w=X(),{locale:D}=Y(),I=K(),c=ae(),{addLesson:m}=c,t=F(),{user:A}=q(t),i=g([]),h=g(0),x=g(!1),u=g(!1);ne(b,i,{onUpdate:s=>{ie(i.value,s.oldIndex,s.newIndex,s),te(async()=>{const r=[];i.value.map(l=>{const y=parseInt(l.id,10);r.push(y)});try{const{data:l}=await R.changeModulesOrder(r);w.add({severity:"success",summary:l.message,life:2e3})}catch(l){w.add({severity:"error",summary:l.response.data.error,detail:l,life:2e3})}})}});async function d(){if(!x.value){x.value=!0;try{const{data:s}=await R.getModules();x.value=!1,i.value=[],h.value=s.length;for(const r of s){const l=await N(r);i.value.push(l)}}catch(s){console.log(s)}finally{x.value=!1}}}Z(d),ee(D,d);async function E(){u.value=!0;try{const{data:s}=await R.createModule(),r=await N(s);m(r),I.push(`/module/${r.id}/edit`)}catch(s){console.log(s)}finally{u.value=!1}}return(s,r)=>{var v;const l=oe,y=O;return e(),o("div",ge,[$(se),((v=p(A))==null?void 0:v.user_type)=="editor"?(e(),o("div",{key:0,ref_key:"el",ref:b,class:"flex flex-wrap justify-center gap-8 px-4 sm:px-12 py-6"},[(e(!0),o(M,null,B(i.value,a=>(e(),_(U,{key:a.id,module:a,onAfterRemove:d},null,8,["module"]))),128)),(e(!0),o(M,null,B(h.value-i.value.length,a=>(e(),_(l,{key:a,width:"128px",height:"128px",class:"rounded-xl shadow-sm"}))),128)),n("div",be,[$(y,{variant:"text",style:{width:"128px",height:"128px"},class:"bg-green-50",onClick:E,loading:u.value,disabled:u.value},{icon:H(()=>r[0]||(r[0]=[n("i",{class:"pi pi-plus text-xl"},null,-1)])),_:1},8,["loading","disabled"])])],512)):(e(),o("div",we,[(e(!0),o(M,null,B(i.value,a=>(e(),_(U,{key:a.id,module:a,onAfterRemove:d},null,8,["module"]))),128)),(e(!0),o(M,null,B(h.value-i.value.length,a=>(e(),_(l,{key:a,width:"128px",height:"128px",class:"rounded-xl shadow-sm"}))),128))]))])}}});export{We as default};
