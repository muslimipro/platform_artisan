import{h as j,z as p,s as L}from"./index-DM_w36p9.js";import{s as N}from"./index-DG8TrzZm.js";import{s as R}from"./index-CVEnGco9.js";import{s as S}from"./index-BuSmqSPl.js";import{d as E,u as T,r as b,o,c as l,b as a,e,j as k,w as i,t as n,f as M,F as u,i as P,h as $,n as q,k as A,s as D}from"./index-Bys-p59Q.js";import{_ as Z}from"./AuthHeader.vue_vue_type_script_setup_true_lang-DQfu66xm.js";import{a as G}from"./index-CqQi59sS.js";import"./index-BLLXC1dr.js";import"./index-DWmrnhHm.js";import"./logo-C48NNFvR.js";import"./LocaleSwitcher.vue_vue_type_script_setup_true_lang-D_onbOp7.js";import"./index-BVpJyO2r.js";import"./index-CNLIXpue.js";const H={class:"card flex flex-col items-center pt-4"},I={class:"flex flex-1 items-center justify-center my-4"},J={class:"text-4xl font-semibold px-2 mr-4"},K={class:"flex flex-col gap-1"},O={for:"password"},Q={class:"my-0 flex flex-col gap-1"},U={class:"flex flex-col gap-1"},W={for:"confirm_password"},X={class:"my-0 flex flex-col gap-1"},us=E({__name:"ResetPassword",setup(Y){const f=T(),V=q(),_=A(),t=b(!1),z=b({password:""}),B=j(p.object({password:p.string().min(8,{message:"Minimum 8 characters."}).max(100,{message:"Maximum 100 characters."}).refine(s=>/[a-z]/.test(s),{message:"Must have a lowercase letter."}).refine(s=>/[A-Z]/.test(s),{message:"Must have an uppercase letter."}).refine(s=>/[0-9]/.test(s),{message:"Must have a number."}),confirm_password:p.string()}).refine(s=>s.password===s.confirm_password,{message:"Passwords must match",path:["confirm_password"]})),F=async s=>{if(!t.value&&s.valid){t.value=!0;try{await G.resetPassword(V.query.token,s.states.password.value),_.replace({name:"login"}),f.add({severity:"success",summary:"Password changed successfully",life:3e3})}catch(c){console.log(c),f.add({severity:"error",summary:"Expired or invalid token",life:3e3})}finally{t.value=!1}}};return(s,c)=>{const g=D,w=S,v=R,y=N,C=L;return o(),l(u,null,[a(Z),e("div",H,[a(g,{label:s.$t("pages.login.backToLogin"),variant:"outlined",icon:"pi pi-arrow-left",size:"small",onClick:c[0]||(c[0]=r=>k(_).replace({name:"login"}))},null,8,["label"]),a(C,{initialValues:z.value,resolver:k(B),onSubmit:F,class:"flex flex-col gap-4 w-full sm:w-80 sm:px-0 px-8"},{default:i(r=>{var h,x;return[e("div",I,[e("p",J,n(s.$t("pages.login.newPassword")),1)]),e("div",K,[a(v,{variant:"on"},{default:i(()=>[a(w,{id:"password",name:"password",feedback:!1,toggleMask:"",fluid:""}),e("label",O,n(s.$t("pages.login.newPassword")),1)]),_:1}),(h=r.password)!=null&&h.invalid?(o(),M(y,{key:0,severity:"error",size:"small",variant:"simple"},{default:i(()=>[e("ul",Q,[(o(!0),l(u,null,P(r.password.errors,(m,d)=>(o(),l("li",{key:d},n(m.message),1))),128))])]),_:2},1024)):$("",!0)]),e("div",U,[a(v,{variant:"on"},{default:i(()=>[a(w,{id:"confirm_password",name:"confirm_password",feedback:!1,toggleMask:"",fluid:""}),e("label",W,n(s.$t("pages.login.confirmPassword")),1)]),_:1}),(x=r.confirm_password)!=null&&x.invalid?(o(),M(y,{key:0,severity:"error",size:"small",variant:"simple"},{default:i(()=>[e("ul",X,[(o(!0),l(u,null,P(r.confirm_password.errors,(m,d)=>(o(),l("li",{key:d},n(m.message),1))),128))])]),_:2},1024)):$("",!0)]),a(g,{type:"submit",label:s.$t("pages.login.save"),loading:t.value,disabled:t.value},null,8,["label","loading","disabled"])]}),_:1},8,["initialValues","resolver"])])],64)}}});export{us as default};
