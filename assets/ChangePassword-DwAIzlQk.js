import{s as $}from"./index-ChOX4LA1.js";import{h as C,z as p,s as N}from"./index-CzBdfAI4.js";import{a as j,u as q,r as M,b as e,k as f,w as r,f as t,h as a,t as l,e as i,j as g,F as v,l as h,g as A,q as L}from"./index-BEuVwAr8.js";import{s as D}from"./index-DSPRcvKO.js";import{s as E}from"./index-7OA1qYBw.js";import{s as O}from"./index-BWmI3jGq.js";import{S as T}from"./index-BeFVaD5v.js";import"./index-BcdmDF4L.js";import"./index-B1S9ByTA.js";import"./index-BFWEgjsR.js";import"./index-BYv6yn4V.js";import"./http-PePEMJWw.js";const Z={class:"flex flex-col gap-1"},G={for:"old_password"},H={class:"my-0 flex flex-col gap-1"},I={class:"flex flex-col gap-1"},J={for:"new_password"},K={class:"my-0 flex flex-col gap-1"},Q={class:"flex flex-col gap-1"},R={for:"confirm_password"},U={class:"my-0 flex flex-col gap-1"},cs=j({__name:"ChangePassword",setup(W){const y=q(),n=M(!1),P=M({old_password:"",new_password:""}),V=C(p.object({old_password:p.string().min(1,{message:"Old password is required."}).max(100,{message:"Maximum 100 characters."}),new_password:p.string().min(8,{message:"Minimum 8 characters."}).max(100,{message:"Maximum 100 characters."}).refine(s=>/[a-z]/.test(s),{message:"Must have a lowercase letter."}).refine(s=>/[A-Z]/.test(s),{message:"Must have an uppercase letter."}).refine(s=>/[0-9]/.test(s),{message:"Must have a number."}),confirm_password:p.string()}).refine(s=>s.new_password===s.confirm_password,{message:"Passwords must match",path:["confirm_password"]})),z=async s=>{if(!n.value&&s.valid){n.value=!0;try{const{data:d}=await T.changePassword(s.states.old_password.value,s.states.new_password.value);y.add({severity:"success",summary:d.message,life:2e3})}catch(d){y.add({severity:"error",summary:d.response.data.error,detail:d,life:2e3})}finally{n.value=!1}}};return(s,d)=>{const u=O,_=E,w=D,B=L,F=N,S=$;return e(),f(S,{class:"flex-grow",header:s.$t("pages.settings.changePassword")},{default:r(()=>[t(F,{initialValues:P.value,resolver:A(V),onSubmit:z,class:"flex flex-col gap-2"},{default:r(o=>{var b,x,k;return[a("div",Z,[t(_,{variant:"on"},{default:r(()=>[t(u,{id:"old_password",name:"old_password",feedback:!1,toggleMask:"",fluid:"",class:"w-full sm:w-96"}),a("label",G,l(s.$t("pages.settings.oldPassword")),1)]),_:1}),(b=o.old_password)!=null&&b.invalid?(e(),f(w,{key:0,severity:"error",size:"small",variant:"simple"},{default:r(()=>[a("ul",H,[(e(!0),i(v,null,g(o.old_password.errors,(c,m)=>(e(),i("li",{key:m},l(c.message),1))),128))])]),_:2},1024)):h("",!0)]),a("div",I,[t(_,{variant:"on"},{default:r(()=>[t(u,{id:"new_password",name:"new_password",feedback:!1,toggleMask:"",fluid:"",class:"w-full sm:w-96"}),a("label",J,l(s.$t("pages.settings.newPassword")),1)]),_:1}),(x=o.new_password)!=null&&x.invalid?(e(),f(w,{key:0,severity:"error",size:"small",variant:"simple"},{default:r(()=>[a("ul",K,[(e(!0),i(v,null,g(o.new_password.errors,(c,m)=>(e(),i("li",{key:m},l(c.message),1))),128))])]),_:2},1024)):h("",!0)]),a("div",Q,[t(_,{variant:"on"},{default:r(()=>[t(u,{id:"confirm_password",name:"confirm_password",feedback:!1,toggleMask:"",fluid:"",class:"w-full sm:w-96"}),a("label",R,l(s.$t("pages.settings.confirmPassword")),1)]),_:1}),(k=o.confirm_password)!=null&&k.invalid?(e(),f(w,{key:0,severity:"error",size:"small",variant:"simple"},{default:r(()=>[a("ul",U,[(e(!0),i(v,null,g(o.confirm_password.errors,(c,m)=>(e(),i("li",{key:m},l(c.message),1))),128))])]),_:2},1024)):h("",!0)]),t(B,{type:"submit",label:s.$t("pages.settings.savePassword"),class:"w-fit",loading:n.value,disabled:n.value},null,8,["label","loading","disabled"])]}),_:1},8,["initialValues","resolver"])]),_:1},8,["header"])}}});export{cs as default};
