import{s as D}from"./index-BgrrkUTi.js";import{s as T}from"./index-BBP-spGk.js";import{a as x,L as U,M as A,u as F,r as c,S as Y,b as m,i as f,w as i,h as r,f as o,D as N,t as k,K as B,H,m as S,p as L,Q as P,s as I,N as R,e as j,g as p,F as q}from"./index-Bzt9KOfG.js";import{s as h}from"./index-DoGwK5kr.js";import{a as z,s as K}from"./index-BJk7I2-9.js";import{s as O}from"./index-BErXl6Bn.js";import{_ as Q}from"./VerifyEmailDialog.vue_vue_type_script_setup_true_lang-DvBfN_jm.js";import{S as G}from"./index-DdP9G9LQ.js";import{u as J}from"./profile-CKxb-yIb.js";import"./index-DbdWTsGi.js";import"./index-CV6ojNDB.js";import"./http-j2rGyWLF.js";const W={class:"text-blue-500"},X={class:"flex flex-col gap-1"},Z={class:"flex gap-1 justify-end"},ee=x({__name:"VerifyNewEmailDialog",props:U({email:{}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup($){const v=$,u=A($,"modelValue"),g=F(),l=c(!1),a=c(0);let n;const d=()=>{a.value=60,n=setInterval(()=>{a.value>0?a.value--:clearInterval(n)},1e3)};async function s(){l.value=!0;try{const{data:e}=await G.changeEmail(v.email);g.add({severity:"success",summary:e.message,life:2e3}),d()}catch(e){g.add({severity:"error",summary:e.response.data.error,detail:e,life:2e3})}finally{l.value=!1}}return Y(()=>{clearInterval(n)}),(e,_)=>{const V=H("i18n-t"),b=S,E=h,y=L;return m(),f(y,{visible:u.value,"onUpdate:visible":_[0]||(_[0]=w=>u.value=w),modal:"",draggable:!1,class:"m-4 max-w-md",header:e.$t("dialog.verifyYourEmail")},{footer:i(()=>[r("div",X,[r("div",Z,[o(b,{label:a.value>0?`${e.$t("pages.login.resendIn")} ${a.value}s`:e.$t("dialog.sendVerificationEmail"),onClick:s,loading:l.value,disabled:l.value||a.value>0},null,8,["label","loading","disabled"])]),a.value>0?(m(),f(E,{key:0,severity:"success"},{default:i(()=>[N(k(e.$t("pages.settings.weHaveSentLinkToVerifyEmail")),1)]),_:1})):B("",!0)])]),default:i(()=>[r("div",null,[o(V,{keypath:"dialog.confirmEmailAddress"},{email:i(()=>[r("span",W,k(v.email),1)]),_:1})])]),_:1},8,["visible","header"])}}}),ae={class:"flex flex-col gap-2"},se={class:"flex flex-wrap sm:flex-nowrap gap-2"},le={class:"flex flex-col gap-1"},ge=x({__name:"ChangeEmail",setup($){const v=P(),{user:u}=I(v),g=J(),{verified:l}=I(g),a=c(""),n=c(!1),d=c(!1);return R(()=>{var s;a.value=((s=u.value)==null?void 0:s.email)??""}),(s,e)=>{const _=z,V=O,b=K,E=h,y=S,w=T,C=D;return m(),j(q,null,[o(C,{class:"flex-grow",header:s.$t("pages.settings.changeEmail")},{default:i(()=>[r("div",ae,[r("div",se,[r("div",le,[o(b,null,{default:i(()=>[o(_,{class:"pi pi-envelope"}),o(V,{id:"email",autocomplete:"off",variant:"filled",placeholder:"Email",modelValue:a.value,"onUpdate:modelValue":e[0]||(e[0]=t=>a.value=t),disabled:p(l),class:"w-full sm:w-96"},null,8,["modelValue","disabled"])]),_:1}),o(E,{for:"email",severity:p(l)?"success":"error",size:"small",variant:"simple"},{default:i(()=>[N(k(p(l)?s.$t("pages.settings.yourEmailIsVerified"):s.$t("pages.settings.yourEmailIsNotVerified")),1)]),_:1},8,["severity"])]),p(l)?B("",!0):(m(),f(w,{key:0,severity:"danger"},{default:i(()=>{var t;return[((t=p(u))==null?void 0:t.email)==a.value?(m(),f(y,{key:0,label:s.$t("pages.settings.verifyYourEmail"),onClick:e[1]||(e[1]=M=>n.value=!0)},null,8,["label"])):(m(),f(y,{key:1,label:s.$t("pages.settings.verifyYourNewEmail"),onClick:e[2]||(e[2]=M=>d.value=!0),severity:"info"},null,8,["label"]))]}),_:1}))])])]),_:1},8,["header"]),o(Q,{modelValue:n.value,"onUpdate:modelValue":e[3]||(e[3]=t=>n.value=t)},null,8,["modelValue"]),o(ee,{modelValue:d.value,"onUpdate:modelValue":e[4]||(e[4]=t=>d.value=t),email:a.value},null,8,["modelValue","email"])],64)}}});export{ge as default};
