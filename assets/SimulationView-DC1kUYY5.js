var lt=Object.defineProperty;var ut=(n,e,t)=>e in n?lt(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var B=(n,e,t)=>ut(n,typeof e!="symbol"?e+"":e,t);import{J as We,aD as ct,aE as pt,M as ve,aO as me,aP as Re,i as dt,D as $,E as C,a4 as le,aa as we,V as ge,W as ye,m as be,I as b,X as ie,a0 as Ye,F as ft,e as v,ap as Se,ac as G,an as de,o as _e,aQ as ht,T as V,_ as K,af as w,al as J,ai as Ee,aR as vt,ah as Ae,Y as ce,aS as mt,c as ee,aT as H,a6 as Ne,av as wt,aU as gt,aV as yt,w as ze,t as je,aW as Ge,G as ue,aX as bt,aY as xt,aZ as St,r as ae,n as xe}from"./index-EFKUviNu.js";import{a as _t,_ as fe}from"./_plugin-vue_export-helper-CHc3pKy4.js";import{a as Et}from"./logo-DNmcmLnj.js";import{P as zt}from"./pibody-B70zHXNr.js";var Pt=function(e){var t=e.dt;return`
.p-splitter {
    display: flex;
    flex-wrap: nowrap;
    border: 1px solid `.concat(t("splitter.border.color"),`;
    background: `).concat(t("splitter.background"),`;
    border-radius: `).concat(t("border.radius.md"),`;
    color: `).concat(t("splitter.color"),`;
}

.p-splitter-vertical {
    flex-direction: column;
}

.p-splitter-gutter {
    flex-grow: 0;
    flex-shrink: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 1;
    background: `).concat(t("splitter.gutter.background"),`;
}

.p-splitter-gutter-handle {
    border-radius: `).concat(t("splitter.handle.border.radius"),`;
    background: `).concat(t("splitter.handle.background"),`;
    transition: outline-color `).concat(t("splitter.transition.duration"),", box-shadow ").concat(t("splitter.transition.duration"),`;
    outline-color: transparent;
}

.p-splitter-gutter-handle:focus-visible {
    box-shadow: `).concat(t("splitter.handle.focus.ring.shadow"),`;
    outline: `).concat(t("splitter.handle.focus.ring.width")," ").concat(t("splitter.handle.focus.ring.style")," ").concat(t("splitter.handle.focus.ring.color"),`;
    outline-offset: `).concat(t("splitter.handle.focus.ring.offset"),`;
}

.p-splitter-horizontal.p-splitter-resizing {
    cursor: col-resize;
    user-select: none;
}

.p-splitter-vertical.p-splitter-resizing {
    cursor: row-resize;
    user-select: none;
}

.p-splitter-horizontal > .p-splitter-gutter > .p-splitter-gutter-handle {
    height: `).concat(t("splitter.handle.size"),`;
    width: 100%;
}

.p-splitter-vertical > .p-splitter-gutter > .p-splitter-gutter-handle {
    width: `).concat(t("splitter.handle.size"),`;
    height: 100%;
}

.p-splitter-horizontal > .p-splitter-gutter {
    cursor: col-resize;
}

.p-splitter-vertical > .p-splitter-gutter {
    cursor: row-resize;
}

.p-splitterpanel {
    flex-grow: 1;
    overflow: hidden;
}

.p-splitterpanel-nested {
    display: flex;
}

.p-splitterpanel .p-splitter {
    flex-grow: 1;
    border: 0 none;
}
`)},kt={root:function(e){var t=e.props;return["p-splitter p-component","p-splitter-"+t.layout]},gutter:"p-splitter-gutter",gutterHandle:"p-splitter-gutter-handle"},Lt={root:function(e){var t=e.props;return[{display:"flex","flex-wrap":"nowrap"},t.layout==="vertical"?{"flex-direction":"column"}:""]}},Tt=We.extend({name:"splitter",theme:Pt,classes:kt,inlineStyles:Lt}),$t={name:"BaseSplitter",extends:Ye,props:{layout:{type:String,default:"horizontal"},gutterSize:{type:Number,default:4},stateKey:{type:String,default:null},stateStorage:{type:String,default:"session"},step:{type:Number,default:5}},style:Tt,provide:function(){return{$pcSplitter:this,$parentInstance:this}}};function Fe(n){return It(n)||Dt(n)||Mt(n)||Ct()}function Ct(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Mt(n,e){if(n){if(typeof n=="string")return Le(n,e);var t={}.toString.call(n).slice(8,-1);return t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set"?Array.from(n):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Le(n,e):void 0}}function Dt(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function It(n){if(Array.isArray(n))return Le(n)}function Le(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,i=Array(e);t<e;t++)i[t]=n[t];return i}var Rt={name:"Splitter",extends:$t,inheritAttrs:!1,emits:["resizestart","resizeend","resize"],dragging:!1,mouseMoveListener:null,mouseUpListener:null,touchMoveListener:null,touchEndListener:null,size:null,gutterElement:null,startPos:null,prevPanelElement:null,nextPanelElement:null,nextPanelSize:null,prevPanelSize:null,panelSizes:null,prevPanelIndex:null,timer:null,mutationObserver:null,data:function(){return{prevSize:null,isRTL:!1}},mounted:function(){this.initializePanels(),this.updateDirection(),this.observeDirectionChanges()},beforeUnmount:function(){this.clear(),this.unbindMouseListeners(),this.mutationObserver&&this.mutationObserver.disconnect()},methods:{updateDirection:function(){this.isRTL=!!this.$el.closest('[dir="rtl"]')},observeDirectionChanges:function(){var e=this,t=document.documentElement,i={attributes:!0,attributeFilter:["dir"]};this.mutationObserver=new MutationObserver(function(){e.updateDirection()}),this.mutationObserver.observe(t,i)},isSplitterPanel:function(e){return e.type.name==="SplitterPanel"},initializePanels:function(){var e=this;if(this.panels&&this.panels.length){var t=!1;if(this.isStateful()&&(t=this.restoreState()),!t){var i=Fe(this.$el.children).filter(function(s){return s.getAttribute("data-pc-name")==="splitterpanel"}),r=[];this.panels.map(function(s,a){var u=s.props&&s.props.size?s.props.size:null,o=u||100/e.panels.length;r[a]=o,i[a].style.flexBasis="calc("+o+"% - "+(e.panels.length-1)*e.gutterSize+"px)"}),this.panelSizes=r,this.prevSize=parseFloat(r[0]).toFixed(4)}}},onResizeStart:function(e,t,i){this.gutterElement=e.currentTarget||e.target.parentElement,this.size=this.horizontal?ct(this.$el):pt(this.$el),i||(this.dragging=!0,this.startPos=this.layout==="horizontal"?e.pageX||e.changedTouches[0].pageX:e.pageY||e.changedTouches[0].pageY),this.prevPanelElement=this.gutterElement.previousElementSibling,this.nextPanelElement=this.gutterElement.nextElementSibling,i?(this.prevPanelSize=this.horizontal?ve(this.prevPanelElement,!0):me(this.prevPanelElement,!0),this.nextPanelSize=this.horizontal?ve(this.nextPanelElement,!0):me(this.nextPanelElement,!0)):(this.prevPanelSize=100*(this.horizontal?ve(this.prevPanelElement,!0):me(this.prevPanelElement,!0))/this.size,this.nextPanelSize=100*(this.horizontal?ve(this.nextPanelElement,!0):me(this.nextPanelElement,!0))/this.size),this.prevPanelIndex=t,this.$emit("resizestart",{originalEvent:e,sizes:this.panelSizes}),this.$refs.gutter[t].setAttribute("data-p-gutter-resizing",!0),this.$el.setAttribute("data-p-resizing",!0)},onResize:function(e,t,i){var r,s,a;i?this.horizontal?(s=100*(this.prevPanelSize+t)/this.size,a=100*(this.nextPanelSize-t)/this.size):(s=100*(this.prevPanelSize-t)/this.size,a=100*(this.nextPanelSize+t)/this.size):(this.horizontal?this.isRTL?r=(this.startPos-e.pageX)*100/this.size:r=(e.pageX-this.startPos)*100/this.size:r=(e.pageY-this.startPos)*100/this.size,s=this.prevPanelSize+r,a=this.nextPanelSize-r),this.validateResize(s,a)&&(this.prevPanelElement.style.flexBasis="calc("+s+"% - "+(this.panels.length-1)*this.gutterSize+"px)",this.nextPanelElement.style.flexBasis="calc("+a+"% - "+(this.panels.length-1)*this.gutterSize+"px)",this.panelSizes[this.prevPanelIndex]=s,this.panelSizes[this.prevPanelIndex+1]=a,this.prevSize=parseFloat(s).toFixed(4)),this.$emit("resize",{originalEvent:e,sizes:this.panelSizes})},onResizeEnd:function(e){this.isStateful()&&this.saveState(),this.$emit("resizeend",{originalEvent:e,sizes:this.panelSizes}),this.$refs.gutter.forEach(function(t){return t.setAttribute("data-p-gutter-resizing",!1)}),this.$el.setAttribute("data-p-resizing",!1),this.clear()},repeat:function(e,t,i){this.onResizeStart(e,t,!0),this.onResize(e,i,!0)},setTimer:function(e,t,i){var r=this;this.timer||(this.timer=setInterval(function(){r.repeat(e,t,i)},40))},clearTimer:function(){this.timer&&(clearInterval(this.timer),this.timer=null)},onGutterKeyUp:function(){this.clearTimer(),this.onResizeEnd()},onGutterKeyDown:function(e,t){switch(e.code){case"ArrowLeft":{this.layout==="horizontal"&&this.setTimer(e,t,this.step*-1),e.preventDefault();break}case"ArrowRight":{this.layout==="horizontal"&&this.setTimer(e,t,this.step),e.preventDefault();break}case"ArrowDown":{this.layout==="vertical"&&this.setTimer(e,t,this.step*-1),e.preventDefault();break}case"ArrowUp":{this.layout==="vertical"&&this.setTimer(e,t,this.step),e.preventDefault();break}}},onGutterMouseDown:function(e,t){this.onResizeStart(e,t),this.bindMouseListeners()},onGutterTouchStart:function(e,t){this.onResizeStart(e,t),this.bindTouchListeners(),e.preventDefault()},onGutterTouchMove:function(e){this.onResize(e),e.preventDefault()},onGutterTouchEnd:function(e){this.onResizeEnd(e),this.unbindTouchListeners(),e.preventDefault()},bindMouseListeners:function(){var e=this;this.mouseMoveListener||(this.mouseMoveListener=function(t){return e.onResize(t)},document.addEventListener("mousemove",this.mouseMoveListener)),this.mouseUpListener||(this.mouseUpListener=function(t){e.onResizeEnd(t),e.unbindMouseListeners()},document.addEventListener("mouseup",this.mouseUpListener))},bindTouchListeners:function(){var e=this;this.touchMoveListener||(this.touchMoveListener=function(t){return e.onResize(t.changedTouches[0])},document.addEventListener("touchmove",this.touchMoveListener)),this.touchEndListener||(this.touchEndListener=function(t){e.resizeEnd(t),e.unbindTouchListeners()},document.addEventListener("touchend",this.touchEndListener))},validateResize:function(e,t){if(e>100||e<0||t>100||t<0)return!1;var i=Re(this.panels[this.prevPanelIndex],"minSize");if(this.panels[this.prevPanelIndex].props&&i&&i>e)return!1;var r=Re(this.panels[this.prevPanelIndex+1],"minSize");return!(this.panels[this.prevPanelIndex+1].props&&r&&r>t)},unbindMouseListeners:function(){this.mouseMoveListener&&(document.removeEventListener("mousemove",this.mouseMoveListener),this.mouseMoveListener=null),this.mouseUpListener&&(document.removeEventListener("mouseup",this.mouseUpListener),this.mouseUpListener=null)},unbindTouchListeners:function(){this.touchMoveListener&&(document.removeEventListener("touchmove",this.touchMoveListener),this.touchMoveListener=null),this.touchEndListener&&(document.removeEventListener("touchend",this.touchEndListener),this.touchEndListener=null)},clear:function(){this.dragging=!1,this.size=null,this.startPos=null,this.prevPanelElement=null,this.nextPanelElement=null,this.prevPanelSize=null,this.nextPanelSize=null,this.gutterElement=null,this.prevPanelIndex=null},isStateful:function(){return this.stateKey!=null},getStorage:function(){switch(this.stateStorage){case"local":return window.localStorage;case"session":return window.sessionStorage;default:throw new Error(this.stateStorage+' is not a valid value for the state storage, supported values are "local" and "session".')}},saveState:function(){dt(this.panelSizes)&&this.getStorage().setItem(this.stateKey,JSON.stringify(this.panelSizes))},restoreState:function(){var e=this,t=this.getStorage(),i=t.getItem(this.stateKey);if(i){this.panelSizes=JSON.parse(i);var r=Fe(this.$el.children).filter(function(s){return s.getAttribute("data-pc-name")==="splitterpanel"});return r.forEach(function(s,a){s.style.flexBasis="calc("+e.panelSizes[a]+"% - "+(e.panels.length-1)*e.gutterSize+"px)"}),!0}return!1},resetState:function(){this.initializePanels()}},computed:{panels:function(){var e=this,t=[];return this.$slots.default().forEach(function(i){e.isSplitterPanel(i)?t.push(i):i.children instanceof Array&&i.children.forEach(function(r){e.isSplitterPanel(r)&&t.push(r)})}),t},gutterStyle:function(){return this.horizontal?{width:this.gutterSize+"px"}:{height:this.gutterSize+"px"}},horizontal:function(){return this.layout==="horizontal"},getPTOptions:function(){var e;return{context:{nested:(e=this.$parentInstance)===null||e===void 0?void 0:e.nestedState}}}}},At=["onMousedown","onTouchstart","onTouchmove","onTouchend"],Ft=["aria-orientation","aria-valuenow","onKeydown"];function Bt(n,e,t,i,r,s){return $(),C("div",be({class:n.cx("root"),style:n.sx("root"),"data-p-resizing":!1},n.ptmi("root",s.getPTOptions)),[($(!0),C(le,null,we(s.panels,function(a,u){return $(),C(le,{key:u},[($(),ge(ye(a),{tabindex:"-1"})),u!==s.panels.length-1?($(),C("div",be({key:0,ref_for:!0,ref:"gutter",class:n.cx("gutter"),role:"separator",tabindex:"-1",onMousedown:function(l){return s.onGutterMouseDown(l,u)},onTouchstart:function(l){return s.onGutterTouchStart(l,u)},onTouchmove:function(l){return s.onGutterTouchMove(l,u)},onTouchend:function(l){return s.onGutterTouchEnd(l,u)},"data-p-gutter-resizing":!1},n.ptm("gutter")),[b("div",be({class:n.cx("gutterHandle"),tabindex:"0",style:[s.gutterStyle],"aria-orientation":n.layout,"aria-valuenow":r.prevSize,onKeyup:e[0]||(e[0]=function(){return s.onGutterKeyUp&&s.onGutterKeyUp.apply(s,arguments)}),onKeydown:function(l){return s.onGutterKeyDown(l,u)},ref_for:!0},n.ptm("gutterHandle")),null,16,Ft)],16,At)):ie("",!0)],64)}),128))],16)}Rt.render=Bt;var Ot={root:function(e){var t=e.instance;return["p-splitterpanel",{"p-splitterpanel-nested":t.isNested}]}},Ut=We.extend({name:"splitterpanel",classes:Ot}),Xt={name:"BaseSplitterPanel",extends:Ye,props:{size:{type:Number,default:null},minSize:{type:Number,default:null}},style:Ut,provide:function(){return{$pcSplitterPanel:this,$parentInstance:this}}},Vt={name:"SplitterPanel",extends:Xt,inheritAttrs:!1,data:function(){return{nestedState:null}},computed:{isNested:function(){var e=this;return this.$slots.default().some(function(t){return e.nestedState=t.type.name==="Splitter"?!0:null,e.nestedState})},getPTOptions:function(){return{context:{nested:this.isNested}}}}};function Ht(n,e,t,i,r,s){return $(),C("div",be({ref:"container",class:n.cx("root")},n.ptmi("root",s.getPTOptions)),[ft(n.$slots,"default")],16)}Vt.render=Ht;function ke(n){return new Promise(e=>setTimeout(e,n))}class Wt{constructor(){B(this,"_lock",Promise.resolve());this._lock=Promise.resolve()}acquire(){let e;const t=new Promise(r=>e=r),i=this._lock.then(()=>e);return this._lock=this._lock.then(()=>t),i}}class Ce{constructor(){B(this,"mutex");B(this,"inTransaction");B(this,"receivedData");B(this,"activityCallback");B(this,"receiveCallback");B(this,"disconnectCallback");B(this,"writeChunk");B(this,"emit");B(this,"info");B(this,"prevRecvCbk");if(new.target===Ce)throw new Error("Cannot instantiate abstract class Transport");this.mutex=new Wt,this.inTransaction=!1,this.receivedData="",this.activityCallback=()=>{},this.receiveCallback=()=>{},this.disconnectCallback=()=>{},this.prevRecvCbk=e=>{},this.writeChunk=128,this.emit=!1,this.info={}}async getInfo(){return this.info}async write(e){const i=new TextEncoder().encode(e);try{if(i.byteLength==0)await this.writeBytes(i),this.activityCallback();else{let r=0;for(;r<i.byteLength;){const s=i.slice(r,r+this.writeChunk);await this.writeBytes(s),this.activityCallback(),r+=this.writeChunk}}}catch(r){throw r}}onActivity(e){this.activityCallback=e}onReceive(e){this.receiveCallback=e}onDisconnect(e){this.disconnectCallback=e}async startTransaction(){await ke(10);const e=await this.mutex.acquire();return this.prevRecvCbk=this.receiveCallback,this.inTransaction=!0,this.receivedData="",this.receiveCallback=t=>{this.receivedData+=t,this.emit&&this.prevRecvCbk&&this.prevRecvCbk(t)},()=>{this.prevRecvCbk&&(this.receiveCallback=this.prevRecvCbk,this.receiveCallback(this.receivedData)),this.receivedData="",this.inTransaction=!1,e()}}async readExactly(e,t=5e3){if(!this.inTransaction)throw new Error("Not in transaction");let i=Date.now()+t;for(;t<=0||Date.now()<i;){if(this.receivedData.length>=e){const s=this.receivedData.substring(0,e);return this.receivedData=this.receivedData.substring(e),s}const r=this.receivedData.length;await ke(10),this.receivedData.length>r&&(i=Date.now()+t)}throw new Error("Timeout")}async readUntil(e,t=5e3){if(!this.inTransaction)throw new Error("Not in transaction");const i=Date.now();let r=0;for(;t<=0||r<t;){const s=this.receivedData.indexOf(e)+e.length;if(s>=e.length){const a=this.receivedData.substring(0,s);return this.receivedData=this.receivedData.substring(s),a}await ke(10),r=Date.now()-i}throw new Error("Timeout reached before finding the ending sequence")}}class Yt extends Ce{constructor(){super();B(this,"port");B(this,"reader");B(this,"writer");B(this,"serial");if(this.port=void 0,this.reader=null,this.writer=null,"serial"in navigator)this.serial=navigator.serial;else throw new Error("WebSerial not available")}async requestAccess(){var s,a,u,o;const r={filters:[{usbVendorId:11914,usbProductId:5}]};this.port=await((s=this.serial)==null?void 0:s.requestPort(r));try{const l=(a=this.port)==null?void 0:a.getInfo();this.info={vid:(u=l==null?void 0:l.usbVendorId)==null?void 0:u.toString(16).padStart(4,"0"),pid:(o=l==null?void 0:l.usbProductId)==null?void 0:o.toString(16).padStart(4,"0")}}catch(l){throw l}}async connect(){var t,i;if(!this.port)throw new Error("Port is not available");await this.port.open({baudRate:115200}),this.reader=((t=this.port.readable)==null?void 0:t.getReader())||null,this.writer=((i=this.port.writable)==null?void 0:i.getWriter())||null,this.reader&&this.listen()}async disconnect(){if(!this.reader||!this.port)throw new Error("No active connection to disconnect from");try{await this.reader.cancel()}catch{}await this.port.forget()}async writeBytes(t){if(!this.writer)throw new Error("Writer is not initialized");await this.writer.write(t)}async listen(){if(!this.reader)throw new Error("Reader is not initialized");const t=new TextDecoder;await this.write(""),await this.write("");try{for(;;){const{value:i,done:r}=await this.reader.read();if(r||!i)break;this.receiveCallback(t.decode(i))}}catch(i){throw console.log("disconnect callback"),this.disconnectCallback(),i}}async flushInput(){if(!this.reader)throw new Error("Reader is not initialized");this.receivedData=""}}class ne{constructor(e){B(this,"port");B(this,"end");this.port=e,this.end=async()=>{}}static async begin(e,t=!1){var r;const i=new ne(e);await i.enterRawRepl(t);try{await i.exec("import sys,os")}catch(s){throw await((r=i.end)==null?void 0:r.call(i)),s}return i}async interruptProgram(){await this.port.write("")}async enterRawRepl(e=!1){const t=await this.port.startTransaction();try{await this.interruptProgram(),await this.port.flushInput(),await this.port.write("\r"),await this.port.readUntil(`raw REPL; CTRL-B to exit\r
`),e&&(await this.port.write(""),await this.port.readUntil("OK")),this.end=async()=>{try{await this.port.write(""),await this.port.readUntil(`>\r
`),await this.port.readUntil(">>> ")}finally{t()}}}catch(i){throw t(),i}}async exec(e,t=5e3,i=!1){if(e.length===0)return"";await this.port.write(e),await this.port.write(""),await this.port.readUntil("OK"),this.port.emit=i,i&&this.port.prevRecvCbk(this.port.receivedData);const r=(await this.port.readUntil("",t)).slice(0,-1),s=(await this.port.readUntil("",t)).slice(0,-1);if(s.length)throw new Error(s);return r}async readFile(e){const t=await this.exec(`
try:
 import binascii
 h=lambda x: binascii.hexlify(x).decode()
 h(b'')
except:
 h=lambda b: ''.join('{:02x}'.format(byte) for byte in b)
with open('${e}','rb') as f:
 while 1:
  b=f.read(64)
  if not b:break
  print(h(b),end='')
`);return t.length?new Uint8Array(t.match(/../g).map(i=>parseInt(i,16))):new Uint8Array}async writeFile(e,t,i=128,r=!1){if(typeof t=="string"){const o=new TextEncoder;t=new Uint8Array(o.encode(t))}const s=o=>Array.from(o).map(l=>l.toString(16).padStart(2,"0")).join(""),a=o=>{o=new Uint8Array(o);let l="b'";for(const c of o)c>=32&&c<=126?c===92||c===39?l+="\\"+String.fromCharCode(c):l+=String.fromCharCode(c):l+="\\x"+c.toString(16).padStart(2,"0");return l+="'",l},u=r?e:".viper.tmp";await this.exec(`
try:
 import binascii
 h=binascii.unhexlify
 h('')
except:
 h=lambda s: bytes(int(s[i:i+2], 16) for i in range(0, len(s), 2))
f=open('${u}','wb')
w=lambda d: f.write(h(d))
o=f.write
`);for(let o=0;o<t.byteLength;o+=i){const l=t.slice(o,o+i),c="w('"+s(l)+"')",p="o("+a(l)+")";c.length<p.length?await this.exec(c):await this.exec(p)}r?await this.exec("f.close()"):await this.exec(`f.close()
try: os.remove('${e}')
except: pass
os.rename('${u}','${e}')
`)}async getDeviceInfo(){const e=await this.exec(`
try: u=os.uname()
except: u=('','','','',sys.platform)
try: v=sys.version.split(';')[1].strip()
except: v='MicroPython '+u[2]
mpy=getattr(sys.implementation, '_mpy', 0)
sp=':'.join(sys.path)
d=[u[4],u[2],u[0],v,mpy>>10,mpy&0xFF,(mpy>>8)&3,sp]
print('|'.join(str(x) for x in d))
`);let[t,i,r,s,a,u,o,l]=e.trim().split("|");const c=l.split(":");try{a=["","x86","x64","armv6","armv6m","armv7m","armv7em","armv7emsp","armv7emdp","xtensa","xtensawin","rv32imc"][parseInt(a)]}catch{a=""}let p=parseInt(u,10);const m=parseInt(o,10);return p||(p="py"),{machine:t,release:i,sysname:r,version:s,mpy_arch:a,mpy_ver:p,mpy_sub:m,sys_path:c}}async touchFile(e){await this.exec(`
f=open('${e}','wb')
f.close()
`)}async moveFile(e,t){await this.exec(`os.rename('${e}', '${t}')`)}async makeDir(e){await this.exec(`os.mkdir('${e}')`)}async makePath(e){await this.exec(`
p=''
for d in '${e}'.split('/'):
 if not d: continue
 p += '/'+d
 try: os.mkdir(p)
 except OSError as e:
  if e.args[0] not in (17, 20): raise
`)}async removeFile(e){await this.exec(`
try:
 os.remove('${e}')
except OSError as e:
 if e.args[0] == 39:
  throw new Error('Directory not empty')
 else:
  throw e
`)}async removeDir(e){await this.exec(`
try:
 os.rmdir('${e}')
except OSError as e:
 if e.args[0] == 39:
  throw new Error('Directory not empty')
 else:
  throw e
`)}async getFsStats(e="/"){return(await this.exec(`
s = os.statvfs('${e}')
fs = s[1] * s[2]
ff = s[3] * s[0]
fu = fs - ff
print('%s|%s|%s'%(fu,ff,fs))
`)).trim().split("|")}async getFiles(){return await this.exec(`
def walk(p):
 for n in os.listdir(p if p else '/'):
  fn=p+'/'+n
  try: s=os.stat(fn)
  except: s=(0,)*7
  try:
   if s[0] & 0x4000 == 0:
    print('f|'+fn+'|'+str(s[6]))
   elif n not in ('.','..'):
    print('d|'+fn+'|'+str(s[6]))
    walk(fn)
  except:
   print('f|'+p+'/???|'+str(s[6]))
walk('')
`)}async readSysInfoMD(){return await this.exec(`
import gc
gc.collect()
mu = gc.mem_alloc()
mf = gc.mem_free()
ms = mu + mf
uname=os.uname()
p=print
def size_fmt(size):
 suffixes = ['B','KiB','MiB','GiB','TiB']
 i = 0
 while size > 1024 and i < len(suffixes)-1:
  i += 1
  size //= 1024
 return "%d%s" % (size, suffixes[i])
p('## Machine')
p('- Name: \`'+uname.machine+'\`')
try:
 gc.collect()
 import microcontroller as uc
 p('- CPU: \`%s @ %s MHz\`' % (sys.platform, uc.cpu.frequency // 1_000_000))
 p('- UID: \`%s\`' % (uc.cpu.uid.hex(),))
 p('- Temp.: \`%s °C\`' % (uc.cpu.temperature,))
 p('- Voltage: \`%s V\`' % (uc.cpu.voltage,))
except:
 try:
  gc.collect()
  import machine
  p('- CPU: \`%s @ %s MHz\`' % (sys.platform, machine.freq() // 1_000_000))
 except:
  p('- CPU: \`'+sys.platform+'\`')
p()
p('## System')
p('- Version: \`'+sys.version.split(";")[1].strip()+'\`')
if ms:
 p('- Memory use:  \`%s / %s, free: %d%%\`' % (size_fmt(mu), size_fmt(ms), (mf * 100) // ms))
`)}}const Te=v(!1);v(Qe());const Y=v(!1),Nt=v(!1),jt=v(),U=v(!1),Be=v(!1),Ke=v(!1),qe=v(),pe=v(!1),Oe=v(!1),Gt=v(!1),Kt=v(),te=v(!1),Ue=v(!1),qt=v(!1),Jt=v();let I=null;function Qt(n){return new Promise(e=>setTimeout(e,n))}async function Zt(n){try{pe.value=!0,Oe.value=!1,await n(),Oe.value=!0}catch(e){Gt.value=!0,Kt.value=e}finally{pe.value=!1}}async function en(n){try{te.value=!0,Ue.value=!1,await n(),Ue.value=!0}catch(e){qt.value=!0,Jt.value=e}finally{te.value=!1}}function re(n){return"children"in n}function Je(n){if(n){n.children.sort((e,t)=>re(e)&&!re(t)?-1:!re(e)&&re(t)?1:e.name.localeCompare(t.name));for(const e of n.children)re(e)&&Je(e)}}async function tn(){if(!I)return{name:"",path:"",children:[]};const n=await ne.begin(I,!0),e=await n.getFiles();await n.end();const t=nn(e);return Je(t),t}function nn(n){const e={name:"",path:"",children:[]},t=n.trim().split(`
`),i={"":e};for(const r of t){const[s,a,u]=r.split("|"),o=a.split("/"),l=o[o.length-1],c=o.slice(0,-1).join("/")||"";if(s==="f"){const p={name:l,path:a,size:parseInt(u)};i[c]&&i[c].children.push(p)}else if(s==="d"){const p={name:l,path:a,children:[]};i[a]=p,i[c]&&i[c].children.push(p)}}return e}function Xe(n,e){let t=!1;const i=n.trim().split(`
`),r=s=>{const[a,u,o]=s.split("|");return u===e};return i.find(r)&&(t=!0),t}function Qe(){return/(iPad|iPhone|iPod)/g.test(navigator.userAgent)?(console.error("WebSerial is not available on iOS"),!1):window.isSecureContext?"serial"in navigator||"usb"in navigator?!0:(console.error("Try Chrome, Edge, Opera, Brave","WebSerial and WebUSB are not supported"),!1):(console.error("WebSerial cannot be accessed with unsecure connection"),!1)}async function sn(){let n;if(n=new Yt,!Qe())return null;try{await n.requestAccess()}catch(e){return jt.value=e,null}return n}async function rn(n,e,t){try{await n.connect(),Y.value=!0}catch{Te.value=!1,Y.value=!1,U.value=!1,te.value=!1,pe.value=!1,Nt.value=!0;return}n.onReceive(e),n.onDisconnect(()=>{t(),Y.value=!1,U.value=!1,te.value=!1,pe.value=!1,Te.value=!1}),I=n}async function an(){I==null||I.disconnect(),I=null,Te.value=!1,Y.value=!1,U.value=!1,pe.value=!1,te.value=!1}async function on(n){if(I)if(U.value)await I.write(n);else{const e=await I.mutex.acquire();try{await I.write(n)}finally{e()}}}async function ln(){if(!I)return"";try{await I.write("\r"),U.value=!1}catch(n){Ke.value=!0,U.value=!1,qe.value=n}}async function un(n){if(!I||(U.value&&await I.write("\r"),n.length===0))return;const e=!0,t=-1,i=await ne.begin(I,e);try{Be.value=!1,U.value=!0;const r=!0;await Qt(10),await i.exec(n,t,r),Be.value=!0}catch(r){let s;r instanceof Error?s=r.message:s=String(r),s.includes("KeyboardInterrupt")||(Ke.value=!0,qe.value=r)}finally{I.emit=!1,U.value=!1}await i.end()}async function $e(n){if(!I)return"";let e="";const t=await ne.begin(I);return await Zt(async()=>{const i=await t.readFile(n);e=new TextDecoder("utf-8",{fatal:!0}).decode(i)}),t.end(),e}async function cn(){if(!I)return"";const n=await ne.begin(I),e=await n.getFiles();await n.end();let t="";return Xe(e,"/main.py")?t=await $e("/main.py"):Xe(e,"/code.py")?t=await $e("/code.py"):(t="",await Ze("/main.py",t)),t}async function Ze(n,e){if(!I)return;const t=await ne.begin(I);await en(async()=>await t.writeFile(n,e)),t.end()}const Me=Se("useTerminalStore",()=>{const n=v("");let e="";const t=65536;let i=null;const r=v(0);let s=null;const a=m=>{for(let d=0;d<m.length;d++){let f=m[d];f==="\b"?r.value=Math.max(0,r.value-1):f==="\x1B"?(f=m[++d],f==="["&&(f=m[++d],f==="K"&&(e=e.slice(0,r.value)+n.value.slice(r.value+1),u()))):(e+=f,e.length>t&&(e=e.slice(e.length-t,e.length)),u())}},u=()=>{i||(i=setTimeout(()=>{o(),i=null},1))},o=()=>{n.value=e,r.value=n.value.length,c()},l=()=>{n.value="",e="",r.value=0,i&&(clearTimeout(i),i=null)},c=()=>{s&&(s.scrollTop=s.scrollHeight)};return{output:n,caret:r,write:a,clear:l,openTerminal:m=>{s=m}}}),De=Se("useMPDeviceStore",()=>{const n=v(localStorage.getItem("fileContent")||""),e=v(""),t=v(""),i=v(!1),r=v([]),s=v({name:"",path:"",children:[]});async function a(l,c){r.value=[l],t.value=l,n.value=c}async function u(l){r.value=[l],t.value=l,n.value=await $e(l)}function o(l){n.value=l}return{isProject:i,activeFiles:r,fileContent:n,fileName:e,filePath:t,fileTree:s,openFile:a,loadFile:u,setCode:o}}),pn={key:0,class:"material-icons"},dn={key:1,class:"material-icons"},fn=G({__name:"IdeButtons",setup(n){const e=De(),t=Me(),{isProject:i,filePath:r,fileContent:s,fileTree:a}=de(e),{openFile:u}=e;let o=null;_e(()=>{i.value||(o=setInterval(()=>{localStorage.setItem("fileContent",s.value)},1e3))}),ht(()=>{o&&clearInterval(o)});async function l(){const d=await sn();if(d&&(await rn(d,t.write,()=>{i.value&&(r.value="",s.value=""),a.value={name:"empty",path:"",children:[]}}),t.clear(),i.value)){const f=await cn();u("/main.py",f),a.value=await tn()}}function c(){Y.value?(an(),i.value&&(r.value="",s.value="",a.value={name:"empty",path:"",children:[]})):l()}const p=v(!1);function m(){un(s.value)}return(d,f)=>{const T=Ee;return $(),C("div",null,[V(T,{type:"button",class:J(["w-9 h-9 mr-1 text-white",w(Y)?p.value?"bg-red-500":"bg-green-500":"bg-gray-600"]),rounded:"",text:"",onClick:f[0]||(f[0]=S=>c()),onMouseover:f[1]||(f[1]=S=>p.value=!0),onMouseleave:f[2]||(f[2]=S=>p.value=!1)},{default:K(()=>[p.value&&w(Y)?($(),C("span",pn,"close")):($(),C("span",dn,"cable"))]),_:1},8,["class"]),V(T,{id:"#run",type:"button",class:"w-9 h-9 mr-1",variant:w(U)||!w(Y)?"outlined":void 0,severity:"info",rounded:"",onClick:m,disabled:w(U)||!w(Y),loading:w(U)},{default:K(()=>f[5]||(f[5]=[b("span",{class:"material-icons"},"play_arrow",-1)])),_:1},8,["variant","disabled","loading"]),V(T,{type:"button",class:"w-9 h-9 mr-1",variant:!w(U)||!w(Y)?"outlined":void 0,severity:"danger",rounded:"",onClick:f[3]||(f[3]=S=>w(ln)()),disabled:!w(U)||!w(Y)},{default:K(()=>f[6]||(f[6]=[b("span",{class:"material-icons"},"stop",-1)])),_:1},8,["variant","disabled"]),V(T,{type:"button",class:"w-9 h-9",variant:"outlined",severity:"secondary",rounded:"",onClick:f[4]||(f[4]=S=>w(Ze)(w(r),w(s))),disabled:w(te)||w(U)||!w(Y),loading:w(te)},{default:K(()=>f[7]||(f[7]=[b("span",{class:"material-icons"},"save",-1)])),_:1},8,["disabled","loading"])])}}}),hn={class:"relative flex h-full"},bs=G({__name:"CodeView",setup(n){const e=De(),{fileContent:t}=de(e);return(i,r)=>($(),C("div",hn,[V(_t,{modelValue:w(t),"onUpdate:modelValue":r[0]||(r[0]=s=>vt(t)?t.value=s:null)},null,8,["modelValue"]),r[1]||(r[1]=b("div",{id:"#editor",class:"absolute top-10 left-10"},null,-1)),V(fn,{class:"absolute bottom-2 right-2"})]))}}),vn={class:"flex flex-col h-full"},mn={class:"flex px-2 w-full bg-zinc-900 text-white h-6 justify-between items-center"},wn=G({__name:"TerminalView",setup(n){const e=v(!1),t=Me(),{output:i}=de(t);function r(a){let u=a.key;if(u==="Enter")u=`
\r`;else if(u==="Backspace")u="\b";else if(u.length>1)return;on(u)}const s=v(null);return _e(()=>{t.openTerminal(s.value)}),(a,u)=>{const o=Ee;return $(),C("div",vn,[b("div",mn,[u[4]||(u[4]=b("span",{class:"material-icons"},"terminal",-1)),V(o,{onClick:u[0]||(u[0]=l=>w(t).clear()),class:"w-4 h-4 text-white",link:""},{default:K(()=>u[3]||(u[3]=[b("span",{class:"material-icons",style:{"font-size":"16px"}},"cleaning_services",-1)])),_:1})]),b("pre",{class:"h-full font-mono overflow-auto p-2 text-white bg-black",ref_key:"el",ref:s,tabindex:"0",onKeydown:r,onFocus:u[1]||(u[1]=l=>e.value=!0),onBlur:u[2]||(u[2]=l=>e.value=!1)},[u[5]||(u[5]=Ae("")),b("span",null,ce(w(i)),1),b("span",{class:J([{caret:e.value},"bg-white"])}," ",2),u[6]||(u[6]=Ae(`
    `))],544)])}}}),xs=fe(wn,[["__scopeId","data-v-61224fc2"]]),gn={class:"color-picker select-none w-32"},yn={class:"slider-container"},bn={class:"slider-container"},xn=G({__name:"ColorPicker",props:{modelValue:{required:!0,default:{r:0,g:0,b:0}},modelModifiers:{}},emits:["update:modelValue"],setup(n){const e=mt(n,"modelValue"),{h:t,s:i}=c(e.value.r,e.value.g,e.value.b),r=v(t/360),s=v(),a=v(i/100),u=v();let o=!1,l=!1;function c(g,h,E){g/=255,h/=255,E/=255;const y=Math.max(g,h,E),M=Math.min(g,h,E),X=y-M;let F=0;X!==0&&(y===g?F=(h-E)/X%6:y===h?F=(E-g)/X+2:F=(g-h)/X+4,F=Math.round(F*60),F<0&&(F+=360));const W=(y+M)/2,N=X===0?0:X/(1-Math.abs(2*W-1));return{h:F,s:N*100,l:W*100}}function p(g,h,E){g=g*360%360,h/=100,E/=100;const y=(1-Math.abs(2*E-1))*h,M=y*(1-Math.abs(g/60%2-1)),X=E-y/2;let F=0,W=0,N=0;return 0<=g&&g<60?(F=y,W=M,N=0):60<=g&&g<120?(F=M,W=y,N=0):120<=g&&g<180?(F=0,W=y,N=M):180<=g&&g<240?(F=0,W=M,N=y):240<=g&&g<300?(F=M,W=0,N=y):300<=g&&g<=360&&(F=y,W=0,N=M),{r:Math.round((F+X)*255),g:Math.round((W+X)*255),b:Math.round((N+X)*255)}}function m(g,h,E){const y=(1-E+h)/2;let M;return y===0||y===1?M=0:M=(1-E-h)/(1-Math.abs(2*y-1)),{h:g,s:M*100,l:y*100}}const d=ee(()=>{const{h:g,s:h,l:E}=m(r.value,1-a.value,0),{r:y,g:M,b:X}=p(g,h,E);return e.value={r:y,g:M,b:X},`hsl(${g}turn, ${h}%, ${E}%)`}),f=g=>{l=!l,S(g),window.addEventListener("pointermove",S),window.addEventListener("pointerup",T)},T=()=>{l=!1,window.removeEventListener("pointermove",S),window.removeEventListener("pointerup",T)},S=g=>{if(l){const h=u.value.getBoundingClientRect(),E=Math.min(h.width,Math.max(0,g.clientX-h.left));a.value=E/h.width}},A=g=>{o=!o,_(g),window.addEventListener("pointermove",_),window.addEventListener("pointerup",R)},R=()=>{o=!1,window.removeEventListener("pointermove",_),window.removeEventListener("pointerup",R)},_=g=>{if(o){const h=s.value.getBoundingClientRect(),E=Math.min(h.width,Math.max(0,g.clientX-h.left));r.value=E/h.width}};return(g,h)=>($(),C("div",gn,[b("div",yn,[b("div",{class:"hue-slider",style:{background:"linear-gradient(to right, red, yellow, lime, cyan, blue, magenta, red)"},onPointerdown:A,onPointerup:R,onPointermove:_,ref_key:"hueRef",ref:s},[b("div",{class:"slider-handle",style:H({left:`${r.value*100}%`})},null,4)],544)]),b("div",bn,[b("div",{class:"saturation-slider",style:H({background:`linear-gradient(to right, white, hsl(${r.value}turn, 100%, 50%))`}),onPointerdown:f,onPointerup:T,onPointermove:S,ref_key:"saturationRef",ref:u},[b("div",{class:"slider-handle",style:H({left:`${a.value*100}%`})},null,4)],36)]),Ne(b("div",{class:"color-preview",style:H({backgroundColor:`${d.value}`})},null,4),[[wt,!1]])]))}}),Sn=fe(xn,[["__scopeId","data-v-53a96f93"]]);function _n(n){return gt()?(yt(n),!0):!1}const En=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const zn=Object.prototype.toString,Pn=n=>zn.call(n)==="[object Object]",kn=()=>{};function Ve(n){return Array.isArray(n)?n:[n]}const Ie=En?window:void 0;function et(n){var e;const t=je(n);return(e=t==null?void 0:t.$el)!=null?e:t}function oe(...n){let e,t,i,r;if(typeof n[0]=="string"||Array.isArray(n[0])?([t,i,r]=n,e=Ie):[e,t,i,r]=n,!e)return kn;t=Ve(t),i=Ve(i);const s=[],a=()=>{s.forEach(c=>c()),s.length=0},u=(c,p,m,d)=>(c.addEventListener(p,m,d),()=>c.removeEventListener(p,m,d)),o=ze(()=>[et(e),je(r)],([c,p])=>{if(a(),!c)return;const m=Pn(p)?{...p}:p;s.push(...t.flatMap(d=>i.map(f=>u(c,d,f,m))))},{immediate:!0,flush:"post"}),l=()=>{o(),a()};return _n(l),l}const Ln={page:n=>[n.pageX,n.pageY],client:n=>[n.clientX,n.clientY],screen:n=>[n.screenX,n.screenY],movement:n=>n instanceof Touch?null:[n.movementX,n.movementY]};function Tn(n={}){const{type:e="page",touch:t=!0,resetOnTouchEnds:i=!1,initialValue:r={x:0,y:0},window:s=Ie,target:a=s,scroll:u=!0,eventFilter:o}=n;let l=null,c=0,p=0;const m=v(r.x),d=v(r.y),f=v(null),T=typeof e=="function"?e:Ln[e],S=y=>{const M=T(y);l=y,M&&([m.value,d.value]=M,f.value="mouse"),s&&(c=s.scrollX,p=s.scrollY)},A=y=>{if(y.touches.length>0){const M=T(y.touches[0]);M&&([m.value,d.value]=M,f.value="touch")}},R=()=>{if(!l||!s)return;const y=T(l);l instanceof MouseEvent&&y&&(m.value=y[0]+s.scrollX-c,d.value=y[1]+s.scrollY-p)},_=()=>{m.value=r.x,d.value=r.y},g=o?y=>o(()=>S(y),{}):y=>S(y),h=o?y=>o(()=>A(y),{}):y=>A(y),E=o?()=>o(()=>R(),{}):()=>R();if(a){const y={passive:!0};oe(a,["mousemove","dragover"],g,y),t&&e!=="movement"&&(oe(a,["touchstart","touchmove"],h,y),i&&oe(a,"touchend",_,y)),u&&e==="page"&&oe(s,"scroll",E,{passive:!0})}return{x:m,y:d,sourceType:f}}function tt(n,e={}){const{handleOutside:t=!0,window:i=Ie}=e,r=e.type||"page",{x:s,y:a,sourceType:u}=Tn(e),o=v(n??(i==null?void 0:i.document.body)),l=v(0),c=v(0),p=v(0),m=v(0),d=v(0),f=v(0),T=v(!0);let S=()=>{};return i&&(S=ze([o,s,a],()=>{const A=et(o);if(!A||!(A instanceof Element))return;const{left:R,top:_,width:g,height:h}=A.getBoundingClientRect();p.value=R+(r==="page"?i.pageXOffset:0),m.value=_+(r==="page"?i.pageYOffset:0),d.value=h,f.value=g;const E=s.value-p.value,y=a.value-m.value;T.value=g===0||h===0||E<0||y<0||E>g||y>h,(t||!T.value)&&(l.value=E,c.value=y)},{immediate:!0}),oe(document,"mouseleave",()=>{T.value=!0})),{x:s,y:a,sourceType:u,elementX:l,elementY:c,elementPositionX:p,elementPositionY:m,elementHeight:d,elementWidth:f,isOutside:T,stop:S}}const $n="/assets/yellow_led-TydLrbQ8.jpg";function se(n){return{state:v(0),mode:n}}const Pe=(n={})=>{const{mode0:e="gnd",mode1:t="power",mode2:i="air",mode3:r="air",setShared:s=()=>{},getShared:a=()=>{}}=n,u=se(e),o=se(t),l=se(i),c=se(r);return{pin0:u,pin1:o,pin2:l,pin3:c,setShared:s,getShared:a}},Cn={ref:"theref"},Mn={class:"rounded-lg overflow-hidden relative"},Dn=["src"],In={key:1,class:"absolute top-0 left-0"},Rn=G({__name:"LED",setup(n,{expose:e}){const{isOutside:t}=tt(Ge("theref")),i=Pe({mode2:"input",setShared:m=>{s.value=m.color.value},getShared:()=>({color:s})});e(i);const{pin2:r}=i,s=v({r:255,g:0,b:0}),a=v({visible:!1,toggle:m=>{}});function u(m){a.value.toggle(m)}const o=ee(()=>`
0 0 3px 3px rgba(${s.value.r}, ${s.value.g}, ${s.value.b}, ${r.state.value*.7}),
0 0 5px 5px rgba(${s.value.r}, ${s.value.g}, ${s.value.b}, ${r.state.value*.5}),
0 0 7px 7px rgba(${s.value.r}, ${s.value.g}, ${s.value.b}, ${r.state.value*.3})
`),l=ee(()=>`radial-gradient(circle, rgb(${s.value.r}, ${s.value.g}, ${s.value.b}) 40%, #000 90%)`),c=ee(()=>`rgb(${s.value.r}, ${s.value.g}, ${s.value.b})`),p=ee(()=>`rgba(${s.value.r}, ${s.value.g}, ${s.value.b}, 0.7)`);return(m,d)=>{const f=Ee,T=bt;return $(),C("div",Cn,[b("div",Mn,[b("img",{src:w($n),alt:"LED"},null,8,Dn),b("div",{class:"absolute top-[10px] left-[30px] rounded-full h-[19px] w-[19px]",style:H({background:c.value})},null,4),b("div",{class:"absolute top-[12px] left-[32px] rounded-full h-[15px] w-[15px]",style:H({background:l.value})},null,4),w(r).state.value?($(),C("div",{key:0,class:"absolute top-2 left-7 rounded-full h-6 w-6 p-0 border-none absolute top-0 left-0 overflow-hidden",style:H({boxShadow:o.value,background:p.value})},null,4)):ie("",!0),!w(t)||a.value.visible?($(),C("div",In,[V(f,{type:"button",class:"w-6 h-6 bg-black",rounded:"",onClick:u,onPointerdown:d[0]||(d[0]=ue(()=>{},["stop"]))},{default:K(()=>d[2]||(d[2]=[b("span",{class:"material-icons"},"palette",-1)])),_:1})])):ie("",!0),V(T,{ref_key:"cp",ref:a},{default:K(()=>[V(Sn,{modelValue:s.value,"onUpdate:modelValue":d[1]||(d[1]=S=>s.value=S)},null,8,["modelValue"])]),_:1},512)])],512)}}}),An=fe(Rn,[["__scopeId","data-v-799d0c28"]]),Fn="/assets/push_button-DvCvYEel.jpg",Bn={ref:"theref"},On={class:"rounded-lg overflow-hidden relative"},Un=["src"],Xn=G({__name:"PushButton",setup(n,{expose:e}){const{isOutside:t}=tt(Ge("theref")),i=Pe({mode2:"input",setShared:p=>{s.value=p},getShared:()=>s.value});e(i);const{pin2:r}=i,s=v(""),a=v(!1),u=p=>{!a.value&&p.key.toUpperCase()===s.value&&(r.state.value=1)},o=p=>{!a.value&&p.key.toUpperCase()===s.value&&(r.state.value=0)},l=p=>{a.value&&p.key==="Escape"&&(s.value="",a.value=!1,window.removeEventListener("keydown",l)),a.value&&/^[A-Za-z0-9]$/.test(p.key)&&(s.value=p.key.toUpperCase(),a.value=!1,window.removeEventListener("keydown",l))},c=p=>{p.stopPropagation(),a.value=!0,window.addEventListener("keydown",l)};return _e(()=>{window.addEventListener("keydown",u),window.addEventListener("keyup",o)}),xt(()=>{window.removeEventListener("keydown",u),window.removeEventListener("keyup",o)}),(p,m)=>($(),C("div",Bn,[b("div",On,[b("img",{src:w(Fn),alt:"Push Button"},null,8,Un),b("button",{class:J(["absolute top-[27px] left-[27px] rounded-full w-[25px] h-[25px]",w(r).state.value?"bg-green-500":"bg-purple-500"]),onPointerdown:m[0]||(m[0]=d=>w(r).state.value=1),onPointerup:m[1]||(m[1]=d=>w(r).state.value=0),onPointerleave:m[2]||(m[2]=d=>w(r).state.value=0)},ce(s.value),35),!w(t)||a.value?($(),C("button",{key:0,onClick:c,onPointerdown:m[3]||(m[3]=ue(()=>{},["stop"])),class:"absolute w-full h-4 text-xs top-0 left-0 bg-black/[0.8] text-white rounded-lg"},ce(a.value?"Press a key...":s.value?"Set shortcut":"Add shortcut"),33)):ie("",!0)])],512))}}),Vn="/assets/potentiometer-CklP_JJ1.jpg",Hn={class:"rounded-lg overflow-hidden relative"},Wn=["src"],Yn={class:"absolute rounded-full top-5 left-8 w-10 h-10"},Nn={key:0,class:"absolute bottom-0 left-0 flex items-center"},jn=G({__name:"Potentiometer",setup(n,{expose:e}){const t=Pe({mode2:"input",setShared:p=>{i.state.value=p},getShared:()=>i.state.value});e(t);const{pin2:i}=t,r=ee(()=>i.state.value*6/8-3/8),s=v(!1);let a=!1,u=0;const o=p=>{p.stopPropagation(),p.preventDefault(),a=!a,u=p.clientX,s.value=a,window.addEventListener("pointermove",c),window.addEventListener("pointerup",l)},l=()=>{a=!1,s.value=a,window.removeEventListener("pointermove",c),window.removeEventListener("pointerup",l)},c=p=>{if(a){const m=(p.clientX-u)/20;u=p.clientX,i.state.value=Math.min(1,Math.max(0,i.state.value+m/2))}};return(p,m)=>($(),C("div",null,[b("div",Hn,[b("img",{src:w(Vn),alt:"Potentiometer"},null,8,Wn),b("button",Yn,[b("div",null,[b("div",{class:"top-0 left-0 relative w-10 h-10 rounded-full bg-rose-600 flex items-center justify-center",onPointerdown:o,style:H(`transform: rotate(${r.value}turn)`)},m[1]||(m[1]=[b("div",{class:"absolute top-0 left-4.5 w-1 h-5 bg-white"},null,-1),b("div",{class:"absolute inset-0 flex items-center justify-center pointer-events-none"},null,-1)]),36)])]),s.value?($(),C("div",Nn,[Ne(b("input",{type:"range",min:"0",max:"1",step:"0.01","onUpdate:modelValue":m[0]||(m[0]=d=>w(i).state.value=d),class:"w-full cursor-pointer"},null,512),[[St,w(i).state.value]])])):ie("",!0)])]))}}),Gn="/assets/encoder-BbdKADqm.jpg",Kn="/assets/encoder_knob-Du3tJHEr.png",qn={class:"rounded-lg overflow-hidden relative"},Jn=["src"],Qn=["src"],Zn={key:0,class:"absolute bg-blue-500 top-0 left-4.5 w-1 h-1"},es={class:"absolute bottom-1 left-[25px] flex items-center"},ts=G({__name:"Encoder",setup(n,{expose:e}){const t=Pe({mode1:"input",mode2:"input",setShared:h=>{o.value=h},getShared:()=>o.value});e(t);const{pin0:i,pin1:r,pin2:s,pin3:a}=t,u=ee(()=>i.state.value===0&&r.state.value>0),o=v(0),l=v(!1);let c=!1,p=0,m=0,d=0,f=0,T=0,S=null;const A=h=>{if(h.stopPropagation(),h.preventDefault(),f=Math.atan2(h.clientY-m,h.clientX-p)/(2*Math.PI)+1/4,T=o.value,c=!c,l.value=c,h.currentTarget instanceof HTMLElement){const y=h.currentTarget.getBoundingClientRect();p=y.left+y.width/2,m=y.top+y.height/2}window.addEventListener("pointermove",g),window.addEventListener("pointerup",_)},R=()=>{if(!S)return;let h=d-o.value;h>.5&&(h-=1),h<-.5&&(h+=1);const E=.1;Math.abs(h)>.001?(o.value+=h*E,o.value>1&&(o.value-=1),o.value<0&&(o.value+=1),S=requestAnimationFrame(R)):(o.value=d,cancelAnimationFrame(S),S=null)},_=()=>{const h=.041666666666666664;d=Math.round(o.value/h)*h,S||(S=requestAnimationFrame(R)),c=!1,l.value=c,window.removeEventListener("pointermove",g),window.removeEventListener("pointerup",_)},g=h=>{if(c){let y=Math.atan2(h.clientY-m,h.clientX-p)/(2*Math.PI)+1/4-f;d=T+y,console.log(f,y,o.value,d),S||(S=requestAnimationFrame(R))}};return ze(o,()=>{s.state.value=Math.abs(o.value*96%4)<2?1:0,a.state.value=Math.abs((o.value*96+95)%4)<2?1:0,console.log(s.state.value),console.log(a.state.value)}),(h,E)=>($(),C("div",null,[b("div",qn,[b("img",{src:w(Gn),alt:"Potentiometer"},null,8,Jn),b("button",{class:"absolute rounded-full top-3 left-6 w-14 h-14",onPointerdown:A},[b("img",{class:"top-0 left-0 w-14 h-14",src:w(Kn),style:H(`transform: rotate(${o.value}turn)`)},null,12,Qn),u.value?($(),C("div",Zn)):ie("",!0)],32),b("div",es,[b("div",{class:J(["w-1 h-1 rounded-full",w(s).state.value?"bg-rose-500":"bg-transparent"])},null,2),E[0]||(E[0]=b("div",{class:"w-1 h-1 bg-transparent"},null,-1)),b("div",{class:J(["w-1 h-1 rounded-full",w(a).state.value?"bg-rose-500":"bg-transparent"])},null,2)])])]))}}),ns=G({__name:"Module",setup(n,{expose:e}){const t=se("air"),i=se("air");return e({pin2:t,pin3:i}),(r,s)=>($(),C("div"))}}),He=Me(),{fileContent:ss}=de(De()),is=(n,e)=>{const t=Math.max(0,Math.min(n.x+n.w,e.x+e.w)-Math.max(n.x,e.x)),i=Math.max(0,Math.min(n.y+n.h,e.y+e.h)-Math.max(n.y,e.y));return t*i},rs=Se("emulator",()=>{const n=ae([]),e=ae([An,Xn,jn,ts]),i={x:0,y:0,w:0,h:0,is:ns,on:-1,ref:{pin2:{state:{value:0},mode:"none"},pin3:{state:{value:0},mode:"none"}},style:{},class:""},r=nt(),s=v(!1),a=v(null),u=v(null),o=v(!1),l=v(!1),c=v(!1),p={x:203,y:48,w:40,h:20},m={x:242,y:40,w:8,h:8},d=ae({}),f=ae([{id:"A",pin2:0,pin3:1,pin2State:0,pin3State:0,with:i,x:69,y:49,w:80,h:80,style:{},class:""},{id:"B",pin2:2,pin3:3,pin2State:0,pin3State:0,with:i,x:69,y:152,w:80,h:80,style:{},class:""},{id:"C",pin2:28,pin3:22,pin2State:0,pin3State:0,with:i,x:69,y:255,w:80,h:80,style:{},class:""},{id:"D",pin2:4,pin3:5,pin2State:0,pin3State:0,with:i,x:297,y:49,w:80,h:80,style:{},class:""},{id:"E",pin2:6,pin3:7,pin2State:0,pin3State:0,with:i,x:297,y:152,w:80,h:80,style:{},class:""},{id:"F",pin2:26,pin3:27,pin2State:0,pin3State:0,with:i,x:297,y:255,w:80,h:80,style:{},class:""}]),T={0:0,1:0,2:1,3:1,28:2,22:2,4:3,5:3,6:4,7:4,26:5,27:5};function S(z){const P={x:0,y:0,w:80,h:80,is:z.is,on:0,ref:{setShared:j=>{}},class:"",style:{}};n.push(P);const D=z.ref.getShared();return xe(()=>{P.ref.setShared(D)}),P}function A(z,P,D){return q=>{if(!z)return;z.x=q.clientX-P,z.y=q.clientY-D;const k=[0,0,0,0,0,0];for(const[L,O]of f.entries())k[L]=is(z,O);let x=0;for(let L=1;L<k.length;L++)k[L]>k[x]&&(x=L);k[x]==0?u.value=null:u.value=x,s.value=z.y>400}}function R(z,P){P.x=f[z].x,P.y=f[z].y,f[z].with=P,P.on=z,xe(()=>{P.ref.pin2.mode==="output"&&(P.ref.pin2.state.value=f[z].pin2State),P.ref.pin3.mode==="output"&&(P.ref.pin3.state.value=f[z].pin3State)})}function _(z){f[z].with=i}let g,h;function E(){o.value=!0,r.clearDisplay(),g=new Worker(new URL("/assets/mpWorker-7i6aPlnQ.js",import.meta.url),{type:"module"}),l.value=!0,g.onmessage=z=>{const{command:P,data:D,sharedBuffer:j,sharedArrayInterrupt:q}=z.data;if(P==="error")He.write(D),c.value=!1,M.value=!1;else if(P==="finished")console.log("Finished"),c.value=!1;else if(P==="initialized")console.log("Inited"),o.value=!1,h=q;else if(P==="output")He.write(D);else if(P==="on"){const{pin:k}=D,x=f[T[k]];k===x.pin2&&(x.pin2State=1,x.with.ref.pin2.state.value=1),k===x.pin3&&(x.pin3State=1,x.with.ref.pin3.state.value=1)}else if(P==="off"){const{pin:k}=D,x=f[T[k]];k===x.pin2&&(x.pin2State=0,x.with.ref.pin2.state.value=0),k===x.pin3&&(x.pin3State=0,x.with.ref.pin3.state.value=0)}else if(P==="value"){const{pin:k}=D,x=f[T[k]];let L;k===x.pin2&&(L=x.with.ref.pin2.state.value),k===x.pin3&&(L=x.with.ref.pin3.state.value);const O=new Int32Array(j);Atomics.store(O,1,L),Atomics.store(O,0,1),Atomics.notify(O,0,1)}else if(P==="duty_u16"){const{pin:k,duty_u16:x}=D,L=f[T[k]];k===L.pin2&&(L.pin2State=x/65535,L.with.ref.pin2.state.value=x/65535),k===L.pin3&&(L.pin3State=x/65535,L.with.ref.pin3.state.value=x/65535)}else if(P==="adc read_u16"){const{pin:k}=D,x=f[T[k]];let L;k===x.pin2&&(L=x.with.ref.pin2.state.value),k===x.pin3&&(L=x.with.ref.pin3.state.value);const O=new Int32Array(j);Atomics.store(O,1,L*65535),Atomics.store(O,0,1),Atomics.notify(O,0,1)}else if(P==="display_text"){const{text:k,x,y:L}=D;r.writeText(k,x,L)}else if(P==="clear_display")r.clearDisplay();else if(P==="i2c_read"){const{addr:k,nbytes:x,sharedBuffer:L}=D,O=new Int32Array(L);console.log(`I2C Read from Address: ${k}, Bytes: ${x}`);for(let Q=0;Q<x;Q++)O[Q+1]=Math.floor(Math.random()*256);Atomics.store(O,0,1),Atomics.notify(O,0,1)}}}function y(){c.value=!0,h[0]=0,g.postMessage({command:"runPython",code:ss.value})}const M=v(!1);function X(){M.value=!0,h[0]=2}function F(){g.terminate(),c.value=!1,o.value=!1,l.value=!1,g.onmessage=null}function W(z,P){const D=f[z].with,j=f[P].with;R(P,D),R(z,j)}function N(z,P,D,j){z.style={zIndex:"2"};const q=f[D];a.value=D;const k=j.clientX-z.x,x=j.clientY-z.y,L=A(z,k,x),O=z.x,Q=z.y,he=()=>{u.value===null?(s.value&&(q.with=i,n.splice(P,1)),z.x=O,z.y=Q):W(D,u.value),document.removeEventListener("pointermove",L),document.removeEventListener("pointerup",he),s.value=!1,a.value=null,u.value=null,z.style={zIndex:"1"}};document.addEventListener("pointermove",L),document.addEventListener("pointerup",he)}function st(z,P,D){if(D.currentTarget instanceof HTMLElement){const L=D.currentTarget,O=L.parentElement.parentElement,{top:Q,left:he,width:it,height:rt}=L.getBoundingClientRect(),{top:at,left:ot}=O.getBoundingClientRect();d.x=he-ot,d.y=Q-at,d.w=it,d.h=rt}d.is=z,xe(()=>{d.ref.setShared(P.getShared())});const j=D.clientX-d.x,q=D.clientY-d.y,k=A(d,j,q),x=()=>{if(d){if(u.value===null)s.value&&(d.x=0,d.y=0,d.is=i);else{const L=n.indexOf(f[u.value].with);L>-1&&n.splice(L,1),_(u.value),R(u.value,S(d))}u.value=null,d.is=i,d.x=0,d.y=0,s.value=!1,document.removeEventListener("pointermove",k),document.removeEventListener("pointerup",x)}};document.addEventListener("pointermove",k),document.addEventListener("pointerup",x)}return{usb:p,onLED:m,NoneModule:i,maxAreaIndex:u,fromSlotIndex:a,toDelete:s,slots:f,moduleComponents:e,modules:n,addModuleToSlot:R,removeModuleFromSlot:_,dragged:d,startDragFromSlot:N,startDragFromModuleList:st,connect:E,run:y,stop:X,disconnect:F,isRunning:c,isStopping:M,isLoading:o,isConnected:l,newPiModule:S}}),nt=Se("useST7789",()=>{const n=v(""),e=v(0),t=v(0),i=v("#000000");function r(a,u,o,l){n.value+=a+`\r
`,e.value=u,t.value=o,l&&(i.value=l)}function s(){n.value="",e.value=0,t.value=0,i.value="#000000"}return{text:n,x:e,y:t,textColor:i,writeText:r,clearDisplay:s}}),as=["width","height"],Z=12,os=G({__name:"Display",setup(n){const e=v(112),t=v(160),i=v(null),r=v(null),s=v(0),a=nt();a.text||(a.text="");function u(c){const p=c.deltaY>0?1:-1;s.value+=p*Z,s.value=Math.max(0,s.value);const{lines:m,visibleLines:d}=o();console.log(m.length,s.value),s.value=Math.min(m.length*Z,s.value),l(m,d)}function o(){const c=[];let p=0;return r.value&&a.text&&(String(a.text).split(`
`).forEach(d=>{let f="";d.split(" ").forEach(S=>{const A=f+S+" ";r.value.measureText(A).width>e.value?(c.push(f),f=S+" "):f=A}),c.push(f)}),p=Math.ceil(t.value/Z)),{lines:c,visibleLines:p}}function l(c,p){if(r.value){r.value.fillStyle="#FFFFFF",r.value.fillRect(0,0,e.value,t.value),r.value.fillStyle=String(a.textColor)||"#000000",r.value.font="12px Monaco";const m=Math.floor(s.value/Z);for(let d=0;d<p;d++){const f=m+d;if(f<c.length){const T=(d+1)*Z-s.value%Z;r.value.fillText(c[f],0,T)}}}else console.warn("Canvas context is not initialized.")}return ze(()=>[a.text,a.textColor],()=>{const{lines:c,visibleLines:p}=o();s.value=Math.max(0,(c.length-p)*Z),console.log(s.value,c.length,p),l(c,p)}),_e(async()=>{if(await xe(),console.log("onMounted called"),!i.value){console.error("Canvas element not found!");return}if(r.value=i.value.getContext("2d"),r.value){console.log("Canvas context successfully initialized."),r.value.fillStyle="#FFFFFF",r.value.fillRect(0,0,e.value,t.value),console.log("Initial text:",a.text);const{lines:c,visibleLines:p}=o();console.log("Lines:",c,"Visible Lines:",p),s.value=0,l(c,p)}else console.error("Failed to initialize canvas context.")}),(c,p)=>($(),C("div",{class:"display-container",onWheel:u},[b("canvas",{ref_key:"canvas",ref:i,width:e.value,height:t.value,style:{border:"1px solid black",width:"112px",height:"160px"}},null,8,as)],32))}}),ls=fe(os,[["__scopeId","data-v-7ff5a871"]]),us={class:"h-full parent relative flex flex-col border-t border-surface overflow-auto select-none"},cs={id:"pibody",class:"relative h-[450px] flex-shrink-0 max-h-[calc(100%-100px)] overflow-auto"},ps={class:"absolute top-4 right-1 flex flex-col gap-1"},ds={class:"material-icons"},fs={class:"material-icons"},hs=G({__name:"SimulationView",setup(n){const e=rs(),{maxAreaIndex:t,isLoading:i,isStopping:r,isRunning:s,isConnected:a,fromSlotIndex:u,toDelete:o,slots:l,dragged:c,moduleComponents:p,modules:m}=de(e),d=ae([]);e.connect();function f(){a.value?e.run():e.connect()}return(T,S)=>{const A=Et,R=Ee;return $(),C("div",us,[b("div",cs,[V(A,{src:w(zt),width:"384px",draggable:"false",class:"absolute pt-4 min-w-[384px]",style:{left:"32px",top:"0px"}},null,8,["src"]),V(ls,{class:"absolute top-[213px] left-[167px] w-[112px] h-[160px]"}),b("div",ps,[V(R,{id:"#run",type:"button",class:"w-9 h-9 mr-1",severity:"info",rounded:"",onClick:f,disabled:w(i)||w(s)},{default:K(()=>[b("span",ds,ce(w(i)?"hourglass_top":"play_arrow"),1)]),_:1},8,["disabled"]),V(R,{type:"button",class:"w-9 h-9 mr-1",variant:w(s)?void 0:"outlined",severity:"danger",rounded:"",onClick:S[0]||(S[0]=_=>w(e).stop()),disabled:!w(s)||!w(a)},{default:K(()=>[b("span",fs,ce(w(r)?"hourglass_top":"stop"),1)]),_:1},8,["variant","disabled"])]),($(!0),C(le,null,we(w(l),(_,g)=>($(),C("div",{key:g,class:J(["absolute w-20 h-20 border rounded-lg text-center",[{"bg-green-200/[0.5]":w(t)==g,"bg-blue-200/[0.5]":w(u)==g},_.class]]),style:H([_.style,{left:_.x+"px",top:_.y+"px"}])},null,6))),128)),b("div",{class:"absolute",style:H({left:w(e).onLED.x+"px",top:w(e).onLED.y+"px",width:w(e).onLED.w+"px",height:w(e).onLED.h+"px"})},null,4)]),($(!0),C(le,null,we(w(m),(_,g)=>($(),C("div",{key:g},[($(),ge(ye(_.is),{style:H([_.style,{left:_.x+"px",top:_.y+"px"}]),class:J([_.class,"absolute w-20 h-20 border-sm rounded-xl overflow-hidden"]),onPointerdown:[h=>w(e).startDragFromSlot(_,g,_.on,h),S[1]||(S[1]=ue(h=>h.preventDefault(),["prevent"]))],ref_for:!0,ref:h=>_.ref=h},null,40,["style","class","onPointerdown"]))]))),128)),b("div",{class:J(["w-full overflow-auto flex flex-wrap bg-white gap-2 flex-grow justify-center",{"bg-rose-500":w(o)}])},[($(!0),C(le,null,we(w(p),(_,g)=>($(),ge(ye(_),{ref_for:!0,ref:h=>d.push(h),onPointerdown:[h=>w(e).startDragFromModuleList(_,d[g],h),S[2]||(S[2]=ue(h=>h.preventDefault(),["prevent"]))],class:"w-20 h-20 border-sm cursor-move"},null,40,["onPointerdown"]))),256))],2),($(),ge(ye(w(c).is),{ref:_=>w(c).ref=_,onDragover:S[3]||(S[3]=ue(_=>_.preventDefault(),["prevent"])),style:H({left:w(c).x+"px",top:w(c).y+"px",position:"absolute",zIndex:2}),class:"dragged w-20 m-2 h-20 border-sm rounded-xl text-center overflow-hidden bg-purple-700"},null,40,["style"]))])}}}),Ss=fe(hs,[["__scopeId","data-v-72e044fc"]]);export{Ss as S,xs as T,bs as _,Vt as a,Rt as s,De as u};
