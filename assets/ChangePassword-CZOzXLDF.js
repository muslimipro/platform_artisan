import{s as C}from"./index-C7X-J-Qf.js";import{h as N,z as m,s as j}from"./index-BQ9GYoE1.js";import{d as A,u as L,r as P,G as q,o as e,f as p,w as r,b as t,e as a,t as l,c as i,i as w,F as g,h as v,j as D,s as E}from"./index-DcyBeJgC.js";import{s as G}from"./index-gHHiHdoU.js";import{s as I}from"./index-D33CKrbu.js";import{s as O}from"./index-oVxsVG1C.js";import{S as T}from"./index-aHnXE6gR.js";import"./index-C5SrmfWd.js";import"./index-BHfeFhRm.js";import"./index-BS_i5v3E.js";import"./index-dDCPORGv.js";import"./index-seXcSKnd.js";const Z={class:"flex flex-col gap-1"},H={for:"old_password"},J={class:"my-0 flex flex-col gap-1"},K={class:"flex flex-col gap-1"},Q={for:"new_password"},R={class:"my-0 flex flex-col gap-1"},U={class:"flex flex-col gap-1"},W={for:"confirm_password"},X={class:"my-0 flex flex-col gap-1"},ps=A({__name:"ChangePassword",setup(Y){const h=L(),n=P(!1),{t:y}=q(),S=P({old_password:"",new_password:""}),F=N(m.object({old_password:m.string().min(1,{message:"Old password is required."}).max(100,{message:"Maximum 100 characters."}),new_password:m.string().min(8,{message:"Minimum 8 characters."}).max(100,{message:"Maximum 100 characters."}).refine(s=>/[a-z]/.test(s),{message:"Must have a lowercase letter."}).refine(s=>/[A-Z]/.test(s),{message:"Must have an uppercase letter."}).refine(s=>/[0-9]/.test(s),{message:"Must have a number."}),confirm_password:m.string()}).refine(s=>s.new_password===s.confirm_password,{message:"Passwords must match",path:["confirm_password"]})),V=async s=>{if(!n.value&&s.valid){n.value=!0;try{await T.changePassword(s.states.old_password.value,s.states.new_password.value),h.add({severity:"success",summary:y("pages.settings.passwordSaved"),life:2e3})}catch(b){h.add({severity:"error",summary:y("pages.settings.passwordSaveFailed"),detail:b,life:2e3})}finally{n.value=!1}}};return(s,b)=>{const u=O,f=I,_=G,z=E,B=j,$=C;return e(),p($,{class:"flex-grow",header:s.$t("pages.settings.changePassword")},{default:r(()=>[t(B,{initialValues:S.value,resolver:D(F),onSubmit:V,class:"flex flex-col gap-2"},{default:r(o=>{var x,k,M;return[a("div",Z,[t(f,{variant:"on"},{default:r(()=>[t(u,{id:"old_password",name:"old_password",feedback:!1,toggleMask:"",fluid:"",class:"w-full sm:w-96"}),a("label",H,l(s.$t("pages.settings.oldPassword")),1)]),_:1}),(x=o.old_password)!=null&&x.invalid?(e(),p(_,{key:0,severity:"error",size:"small",variant:"simple"},{default:r(()=>[a("ul",J,[(e(!0),i(g,null,w(o.old_password.errors,(d,c)=>(e(),i("li",{key:c},l(d.message),1))),128))])]),_:2},1024)):v("",!0)]),a("div",K,[t(f,{variant:"on"},{default:r(()=>[t(u,{id:"new_password",name:"new_password",feedback:!1,toggleMask:"",fluid:"",class:"w-full sm:w-96"}),a("label",Q,l(s.$t("pages.settings.newPassword")),1)]),_:1}),(k=o.new_password)!=null&&k.invalid?(e(),p(_,{key:0,severity:"error",size:"small",variant:"simple"},{default:r(()=>[a("ul",R,[(e(!0),i(g,null,w(o.new_password.errors,(d,c)=>(e(),i("li",{key:c},l(d.message),1))),128))])]),_:2},1024)):v("",!0)]),a("div",U,[t(f,{variant:"on"},{default:r(()=>[t(u,{id:"confirm_password",name:"confirm_password",feedback:!1,toggleMask:"",fluid:"",class:"w-full sm:w-96"}),a("label",W,l(s.$t("pages.settings.confirmPassword")),1)]),_:1}),(M=o.confirm_password)!=null&&M.invalid?(e(),p(_,{key:0,severity:"error",size:"small",variant:"simple"},{default:r(()=>[a("ul",X,[(e(!0),i(g,null,w(o.confirm_password.errors,(d,c)=>(e(),i("li",{key:c},l(d.message),1))),128))])]),_:2},1024)):v("",!0)]),t(z,{type:"submit",label:s.$t("pages.settings.savePassword"),class:"w-fit",loading:n.value,disabled:n.value},null,8,["label","loading","disabled"])]}),_:1},8,["initialValues","resolver"])]),_:1},8,["header"])}}});export{ps as default};
