import{S as se,_ as ae,T as ie,s as le,a as oe}from"./SimulationView-B_kJg7c3.js";import{_ as ne}from"./IdeHeader.vue_vue_type_script_setup_true_lang-B3XCj3BX.js";import{s as re}from"./index-DEjeiKOT.js";import{s as ce}from"./index-LWceEU3M.js";import{d as E,ag as ue,ae as C,h,i as de,o as S,c as b,a as o,b as t,w as a,t as d,u as l,l as ve,F as A,n as pe,ar as fe,x as me,s as ye,A as _e}from"./index-CN0vLODe.js";import{f as O,d as z,j as he,k as ge}from"./index-D60eMmph.js";import{a as we}from"./index-CkQhOb_O.js";import{u as Se}from"./editor-store-JGYx2I6W.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./logo-Qfc1U5yA.js";import"./pibody-BwAjMvHk.js";import"./index-B8UTu9zp.js";const be={class:"material-icons"},Re={class:"material-icons"},Te={class:"material-icons"},xe={class:"material-icons"},ke={class:"material-icons"},Ce={class:"flex"},ze={class:"material-icons"},Ae=E({__name:"TesterControls",setup(P){var B;const{locale:N}=ue(),R=Se(),{saveTest:f,removeTest:T,setStepSaving:V}=R,{lesson:U,stepIndex:$}=C(R);let n=null,x=[];if($.value!=null&&(n=((B=U.value)==null?void 0:B.steps[$.value])??null,n&&(x=n.inner.tests??[],O().setCode(n.inner.solution??""),n.inner.highlights!=null))){z().clearSlots();for(const e of n.inner.highlights)z().newModuleToSlot(e.module,e.slot)}console.log(x);const q=fe();parseInt(q.params.index);const{fileContent:F}=C(O()),r=z(),{isLoading:v,isReplaying:J,isReplayTimeout:G}=C(r),p=h({activity:[],userActivity:[]}),g=h({activity:[],userActivity:[]}),c=h({activity:[],userActivity:[]}),L=h("");let w="",y=[];const m=h(null),D=de();function H(){y=[];for(const e of r.getSlots())y.push(e.with.type);w=F.value,r.startRecording()}function K(){p.value=r.stopRecording()}function Q(){he(p.value.activity,p.value.userActivity,w,y,L.value)}const W=async e=>{var i;const s=(i=e.target.files)==null?void 0:i[0];if(s)try{m.value=await ge(s),c.value.activity=m.value.activity,c.value.userActivity=m.value.userActivity,w=m.value.code,L.value=m.value.name,y=m.value.moduleList,console.log("Loaded Test Data:",m.value)}catch(_){console.error("Error loading JSON:",_)}};function X(e,s){const i={},_=Math.min(e.length,s.length);for(let u=0;u<_;u++)JSON.stringify(e[u])!==JSON.stringify(s[u])&&(i[u]={loaded:{...e[u].what},replayed:{...s[u].what}});return i}function I(){r.startReplaying(c.value.userActivity,c.value.activity.length);const e=_e(J,()=>{if(!J.value){g.value=r.getRecordedResults();let s="error";console.log(X(c.value.activity,g.value.activity)),JSON.stringify(c.value.activity)===JSON.stringify(g.value.activity)&&(s="success"),D.add({severity:s,summary:"Replayed",life:3e3}),r.stop()}G.value&&D.add({severity:"warn",summary:"Replay timeout",life:3e3}),e.stop()})}const Y=async()=>{F.value=w;for(let e=0;e<y.length;e++){const s=y[e];r.newModuleToSlotIndex(s,e)}me(()=>{I()})},Z=async()=>{I()};async function j(){if(n!=null){V(!0);try{await we.updateStepTranslationByID(n.id,N.value,n.title,n.inner)}catch(e){console.log(e)}finally{V(!1)}}}function ee(e,s){e.activity=p.value.activity,e.userActivity=p.value.userActivity,f(e,s),j()}return(e,s)=>{const i=ye,_=ce,u=re;return S(),b(A,null,[o("div",null,[t(i,{type:"button",class:"w-9 h-9 mr-1",severity:"success",rounded:"",onClick:H,disabled:l(v)||l(r).isRecording},{default:a(()=>[o("span",be,d(l(v)?"hourglass_top":"play_arrow"),1)]),_:1},8,["disabled"]),t(i,{type:"button",class:"w-9 h-9 mr-1",severity:"danger",rounded:"",onClick:K,disabled:l(v)||!l(r).isRecording},{default:a(()=>[o("span",Re,d(l(v)?"hourglass_top":"stop"),1)]),_:1},8,["disabled"]),t(i,{type:"button",class:"w-9 h-9 mr-1",severity:"info",rounded:"",onClick:Q,disabled:p.value.activity.length<=0},{default:a(()=>[o("span",Te,d(l(v)?"hourglass_top":"save"),1)]),_:1},8,["disabled"])]),o("div",null,[t(i,{type:"button",class:"w-9 h-9 mr-1",severity:"info",rounded:"",onClick:Y,disabled:c.value.activity.length<=0},{default:a(()=>[o("span",xe,d(l(v)?"hourglass_top":"bug_report"),1)]),_:1},8,["disabled"]),t(i,{type:"button",class:"w-9 h-9 mr-1",severity:"warn",rounded:"",onClick:Z,disabled:c.value.activity.length<=0},{default:a(()=>[o("span",ke,d(l(v)?"hourglass_top":"task"),1)]),_:1},8,["disabled"]),t(_,{type:"file",onChange:W,accept:"application/json",placeholder:"Name"})]),ve(" Recorded: "+d(p.value.activity.length)+" Replayed: "+d(g.value.activity.length)+" Loaded: "+d(c.value.activity.length)+" ",1),(S(!0),b(A,null,pe(l(x),(k,te)=>(S(),b("div",null,[o("div",Ce,[t(u,{variant:"on",class:"w-full"},{default:a(()=>[s[0]||(s[0]=o("label",{for:"name"},"Name",-1)),t(_,{id:"name",modelValue:k.name,"onUpdate:modelValue":M=>k.name=M,"aria-describedby":"username-help",class:"w-full",size:"small"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(i,{type:"button",class:"w-9 h-9 mr-1",severity:"info",rounded:"",onClick:M=>ee(k,te),disabled:p.value.activity.length<=0},{default:a(()=>[o("span",ze,d(l(v)?"hourglass_top":"save"),1)]),_:2},1032,["onClick","disabled"])])]))),256))],64)}}}),Ne={class:"flex bg-surface-0",style:{height:"calc(100vh - 52px)"}},Ue=E({__name:"TesterView",setup(P){return(N,R)=>{const f=le,T=oe;return S(),b(A,null,[t(ne),o("div",Ne,[t(T,{class:"w-full rounded-none"},{default:a(()=>[t(f,{size:50,minSize:10,class:"max-w-[467px] w-full"},{default:a(()=>[t(se)]),_:1}),t(f,{size:50,minSize:10},{default:a(()=>[t(T,{layout:"vertical",class:"h-full w-full"},{default:a(()=>[t(f,{size:65,minSize:10},{default:a(()=>[t(ae)]),_:1}),t(f,{size:35,minSize:10},{default:a(()=>[t(ie)]),_:1})]),_:1})]),_:1}),t(f,{size:50,minSize:10},{default:a(()=>[t(Ae)]),_:1})]),_:1})])],64)}}});export{Ue as default};
