import{s as D}from"./index-BFamOs9l.js";import{d as N,u as j,r as R,c as h,a as w,b as m,i as b,w as C,h as f,t as B,g as l,l as F,m as S,s as T,e as k,F as L,k as A,f as n,p as K,o as M}from"./index-Bzt9KOfG.js";import{_ as P}from"./MainHeader.vue_vue_type_script_setup_true_lang-DUAJZdcH.js";import{R as $,m as U}from"./mapRouteFromDto-Lt7Xchvy.js";import{g as q,f as g}from"./groupRoutesByType-B8LQ_TR7.js";import{s as E}from"./index-BErXl6Bn.js";import"./index-DHTb8XB-.js";import"./index-B-4jWEMH.js";import"./index-Dxv-j-XW.js";import"./http-j2rGyWLF.js";import"./mapLessonFromDto-Dmd7ExqT.js";import"./mapUnitFromDto-CYGc5n9V.js";const V=N("routes-store",()=>{const d=j(),e=R([]),t=R(!1),s=R(!1);async function i(){try{t.value=!0;const{data:r}=await $.getRoutes();e.value=(r==null?void 0:r.map(U))??[]}catch(r){d.add({severity:"error",summary:r,life:2e3})}finally{t.value=!1}}async function a(r){try{s.value=!0;const{data:y}=await $.createRoute(r);await i(),d.add({severity:"success",summary:y.message,life:2e3})}catch(y){d.add({severity:"error",summary:y.response.data.error,life:2e3})}finally{s.value=!1}}const u=h(()=>q(e.value)),_=h(()=>g(e.value,"main")),v=h(()=>g(e.value,"side")),o=h(()=>g(e.value,"one_kit")),p=h(()=>g(e.value,"hackathon"));return{routes:e,isLoading:t,isCreating:s,loadRoutes:i,createRoute:a,groupedRoutes:u,mainRoutes:_,sideRoutes:v,oneKitRoutes:o,hackathonRoutes:p}}),G={class:"flex flex-col items-center"},H={class:"text-md font-medium text-gray-600"},I=w({__name:"RouteCard",props:{route:{}},setup(d){const e=F();return(t,s)=>{const i=S;return m(),b(i,{class:"p-4 border rounded-md bg-white shadow-sm w-40 h-24",variant:"outlined",severity:"secondary",onClick:s[0]||(s[0]=a=>l(e).push({name:"route-edit",params:{id:t.route.id}}))},{default:C(()=>[f("div",G,[f("div",H,B(t.route.name),1)])]),_:1})}}}),O={class:"flex flex-col gap-2"},z={class:"text-lg font-semibold"},J={class:"flex flex-wrap gap-2"},Q={class:"flex justify-end gap-2"},x=w({__name:"RouteGroup",props:{title:{},type:{},routes:{}},setup(d){const e=d,t=V(),{isCreating:s}=T(t),{createRoute:i}=t,a=R(!1),u=R("");async function _(){await i({name:u.value,description:"",route_type:e.type}),a.value=!1}return(v,o)=>{const p=S,r=E,y=K;return m(),k("div",O,[f("div",z,B(v.title),1),f("div",J,[(m(!0),k(L,null,A(v.routes,c=>(m(),b(I,{key:c.id,route:c},null,8,["route"]))),128)),n(p,{icon:"pi pi-plus",label:"Add",variant:"outlined",class:"w-40 h-24",onClick:o[0]||(o[0]=c=>{a.value=!0,u.value=""})}),n(y,{visible:a.value,"onUpdate:visible":o[3]||(o[3]=c=>a.value=c),modal:"",header:"Create new level",style:{width:"25rem"}},{default:C(()=>[n(r,{modelValue:u.value,"onUpdate:modelValue":o[1]||(o[1]=c=>u.value=c),id:"name",class:"w-full mb-4",autocomplete:"off",placeholder:"Name"},null,8,["modelValue"]),f("div",Q,[n(p,{type:"button",label:"Cancel",severity:"secondary",onClick:o[2]||(o[2]=c=>a.value=!1)}),n(p,{type:"button",label:"Create",loading:l(s),disabled:l(s),onClick:_},null,8,["loading","disabled"])])]),_:1},8,["visible"])])])}}}),W={class:"flex flex-col items-center h-screen"},X={class:"w-full h-full max-w-screen-xl px-4 md:px-28 py-8"},Y={key:1,class:"flex flex-col gap-8 py-8"},Z={class:"flex gap-8"},pe=w({__name:"RoutesPage",setup(d){const e=V(),{isLoading:t,mainRoutes:s,sideRoutes:i,oneKitRoutes:a,hackathonRoutes:u}=T(e),{loadRoutes:_}=e;return M(_),(v,o)=>{const p=D;return m(),k("div",W,[n(l(P)),f("div",X,[l(t)?(m(),b(p,{key:0,class:"flex justify-center"})):(m(),k("div",Y,[f("div",Z,[n(x,{class:"flex-1",title:"Main",type:"main",routes:l(s)},null,8,["routes"]),n(x,{class:"flex-1",title:"Side quests",type:"side",routes:l(i)},null,8,["routes"])]),n(x,{title:"One project - one kit",type:"one_kit",routes:l(a)},null,8,["routes"]),n(x,{title:"Hackathon",type:"hackathon",routes:l(u)},null,8,["routes"])]))])])}}});export{pe as default};
