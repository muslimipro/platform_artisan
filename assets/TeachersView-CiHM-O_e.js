import{s as z,a as E}from"./index-BFcyraEE.js";import{s as G}from"./index-Dfgxu3Q5.js";import{a as H,s as K}from"./index-DmQEPo33.js";import{s as B}from"./index-dDCPORGv.js";import{d as S,u as N,G as M,a3 as L,r as y,o as m,f as T,w as l,e as d,t as i,b as a,s as U,_ as J,z as Q,A as W,c as D,j as $,h as x,g as p,aF as X}from"./index-DcyBeJgC.js";import{u as j,S as P}from"./useSchoolStore-CPQs3ylp.js";import{s as Y}from"./index-d4SORqJN.js";import"./index-Dm115m7X.js";import"./index-BauW75GO.js";import"./index-Dzo9KCOb.js";import"./index-CcCvklg2.js";import"./index-N8YLxu86.js";import"./index-C5SrmfWd.js";import"./index-CCrQOVR9.js";import"./index-BHfeFhRm.js";import"./index-seXcSKnd.js";const Z={class:"flex flex-col gap-1"},ee={class:"flex flex-col"},oe={class:"font-bold text-sm mb-1"},se={class:"flex gap-2 justify-end"},ae=S({__name:"InviteTeacherDialog",props:{modelValue:{type:Boolean,required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(I){const v=N(),V=j(),{loadTeachers:n}=V,{t:f}=M(),r=L(I,"modelValue"),h=y(""),u=y(!1);async function g(){u.value=!0;try{await P.inviteTeacher(h.value),await n(),v.add({severity:"success",summary:f("pages.school.teacherInvited"),life:2e3}),r.value=!1}catch(c){v.add({severity:"error",summary:f("pages.school.teacherInvitationFailed"),detail:c,life:2e3})}finally{u.value=!1}}return(c,t)=>{const C=B,w=Y,b=U,o=J;return m(),T(o,{visible:r.value,"onUpdate:visible":t[2]||(t[2]=s=>r.value=s),modal:"",draggable:!1,class:"m-4 max-w-md",header:c.$t("pages.school.inviteTeacher")},{default:l(()=>[d("div",Z,[d("div",ee,[d("div",oe,i(c.$t("pages.school.email")),1),a(C,{type:"text",modelValue:h.value,"onUpdate:modelValue":t[0]||(t[0]=s=>h.value=s)},null,8,["modelValue"])]),a(w),d("div",se,[a(b,{label:c.$t("pages.school.cancel"),severity:"secondary",onClick:t[1]||(t[1]=s=>r.value=!1)},null,8,["label"]),a(b,{label:c.$t("pages.school.invite"),onClick:g,loading:u.value,disabled:u.value},null,8,["label","loading","disabled"])])])]),_:1},8,["visible","header"])}}}),le={class:"flex-grow min-w-0 pb-4 mb-4 bg-white rounded-md border"},te={class:"flex items-center"},ie={class:"flex-grow flex gap-2 items-center"},ne={key:0,class:"text-2xl"},ke=S({__name:"TeachersView",setup(I){const v=N(),V=Q(),{t:n}=M(),f=j(),{teachers:r,isLoading:h}=W(f),{loadTeachers:u}=f,g=y(!1),c=y(),t=y();(()=>{t.value={global:{value:null,matchMode:X.CONTAINS}}})();function w(o){V.require({message:n("pages.school.confirmDelete"),header:n("pages.school.confirmHeader"),icon:"pi pi-exclamation-triangle",rejectProps:{label:n("pages.school.confirmCancel"),severity:"secondary",outlined:!0},acceptProps:{label:n("pages.school.confirmDeleteBtn"),severity:"danger"},accept:async()=>{b(o)}})}async function b(o){try{await P.deleteTeacher(o),u(),v.add({severity:"success",summary:n("pages.school.teacherInviteRemoved"),life:2e3})}catch(s){v.add({severity:"error",summary:n("pages.school.teacherInvitationFailed"),detail:s,life:2e3})}}return(o,s)=>{const F=U,A=H,R=B,q=K,_=z,k=G,O=E;return m(),D("div",le,[a(O,{ref_key:"dt",ref:c,filters:t.value,"onUpdate:filters":s[2]||(s[2]=e=>t.value=e),value:$(r),dataKey:"id",loading:$(h),scrollable:"",globalFilterFields:["name","email"],class:"rounded-md overflow-hidden w-full",paginator:"",rows:10,rowsPerPageOptions:[5,10,25]},{header:l(()=>[d("div",te,[d("div",ie,[$(r)?(m(),D("div",ne,i(o.$t("pages.school.teachers"))+" - "+i($(r).length),1)):x("",!0)]),a(F,{label:o.$t("pages.school.inviteTeacher"),icon:"pi pi-plus",variant:"outlined",class:"mr-2",onClick:s[0]||(s[0]=e=>g.value=!0)},null,8,["label"]),a(q,null,{default:l(()=>[a(A,null,{default:l(()=>s[4]||(s[4]=[d("i",{class:"pi pi-search"},null,-1)])),_:1}),a(R,{modelValue:t.value.global.value,"onUpdate:modelValue":s[1]||(s[1]=e=>t.value.global.value=e),placeholder:o.$t("pages.school.search")},null,8,["modelValue","placeholder"])]),_:1})])]),empty:l(()=>[p(i(o.$t("pages.school.noTeachersFound")),1)]),loading:l(()=>[p(i(o.$t("pages.school.loadingTeachers")),1)]),default:l(()=>[a(_,{field:"email",header:o.$t("pages.school.email"),sortable:""},{body:l(({data:e})=>[p(i(e.email),1)]),_:1},8,["header"]),a(_,{field:"name",header:o.$t("pages.school.name"),sortable:""},{body:l(({data:e})=>[d("div",null,i(`${e.name}`),1)]),_:1},8,["header"]),a(_,{header:o.$t("pages.school.status"),sortable:""},{body:l(({data:e})=>[e.registered?e.registered&&!e.invited?(m(),T(k,{key:1,severity:"info"},{default:l(()=>[p(i(o.$t("pages.school.invited")),1)]),_:1})):e.registered&&e.invited?(m(),T(k,{key:2,severity:"success"},{default:l(()=>[p(i(o.$t("pages.school.joined")),1)]),_:1})):x("",!0):(m(),T(k,{key:0,severity:"danger"},{default:l(()=>[p(i(o.$t("pages.school.notRegistered")),1)]),_:1}))]),_:1},8,["header"]),a(_,{exportable:!1},{body:l(({data:e})=>[a(F,{icon:"pi pi-trash",outlined:"",rounded:"",severity:"danger",onClick:re=>w(e.email)},null,8,["onClick"])]),_:1})]),_:1},8,["filters","value","loading"]),a(ae,{modelValue:g.value,"onUpdate:modelValue":s[3]||(s[3]=e=>g.value=e)},null,8,["modelValue"])])}}});export{ke as default};
