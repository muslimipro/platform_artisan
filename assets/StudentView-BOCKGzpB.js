import{s as K}from"./index-bzgAK5Mg.js";import{s as O,a as Q,b as U,c as W}from"./index-DHiANLAF.js";import{s as X}from"./index-ELk9kAPa.js";import{s as Y}from"./index-0lIf6O9I.js";import{s as Z}from"./index-BKSVg22X.js";import{d as I,r as m,m as F,o as a,f as u,c as _,F as T,i as V,L as ee,s as q,u as te,z as se,G as ae,w as r,t as o,b as c,j as B,e as s,g as S,h as oe,n as le,k as ne}from"./index-CvXDlvni.js";import{s as D}from"./index-Cv4Foupa.js";import{S as b,u as ie}from"./useSchoolStore-Df1G3RZK.js";import{T as re}from"./index-C4uQBDlA.js";import"./index-CwAQA0fP.js";import"./index-dYV8A7MW.js";import"./index-BNhhnT_V.js";import"./index-B3J6cNgh.js";import"./index-Cx2Z2ntV.js";const ce={key:1,class:"flex flex-wrap gap-2"},ue=I({__name:"ProjectDetails",props:{id:{},projectId:{}},setup(P){const v=P,g=m(null),i=m(!1);async function h(){if(!i.value){i.value=!0;try{const{data:e}=await b.getStudentProjectSteps(v.id,v.projectId);g.value=e??null}catch(e){console.log(e)}finally{i.value=!1}}}F(h);function y(e,d){if(e!="completed")return e=="attempted"?"warn":(e=="started","secondary")}function $(e,d){if(e!="completed")return e=="attempted"||e=="started"?"outlined":void 0}function k(e,d){switch(e){case"article":return"pi pi-align-left";case"code":return d?"pi pi-hashtag":"pi pi-code";case"question":return"pi pi-question";case"matching":return"pi pi-arrows-h";case"open":return"pi pi-pencil";default:return"pi pi-align-left"}}return(e,d)=>{var x;const p=D,f=q,j=re;return i.value?(a(),u(p,{key:0,class:"flex justify-center"})):(a(),_("div",ce,[(a(!0),_(T,null,V((x=g.value)==null?void 0:x.steps,l=>ee((a(),u(f,{key:l.id,icon:k(l.step_type,l.skip_submit),rounded:"",severity:y(l.status),variant:$(l.status),class:"h-8 min-w-8 w-8"},null,8,["icon","severity","variant"])),[[j,{value:l.name&&l.name.length>0?l.name:l.id.toString()},void 0,{top:!0}]])),128))]))}}}),de={key:1},pe={key:2,class:"flex flex-col items-start px-8 pb-4 gap-4"},fe={class:"w-full flex justify-between items-center"},me={class:"flex gap-4"},_e={class:"flex flex-col gap-2"},ve={class:"pl-1 text-3xl"},ge={class:"pl-1 text-sm"},he={class:"flex flex-col items-end"},ye={class:"text-xl"},xe={class:"text-3xl"},we={key:1,class:"flex flex-col gap-2 w-full"},Se={class:"text-gray-500 text-xl"},be={class:"w-24 h-16 rounded-lg overflow-hidden"},$e=["src"],ke={class:"flex flex-col gap-2 pl-4 w-56 items-start"},je={class:"text-lg"},Pe={class:"flex gap-1"},Ce={class:"flex-grow mr-2"},He=I({__name:"StudentView",setup(P){const v=te(),g=se(),i=le(),h=ne(),{t:y}=ae(),$=ie(),{loadStudents:k}=$,e=m(null),d=m([]),p=m(!1),f=m(!1);async function j(){if(!p.value){p.value=!0;try{const{data:t}=await b.getStudent(Number(i.params.id));e.value=t??null}catch(t){console.log(t)}finally{p.value=!1}}}async function x(){if(!f.value){f.value=!0;try{const{data:t}=await b.getStudentProjects(Number(i.params.id));d.value=t??[]}catch(t){console.log(t)}finally{f.value=!1}}}F(()=>{j(),x()});function l(){g.require({message:"Are you sure you want to expel student from this class?",header:"Confirmation",icon:"pi pi-exclamation-triangle",rejectProps:{label:"Cancel",severity:"secondary",outlined:!0},acceptProps:{label:"Expel",severity:"danger"},accept:()=>{E()}})}async function E(){try{await b.expelStudentFromClass(Number(i.params.id)),await k(),h.go(-1),v.add({severity:"success",summary:y("pages.school.studentRemoved"),life:2e3})}catch(t){v.add({severity:"error",summary:y("pages.school.removeStudentFailed"),detail:t,life:2e3})}}return(t,C)=>{const A=D,N=q,R=Z,w=Y,z=X,L=O,G=Q,H=U,M=W,J=K;return a(),u(J,{class:"flex-grow flex flex-col gap-2"},{default:r(()=>[p.value?(a(),u(A,{key:0,class:"flex justify-center"})):e.value?(a(),_("div",pe,[c(N,{label:t.$t("pages.school.back"),icon:"pi pi-angle-left",severity:"info",variant:"outlined",onClick:C[0]||(C[0]=n=>B(h).go(-1))},null,8,["label"]),s("div",fe,[s("div",me,[c(R,{image:e.value.small_avatar_url.length>0?e.value.small_avatar_url:void 0,shape:"circle",class:"w-[102px] h-[102px]"},null,8,["image"]),s("div",_e,[s("div",ve,o(e.value.name),1),s("div",ge,o(t.$t("pages.school.since"))+" "+o(e.value.created_time.split("T")[0]),1),c(w,{class:"ml-1 w-fit"},{default:r(()=>[S(o(e.value.access_type),1)]),_:1})])]),s("div",he,[s("div",ye,o(e.value.class_name),1),s("div",xe,o(e.value.xp)+" "+o(t.$t("pages.school.xp")),1)])]),f.value?(a(),u(A,{key:0,class:"flex justify-center"})):(a(),_("div",we,[s("div",Se,o(t.$t("pages.school.projects"))+":",1),c(M,{expandIcon:"pi pi-angle-down",collapseIcon:"pi pi-angle-up",lazy:!0,multiple:!0},{default:r(()=>[(a(!0),_(T,null,V(d.value,n=>(a(),u(H,{key:n.id,value:n.id},{default:r(()=>[c(L,{class:"flex gap-2 items-center rounded-lg"},{default:r(()=>[s("div",be,[s("img",{src:n.source_url,class:"w-full h-full object-cover"},null,8,$e)]),s("div",ke,[s("div",je,o(n.name),1),s("div",Pe,[n.layer>0?(a(),u(w,{key:0,severity:"warn"},{default:r(()=>[S(o(t.$t("pages.school.level"))+" - "+o(n.layer),1)]),_:2},1024)):oe("",!0),n.is_guidable?(a(),u(w,{key:1},{default:r(()=>[S(o(t.$t("pages.projects.learn")),1)]),_:1})):(a(),u(w,{key:2,severity:"info"},{default:r(()=>[S(o(t.$t("pages.projects.practice")),1)]),_:1}))])]),s("div",Ce,[c(z,{value:n.student_progress,pt:{root:{class:"bg-gray-200"},value:{class:"bg-cyan-500"}}},null,8,["value"])])]),_:2},1024),c(G,null,{default:r(()=>[c(ue,{id:Number(B(i).params.id),"project-id":Number(n.id)},null,8,["id","project-id"])]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:1})])),c(N,{label:t.$t("pages.school.expelFromClass"),icon:"pi pi-user-minus",severity:"danger",class:"self-end",onClick:l},null,8,["label"])])):(a(),_("div",de,o(t.$t("pages.school.noStudentsFound")),1))]),_:1})}}});export{He as default};
